const __vite__fileDeps=["assets/index-DvY2LsV0.js","assets/index-Beof0WWD.js","assets/index-Cz2wZyyU.css","assets/PWAIcon-DxAi7YRA.js","assets/Preview-CDba-58y.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{r as Cr,a as hn,b as dn,i as Ct,c as Fn,d as zr,e as jr,f as me,g as el,h as _n,j as fu,k as Bi,l as Fi,m as Yi,n as Ji,o as Qi,p as Xg,q as Xw,s as Kg,t as Qf,u as Kw,v as em,w as zc,x as fC,S as Yw,y as mC,R as mu,_ as Jw,z as Lf,A as vC,B as ui,C as R,D as bs,P as kn,E as Kn,F as ci,G as Ue,H as zp,I as gC,J as mh,K as yC,L as Ks,M as zf,N as ft,O as Oe,Q as tl,T as rl,U as Sa,V as Yg,W as Vs,X as Cc,Y as Jg,Z as Qg,$ as k0,a0 as Qw,a1 as tm,a2 as Qr,a3 as eS,a4 as uv,a5 as cv,a6 as pv,a7 as _C,a8 as Ws,a9 as pc,aa as Xi,ab as vh,ac as jp,ad as Gs,ae as jf,af as bC,ag as xC,ah as tS,ai as rS,aj as nS,ak as ey,al as iS,am as ty,an as ry,ao as rm,ap as aS,aq as wC,ar as SC,as as EC,at as ny,au as oS,av as sS,aw as lS,ax as PC,ay as TC,az as CC,aA as IC,aB as iy,aC as MC,aD as OC,aE as RC,aF as AC,aG as uS,aH as cS,aI as kC,aJ as xa,aK as Nf,aL as DC,aM as uh,aN as LC,aO as zC,aP as jC,aQ as D0,aR as L0,aS as z0,aT as ha,aU as pS,aV as NC,aW as Hs,aX as mg,aY as ay,aZ as $s,a_ as j0,a$ as hS,b0 as dS,b1 as fS,b2 as oy,b3 as mS,b4 as sy,b5 as BC,b6 as FC,b7 as UC,b8 as pu,b9 as VC,ba as ly,bb as qC,bc as $C,bd as WC,be as N0,bf as HC,bg as ZC,bh as GC,bi as uy,bj as vS,bk as XC,bl as B0,bm as KC,bn as YC,bo as JC,bp as QC,bq as eI,br as tI,bs as qs,bt as rI,bu as nI,bv as Cf,bw as gS,bx as iI,by as aI,bz as oI,bA as sI,bB as lI,bC as uI,bD as yS,bE as cI,bF as pI,bG as hI,bH as dI,bI as fI,bJ as mI,bK as vI,bL as gI}from"./index-Beof0WWD.js";import{r as _S,a as bS,B as xS,I as yI,b as jc,c as cy,d as py,R as _I,P as bI,T as wS,G as xI,e as wI,O as pi,f as dt,g as Da,h as SI,i as nm,j as SS}from"./PWAIcon-DxAi7YRA.js";function EI(n,t){for(var i=0;i<t.length;i++){const u=t[i];if(typeof u!="string"&&!Array.isArray(u)){for(const p in u)if(p!=="default"&&!(p in n)){const m=Object.getOwnPropertyDescriptor(u,p);m&&Object.defineProperty(n,p,m.get?m:{enumerable:!0,get:()=>u[p]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}var ES={},Ll={},Eh={},zl={},F0;function PI(){if(F0)return zl;F0=1;var n=Ct;Object.defineProperty(zl,"__esModule",{value:!0}),zl.default=zl.styles=void 0;var t=n(Fn()),i=n(zr()),u=n(jr()),p=n(me);n(Cr());var m=n(hn());n(el());var o=n(dn()),_=function(M){var I={};return M.shadows.forEach(function(N,D){I["elevation".concat(D)]={boxShadow:N}}),(0,u.default)({root:{backgroundColor:M.palette.background.paper},rounded:{borderRadius:M.shape.borderRadius}},I)};zl.styles=_;function b(T){var M=T.classes,I=T.className,N=T.component,D=T.square,re=T.elevation,W=(0,i.default)(T,["classes","className","component","square","elevation"]),ee=(0,m.default)(M.root,M["elevation".concat(re)],(0,t.default)({},M.rounded,!D),I);return p.default.createElement(N,(0,u.default)({className:ee},W))}b.propTypes={},b.defaultProps={component:"div",elevation:2,square:!1};var E=(0,o.default)(_,{name:"MuiPaper"})(b);return zl.default=E,zl}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(PI())})(Eh);const Ic=_n(Eh);var U0;function TI(){if(U0)return Ll;U0=1;var n=Ct;Object.defineProperty(Ll,"__esModule",{value:!0}),Ll.default=Ll.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(me);n(Cr());var m=n(hn()),o=n(dn()),_=fu(),b=n(Eh),E=function(N){var D=N.palette.type==="light"?N.palette.grey[100]:N.palette.grey[900];return{root:{display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",zIndex:N.zIndex.appBar,flexShrink:0},positionFixed:{position:"fixed",top:0,left:"auto",right:0},positionAbsolute:{position:"absolute",top:0,left:"auto",right:0},positionSticky:{position:"sticky",top:0,left:"auto",right:0},positionStatic:{position:"static"},colorDefault:{backgroundColor:D,color:N.palette.getContrastText(D)},colorPrimary:{backgroundColor:N.palette.primary.main,color:N.palette.primary.contrastText},colorSecondary:{backgroundColor:N.palette.secondary.main,color:N.palette.secondary.contrastText}}};Ll.styles=E;function T(I){var N,D=I.children,re=I.classes,W=I.className,ee=I.color,J=I.position,Y=(0,u.default)(I,["children","classes","className","color","position"]),B=(0,m.default)(re.root,re["position".concat((0,_.capitalize)(J))],(N={},(0,i.default)(N,re["color".concat((0,_.capitalize)(ee))],ee!=="inherit"),(0,i.default)(N,"mui-fixed",J==="fixed"),N),W);return p.default.createElement(b.default,(0,t.default)({square:!0,component:"header",elevation:4,className:B},Y),D)}T.propTypes={},T.defaultProps={color:"primary",position:"fixed"};var M=(0,o.default)(E,{name:"MuiAppBar"})(T);return Ll.default=M,Ll}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(TI())})(ES);const CI=_n(ES);var PS={},jl={},TS={},Np={},V0;function II(){if(V0)return Np;V0=1;var n=Ct;Object.defineProperty(Np,"__esModule",{value:!0}),Np.default=void 0;var t=n(jr()),i=n(zr()),u=n(Bi()),p=n(Fi()),m=n(Yi()),o=n(Ji()),_=n(Qi()),b=n(me);n(Cr());var E=n(_S()),T=Xg(),M=n(Xw()),I=bS(),N={entering:{opacity:1},entered:{opacity:1}},D=function(W){(0,_.default)(ee,W);function ee(){var J,Y;(0,u.default)(this,ee);for(var B=arguments.length,V=new Array(B),K=0;K<B;K++)V[K]=arguments[K];return Y=(0,m.default)(this,(J=(0,o.default)(ee)).call.apply(J,[this].concat(V))),Y.handleEnter=function(ve){var de=Y.props.theme;(0,I.reflow)(ve);var ie=(0,I.getTransitionProps)(Y.props,{mode:"enter"});ve.style.webkitTransition=de.transitions.create("opacity",ie),ve.style.transition=de.transitions.create("opacity",ie),Y.props.onEnter&&Y.props.onEnter(ve)},Y.handleExit=function(ve){var de=Y.props.theme,ie=(0,I.getTransitionProps)(Y.props,{mode:"exit"});ve.style.webkitTransition=de.transitions.create("opacity",ie),ve.style.transition=de.transitions.create("opacity",ie),Y.props.onExit&&Y.props.onExit(ve)},Y}return(0,p.default)(ee,[{key:"render",value:function(){var Y=this.props,B=Y.children;Y.onEnter,Y.onExit;var V=Y.style;Y.theme;var K=(0,i.default)(Y,["children","onEnter","onExit","style","theme"]),ve=(0,t.default)({},V,b.default.isValidElement(B)?B.props.style:{});return b.default.createElement(E.default,(0,t.default)({appear:!0,onEnter:this.handleEnter,onExit:this.handleExit},K),function(de,ie){return b.default.cloneElement(B,(0,t.default)({style:(0,t.default)({opacity:0,willChange:"opacity"},N[de],ve)},ie))})}}]),ee}(b.default.Component);D.propTypes={},D.defaultProps={timeout:{enter:T.duration.enteringScreen,exit:T.duration.leavingScreen}};var re=(0,M.default)()(D);return Np.default=re,Np}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(II())})(TS);var q0;function MI(){if(q0)return jl;q0=1;var n=Ct;Object.defineProperty(jl,"__esModule",{value:!0}),jl.default=jl.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(me);n(Cr());var m=n(hn()),o=n(dn()),_=n(TS),b={root:{zIndex:-1,position:"fixed",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",touchAction:"none"},invisible:{backgroundColor:"transparent"}};jl.styles=b;function E(M){var I=M.classes,N=M.className,D=M.invisible,re=M.open,W=M.transitionDuration,ee=(0,u.default)(M,["classes","className","invisible","open","transitionDuration"]);return p.default.createElement(_.default,(0,t.default)({appear:!0,in:re,timeout:W},ee),p.default.createElement("div",{className:(0,m.default)(I.root,(0,i.default)({},I.invisible,D),N),"aria-hidden":"true"}))}E.propTypes={},E.defaultProps={invisible:!1};var T=(0,o.default)(b,{name:"MuiBackdrop"})(E);return jl.default=T,jl}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(MI())})(PS);var CS={},Nl={},$0;function OI(){if($0)return Nl;$0=1;var n=Ct;Object.defineProperty(Nl,"__esModule",{value:!0}),Nl.default=Nl.styles=void 0;var t=n(Fn()),i=n(zr()),u=n(jr()),p=n(me);n(Cr());var m=n(hn()),o=n(dn()),_=Kg(),b=n(xS),E=fu(),T=function(D){return{root:(0,u.default)({},D.typography.button,{lineHeight:"1.4em",boxSizing:"border-box",minWidth:64,minHeight:36,padding:"8px 16px",borderRadius:D.shape.borderRadius,color:D.palette.text.primary,transition:D.transitions.create(["background-color","box-shadow","border"],{duration:D.transitions.duration.short}),"&:hover":{textDecoration:"none",backgroundColor:(0,_.fade)(D.palette.text.primary,D.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"},"&$disabled":{backgroundColor:"transparent"}},"&$disabled":{color:D.palette.action.disabled}}),label:{width:"100%",display:"inherit",alignItems:"inherit",justifyContent:"inherit"},text:{},textPrimary:{color:D.palette.primary.main,"&:hover":{backgroundColor:(0,_.fade)(D.palette.primary.main,D.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},textSecondary:{color:D.palette.secondary.main,"&:hover":{backgroundColor:(0,_.fade)(D.palette.secondary.main,D.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},flat:{},flatPrimary:{},flatSecondary:{},outlined:{border:"1px solid ".concat(D.palette.type==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")},outlinedPrimary:{border:"1px solid ".concat((0,_.fade)(D.palette.primary.main,.5)),"&:hover":{border:"1px solid ".concat(D.palette.primary.main)}},outlinedSecondary:{border:"1px solid ".concat((0,_.fade)(D.palette.secondary.main,.5)),"&:hover":{border:"1px solid ".concat(D.palette.secondary.main)}},contained:{color:D.palette.getContrastText(D.palette.grey[300]),backgroundColor:D.palette.grey[300],boxShadow:D.shadows[2],"&$focusVisible":{boxShadow:D.shadows[6]},"&:active":{boxShadow:D.shadows[8]},"&$disabled":{color:D.palette.action.disabled,boxShadow:D.shadows[0],backgroundColor:D.palette.action.disabledBackground},"&:hover":{backgroundColor:D.palette.grey.A100,"@media (hover: none)":{backgroundColor:D.palette.grey[300]},"&$disabled":{backgroundColor:D.palette.action.disabledBackground}}},containedPrimary:{color:D.palette.primary.contrastText,backgroundColor:D.palette.primary.main,"&:hover":{backgroundColor:D.palette.primary.dark,"@media (hover: none)":{backgroundColor:D.palette.primary.main}}},containedSecondary:{color:D.palette.secondary.contrastText,backgroundColor:D.palette.secondary.main,"&:hover":{backgroundColor:D.palette.secondary.dark,"@media (hover: none)":{backgroundColor:D.palette.secondary.main}}},raised:{},raisedPrimary:{},raisedSecondary:{},fab:{borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,boxShadow:D.shadows[6],"&:active":{boxShadow:D.shadows[12]}},extendedFab:{borderRadius:48/2,padding:"0 16px",width:"auto",minWidth:48,height:48},focusVisible:{},disabled:{},colorInherit:{color:"inherit"},mini:{width:40,height:40},sizeSmall:{padding:"7px 8px",minWidth:64,minHeight:32,fontSize:D.typography.pxToRem(13)},sizeLarge:{padding:"8px 24px",minWidth:112,minHeight:40,fontSize:D.typography.pxToRem(15)},fullWidth:{width:"100%"}}};Nl.styles=T;function M(N){var D,re=N.children,W=N.classes,ee=N.className,J=N.color,Y=N.disabled,B=N.disableFocusRipple,V=N.fullWidth,K=N.focusVisibleClassName,ve=N.mini,de=N.size,ie=N.variant,we=(0,i.default)(N,["children","classes","className","color","disabled","disableFocusRipple","fullWidth","focusVisibleClassName","mini","size","variant"]),ze=ie==="fab"||ie==="extendedFab",De=ie==="contained"||ie==="raised",ce=ie==="text"||ie==="flat"||ie==="outlined",Pe=(0,m.default)(W.root,(D={},(0,t.default)(D,W.fab,ze),(0,t.default)(D,W.mini,ze&&ve),(0,t.default)(D,W.extendedFab,ie==="extendedFab"),(0,t.default)(D,W.text,ce),(0,t.default)(D,W.textPrimary,ce&&J==="primary"),(0,t.default)(D,W.textSecondary,ce&&J==="secondary"),(0,t.default)(D,W.flat,ie==="text"||ie==="flat"),(0,t.default)(D,W.flatPrimary,(ie==="text"||ie==="flat")&&J==="primary"),(0,t.default)(D,W.flatSecondary,(ie==="text"||ie==="flat")&&J==="secondary"),(0,t.default)(D,W.contained,De||ze),(0,t.default)(D,W.containedPrimary,(De||ze)&&J==="primary"),(0,t.default)(D,W.containedSecondary,(De||ze)&&J==="secondary"),(0,t.default)(D,W.raised,De||ze),(0,t.default)(D,W.raisedPrimary,(De||ze)&&J==="primary"),(0,t.default)(D,W.raisedSecondary,(De||ze)&&J==="secondary"),(0,t.default)(D,W.outlined,ie==="outlined"),(0,t.default)(D,W.outlinedPrimary,ie==="outlined"&&J==="primary"),(0,t.default)(D,W.outlinedSecondary,ie==="outlined"&&J==="secondary"),(0,t.default)(D,W["size".concat((0,E.capitalize)(de))],de!=="medium"),(0,t.default)(D,W.disabled,Y),(0,t.default)(D,W.fullWidth,V),(0,t.default)(D,W.colorInherit,J==="inherit"),D),ee);return p.default.createElement(b.default,(0,u.default)({className:Pe,disabled:Y,focusRipple:!B,focusVisibleClassName:(0,m.default)(W.focusVisible,K)},we),p.default.createElement("span",{className:W.label},re))}M.propTypes={},M.defaultProps={color:"default",component:"button",disabled:!1,disableFocusRipple:!1,fullWidth:!1,mini:!1,size:"medium",type:"button",variant:"text"};var I=(0,o.default)(T,{name:"MuiButton"})(M);return Nl.default=I,Nl}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(OI())})(CS);const an=_n(CS);var Bl={},W0;function IS(){if(W0)return Bl;W0=1;var n=Ct;Object.defineProperty(Bl,"__esModule",{value:!0}),Bl.cloneElementWithClassName=u,Bl.cloneChildrenWithClassName=p,Bl.isMuiElement=m,Bl.isMuiComponent=o;var t=n(me),i=n(hn());function u(_,b){return t.default.cloneElement(_,{className:(0,i.default)(_.props.className,b)})}function p(_,b){return t.default.Children.map(_,function(E){return t.default.isValidElement(E)&&u(E,b)})}function m(_,b){return t.default.isValidElement(_)&&b.indexOf(_.type.muiName)!==-1}function o(_,b){return b.indexOf(_.muiName)!==-1}return Bl}var Fl={},H0;function RI(){if(H0)return Fl;H0=1;var n=Ct;Object.defineProperty(Fl,"__esModule",{value:!0}),Fl.default=Fl.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(Bi()),m=n(Fi()),o=n(Yi()),_=n(Ji()),b=n(Qi()),E=n(me),T=n(Cr()),M=n(hn()),I=n(dn()),N=n(yI),D={root:{display:"inline-flex",alignItems:"center",transition:"none","&:hover":{backgroundColor:"transparent"}},checked:{},disabled:{},input:{cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0}};Fl.styles=D;var re=function(ee){(0,b.default)(J,ee);function J(Y){var B;return(0,p.default)(this,J),B=(0,o.default)(this,(0,_.default)(J).call(this)),B.input=null,B.isControlled=null,B.state={},B.handleFocus=function(V){B.props.onFocus&&B.props.onFocus(V);var K=B.context.muiFormControl;K&&K.onFocus&&K.onFocus(V)},B.handleBlur=function(V){B.props.onBlur&&B.props.onBlur(V);var K=B.context.muiFormControl;K&&K.onBlur&&K.onBlur(V)},B.handleInputChange=function(V){var K=V.target.checked;B.isControlled||B.setState({checked:K}),B.props.onChange&&B.props.onChange(V,K)},B.isControlled=Y.checked!=null,B.isControlled||(B.state.checked=Y.defaultChecked!==void 0?Y.defaultChecked:!1),B}return(0,m.default)(J,[{key:"render",value:function(){var B,V=this.props,K=V.autoFocus,ve=V.checked,de=V.checkedIcon,ie=V.classes,we=V.className,ze=V.disabled,De=V.icon,ce=V.id,Pe=V.inputProps,gt=V.inputRef,jt=V.name;V.onBlur,V.onChange,V.onFocus;var Tt=V.readOnly,kt=V.required,Ir=V.tabIndex,pr=V.type,Zt=V.value,Kt=(0,u.default)(V,["autoFocus","checked","checkedIcon","classes","className","disabled","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"]),Yt=this.context.muiFormControl,Dt=ze;Yt&&typeof Dt>"u"&&(Dt=Yt.disabled);var Gt=this.isControlled?ve:this.state.checked,yr=pr==="checkbox"||pr==="radio";return E.default.createElement(N.default,(0,t.default)({component:"span",className:(0,M.default)(ie.root,(B={},(0,i.default)(B,ie.checked,Gt),(0,i.default)(B,ie.disabled,Dt),B),we),disabled:Dt,tabIndex:null,role:void 0,onFocus:this.handleFocus,onBlur:this.handleBlur},Kt),Gt?de:De,E.default.createElement("input",(0,t.default)({autoFocus:K,checked:Gt,className:ie.input,disabled:Dt,id:yr&&ce,name:jt,onChange:this.handleInputChange,readOnly:Tt,ref:gt,required:kt,tabIndex:Ir,type:pr,value:Zt},Pe)))}}]),J}(E.default.Component);re.propTypes={},re.contextTypes={muiFormControl:T.default.object};var W=(0,I.default)(D,{name:"MuiSwitchBase"})(re);return Fl.default=W,Fl}var Bp={},Fp={},hv,Z0;function AI(){if(Z0)return hv;Z0=1;function n(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i}return hv=n,hv}var Up={},Vp={},G0;function kI(){if(G0)return Vp;G0=1,Object.defineProperty(Vp,"__esModule",{value:!0}),Vp.default=void 0;var n=function(u,p){return function(m){return m[u]=p,m}},t=n;return Vp.default=t,Vp}var X0;function MS(){if(X0)return Up;X0=1;var n=Qf();Object.defineProperty(Up,"__esModule",{value:!0}),Up.default=void 0;var t=n(kI()),i=function(m){return(0,t.default)("displayName",m)},u=i;return Up.default=u,Up}var K0;function DI(){if(K0)return Fp;K0=1;var n=Qf();Object.defineProperty(Fp,"__esModule",{value:!0}),Fp.default=void 0;var t=n(AI()),i=me;n(MS()),n(Kw());var u=function(o){return function(_){var b=(0,i.createFactory)(_),E=function(T){(0,t.default)(M,T);function M(){return T.apply(this,arguments)||this}var I=M.prototype;return I.shouldComponentUpdate=function(D){return o(this.props,D)},I.render=function(){return b(this.props)},M}(i.Component);return E}},p=u;return Fp.default=p,Fp}var qp={},dv,Y0;function OS(){if(Y0)return dv;Y0=1;var n=Object.prototype.hasOwnProperty;function t(u,p){return u===p?u!==0||p!==0||1/u===1/p:u!==u&&p!==p}function i(u,p){if(t(u,p))return!0;if(typeof u!="object"||u===null||typeof p!="object"||p===null)return!1;var m=Object.keys(u),o=Object.keys(p);if(m.length!==o.length)return!1;for(var _=0;_<m.length;_++)if(!n.call(p,m[_])||!t(u[m[_]],p[m[_]]))return!1;return!0}return dv=i,dv}var J0;function LI(){if(J0)return qp;J0=1;var n=Qf();Object.defineProperty(qp,"__esModule",{value:!0}),qp.default=void 0;var t=n(OS()),i=t.default;return qp.default=i,qp}var Q0;function zI(){if(Q0)return Bp;Q0=1;var n=Qf();Object.defineProperty(Bp,"__esModule",{value:!0}),Bp.default=void 0;var t=n(DI()),i=n(LI());n(MS()),n(Kw());var u=function(o){var _=(0,t.default)(function(b,E){return!(0,i.default)(b,E)});return _(o)},p=u;return Bp.default=p,Bp}var RS={},$p={},Wp={},fv={exports:{}},eb;function jI(){return eb||(eb=1,function(n){function t(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(fv)),fv.exports}var mv={exports:{}},vv={exports:{}},gv={exports:{}},tb;function NI(){return tb||(tb=1,function(n){var t=em().default;function i(u,p){if(t(u)!="object"||!u)return u;var m=u[Symbol.toPrimitive];if(m!==void 0){var o=m.call(u,p||"default");if(t(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(p==="string"?String:Number)(u)}n.exports=i,n.exports.__esModule=!0,n.exports.default=n.exports}(gv)),gv.exports}var rb;function BI(){return rb||(rb=1,function(n){var t=em().default,i=NI();function u(p){var m=i(p,"string");return t(m)=="symbol"?m:m+""}n.exports=u,n.exports.__esModule=!0,n.exports.default=n.exports}(vv)),vv.exports}var nb;function FI(){return nb||(nb=1,function(n){var t=BI();function i(p,m){for(var o=0;o<m.length;o++){var _=m[o];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(p,t(_.key),_)}}function u(p,m,o){return m&&i(p.prototype,m),o&&i(p,o),Object.defineProperty(p,"prototype",{writable:!1}),p}n.exports=u,n.exports.__esModule=!0,n.exports.default=n.exports}(mv)),mv.exports}var yv={exports:{}},_v={exports:{}},ib;function UI(){return ib||(ib=1,function(n){function t(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(_v)),_v.exports}var ab;function VI(){return ab||(ab=1,function(n){var t=em().default,i=UI();function u(p,m){if(m&&(t(m)==="object"||typeof m=="function"))return m;if(m!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return i(p)}n.exports=u,n.exports.__esModule=!0,n.exports.default=n.exports}(yv)),yv.exports}var bv={exports:{}},ob;function qI(){return ob||(ob=1,function(n){function t(i){return n.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},n.exports.__esModule=!0,n.exports.default=n.exports,t(i)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(bv)),bv.exports}var xv={exports:{}},wv={exports:{}},sb;function $I(){return sb||(sb=1,function(n){function t(i,u){return n.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(m,o){return m.__proto__=o,m},n.exports.__esModule=!0,n.exports.default=n.exports,t(i,u)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(wv)),wv.exports}var lb;function WI(){return lb||(lb=1,function(n){var t=$I();function i(u,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(p&&p.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),Object.defineProperty(u,"prototype",{writable:!1}),p&&t(u,p)}n.exports=i,n.exports.__esModule=!0,n.exports.default=n.exports}(xv)),xv.exports}var Sv={exports:{}},Ev={exports:{}},ub;function HI(){return ub||(ub=1,function(n){function t(i,u){if(i==null)return{};var p={},m=Object.keys(i),o,_;for(_=0;_<m.length;_++)o=m[_],!(u.indexOf(o)>=0)&&(p[o]=i[o]);return p}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(Ev)),Ev.exports}var cb;function ZI(){return cb||(cb=1,function(n){var t=HI();function i(u,p){if(u==null)return{};var m=t(u,p),o,_;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(u);for(_=0;_<b.length;_++)o=b[_],!(p.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(u,o)&&(m[o]=u[o])}return m}n.exports=i,n.exports.__esModule=!0,n.exports.default=n.exports}(Sv)),Sv.exports}var Pv={exports:{}},pb;function GI(){return pb||(pb=1,function(n){function t(){return n.exports=t=Object.assign?Object.assign.bind():function(i){for(var u=1;u<arguments.length;u++){var p=arguments[u];for(var m in p)Object.prototype.hasOwnProperty.call(p,m)&&(i[m]=p[m])}return i},n.exports.__esModule=!0,n.exports.default=n.exports,t.apply(this,arguments)}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(Pv)),Pv.exports}var hb;function im(){if(hb)return Wp;hb=1,Object.defineProperty(Wp,"__esModule",{value:!0});function n(B){return B&&typeof B=="object"&&"default"in B?B.default:B}var t=n(jI()),i=n(FI()),u=n(VI()),p=n(qI()),m=n(WI()),o=n(em()),_=n(ZI()),b=n(GI()),E=n(me);n(Cr()),n(el());function T(B,V,K){return Object.defineProperty(B,V,K)}var M=function(){var B=null;return function(){if(B!==null)return B;var V=!1;try{window.addEventListener("test",null,T({},"passive",{get:function(){V=!0}}))}catch{}return B=V,V}()}(),I={capture:!1,passive:!1};function N(B){return b({},I,B)}function D(B,V,K){var ve=[B,V];return ve.push(M?K:K.capture),ve}function re(B,V,K,ve){B.addEventListener.apply(B,D(V,K,ve))}function W(B,V,K,ve){B.removeEventListener.apply(B,D(V,K,ve))}function ee(B,V){B.children,B.target;var K=_(B,["children","target"]);Object.keys(K).forEach(function(ve){if(ve.substring(0,2)==="on"){var de=K[ve],ie=o(de),we=ie==="object",ze=ie==="function";if(!(!we&&!ze)){var De=ve.substr(-7).toLowerCase()==="capture",ce=ve.substring(2).toLowerCase();ce=De?ce.substring(0,ce.length-7):ce,we?V(ce,de.handler,de.options):V(ce,de,N({capture:De}))}}})}function J(B,V){return{handler:B,options:N(V)}}var Y=function(B){m(V,B);function V(){return t(this,V),u(this,p(V).apply(this,arguments))}return i(V,[{key:"componentDidMount",value:function(){this.applyListeners(re)}},{key:"componentDidUpdate",value:function(ve){this.applyListeners(W,ve),this.applyListeners(re)}},{key:"componentWillUnmount",value:function(){this.applyListeners(W)}},{key:"applyListeners",value:function(ve){var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.props,ie=de.target;if(ie){var we=ie;typeof ie=="string"&&(we=window[ie]),ee(de,ve.bind(null,we))}}},{key:"render",value:function(){return this.props.children||null}}]),V}(E.PureComponent);return Y.propTypes={},Wp.withOptions=J,Wp.default=Y,Wp}var db;function XI(){if(db)return $p;db=1;var n=Ct;Object.defineProperty($p,"__esModule",{value:!0}),$p.default=void 0;var t=n(jr()),i=n(zr()),u=n(Bi()),p=n(Fi()),m=n(Yi()),o=n(Ji()),_=n(Qi()),b=n(me),E=n(zc);n(Cr());var T=n(im()),M=n(jc()),I=function(D){(0,_.default)(re,D);function re(){var W,ee;(0,u.default)(this,re);for(var J=arguments.length,Y=new Array(J),B=0;B<J;B++)Y[B]=arguments[B];return ee=(0,m.default)(this,(W=(0,o.default)(re)).call.apply(W,[this].concat(Y))),ee.node=null,ee.mounted=null,ee.handleClickAway=function(V){if(!V.defaultPrevented&&ee.mounted&&ee.node){var K=(0,M.default)(ee.node);K.documentElement&&K.documentElement.contains(V.target)&&!ee.node.contains(V.target)&&ee.props.onClickAway(V)}},ee}return(0,p.default)(re,[{key:"componentDidMount",value:function(){this.node=E.default.findDOMNode(this),this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var ee=this.props,J=ee.children,Y=ee.mouseEvent,B=ee.touchEvent;ee.onClickAway;var V=(0,i.default)(ee,["children","mouseEvent","touchEvent","onClickAway"]),K={};return Y!==!1&&(K[Y]=this.handleClickAway),B!==!1&&(K[B]=this.handleClickAway),b.default.createElement(T.default,(0,t.default)({target:"document"},K,V),J)}}]),re}(b.default.Component);I.propTypes={},I.defaultProps={mouseEvent:"onMouseUp",touchEvent:"onTouchEnd"};var N=I;return $p.default=N,$p}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(XI())})(RS);const KI=_n(RS);var am={},Ul={},Hp={},Hd={exports:{}},Tv={exports:{}},fb;function Nc(){return fb||(fb=1,function(n){function t(i){return i&&i.__esModule?i:{default:i}}n.exports=t,n.exports.__esModule=!0,n.exports.default=n.exports}(Tv)),Tv.exports}var Zd={exports:{}},Gd={exports:{}},mb;function YI(){return mb||(mb=1,function(n,t){t.__esModule=!0,t.default=u;var i=/-(.)/g;function u(p){return p.replace(i,function(m,o){return o.toUpperCase()})}n.exports=t.default}(Gd,Gd.exports)),Gd.exports}var vb;function AS(){return vb||(vb=1,function(n,t){var i=Nc();t.__esModule=!0,t.default=m;var u=i(YI()),p=/^-ms-/;function m(o){return(0,u.default)(o.replace(p,"ms-"))}n.exports=t.default}(Zd,Zd.exports)),Zd.exports}var Xd={exports:{}},Kd={exports:{}},gb;function JI(){return gb||(gb=1,function(n,t){t.__esModule=!0,t.default=u;var i=/([A-Z])/g;function u(p){return p.replace(i,"-$1").toLowerCase()}n.exports=t.default}(Kd,Kd.exports)),Kd.exports}var yb;function QI(){return yb||(yb=1,function(n,t){var i=Nc();t.__esModule=!0,t.default=m;var u=i(JI()),p=/^ms-/;function m(o){return(0,u.default)(o).replace(p,"-ms-")}n.exports=t.default}(Xd,Xd.exports)),Xd.exports}var Yd={exports:{}},_b;function eM(){return _b||(_b=1,function(n,t){var i=Nc();t.__esModule=!0,t.default=o;var u=i(AS()),p=/^(top|right|bottom|left)$/,m=/^([+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|))(?!px)[a-z%]+$/i;function o(_){if(!_)throw new TypeError("No Element passed to `getComputedStyle()`");var b=_.ownerDocument;return"defaultView"in b?b.defaultView.opener?_.ownerDocument.defaultView.getComputedStyle(_,null):window.getComputedStyle(_,null):{getPropertyValue:function(T){var M=_.style;T=(0,u.default)(T),T=="float"&&(T="styleFloat");var I=_.currentStyle[T]||null;if(I==null&&M&&M[T]&&(I=M[T]),m.test(I)&&!p.test(T)){var N=M.left,D=_.runtimeStyle,re=D&&D.left;re&&(D.left=_.currentStyle.left),M.left=T==="fontSize"?"1em":I,I=M.pixelLeft+"px",M.left=N,re&&(D.left=re)}return I}}}n.exports=t.default}(Yd,Yd.exports)),Yd.exports}var Jd={exports:{}},bb;function tM(){return bb||(bb=1,function(n,t){t.__esModule=!0,t.default=i;function i(u,p){return"removeProperty"in u.style?u.style.removeProperty(p):u.style.removeAttribute(p)}n.exports=t.default}(Jd,Jd.exports)),Jd.exports}var Er={},Qd={exports:{}},xb;function kS(){return xb||(xb=1,function(n,t){t.__esModule=!0,t.default=void 0;var i=!!(typeof window<"u"&&window.document&&window.document.createElement);t.default=i,n.exports=t.default}(Qd,Qd.exports)),Qd.exports}var wb;function rM(){if(wb)return Er;wb=1;var n=Nc();Er.__esModule=!0,Er.default=Er.animationEnd=Er.animationDelay=Er.animationTiming=Er.animationDuration=Er.animationName=Er.transitionEnd=Er.transitionDuration=Er.transitionDelay=Er.transitionTiming=Er.transitionProperty=Er.transform=void 0;var t=n(kS()),i="transform";Er.transform=i;var u,p,m;Er.animationEnd=m,Er.transitionEnd=p;var o,_,b,E;Er.transitionDelay=E,Er.transitionTiming=b,Er.transitionDuration=_,Er.transitionProperty=o;var T,M,I,N;if(Er.animationDelay=N,Er.animationTiming=I,Er.animationDuration=M,Er.animationName=T,t.default){var D=W();u=D.prefix,Er.transitionEnd=p=D.transitionEnd,Er.animationEnd=m=D.animationEnd,Er.transform=i=u+"-"+i,Er.transitionProperty=o=u+"-transition-property",Er.transitionDuration=_=u+"-transition-duration",Er.transitionDelay=E=u+"-transition-delay",Er.transitionTiming=b=u+"-transition-timing-function",Er.animationName=T=u+"-animation-name",Er.animationDuration=M=u+"-animation-duration",Er.animationTiming=I=u+"-animation-delay",Er.animationDelay=N=u+"-animation-timing-function"}var re={transform:i,end:p,property:o,timing:b,delay:E,duration:_};Er.default=re;function W(){for(var ee=document.createElement("div").style,J={O:function(we){return"o"+we.toLowerCase()},Moz:function(we){return we.toLowerCase()},Webkit:function(we){return"webkit"+we},ms:function(we){return"MS"+we}},Y=Object.keys(J),B,V,K="",ve=0;ve<Y.length;ve++){var de=Y[ve];if(de+"TransitionProperty"in ee){K="-"+de.toLowerCase(),B=J[de]("TransitionEnd"),V=J[de]("AnimationEnd");break}}return!B&&"transitionProperty"in ee&&(B="transitionend"),!V&&"animationName"in ee&&(V="animationend"),ee=null,{animationEnd:V,transitionEnd:B,prefix:K}}return Er}var ef={exports:{}},Sb;function nM(){return Sb||(Sb=1,function(n,t){t.__esModule=!0,t.default=u;var i=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function u(p){return!!(p&&i.test(p))}n.exports=t.default}(ef,ef.exports)),ef.exports}var Eb;function iM(){return Eb||(Eb=1,function(n,t){var i=Nc();t.__esModule=!0,t.default=E;var u=i(AS()),p=i(QI()),m=i(eM()),o=i(tM()),_=rM(),b=i(nM());function E(T,M,I){var N="",D="",re=M;if(typeof M=="string"){if(I===void 0)return T.style[(0,u.default)(M)]||(0,m.default)(T).getPropertyValue((0,p.default)(M));(re={})[M]=I}Object.keys(re).forEach(function(W){var ee=re[W];!ee&&ee!==0?(0,o.default)(T,(0,p.default)(W)):(0,b.default)(W)?D+=W+"("+ee+") ":N+=(0,p.default)(W)+": "+ee+";"}),D&&(N+=_.transform+": "+D+";"),T.style.cssText+=";"+N}n.exports=t.default}(Hd,Hd.exports)),Hd.exports}var tf={exports:{}},Pb;function DS(){return Pb||(Pb=1,function(n,t){var i=Nc();t.__esModule=!0,t.default=m;var u=i(kS()),p;function m(o){if((!p&&p!==0||o)&&u.default){var _=document.createElement("div");_.style.position="absolute",_.style.top="-9999px",_.style.width="50px",_.style.height="50px",_.style.overflow="scroll",document.body.appendChild(_),p=_.offsetWidth-_.clientWidth,document.body.removeChild(_)}return p}n.exports=t.default}(tf,tf.exports)),tf.exports}var Zp={},rf={exports:{}},Tb;function aM(){return Tb||(Tb=1,function(n,t){t.__esModule=!0,t.default=i;function i(u){return u===u.window?u:u.nodeType===9?u.defaultView||u.parentWindow:!1}n.exports=t.default}(rf,rf.exports)),rf.exports}var Cb;function oM(){if(Cb)return Zp;Cb=1;var n=Ct;Object.defineProperty(Zp,"__esModule",{value:!0}),Zp.isBody=p,Zp.default=m;var t=n(aM()),i=n(jc()),u=n(cy());function p(o){return o&&o.tagName.toLowerCase()==="body"}function m(o){var _=(0,i.default)(o),b=(0,u.default)(_);if(!(0,t.default)(_)&&!p(o))return o.scrollHeight>o.clientHeight;var E=b.getComputedStyle(_.body),T=parseInt(E.getPropertyValue("margin-left"),10),M=parseInt(E.getPropertyValue("margin-right"),10);return T+_.body.clientWidth+M<b.innerWidth}return Zp}var hc={},Ib;function sM(){if(Ib)return hc;Ib=1,Object.defineProperty(hc,"__esModule",{value:!0}),hc.ariaHidden=u,hc.hideSiblings=p,hc.showSiblings=m;var n=["template","script","style"];function t(o){return o.nodeType===1&&n.indexOf(o.tagName.toLowerCase())===-1}function i(o,_,b){_=[].concat(_),[].forEach.call(o.children,function(E){_.indexOf(E)===-1&&t(E)&&b(E)})}function u(o,_){_&&(o?_.setAttribute("aria-hidden","true"):_.removeAttribute("aria-hidden"))}function p(o,_){i(o,_,function(b){return u(!0,b)})}function m(o,_){i(o,_,function(b){return u(!1,b)})}return hc}var Mb;function LS(){if(Mb)return Hp;Mb=1;var n=Ct;Object.defineProperty(Hp,"__esModule",{value:!0}),Hp.default=void 0;var t=n(Bi()),i=n(Fi()),u=n(iM()),p=n(DS()),m=n(jc()),o=n(oM()),_=sM();function b(D,re){var W=-1;return D.some(function(ee,J){return re(ee)?(W=J,!0):!1}),W}function E(D){return parseInt((0,u.default)(D,"paddingRight")||0,10)}function T(D,re){var W={overflow:"hidden"};if(D.style={overflow:re.style.overflow,paddingRight:re.style.paddingRight},D.overflowing){var ee=(0,p.default)();W.paddingRight="".concat(E(re)+ee,"px");for(var J=(0,m.default)(re).querySelectorAll(".mui-fixed"),Y=0;Y<J.length;Y+=1){var B=E(J[Y]);D.prevPaddings.push(B),J[Y].style.paddingRight="".concat(B+ee,"px")}}Object.keys(W).forEach(function(V){re.style[V]=W[V]})}function M(D,re){Object.keys(D.style).forEach(function(J){re.style[J]=D.style[J]});for(var W=(0,m.default)(re).querySelectorAll(".mui-fixed"),ee=0;ee<W.length;ee+=1)W[ee].style.paddingRight="".concat(D.prevPaddings[ee],"px")}var I=function(){function D(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,t.default)(this,D);var W=re.hideSiblingNodes,ee=W===void 0?!0:W,J=re.handleContainerOverflow,Y=J===void 0?!0:J;this.hideSiblingNodes=ee,this.handleContainerOverflow=Y,this.modals=[],this.containers=[],this.data=[]}return(0,i.default)(D,[{key:"add",value:function(W,ee){var J=this.modals.indexOf(W);if(J!==-1)return J;J=this.modals.length,this.modals.push(W),this.hideSiblingNodes&&(0,_.hideSiblings)(ee,W.mountNode);var Y=this.containers.indexOf(ee);if(Y!==-1)return this.data[Y].modals.push(W),J;var B={modals:[W],overflowing:(0,o.default)(ee),prevPaddings:[]};return this.handleContainerOverflow&&T(B,ee),this.containers.push(ee),this.data.push(B),J}},{key:"remove",value:function(W){var ee=this.modals.indexOf(W);if(ee===-1)return ee;var J=b(this.data,function(V){return V.modals.indexOf(W)!==-1}),Y=this.data[J],B=this.containers[J];return Y.modals.splice(Y.modals.indexOf(W),1),this.modals.splice(ee,1),Y.modals.length===0?(this.handleContainerOverflow&&M(Y,B),this.hideSiblingNodes&&(0,_.showSiblings)(B,W.mountNode),this.containers.splice(J,1),this.data.splice(J,1)):this.hideSiblingNodes&&(0,_.ariaHidden)(!1,Y.modals[Y.modals.length-1].mountNode),ee}},{key:"isTopModal",value:function(W){return!!this.modals.length&&this.modals[this.modals.length-1]===W}}]),D}(),N=I;return Hp.default=N,Hp}var Ob;function lM(){if(Ob)return Ul;Ob=1;var n=Ct;Object.defineProperty(Ul,"__esModule",{value:!0}),Ul.default=Ul.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(Bi()),m=n(Fi()),o=n(Yi()),_=n(Ji()),b=n(Qi()),E=n(fC()),T=n(me),M=n(zc);n(Cr());var I=n(hn());n(el());var N=n(py()),D=n(jc()),re=n(_I),W=n(bI),ee=fu(),J=n(dn()),Y=n(LS()),B=n(PS);function V(we,ze){return we=typeof we=="function"?we():we,M.default.findDOMNode(we)||ze}function K(we){return we.children?we.children.props.hasOwnProperty("in"):!1}var ve=function(ze){return{root:{position:"fixed",zIndex:ze.zIndex.modal,right:0,bottom:0,top:0,left:0},hidden:{visibility:"hidden"}}};Ul.styles=ve;var de=function(we){(0,b.default)(ze,we);function ze(De){var ce;return(0,p.default)(this,ze),ce=(0,o.default)(this,(0,_.default)(ze).call(this)),ce.mountNode=null,ce.modalRef=null,ce.dialogRef=null,ce.mounted=!1,ce.handleRendered=function(){ce.autoFocus(),ce.modalRef.scrollTop=0,ce.props.onRendered&&ce.props.onRendered()},ce.handleOpen=function(){var Pe=(0,D.default)(ce.mountNode),gt=V(ce.props.container,Pe.body);ce.props.manager.add((0,E.default)((0,E.default)(ce)),gt),Pe.addEventListener("keydown",ce.handleDocumentKeyDown),Pe.addEventListener("focus",ce.enforceFocus,!0)},ce.handleClose=function(){ce.props.manager.remove((0,E.default)((0,E.default)(ce)));var Pe=(0,D.default)(ce.mountNode);Pe.removeEventListener("keydown",ce.handleDocumentKeyDown),Pe.removeEventListener("focus",ce.enforceFocus,!0),ce.restoreLastFocus()},ce.handleExited=function(){ce.setState({exited:!0}),ce.handleClose()},ce.handleBackdropClick=function(Pe){Pe.target===Pe.currentTarget&&(ce.props.onBackdropClick&&ce.props.onBackdropClick(Pe),!ce.props.disableBackdropClick&&ce.props.onClose&&ce.props.onClose(Pe,"backdropClick"))},ce.handleDocumentKeyDown=function(Pe){!ce.isTopModal()||(0,N.default)(Pe)!=="esc"||Pe.defaultPrevented||(ce.props.onEscapeKeyDown&&ce.props.onEscapeKeyDown(Pe),!ce.props.disableEscapeKeyDown&&ce.props.onClose&&ce.props.onClose(Pe,"escapeKeyDown"))},ce.checkForFocus=function(){ce.lastFocus=(0,D.default)(ce.mountNode).activeElement},ce.enforceFocus=function(){if(!(ce.props.disableEnforceFocus||!ce.mounted||!ce.isTopModal())){var Pe=(0,D.default)(ce.mountNode).activeElement;ce.dialogRef&&!ce.dialogRef.contains(Pe)&&ce.dialogRef.focus()}},ce.state={exited:!De.open},ce}return(0,m.default)(ze,[{key:"componentDidMount",value:function(){this.mounted=!0,this.props.open&&this.handleOpen()}},{key:"componentDidUpdate",value:function(ce){!ce.open&&this.props.open&&this.checkForFocus(),ce.open&&!this.props.open&&!K(this.props)?this.handleClose():!ce.open&&this.props.open&&this.handleOpen()}},{key:"componentWillUnmount",value:function(){this.mounted=!1,(this.props.open||K(this.props)&&!this.state.exited)&&this.handleClose()}},{key:"autoFocus",value:function(){if(!this.props.disableAutoFocus){var ce=(0,D.default)(this.mountNode).activeElement;this.dialogRef&&!this.dialogRef.contains(ce)&&(this.lastFocus=ce,this.dialogRef.hasAttribute("tabIndex")||this.dialogRef.setAttribute("tabIndex",-1),this.dialogRef.focus())}}},{key:"restoreLastFocus",value:function(){this.props.disableRestoreFocus||this.lastFocus&&(this.lastFocus.focus&&this.lastFocus.focus(),this.lastFocus=null)}},{key:"isTopModal",value:function(){return this.props.manager.isTopModal(this)}},{key:"render",value:function(){var ce=this,Pe=this.props,gt=Pe.BackdropComponent,jt=Pe.BackdropProps,Tt=Pe.children,kt=Pe.classes,Ir=Pe.className,pr=Pe.container;Pe.disableAutoFocus,Pe.disableBackdropClick,Pe.disableEnforceFocus,Pe.disableEscapeKeyDown;var Zt=Pe.disablePortal;Pe.disableRestoreFocus;var Kt=Pe.hideBackdrop,Yt=Pe.keepMounted;Pe.manager,Pe.onBackdropClick,Pe.onClose,Pe.onEscapeKeyDown,Pe.onRendered;var Dt=Pe.open,Gt=(0,u.default)(Pe,["BackdropComponent","BackdropProps","children","classes","className","container","disableAutoFocus","disableBackdropClick","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onEscapeKeyDown","onRendered","open"]),yr=this.state.exited,Et=K(this.props),er={};return!Yt&&!Dt&&(!Et||yr)?null:(Et&&(er.onExited=(0,ee.createChainedFunction)(this.handleExited,Tt.props.onExited)),Tt.props.role===void 0&&(er.role=Tt.props.role||"document"),Tt.props.tabIndex===void 0&&(er.tabIndex=Tt.props.tabIndex||"-1"),T.default.createElement(W.default,{ref:function($t){ce.mountNode=$t&&$t.getMountNode()},container:pr,disablePortal:Zt,onRendered:this.handleRendered},T.default.createElement("div",(0,t.default)({ref:function($t){ce.modalRef=$t},className:(0,I.default)(kt.root,Ir,(0,i.default)({},kt.hidden,yr))},Gt),Kt?null:T.default.createElement(gt,(0,t.default)({open:Dt,onClick:this.handleBackdropClick},jt)),T.default.createElement(re.default,{rootRef:function($t){ce.dialogRef=$t}},T.default.cloneElement(Tt,er)))))}}],[{key:"getDerivedStateFromProps",value:function(ce){return ce.open?{exited:!1}:K(ce)?null:{exited:!0}}}]),ze}(T.default.Component);de.propTypes={},de.defaultProps={disableAutoFocus:!1,disableBackdropClick:!1,disableEnforceFocus:!1,disableEscapeKeyDown:!1,disablePortal:!1,disableRestoreFocus:!1,hideBackdrop:!1,keepMounted:!1,manager:new Y.default,BackdropComponent:B.default};var ie=(0,J.default)(ve,{flip:!1,name:"MuiModal"})(de);return Ul.default=ie,Ul}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"ModalManager",{enumerable:!0,get:function(){return u.default}});var i=t(lM()),u=t(LS())})(am);const Mc=_n(am);var zS={},Vl={},Rb;function uM(){if(Rb)return Vl;Rb=1;var n=Ct;Object.defineProperty(Vl,"__esModule",{value:!0}),Vl.default=Vl.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(me);n(Cr());var m=n(hn()),o=n(dn()),_=Kg(),b=function(I){return{root:{height:1,margin:0,border:"none",flexShrink:0,backgroundColor:I.palette.divider},absolute:{position:"absolute",bottom:0,left:0,width:"100%"},inset:{marginLeft:72},light:{backgroundColor:(0,_.fade)(I.palette.divider,.08)}}};Vl.styles=b;function E(M){var I,N=M.absolute,D=M.classes,re=M.className,W=M.component,ee=M.inset,J=M.light,Y=(0,u.default)(M,["absolute","classes","className","component","inset","light"]),B=(0,m.default)(D.root,(I={},(0,i.default)(I,D.absolute,N),(0,i.default)(I,D.inset,ee),(0,i.default)(I,D.light,J),I),re);return p.default.createElement(W,(0,t.default)({className:B},Y))}E.propTypes={},E.defaultProps={absolute:!1,component:"hr",inset:!1,light:!1};var T=(0,o.default)(b,{name:"MuiDivider"})(E);return Vl.default=T,Vl}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(uM())})(zS);const Ja=_n(zS);var jS={},us={},NS={},dc={},Cv,Ab;function om(){if(Ab)return Cv;Ab=1;function n(t,i,u){var p,m,o,_,b;i==null&&(i=100);function E(){var M=Date.now()-_;M<i&&M>=0?p=setTimeout(E,i-M):(p=null,u||(b=t.apply(o,m),o=m=null))}var T=function(){o=this,m=arguments,_=Date.now();var M=u&&!p;return p||(p=setTimeout(E,i)),M&&(b=t.apply(o,m),o=m=null),b};return T.clear=function(){p&&(clearTimeout(p),p=null)},T.flush=function(){p&&(b=t.apply(o,m),o=m=null,clearTimeout(p),p=null)},T}return n.debounce=n,Cv=n,Cv}var kb;function cM(){if(kb)return dc;kb=1;var n=Ct;Object.defineProperty(dc,"__esModule",{value:!0}),dc.setTranslateValue=Y,dc.default=void 0;var t=n(zr()),i=n(jr()),u=n(Bi()),p=n(Fi()),m=n(Yi()),o=n(Ji()),_=n(Qi()),b=n(me);n(Cr());var E=n(zc),T=n(im()),M=n(om()),I=n(_S()),N=n(cy()),D=n(Xw()),re=Xg(),W=bS(),ee=24;function J(K,ve){var de=K.direction,ie=ve.getBoundingClientRect(),we;if(ve.fakeTransform)we=ve.fakeTransform;else{var ze=(0,N.default)(ve).getComputedStyle(ve);we=ze.getPropertyValue("-webkit-transform")||ze.getPropertyValue("transform")}var De=0,ce=0;if(we&&we!=="none"&&typeof we=="string"){var Pe=we.split("(")[1].split(")")[0].split(",");De=parseInt(Pe[4],10),ce=parseInt(Pe[5],10)}return de==="left"?"translateX(100vw) translateX(-".concat(ie.left-De,"px)"):de==="right"?"translateX(-".concat(ie.left+ie.width+ee-De,"px)"):de==="up"?"translateY(100vh) translateY(-".concat(ie.top-ce,"px)"):"translateY(-".concat(ie.top+ie.height+ee-ce,"px)")}function Y(K,ve){var de=J(K,ve);de&&(ve.style.webkitTransform=de,ve.style.transform=de)}var B=function(K){(0,_.default)(ve,K);function ve(){var de,ie;(0,u.default)(this,ve);for(var we=arguments.length,ze=new Array(we),De=0;De<we;De++)ze[De]=arguments[De];return ie=(0,m.default)(this,(de=(0,o.default)(ve)).call.apply(de,[this].concat(ze))),ie.mounted=!1,ie.transition=null,ie.handleResize=(0,M.default)(function(){ie.props.in||ie.props.direction==="down"||ie.props.direction==="right"||ie.transitionRef&&Y(ie.props,ie.transitionRef)},166),ie.handleEnter=function(ce){Y(ie.props,ce),(0,W.reflow)(ce),ie.props.onEnter&&ie.props.onEnter(ce)},ie.handleEntering=function(ce){var Pe=ie.props.theme,gt=(0,W.getTransitionProps)(ie.props,{mode:"enter"});ce.style.webkitTransition=Pe.transitions.create("-webkit-transform",(0,i.default)({},gt,{easing:Pe.transitions.easing.easeOut})),ce.style.transition=Pe.transitions.create("transform",(0,i.default)({},gt,{easing:Pe.transitions.easing.easeOut})),ce.style.webkitTransform="translate(0, 0)",ce.style.transform="translate(0, 0)",ie.props.onEntering&&ie.props.onEntering(ce)},ie.handleExit=function(ce){var Pe=ie.props.theme,gt=(0,W.getTransitionProps)(ie.props,{mode:"exit"});ce.style.webkitTransition=Pe.transitions.create("-webkit-transform",(0,i.default)({},gt,{easing:Pe.transitions.easing.sharp})),ce.style.transition=Pe.transitions.create("transform",(0,i.default)({},gt,{easing:Pe.transitions.easing.sharp})),Y(ie.props,ce),ie.props.onExit&&ie.props.onExit(ce)},ie.handleExited=function(ce){ce.style.webkitTransition="",ce.style.transition="",ie.props.onExited&&ie.props.onExited(ce)},ie}return(0,p.default)(ve,[{key:"componentDidMount",value:function(){this.props.in||this.updatePosition(),this.mounted=!0}},{key:"componentDidUpdate",value:function(ie){ie.direction!==this.props.direction&&!this.props.in&&this.updatePosition()}},{key:"componentWillUnmount",value:function(){this.handleResize.clear()}},{key:"updatePosition",value:function(){this.transitionRef&&(this.transitionRef.style.visibility="inherit",Y(this.props,this.transitionRef))}},{key:"render",value:function(){var ie=this,we=this.props,ze=we.children;we.onEnter,we.onEntering,we.onExit,we.onExited;var De=we.style;we.theme;var ce=(0,t.default)(we,["children","onEnter","onEntering","onExit","onExited","style","theme"]),Pe={};return!this.props.in&&!this.mounted&&(Pe.visibility="hidden"),Pe=(0,i.default)({},Pe,De,b.default.isValidElement(ze)?ze.props.style:{}),b.default.createElement(T.default,{target:"window",onResize:this.handleResize},b.default.createElement(I.default,(0,i.default)({onEnter:this.handleEnter,onEntering:this.handleEntering,onExit:this.handleExit,onExited:this.handleExited,appear:!0,style:Pe,ref:function(jt){ie.transitionRef=E.default.findDOMNode(jt)}},ce),ze))}}]),ve}(b.default.Component);B.propTypes={},B.defaultProps={direction:"down",timeout:{enter:re.duration.enteringScreen,exit:re.duration.leavingScreen}};var V=(0,D.default)()(B);return dc.default=V,dc}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(cM())})(NS);var Db;function pM(){if(Db)return us;Db=1;var n=Ct;Object.defineProperty(us,"__esModule",{value:!0}),us.isHorizontal=J,us.getAnchor=Y,us.default=us.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(Bi()),m=n(Fi()),o=n(Yi()),_=n(Ji()),b=n(Qi()),E=n(me);n(Cr());var T=n(hn()),M=n(am),I=n(dn()),N=n(NS),D=n(Eh),re=fu(),W=Xg(),ee={left:"right",right:"left",top:"down",bottom:"up"};function J(ve){return["left","right"].indexOf(ve.anchor)!==-1}function Y(ve){return ve.theme.direction==="rtl"&&J(ve)?ee[ve.anchor]:ve.anchor}var B=function(de){return{docked:{flex:"0 0 auto"},paper:{overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:de.zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:"none"},paperAnchorLeft:{left:0,right:"auto"},paperAnchorRight:{left:"auto",right:0},paperAnchorTop:{top:0,left:0,bottom:"auto",right:0,height:"auto",maxHeight:"100%"},paperAnchorBottom:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},paperAnchorDockedLeft:{borderRight:"1px solid ".concat(de.palette.divider)},paperAnchorDockedTop:{borderBottom:"1px solid ".concat(de.palette.divider)},paperAnchorDockedRight:{borderLeft:"1px solid ".concat(de.palette.divider)},paperAnchorDockedBottom:{borderTop:"1px solid ".concat(de.palette.divider)},modal:{}}};us.styles=B;var V=function(ve){(0,b.default)(de,ve);function de(){var ie,we;(0,p.default)(this,de);for(var ze=arguments.length,De=new Array(ze),ce=0;ce<ze;ce++)De[ce]=arguments[ce];return we=(0,o.default)(this,(ie=(0,_.default)(de)).call.apply(ie,[this].concat(De))),we.mounted=!1,we}return(0,m.default)(de,[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"render",value:function(){var we=this.props;we.anchor;var ze=we.children,De=we.classes,ce=we.className,Pe=we.elevation,gt=we.ModalProps;gt=gt===void 0?{}:gt;var jt=gt.BackdropProps,Tt=(0,u.default)(gt,["BackdropProps"]),kt=we.onClose,Ir=we.open,pr=we.PaperProps,Zt=we.SlideProps;we.theme;var Kt=we.transitionDuration,Yt=we.variant,Dt=(0,u.default)(we,["anchor","children","classes","className","elevation","ModalProps","onClose","open","PaperProps","SlideProps","theme","transitionDuration","variant"]),Gt=Y(this.props),yr=E.default.createElement(D.default,(0,t.default)({elevation:Yt==="temporary"?Pe:0,square:!0,className:(0,T.default)(De.paper,De["paperAnchor".concat((0,re.capitalize)(Gt))],(0,i.default)({},De["paperAnchorDocked".concat((0,re.capitalize)(Gt))],Yt!=="temporary"))},pr),ze);if(Yt==="permanent")return E.default.createElement("div",(0,t.default)({className:(0,T.default)(De.docked,ce)},Dt),yr);var Et=E.default.createElement(N.default,(0,t.default)({in:Ir,direction:ee[Gt],timeout:Kt,appear:this.mounted},Zt),yr);return Yt==="persistent"?E.default.createElement("div",(0,t.default)({className:(0,T.default)(De.docked,ce)},Dt),Et):E.default.createElement(M.default,(0,t.default)({BackdropProps:(0,t.default)({},jt,{transitionDuration:Kt}),className:(0,T.default)(De.modal,ce),open:Ir,onClose:kt},Dt,Tt),Et)}}]),de}(E.default.Component);V.propTypes={},V.defaultProps={anchor:"left",elevation:16,open:!1,transitionDuration:{enter:W.duration.enteringScreen,exit:W.duration.leavingScreen},variant:"temporary"};var K=(0,I.default)(B,{name:"MuiDrawer",flip:!1,withTheme:!0})(V);return us.default=K,us}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(pM())})(jS);const hM=_n(jS);var hy={},ql={},Mo={},$l={},Lb;function dM(){if(Lb)return $l;Lb=1;var n=Ct;Object.defineProperty($l,"__esModule",{value:!0}),$l.default=$l.styles=void 0;var t=n(jr()),i=n(zr()),u=n(Bi()),p=n(Fi()),m=n(Yi()),o=n(Ji()),_=n(Qi()),b=n(me);n(Cr());var E=n(hn()),T=n(om()),M=n(im()),I=n(dn()),N=19,D={root:{position:"relative",width:"100%"},textarea:{width:"100%",height:"100%",resize:"none",font:"inherit",padding:0,cursor:"inherit",boxSizing:"border-box",lineHeight:"inherit",border:"none",outline:"none",background:"transparent"},shadow:{overflow:"hidden",visibility:"hidden",position:"absolute",height:"auto",whiteSpace:"pre-wrap"}};$l.styles=D;var re=function(ee){(0,_.default)(J,ee);function J(Y){var B;return(0,u.default)(this,J),B=(0,m.default)(this,(0,o.default)(J).call(this)),B.isControlled=null,B.shadowRef=null,B.singlelineShadowRef=null,B.inputRef=null,B.value=null,B.handleResize=(0,T.default)(function(){B.syncHeightWithShadow()},166),B.state={height:null},B.handleRefInput=function(V){B.inputRef=V;var K=B.props.textareaRef;K&&(typeof K=="function"?K(V):K.current=V)},B.handleRefSinglelineShadow=function(V){B.singlelineShadowRef=V},B.handleRefShadow=function(V){B.shadowRef=V},B.handleChange=function(V){B.value=V.target.value,B.isControlled||(B.shadowRef.value=B.value,B.syncHeightWithShadow()),B.props.onChange&&B.props.onChange(V)},B.isControlled=Y.value!=null,B.value=Y.value||Y.defaultValue||"",B.state={height:Number(Y.rows)*N},B}return(0,p.default)(J,[{key:"componentDidMount",value:function(){this.syncHeightWithShadow()}},{key:"componentDidUpdate",value:function(){this.syncHeightWithShadow()}},{key:"componentWillUnmount",value:function(){this.handleResize.clear()}},{key:"syncHeightWithShadow",value:function(){var B=this.props;if(this.shadowRef){this.isControlled&&(this.shadowRef.value=B.value==null?"":String(B.value));var V=this.singlelineShadowRef.scrollHeight,K=this.shadowRef.scrollHeight;K!==void 0&&(Number(B.rowsMax)>=Number(B.rows)&&(K=Math.min(Number(B.rowsMax)*V,K)),K=Math.max(K,V),Math.abs(this.state.height-K)>1&&this.setState({height:K}))}}},{key:"render",value:function(){var B=this.props,V=B.classes,K=B.className,ve=B.defaultValue;B.onChange;var de=B.rows;B.rowsMax,B.textareaRef;var ie=B.value,we=(0,i.default)(B,["classes","className","defaultValue","onChange","rows","rowsMax","textareaRef","value"]);return b.default.createElement("div",{className:V.root,style:{height:this.state.height}},b.default.createElement(M.default,{target:"window",onResize:this.handleResize}),b.default.createElement("textarea",{"aria-hidden":"true",className:(0,E.default)(V.textarea,V.shadow),readOnly:!0,ref:this.handleRefSinglelineShadow,rows:"1",tabIndex:-1,value:""}),b.default.createElement("textarea",{"aria-hidden":"true",className:(0,E.default)(V.textarea,V.shadow),defaultValue:ve,readOnly:!0,ref:this.handleRefShadow,rows:de,tabIndex:-1,value:ie}),b.default.createElement("textarea",(0,t.default)({rows:de,className:(0,E.default)(V.textarea,K),defaultValue:ve,value:ie,onChange:this.handleChange,ref:this.handleRefInput},we)))}}]),J}(b.default.Component);re.propTypes={},re.defaultProps={rows:1};var W=(0,I.default)(D)(re);return $l.default=W,$l}var zb;function dy(){if(zb)return Mo;zb=1;var n=Ct;Object.defineProperty(Mo,"__esModule",{value:!0}),Mo.hasValue=D,Mo.isFilled=re,Mo.isAdornedStart=W,Mo.default=Mo.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(Bi()),m=n(Fi()),o=n(Yi()),_=n(Ji()),b=n(Qi()),E=n(me),T=n(Cr()),M=n(hn()),I=n(dn()),N=n(dM());function D(V){return V!=null&&!(Array.isArray(V)&&V.length===0)}function re(V){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return V&&(D(V.value)&&V.value!==""||K&&D(V.defaultValue)&&V.defaultValue!=="")}function W(V){return V.startAdornment}var ee=function(K){var ve=K.palette.type==="light",de={color:"currentColor",opacity:ve?.42:.5,transition:K.transitions.create("opacity",{duration:K.transitions.duration.shorter})},ie={opacity:0},we={opacity:ve?.42:.5},ze=ve?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return{root:{display:"inline-flex",position:"relative",fontFamily:K.typography.fontFamily,color:K.palette.text.primary,fontSize:K.typography.pxToRem(16),lineHeight:"1.1875em","&$disabled":{color:K.palette.text.disabled}},formControl:{"label + &":{marginTop:16}},focused:{},disabled:{},underline:{"&:after":{borderBottom:"2px solid ".concat(K.palette.primary[ve?"dark":"light"]),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:K.transitions.create("transform",{duration:K.transitions.duration.shorter,easing:K.transitions.easing.easeOut}),pointerEvents:"none"},"&$focused:after":{transform:"scaleX(1)"},"&$error:after":{borderBottomColor:K.palette.error.main,transform:"scaleX(1)"},"&:before":{borderBottom:"1px solid ".concat(ze),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:K.transitions.create("border-bottom-color",{duration:K.transitions.duration.shorter}),pointerEvents:"none"},"&:hover:not($disabled):not($focused):not($error):before":{borderBottom:"2px solid ".concat(K.palette.text.primary)},"&$disabled:before":{borderBottom:"1px dotted ".concat(ze)}},error:{},multiline:{padding:"".concat(6,"px 0 ").concat(7,"px")},fullWidth:{width:"100%"},input:{font:"inherit",color:"currentColor",padding:"".concat(6,"px 0 ").concat(7,"px"),border:0,boxSizing:"content-box",verticalAlign:"middle",background:"none",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,flexGrow:1,"&::-webkit-input-placeholder":de,"&::-moz-placeholder":de,"&:-ms-input-placeholder":de,"&::-ms-input-placeholder":de,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{"-webkit-appearance":"none"},"label[data-shrink=false] + $formControl &":{"&::-webkit-input-placeholder":ie,"&::-moz-placeholder":ie,"&:-ms-input-placeholder":ie,"&::-ms-input-placeholder":ie,"&:focus::-webkit-input-placeholder":we,"&:focus::-moz-placeholder":we,"&:focus:-ms-input-placeholder":we,"&:focus::-ms-input-placeholder":we},"&$disabled":{opacity:1}},inputMarginDense:{paddingTop:3},inputMultiline:{resize:"none",padding:0},inputType:{height:"1.1875em"},inputTypeSearch:{"-moz-appearance":"textfield","-webkit-appearance":"textfield"}}};Mo.styles=ee;function J(V,K){var ve=V.disabled,de=V.error,ie=V.margin,we=V.required;return K&&K.muiFormControl&&(typeof ve>"u"&&(ve=K.muiFormControl.disabled),typeof de>"u"&&(de=K.muiFormControl.error),typeof ie>"u"&&(ie=K.muiFormControl.margin),typeof we>"u"&&(we=K.muiFormControl.required)),{disabled:ve,error:de,margin:ie,required:we}}var Y=function(V){(0,b.default)(K,V);function K(ve,de){var ie;(0,p.default)(this,K),ie=(0,o.default)(this,(0,_.default)(K).call(this,ve,de)),ie.isControlled=null,ie.input=null,ie.state={focused:!1},ie.handleFocus=function(De){if(J(ie.props,ie.context).disabled){De.stopPropagation();return}ie.setState({focused:!0}),ie.props.onFocus&&ie.props.onFocus(De);var ce=ie.context.muiFormControl;ce&&ce.onFocus&&ce.onFocus(De)},ie.handleBlur=function(De){ie.setState({focused:!1}),ie.props.onBlur&&ie.props.onBlur(De);var ce=ie.context.muiFormControl;ce&&ce.onBlur&&ce.onBlur(De)},ie.handleChange=function(De){ie.isControlled||ie.checkDirty(ie.inputRef),ie.props.onChange&&ie.props.onChange(De)},ie.handleRefInput=function(De){ie.inputRef=De;var ce;ie.props.inputRef?ce=ie.props.inputRef:ie.props.inputProps&&ie.props.inputProps.ref&&(ce=ie.props.inputProps.ref),ce&&(typeof ce=="function"?ce(De):ce.current=De)},ie.isControlled=ve.value!=null,ie.isControlled&&ie.checkDirty(ve);var we=function(ce,Pe){!J(ie.props,ie.context).disabled&&J(ce,Pe).disabled&&ie.setState({focused:!1})},ze=function(ce,Pe,gt){if(!J(ie.props,ie.context).disabled&&J(ce,gt).disabled){var jt=ie.context.muiFormControl;jt&&jt.onBlur&&jt.onBlur()}};return E.default.createContext?(ie.UNSAFE_componentWillReceiveProps=we,ie.UNSAFE_componentWillUpdate=ze):(ie.componentWillReceiveProps=we,ie.componentWillUpdate=ze),ie}return(0,m.default)(K,[{key:"getChildContext",value:function(){return{muiFormControl:null}}},{key:"componentDidMount",value:function(){this.isControlled||this.checkDirty(this.inputRef)}},{key:"componentDidUpdate",value:function(){this.isControlled&&this.checkDirty(this.props)}},{key:"checkDirty",value:function(de){var ie=this.context.muiFormControl;if(re(de)){ie&&ie.onFilled&&ie.onFilled(),this.props.onFilled&&this.props.onFilled();return}ie&&ie.onEmpty&&ie.onEmpty(),this.props.onEmpty&&this.props.onEmpty()}},{key:"render",value:function(){var de,ie,we=this.props,ze=we.autoComplete,De=we.autoFocus,ce=we.classes,Pe=we.className,gt=we.defaultValue;we.disabled;var jt=we.disableUnderline,Tt=we.endAdornment;we.error;var kt=we.fullWidth,Ir=we.id,pr=we.inputComponent,Zt=we.inputProps;Zt=Zt===void 0?{}:Zt;var Kt=Zt.className,Yt=(0,u.default)(Zt,["className"]);we.inputRef,we.margin;var Dt=we.multiline,Gt=we.name;we.onBlur,we.onChange,we.onEmpty,we.onFilled,we.onFocus;var yr=we.onKeyDown,Et=we.onKeyUp,er=we.placeholder,mt=we.readOnly,$t=we.rows,Nr=we.rowsMax,Br=we.startAdornment,It=we.type,$r=we.value,hr=(0,u.default)(we,["autoComplete","autoFocus","classes","className","defaultValue","disabled","disableUnderline","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","multiline","name","onBlur","onChange","onEmpty","onFilled","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","rows","rowsMax","startAdornment","type","value"]),dr=this.context.muiFormControl,Un=J(this.props,this.context),Tn=Un.disabled,Pi=Un.error,bn=Un.margin,en=Un.required,ea=(0,M.default)(ce.root,(de={},(0,i.default)(de,ce.disabled,Tn),(0,i.default)(de,ce.error,Pi),(0,i.default)(de,ce.fullWidth,kt),(0,i.default)(de,ce.focused,this.state.focused),(0,i.default)(de,ce.formControl,dr),(0,i.default)(de,ce.multiline,Dt),(0,i.default)(de,ce.underline,!jt),de),Pe),Wt=(0,M.default)(ce.input,(ie={},(0,i.default)(ie,ce.disabled,Tn),(0,i.default)(ie,ce.inputType,It!=="text"),(0,i.default)(ie,ce.inputTypeSearch,It==="search"),(0,i.default)(ie,ce.inputMultiline,Dt),(0,i.default)(ie,ce.inputMarginDense,bn==="dense"),ie),Kt),lt="input",Mt=(0,t.default)({},Yt,{ref:this.handleRefInput});return pr?(lt=pr,Mt=(0,t.default)({inputRef:this.handleRefInput},Mt,{ref:null})):Dt&&($t&&!Nr?lt="textarea":(Mt=(0,t.default)({rowsMax:Nr,textareaRef:this.handleRefInput},Mt,{ref:null}),lt=N.default)),E.default.createElement("div",(0,t.default)({className:ea},hr),Br,E.default.createElement(lt,(0,t.default)({"aria-invalid":Pi,autoComplete:ze,autoFocus:De,className:Wt,defaultValue:gt,disabled:Tn,id:Ir,name:Gt,onBlur:this.handleBlur,onChange:this.handleChange,onFocus:this.handleFocus,onKeyDown:yr,onKeyUp:Et,placeholder:er,readOnly:mt,required:en,rows:$t,type:It,value:$r},Mt)),Tt)}}]),K}(E.default.Component);Y.propTypes={},Y.muiName="Input",Y.defaultProps={disableUnderline:!1,fullWidth:!1,multiline:!1,type:"text"},Y.contextTypes={muiFormControl:T.default.object},Y.childContextTypes={muiFormControl:T.default.object};var B=(0,I.default)(ee,{name:"MuiInput"})(Y);return Mo.default=B,Mo}var jb;function fM(){if(jb)return ql;jb=1;var n=Ct;Object.defineProperty(ql,"__esModule",{value:!0}),ql.default=ql.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(Bi()),m=n(Fi()),o=n(Yi()),_=n(Ji()),b=n(Qi()),E=n(me),T=n(Cr()),M=n(hn()),I=n(dn()),N=dy(),D=fu(),re=IS(),W={root:{display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0},marginNormal:{marginTop:16,marginBottom:8},marginDense:{marginTop:8,marginBottom:4},fullWidth:{width:"100%"}};ql.styles=W;var ee=function(Y){(0,b.default)(B,Y);function B(V){var K;(0,p.default)(this,B),K=(0,o.default)(this,(0,_.default)(B).call(this)),K.state={adornedStart:!1,filled:!1,focused:!1},K.handleFocus=function(){K.setState(function(de){return de.focused?null:{focused:!0}})},K.handleBlur=function(){K.setState(function(de){return de.focused?{focused:!1}:null})},K.handleDirty=function(){K.state.filled||K.setState({filled:!0})},K.handleClean=function(){K.state.filled&&K.setState({filled:!1})};var ve=V.children;return ve&&E.default.Children.forEach(ve,function(de){if((0,re.isMuiElement)(de,["Input","Select","NativeSelect"])){(0,N.isFilled)(de.props,!0)&&(K.state.filled=!0);var ie=(0,re.isMuiElement)(de,["Select","NativeSelect"])?de.props.input:de;ie&&(0,N.isAdornedStart)(ie.props)&&(K.state.adornedStart=!0)}}),K}return(0,m.default)(B,[{key:"getChildContext",value:function(){var K=this.props,ve=K.disabled,de=K.error,ie=K.required,we=K.margin,ze=this.state,De=ze.adornedStart,ce=ze.filled,Pe=ze.focused;return{muiFormControl:{adornedStart:De,disabled:ve,error:de,filled:ce,focused:Pe,margin:we,onBlur:this.handleBlur,onEmpty:this.handleClean,onFilled:this.handleDirty,onFocus:this.handleFocus,required:ie}}}},{key:"render",value:function(){var K,ve=this.props,de=ve.classes,ie=ve.className,we=ve.component;ve.disabled,ve.error;var ze=ve.fullWidth,De=ve.margin;ve.required;var ce=(0,u.default)(ve,["classes","className","component","disabled","error","fullWidth","margin","required"]);return E.default.createElement(we,(0,t.default)({className:(0,M.default)(de.root,(K={},(0,i.default)(K,de["margin".concat((0,D.capitalize)(De))],De!=="none"),(0,i.default)(K,de.fullWidth,ze),K),ie)},ce))}}]),B}(E.default.Component);ee.propTypes={},ee.defaultProps={component:"div",disabled:!1,error:!1,fullWidth:!1,margin:"none",required:!1},ee.childContextTypes={muiFormControl:T.default.object};var J=(0,I.default)(W,{name:"MuiFormControl"})(ee);return ql.default=J,ql}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(fM())})(hy);const mM=_n(hy);var BS={},Wl={},Nb;function vM(){if(Nb)return Wl;Nb=1;var n=Ct;Object.defineProperty(Wl,"__esModule",{value:!0}),Wl.default=Wl.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(me),m=n(Cr()),o=n(hn()),_=n(dn()),b=n(wS),E=function(N){return{root:{display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-14,marginRight:16,"&$disabled":{cursor:"default"}},labelPlacementStart:{flexDirection:"row-reverse"},disabled:{},label:{"&$disabled":{color:N.palette.text.disabled}}}};Wl.styles=E;function T(I,N){var D;I.checked;var re=I.classes,W=I.className,ee=I.control,J=I.disabled;I.inputRef;var Y=I.label,B=I.labelPlacement;I.name,I.onChange,I.value;var V=(0,u.default)(I,["checked","classes","className","control","disabled","inputRef","label","labelPlacement","name","onChange","value"]),K=N.muiFormControl,ve=J;typeof ve>"u"&&typeof ee.props.disabled<"u"&&(ve=ee.props.disabled),typeof ve>"u"&&K&&(ve=K.disabled);var de={disabled:ve};return["checked","name","onChange","value","inputRef"].forEach(function(ie){typeof ee.props[ie]>"u"&&typeof I[ie]<"u"&&(de[ie]=I[ie])}),p.default.createElement("label",(0,t.default)({className:(0,o.default)(re.root,(D={},(0,i.default)(D,re.labelPlacementStart,B==="start"),(0,i.default)(D,re.disabled,ve),D),W)},V),p.default.cloneElement(ee,de),p.default.createElement(b.default,{component:"span",className:(0,o.default)(re.label,(0,i.default)({},re.disabled,ve))},Y))}T.propTypes={},T.defaultProps={labelPlacement:"end"},T.contextTypes={muiFormControl:m.default.object};var M=(0,_.default)(E,{name:"MuiFormControlLabel"})(T);return Wl.default=M,Wl}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(vM())})(BS);const gM=_n(BS);var FS={},Hl={},Bb;function yM(){if(Bb)return Hl;Bb=1;var n=Ct;Object.defineProperty(Hl,"__esModule",{value:!0}),Hl.default=Hl.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(me),m=n(Cr()),o=n(hn()),_=n(dn()),b=function(I){return{root:{color:I.palette.text.secondary,fontFamily:I.typography.fontFamily,fontSize:I.typography.pxToRem(12),textAlign:"left",marginTop:8,lineHeight:"1em",minHeight:"1em",margin:0,"&$error":{color:I.palette.error.main},"&$disabled":{color:I.palette.text.disabled}},error:{},disabled:{},marginDense:{marginTop:4},focused:{},filled:{},required:{}}};Hl.styles=b;function E(M,I){var N,D=M.classes,re=M.className,W=M.component,ee=M.disabled,J=M.error,Y=M.filled,B=M.focused,V=M.margin,K=M.required,ve=(0,u.default)(M,["classes","className","component","disabled","error","filled","focused","margin","required"]),de=I.muiFormControl,ie=ee,we=J,ze=Y,De=B,ce=V,Pe=K;de&&(typeof ie>"u"&&(ie=de.disabled),typeof we>"u"&&(we=de.error),typeof ce>"u"&&(ce=de.margin),typeof Pe>"u"&&(Pe=de.required),typeof De>"u"&&(De=de.focused),typeof ze>"u"&&(ze=de.filled));var gt=(0,o.default)(D.root,(N={},(0,i.default)(N,D.disabled,ie),(0,i.default)(N,D.error,we),(0,i.default)(N,D.filled,ze),(0,i.default)(N,D.focused,De),(0,i.default)(N,D.marginDense,ce==="dense"),(0,i.default)(N,D.required,Pe),N),re);return p.default.createElement(W,(0,t.default)({className:gt},ve))}E.propTypes={},E.defaultProps={component:"p"},E.contextTypes={muiFormControl:m.default.object};var T=(0,_.default)(b,{name:"MuiFormHelperText"})(E);return Hl.default=T,Hl}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(yM())})(FS);var US={},Zl={},Fb;function _M(){if(Fb)return Zl;Fb=1;var n=Ct;Object.defineProperty(Zl,"__esModule",{value:!0}),Zl.default=Zl.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(me),m=n(Cr()),o=n(hn()),_=n(dn()),b=function(I){return{root:{fontFamily:I.typography.fontFamily,color:I.palette.text.secondary,fontSize:I.typography.pxToRem(16),lineHeight:1,padding:0,"&$focused":{color:I.palette.primary[I.palette.type==="light"?"dark":"light"]},"&$disabled":{color:I.palette.text.disabled},"&$error":{color:I.palette.error.main}},focused:{},disabled:{},error:{},filled:{},required:{},asterisk:{"&$error":{color:I.palette.error.main}}}};Zl.styles=b;function E(M,I){var N,D=M.children,re=M.classes,W=M.className,ee=M.component,J=M.disabled,Y=M.error,B=M.filled,V=M.focused,K=M.required,ve=(0,u.default)(M,["children","classes","className","component","disabled","error","filled","focused","required"]),de=I.muiFormControl,ie=J,we=Y,ze=B,De=V,ce=K;de&&(typeof ce>"u"&&(ce=de.required),typeof De>"u"&&(De=de.focused),typeof ie>"u"&&(ie=de.disabled),typeof we>"u"&&(we=de.error),typeof ze>"u"&&(ze=de.filled));var Pe=(0,o.default)(re.root,(N={},(0,i.default)(N,re.disabled,ie),(0,i.default)(N,re.error,we),(0,i.default)(N,re.filled,ze),(0,i.default)(N,re.focused,De),(0,i.default)(N,re.required,ce),N),W);return p.default.createElement(ee,(0,t.default)({className:Pe},ve),D,ce&&p.default.createElement("span",{className:(0,o.default)(re.asterisk,(0,i.default)({},re.error,we))}," *"))}E.propTypes={},E.defaultProps={component:"label"},E.contextTypes={muiFormControl:m.default.object};var T=(0,_.default)(b,{name:"MuiFormLabel"})(E);return Zl.default=T,Zl}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(_M())})(US);var VS={},Gl={},Ub;function bM(){if(Ub)return Gl;Ub=1;var n=Ct;Object.defineProperty(Gl,"__esModule",{value:!0}),Gl.default=Gl.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(me);n(Cr());var m=n(hn()),o=n(dn()),_=fu(),b=function(I){return{root:{userSelect:"none",fontSize:24,width:"1em",height:"1em",overflow:"hidden",flexShrink:0},colorPrimary:{color:I.palette.primary.main},colorSecondary:{color:I.palette.secondary.main},colorAction:{color:I.palette.action.active},colorError:{color:I.palette.error.main},colorDisabled:{color:I.palette.action.disabled},fontSizeInherit:{fontSize:"inherit"}}};Gl.styles=b;function E(M){var I,N=M.children,D=M.classes,re=M.className,W=M.color,ee=M.fontSize,J=(0,u.default)(M,["children","classes","className","color","fontSize"]);return p.default.createElement("span",(0,t.default)({className:(0,m.default)("material-icons",D.root,(I={},(0,i.default)(I,D["color".concat((0,_.capitalize)(W))],W!=="inherit"),(0,i.default)(I,D["fontSize".concat((0,_.capitalize)(ee))],ee!=="default"),I),re),"aria-hidden":"true"},J),N)}E.propTypes={},E.defaultProps={color:"inherit",fontSize:"default"},E.muiName="Icon";var T=(0,o.default)(b,{name:"MuiIcon"})(E);return Gl.default=T,Gl}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(bM())})(VS);const xM=_n(VS);var sm={};(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(dy())})(sm);var qS={},Xl={},Vb;function wM(){if(Vb)return Xl;Vb=1;var n=Ct;Object.defineProperty(Xl,"__esModule",{value:!0}),Xl.default=Xl.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(me);n(Cr());var m=n(hn()),o=n(wS),_=n(dn()),b={root:{display:"flex",maxHeight:"2em",alignItems:"center"},positionStart:{marginRight:8},positionEnd:{marginLeft:8}};Xl.styles=b;function E(M){var I,N=M.children,D=M.component,re=M.classes,W=M.className,ee=M.disableTypography,J=M.position,Y=(0,u.default)(M,["children","component","classes","className","disableTypography","position"]);return p.default.createElement(D,(0,t.default)({className:(0,m.default)(re.root,(I={},(0,i.default)(I,re.positionStart,J==="start"),(0,i.default)(I,re.positionEnd,J==="end"),I),W)},Y),typeof N=="string"&&!ee?p.default.createElement(o.default,{color:"textSecondary"},N):N)}E.propTypes={},E.defaultProps={component:"div",disableTypography:!1};var T=(0,_.default)(b,{name:"MuiInputAdornment"})(E);return Xl.default=T,Xl}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(wM())})(qS);const qb=_n(qS);var $S={},Kl={},$b;function SM(){if($b)return Kl;$b=1;var n=Ct;Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.default=Kl.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(me),m=n(Cr()),o=n(hn()),_=n(dn()),b=n(US),E=function(N){return{root:{transformOrigin:"top left"},formControl:{position:"absolute",left:0,top:0,transform:"translate(0, 24px) scale(1)"},marginDense:{transform:"translate(0, 21px) scale(1)"},shrink:{transform:"translate(0, 1.5px) scale(0.75)",transformOrigin:"top left"},animated:{transition:N.transitions.create("transform",{duration:N.transitions.duration.shorter,easing:N.transitions.easing.easeOut})}}};Kl.styles=E;function T(I,N){var D,re=I.children,W=I.classes,ee=I.className,J=I.disableAnimation,Y=I.FormLabelClasses,B=I.margin,V=I.shrink,K=(0,u.default)(I,["children","classes","className","disableAnimation","FormLabelClasses","margin","shrink"]),ve=N.muiFormControl,de=V;typeof de>"u"&&ve&&(de=ve.filled||ve.focused||ve.adornedStart);var ie=B;typeof ie>"u"&&ve&&(ie=ve.margin);var we=(0,o.default)(W.root,(D={},(0,i.default)(D,W.formControl,ve),(0,i.default)(D,W.animated,!J),(0,i.default)(D,W.shrink,de),(0,i.default)(D,W.marginDense,ie==="dense"),D),ee);return p.default.createElement(b.default,(0,t.default)({"data-shrink":de,className:we,classes:Y},K),re)}T.propTypes={},T.defaultProps={disableAnimation:!1},T.contextTypes={muiFormControl:m.default.object};var M=(0,_.default)(E,{name:"MuiInputLabel"})(T);return Kl.default=M,Kl}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(SM())})($S);var WS={},Yl={},Wb;function EM(){if(Wb)return Yl;Wb=1;var n=Ct;Object.defineProperty(Yl,"__esModule",{value:!0}),Yl.default=Yl.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(me);n(Cr());var m=n(hn());n(el());var o=n(dn()),_=Kg(),b=4,E=function(N){return{root:{position:"relative",overflow:"hidden",height:5},colorPrimary:{backgroundColor:(0,_.lighten)(N.palette.primary.light,.6)},colorSecondary:{backgroundColor:(0,_.lighten)(N.palette.secondary.light,.4)},buffer:{backgroundColor:"transparent"},query:{transform:"rotate(180deg)"},dashed:{position:"absolute",marginTop:0,height:"100%",width:"100%",animation:"buffer 3s infinite linear"},dashedColorPrimary:{backgroundImage:"radial-gradient(".concat((0,_.lighten)(N.palette.primary.light,.6)," 0%, ").concat((0,_.lighten)(N.palette.primary.light,.6)," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0px -23px"},dashedColorSecondary:{backgroundImage:"radial-gradient(".concat((0,_.lighten)(N.palette.secondary.light,.4)," 0%, ").concat((0,_.lighten)(N.palette.secondary.light,.6)," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0px -23px"},bar:{width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},barColorPrimary:{backgroundColor:N.palette.primary.main},barColorSecondary:{backgroundColor:N.palette.secondary.main},bar1Indeterminate:{width:"auto",willChange:"left, right",animation:"mui-indeterminate1 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite"},bar1Determinate:{willChange:"transform",transition:"transform .".concat(b,"s linear")},bar1Buffer:{zIndex:1,transition:"transform .".concat(b,"s linear")},bar2Indeterminate:{width:"auto",willChange:"left, right",animation:"mui-indeterminate2 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) infinite",animationDelay:"1.15s"},bar2Determinate:{},bar2Buffer:{transition:"transform .".concat(b,"s linear")},"@keyframes mui-indeterminate1":{"0%":{left:"-35%",right:"100%"},"60%":{left:"100%",right:"-90%"},"100%":{left:"100%",right:"-90%"}},"@keyframes mui-indeterminate2":{"0%":{left:"-200%",right:"100%"},"60%":{left:"107%",right:"-8%"},"100%":{left:"107%",right:"-8%"}},"@keyframes buffer":{"0%":{opacity:1,backgroundPosition:"0px -23px"},"50%":{opacity:0,backgroundPosition:"0px -23px"},"100%":{opacity:1,backgroundPosition:"-200px -23px"}}}};Yl.styles=E;function T(I){var N,D,re,W,ee=I.classes,J=I.className,Y=I.color,B=I.value,V=I.valueBuffer,K=I.variant,ve=(0,u.default)(I,["classes","className","color","value","valueBuffer","variant"]),de=(0,m.default)(ee.root,(N={},(0,i.default)(N,ee.colorPrimary,Y==="primary"),(0,i.default)(N,ee.colorSecondary,Y==="secondary"),(0,i.default)(N,ee.buffer,K==="buffer"),(0,i.default)(N,ee.query,K==="query"),N),J),ie=(0,m.default)(ee.dashed,(D={},(0,i.default)(D,ee.dashedColorPrimary,Y==="primary"),(0,i.default)(D,ee.dashedColorSecondary,Y==="secondary"),D)),we=(0,m.default)(ee.bar,(re={},(0,i.default)(re,ee.barColorPrimary,Y==="primary"),(0,i.default)(re,ee.barColorSecondary,Y==="secondary"),(0,i.default)(re,ee.bar1Indeterminate,K==="indeterminate"||K==="query"),(0,i.default)(re,ee.bar1Determinate,K==="determinate"),(0,i.default)(re,ee.bar1Buffer,K==="buffer"),re)),ze=(0,m.default)(ee.bar,(W={},(0,i.default)(W,ee.barColorPrimary,Y==="primary"&&K!=="buffer"),(0,i.default)(W,ee.colorPrimary,Y==="primary"&&K==="buffer"),(0,i.default)(W,ee.barColorSecondary,Y==="secondary"&&K!=="buffer"),(0,i.default)(W,ee.colorSecondary,Y==="secondary"&&K==="buffer"),(0,i.default)(W,ee.bar2Indeterminate,K==="indeterminate"||K==="query"),(0,i.default)(W,ee.bar2Determinate,K==="determinate"),(0,i.default)(W,ee.bar2Buffer,K==="buffer"),W)),De={},ce={bar1:{},bar2:{}};return(K==="determinate"||K==="buffer")&&B!==void 0&&(De["aria-valuenow"]=Math.round(B),ce.bar1.transform="scaleX(".concat(B/100,")")),K==="buffer"&&V!==void 0&&(ce.bar2.transform="scaleX(".concat((V||0)/100,")")),p.default.createElement("div",(0,t.default)({className:de,role:"progressbar"},De,ve),K==="buffer"?p.default.createElement("div",{className:ie}):null,p.default.createElement("div",{className:we,style:ce.bar1}),K==="determinate"?null:p.default.createElement("div",{className:ze,style:ce.bar2}))}T.propTypes={},T.defaultProps={color:"primary",variant:"indeterminate"};var M=(0,o.default)(E,{name:"MuiLinearProgress"})(T);return Yl.default=M,Yl}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(EM())})(WS);const PM=_n(WS);var HS={},Jl={},Hb;function TM(){if(Hb)return Jl;Hb=1;var n=Ct;Object.defineProperty(Jl,"__esModule",{value:!0}),Jl.default=Jl.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(Bi()),m=n(Fi()),o=n(Yi()),_=n(Ji()),b=n(Qi()),E=n(me),T=n(Cr()),M=n(hn()),I=n(dn()),N={root:{listStyle:"none",margin:0,padding:0,position:"relative"},padding:{paddingTop:8,paddingBottom:8},dense:{paddingTop:4,paddingBottom:4},subheader:{paddingTop:0}};Jl.styles=N;var D=function(W){(0,b.default)(ee,W);function ee(){return(0,p.default)(this,ee),(0,o.default)(this,(0,_.default)(ee).apply(this,arguments))}return(0,m.default)(ee,[{key:"getChildContext",value:function(){return{dense:this.props.dense}}},{key:"render",value:function(){var Y,B=this.props,V=B.children,K=B.classes,ve=B.className,de=B.component,ie=B.dense,we=B.disablePadding,ze=B.subheader,De=(0,u.default)(B,["children","classes","className","component","dense","disablePadding","subheader"]),ce=(0,M.default)(K.root,(Y={},(0,i.default)(Y,K.dense,ie&&!we),(0,i.default)(Y,K.padding,!we),(0,i.default)(Y,K.subheader,ze),Y),ve);return E.default.createElement(de,(0,t.default)({className:ce},De),ze,V)}}]),ee}(E.default.Component);D.propTypes={},D.defaultProps={component:"ul",dense:!1,disablePadding:!1},D.childContextTypes={dense:T.default.bool};var re=(0,I.default)(N,{name:"MuiList"})(D);return Jl.default=re,Jl}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(TM())})(HS);var fy={},Ql={},Zb;function CM(){if(Zb)return Ql;Zb=1;var n=Ct;Object.defineProperty(Ql,"__esModule",{value:!0}),Ql.default=Ql.styles=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(Bi()),m=n(Fi()),o=n(Yi()),_=n(Ji()),b=n(Qi()),E=n(me),T=n(Cr()),M=n(hn()),I=n(dn()),N=n(xS),D=IS(),re=function(Y){return{root:{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",paddingTop:12,paddingBottom:12},container:{position:"relative"},focusVisible:{backgroundColor:Y.palette.action.hover},default:{},dense:{paddingTop:8,paddingBottom:8},disabled:{opacity:.5},divider:{borderBottom:"1px solid ".concat(Y.palette.divider),backgroundClip:"padding-box"},gutters:Y.mixins.gutters(),button:{transition:Y.transitions.create("background-color",{duration:Y.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:Y.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}},secondaryAction:{paddingRight:32}}};Ql.styles=re;var W=function(J){(0,b.default)(Y,J);function Y(){return(0,p.default)(this,Y),(0,o.default)(this,(0,_.default)(Y).apply(this,arguments))}return(0,m.default)(Y,[{key:"getChildContext",value:function(){return{dense:this.props.dense||this.context.dense||!1}}},{key:"render",value:function(){var V,K=this.props,ve=K.button,de=K.children,ie=K.classes,we=K.className,ze=K.component,De=K.ContainerComponent,ce=K.ContainerProps;ce=ce===void 0?{}:ce;var Pe=ce.className,gt=(0,u.default)(ce,["className"]),jt=K.dense,Tt=K.disabled,kt=K.disableGutters,Ir=K.divider,pr=K.focusVisibleClassName,Zt=(0,u.default)(K,["button","children","classes","className","component","ContainerComponent","ContainerProps","dense","disabled","disableGutters","divider","focusVisibleClassName"]),Kt=jt||this.context.dense||!1,Yt=E.default.Children.toArray(de),Dt=Yt.some(function(mt){return(0,D.isMuiElement)(mt,["ListItemAvatar"])}),Gt=Yt.length&&(0,D.isMuiElement)(Yt[Yt.length-1],["ListItemSecondaryAction"]),yr=(0,M.default)(ie.root,ie.default,(V={},(0,i.default)(V,ie.dense,Kt||Dt),(0,i.default)(V,ie.gutters,!kt),(0,i.default)(V,ie.divider,Ir),(0,i.default)(V,ie.disabled,Tt),(0,i.default)(V,ie.button,ve),(0,i.default)(V,ie.secondaryAction,Gt),V),we),Et=(0,t.default)({className:yr,disabled:Tt},Zt),er=ze||"li";return ve&&(Et.component=ze||"div",Et.focusVisibleClassName=(0,M.default)(ie.focusVisible,pr),er=N.default),Gt?(er=!Et.component&&!ze?"div":er,De==="li"&&(er==="li"?er="div":Et.component==="li"&&(Et.component="div")),E.default.createElement(De,(0,t.default)({className:(0,M.default)(ie.container,Pe)},gt),E.default.createElement(er,Et,Yt),Yt.pop())):E.default.createElement(er,Et,Yt)}}]),Y}(E.default.Component);W.propTypes={},W.defaultProps={button:!1,ContainerComponent:"li",dense:!1,disabled:!1,disableGutters:!1,divider:!1},W.contextTypes={dense:T.default.bool},W.childContextTypes={dense:T.default.bool};var ee=(0,I.default)(re,{name:"MuiListItem"})(W);return Ql.default=ee,Ql}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(CM())})(fy);const vg=_n(fy);var ZS={},eu={},GS={},tu={},Gb;function IM(){if(Gb)return tu;Gb=1;var n=Ct;Object.defineProperty(tu,"__esModule",{value:!0}),tu.default=tu.styles=void 0;var t=n(jr()),i=n(zr()),u=n(Bi()),p=n(Fi()),m=n(Yi()),o=n(Ji()),_=n(Qi()),b=n(me);n(Cr());var E=n(zc);n(el());var T=n(om()),M=n(im()),I=n(jc()),N=n(cy()),D=n(dn()),re=n(am),W=n(xI),ee=n(Eh);function J(we,ze){var De=0;return typeof ze=="number"?De=ze:ze==="center"?De=we.height/2:ze==="bottom"&&(De=we.height),De}function Y(we,ze){var De=0;return typeof ze=="number"?De=ze:ze==="center"?De=we.width/2:ze==="right"&&(De=we.width),De}function B(we){return[we.horizontal,we.vertical].map(function(ze){return typeof ze=="number"?"".concat(ze,"px"):ze}).join(" ")}function V(we,ze){for(var De=ze,ce=0;De&&De!==we;)De=De.parentNode,ce+=De.scrollTop;return ce}function K(we){return typeof we=="function"?we():we}var ve={paper:{position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:"none"}};tu.styles=ve;var de=function(we){(0,_.default)(ze,we);function ze(){var De,ce;(0,u.default)(this,ze);for(var Pe=arguments.length,gt=new Array(Pe),jt=0;jt<Pe;jt++)gt[jt]=arguments[jt];return ce=(0,m.default)(this,(De=(0,o.default)(ze)).call.apply(De,[this].concat(gt))),ce.paperRef=null,ce.handleGetOffsetTop=J,ce.handleGetOffsetLeft=Y,ce.handleResize=(0,T.default)(function(){ce.setPositioningStyles(ce.paperRef)},166),ce.componentWillUnmount=function(){ce.handleResize.clear()},ce.setPositioningStyles=function(Tt){if(Tt&&Tt.style){var kt=ce.getPositioningStyle(Tt);kt.top!==null&&(Tt.style.top=kt.top),kt.left!==null&&(Tt.style.left=kt.left),Tt.style.transformOrigin=kt.transformOrigin}},ce.getPositioningStyle=function(Tt){var kt=ce.props,Ir=kt.anchorEl,pr=kt.anchorReference,Zt=kt.marginThreshold,Kt=ce.getContentAnchorOffset(Tt),Yt={width:Tt.clientWidth,height:Tt.clientHeight},Dt=ce.getTransformOrigin(Yt,Kt);if(pr==="none")return{top:null,left:null,transformOrigin:B(Dt)};var Gt=ce.getAnchorOffset(Kt),yr=Gt.top-Dt.vertical,Et=Gt.left-Dt.horizontal,er=yr+Yt.height,mt=Et+Yt.width,$t=(0,N.default)(K(Ir)),Nr=$t.innerHeight-Zt,Br=$t.innerWidth-Zt;if(yr<Zt){var It=yr-Zt;yr-=It,Dt.vertical+=It}else if(er>Nr){var $r=er-Nr;yr-=$r,Dt.vertical+=$r}if(Et<Zt){var hr=Et-Zt;Et-=hr,Dt.horizontal+=hr}else if(mt>Br){var dr=mt-Br;Et-=dr,Dt.horizontal+=dr}return{top:"".concat(yr,"px"),left:"".concat(Et,"px"),transformOrigin:B(Dt)}},ce.handleEnter=function(Tt){ce.props.onEnter&&ce.props.onEnter(Tt),ce.setPositioningStyles(Tt)},ce}return(0,p.default)(ze,[{key:"componentDidMount",value:function(){this.props.action&&this.props.action({updatePosition:this.handleResize})}},{key:"getAnchorOffset",value:function(ce){var Pe=this.props,gt=Pe.anchorEl,jt=Pe.anchorOrigin,Tt=Pe.anchorReference,kt=Pe.anchorPosition;if(Tt==="anchorPosition")return kt;var Ir=K(gt)||(0,I.default)(this.paperRef).body,pr=Ir.getBoundingClientRect(),Zt=ce===0?jt.vertical:"center";return{top:pr.top+this.handleGetOffsetTop(pr,Zt),left:pr.left+this.handleGetOffsetLeft(pr,jt.horizontal)}}},{key:"getContentAnchorOffset",value:function(ce){var Pe=this.props,gt=Pe.getContentAnchorEl,jt=Pe.anchorReference,Tt=0;if(gt&&jt==="anchorEl"){var kt=gt(ce);if(kt&&ce.contains(kt)){var Ir=V(ce,kt);Tt=kt.offsetTop+kt.clientHeight/2-Ir||0}}return Tt}},{key:"getTransformOrigin",value:function(ce){var Pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,gt=this.props.transformOrigin;return{vertical:this.handleGetOffsetTop(ce,gt.vertical)+Pe,horizontal:this.handleGetOffsetLeft(ce,gt.horizontal)}}},{key:"render",value:function(){var ce=this,Pe=this.props;Pe.action;var gt=Pe.anchorEl;Pe.anchorOrigin,Pe.anchorPosition,Pe.anchorReference;var jt=Pe.children,Tt=Pe.classes,kt=Pe.container,Ir=Pe.elevation;Pe.getContentAnchorEl,Pe.marginThreshold;var pr=Pe.ModalClasses;Pe.onEnter;var Zt=Pe.onEntered,Kt=Pe.onEntering,Yt=Pe.onExit,Dt=Pe.onExited,Gt=Pe.onExiting,yr=Pe.open,Et=Pe.PaperProps,er=Pe.role;Pe.transformOrigin;var mt=Pe.TransitionComponent,$t=Pe.transitionDuration,Nr=Pe.TransitionProps,Br=(0,i.default)(Pe,["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","classes","container","elevation","getContentAnchorEl","marginThreshold","ModalClasses","onEnter","onEntered","onEntering","onExit","onExited","onExiting","open","PaperProps","role","transformOrigin","TransitionComponent","transitionDuration","TransitionProps"]),It=$t;$t==="auto"&&!mt.muiSupportAuto&&(It=void 0);var $r=kt||(gt?(0,I.default)(K(gt)).body:void 0);return b.default.createElement(re.default,(0,t.default)({classes:pr,container:$r,open:yr,BackdropProps:{invisible:!0}},Br),b.default.createElement(mt,(0,t.default)({appear:!0,in:yr,onEnter:this.handleEnter,onEntered:Zt,onEntering:Kt,onExit:Yt,onExited:Dt,onExiting:Gt,role:er,timeout:It},Nr),b.default.createElement(ee.default,(0,t.default)({className:Tt.paper,elevation:Ir,ref:function(dr){ce.paperRef=E.default.findDOMNode(dr)}},Et),b.default.createElement(M.default,{target:"window",onResize:this.handleResize}),jt)))}}]),ze}(b.default.Component);de.propTypes={},de.defaultProps={anchorReference:"anchorEl",anchorOrigin:{vertical:"top",horizontal:"left"},elevation:8,marginThreshold:16,transformOrigin:{vertical:"top",horizontal:"left"},TransitionComponent:W.default,transitionDuration:"auto"};var ie=(0,D.default)(ve,{name:"MuiPopover"})(de);return tu.default=ie,tu}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(IM())})(GS);var XS={},Gp={},Xb;function MM(){if(Xb)return Gp;Xb=1;var n=Ct;Object.defineProperty(Gp,"__esModule",{value:!0}),Gp.default=void 0;var t=n(jr()),i=n(zr()),u=n(Bi()),p=n(Fi()),m=n(Yi()),o=n(Ji()),_=n(Qi()),b=n(me);n(Cr());var E=n(zc),T=n(py());n(el());var M=n(jc()),I=n(HS),N=function(re){(0,_.default)(W,re);function W(){var ee,J;(0,u.default)(this,W);for(var Y=arguments.length,B=new Array(Y),V=0;V<Y;V++)B[V]=arguments[V];return J=(0,m.default)(this,(ee=(0,o.default)(W)).call.apply(ee,[this].concat(B))),J.listRef=null,J.selectedItemRef=null,J.blurTimer=null,J.state={currentTabIndex:null},J.handleBlur=function(K){J.blurTimer=setTimeout(function(){if(J.listRef){var ve=J.listRef,de=(0,M.default)(ve).activeElement;ve.contains(de)||J.resetTabIndex()}},30),J.props.onBlur&&J.props.onBlur(K)},J.handleKeyDown=function(K){var ve=J.listRef,de=(0,T.default)(K),ie=(0,M.default)(ve).activeElement;(de==="up"||de==="down")&&(!ie||ie&&!ve.contains(ie))?J.selectedItemRef?J.selectedItemRef.focus():ve.firstChild.focus():de==="down"?(K.preventDefault(),ie.nextElementSibling&&ie.nextElementSibling.focus()):de==="up"&&(K.preventDefault(),ie.previousElementSibling&&ie.previousElementSibling.focus()),J.props.onKeyDown&&J.props.onKeyDown(K,de)},J.handleItemFocus=function(K){var ve=J.listRef;if(ve){for(var de=0;de<ve.children.length;de+=1)if(ve.children[de]===K.currentTarget){J.setTabIndex(de);break}}},J}return(0,p.default)(W,[{key:"componentDidMount",value:function(){this.resetTabIndex()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.blurTimer)}},{key:"setTabIndex",value:function(J){this.setState({currentTabIndex:J})}},{key:"focus",value:function(){var J=this.state.currentTabIndex,Y=this.listRef;!Y||!Y.children||!Y.firstChild||(J&&J>=0?Y.children[J].focus():Y.firstChild.focus())}},{key:"resetTabIndex",value:function(){for(var J=this.listRef,Y=(0,M.default)(J).activeElement,B=[],V=0;V<J.children.length;V+=1)B.push(J.children[V]);var K=B.indexOf(Y);return K!==-1?this.setTabIndex(K):this.selectedItemRef?this.setTabIndex(B.indexOf(this.selectedItemRef)):this.setTabIndex(0)}},{key:"render",value:function(){var J=this,Y=this.props,B=Y.children,V=Y.className;Y.onBlur,Y.onKeyDown;var K=(0,i.default)(Y,["children","className","onBlur","onKeyDown"]);return b.default.createElement(I.default,(0,t.default)({role:"menu",ref:function(de){J.listRef=E.default.findDOMNode(de)},className:V,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur},K),b.default.Children.map(B,function(ve,de){return b.default.isValidElement(ve)?b.default.cloneElement(ve,{tabIndex:de===J.state.currentTabIndex?0:-1,ref:ve.props.selected?function(ie){J.selectedItemRef=E.default.findDOMNode(ie)}:void 0,onFocus:J.handleItemFocus}):null}))}}]),W}(b.default.Component);N.propTypes={};var D=N;return Gp.default=D,Gp}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(MM())})(XS);var Kb;function KS(){if(Kb)return eu;Kb=1;var n=Ct;Object.defineProperty(eu,"__esModule",{value:!0}),eu.default=eu.styles=void 0;var t=n(jr()),i=n(zr()),u=n(Bi()),p=n(Fi()),m=n(Yi()),o=n(Ji()),_=n(Qi()),b=n(me);n(Cr());var E=n(zc),T=n(DS()),M=n(dn()),I=n(GS),N=n(XS),D={vertical:"top",horizontal:"right"},re={vertical:"top",horizontal:"left"},W={paper:{maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}};eu.styles=W;var ee=function(Y){(0,_.default)(B,Y);function B(){var V,K;(0,u.default)(this,B);for(var ve=arguments.length,de=new Array(ve),ie=0;ie<ve;ie++)de[ie]=arguments[ie];return K=(0,m.default)(this,(V=(0,o.default)(B)).call.apply(V,[this].concat(de))),K.menuListRef=null,K.getContentAnchorEl=function(){return!K.menuListRef||!K.menuListRef.selectedItemRef?E.default.findDOMNode(K.menuListRef).firstChild:E.default.findDOMNode(K.menuListRef.selectedItemRef)},K.focus=function(){if(K.menuListRef&&K.menuListRef.selectedItemRef){E.default.findDOMNode(K.menuListRef.selectedItemRef).focus();return}var we=E.default.findDOMNode(K.menuListRef);we&&we.firstChild&&we.firstChild.focus()},K.handleEnter=function(we){var ze=K.props,De=ze.disableAutoFocusItem,ce=ze.theme,Pe=E.default.findDOMNode(K.menuListRef);if(De!==!0&&K.focus(),Pe&&we.clientHeight<Pe.clientHeight&&!Pe.style.width){var gt="".concat((0,T.default)(),"px");Pe.style[ce.direction==="rtl"?"paddingLeft":"paddingRight"]=gt,Pe.style.width="calc(100% + ".concat(gt,")")}K.props.onEnter&&K.props.onEnter(we)},K.handleListKeyDown=function(we,ze){ze==="tab"&&(we.preventDefault(),K.props.onClose&&K.props.onClose(we))},K}return(0,p.default)(B,[{key:"componentDidMount",value:function(){this.props.open&&this.props.disableAutoFocusItem!==!0&&this.focus()}},{key:"render",value:function(){var K=this,ve=this.props,de=ve.children,ie=ve.classes;ve.disableAutoFocusItem;var we=ve.MenuListProps;ve.onEnter;var ze=ve.PaperProps,De=ze===void 0?{}:ze,ce=ve.PopoverClasses,Pe=ve.theme,gt=(0,i.default)(ve,["children","classes","disableAutoFocusItem","MenuListProps","onEnter","PaperProps","PopoverClasses","theme"]);return b.default.createElement(I.default,(0,t.default)({getContentAnchorEl:this.getContentAnchorEl,classes:ce,onEnter:this.handleEnter,anchorOrigin:Pe.direction==="rtl"?D:re,transformOrigin:Pe.direction==="rtl"?D:re,PaperProps:(0,t.default)({},De,{classes:(0,t.default)({},De.classes,{root:ie.paper})})},gt),b.default.createElement(N.default,(0,t.default)({onKeyDown:this.handleListKeyDown},we,{ref:function(Tt){K.menuListRef=Tt}}),de))}}]),B}(b.default.Component);ee.propTypes={},ee.defaultProps={disableAutoFocusItem:!1,transitionDuration:"auto"};var J=(0,M.default)(W,{name:"MuiMenu",withTheme:!0})(ee);return eu.default=J,eu}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(KS())})(ZS);const Bf=_n(ZS);var YS={},ru={},Yb;function OM(){if(Yb)return ru;Yb=1;var n=Ct;Object.defineProperty(ru,"__esModule",{value:!0}),ru.default=ru.styles=void 0;var t=n(Fn()),i=n(zr()),u=n(jr()),p=n(me);n(Cr());var m=n(hn()),o=n(dn()),_=n(fy),b=function(I){return{root:(0,u.default)({},I.typography.subheading,{height:24,boxSizing:"content-box",width:"auto",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",paddingLeft:16,paddingRight:16,"&$selected":{backgroundColor:I.palette.action.selected}}),selected:{}}};ru.styles=b;function E(M){var I=M.classes,N=M.className,D=M.component,re=M.selected,W=M.role,ee=(0,i.default)(M,["classes","className","component","selected","role"]);return p.default.createElement(_.default,(0,u.default)({button:!0,role:W,tabIndex:-1,className:(0,m.default)(I.root,(0,t.default)({},I.selected,re),N),component:D},ee))}E.propTypes={},E.defaultProps={component:"li",role:"menuitem",selected:!1};var T=(0,o.default)(b,{name:"MuiMenuItem"})(E);return ru.default=T,ru}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(OM())})(YS);const yi=_n(YS);var nu={},Xp={},Jb;function JS(){if(Jb)return Xp;Jb=1;var n=Ct;Object.defineProperty(Xp,"__esModule",{value:!0}),Xp.default=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(me);n(Cr());var m=n(hn());function o(b){var E=b.children,T=b.classes,M=b.className,I=b.disabled,N=b.IconComponent,D=b.inputRef,re=b.name,W=b.onChange,ee=b.value,J=(0,u.default)(b,["children","classes","className","disabled","IconComponent","inputRef","name","onChange","value"]);return p.default.createElement("div",{className:T.root},p.default.createElement("select",(0,t.default)({className:(0,m.default)(T.select,(0,i.default)({},T.disabled,I),M),name:re,disabled:I,onChange:W,value:ee,ref:D},J),E),p.default.createElement(N,{className:T.icon}))}o.propTypes={};var _=o;return Xp.default=_,Xp}var Kp={},Qb;function QS(){if(Qb)return Kp;Qb=1;var n=Ct;Object.defineProperty(Kp,"__esModule",{value:!0}),Kp.default=void 0;var t=n(me),i=n(zI()),u=n(Yw),p=t.default.createElement("path",{d:"M7 10l5 5 5-5z"}),m=function(b){return t.default.createElement(u.default,b,p)};m=(0,i.default)(m),m.muiName="SvgIcon";var o=m;return Kp.default=o,Kp}var ex;function RM(){if(ex)return nu;ex=1;var n=Ct;Object.defineProperty(nu,"__esModule",{value:!0}),nu.default=nu.styles=void 0;var t=n(jr()),i=n(zr()),u=n(me);n(Cr());var p=n(JS()),m=n(dn()),o=n(QS()),_=n(sm),b=function(I){return{root:{position:"relative",width:"100%"},select:{"-moz-appearance":"none","-webkit-appearance":"none",userSelect:"none",paddingRight:32,width:"calc(100% - 32px)",minWidth:16,cursor:"pointer","&:focus":{background:I.palette.type==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)",borderRadius:0},"&:-moz-focusring":{color:"transparent",textShadow:"0 0 0 #000"},"&::-ms-expand":{display:"none"},"&$disabled":{cursor:"default"}},selectMenu:{width:"auto",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",minHeight:"1.1875em"},disabled:{},icon:{position:"absolute",right:0,top:"calc(50% - 12px)",color:I.palette.action.active,"pointer-events":"none"}}};nu.styles=b;function E(M){var I=M.children,N=M.classes,D=M.IconComponent,re=M.input,W=M.inputProps,ee=(0,i.default)(M,["children","classes","IconComponent","input","inputProps"]);return u.default.cloneElement(re,(0,t.default)({inputComponent:p.default,inputProps:(0,t.default)({children:I,classes:N,IconComponent:D,type:void 0},W,re?re.props.inputProps:{})},ee))}E.propTypes={},E.defaultProps={IconComponent:o.default,input:u.default.createElement(_.default,null)},E.muiName="NativeSelect";var T=(0,m.default)(b,{name:"MuiNativeSelect"})(E);return nu.default=T,nu}var my={},iu={},Yp={},tx;function AM(){if(tx)return Yp;tx=1;var n=Ct;Object.defineProperty(Yp,"__esModule",{value:!0}),Yp.default=void 0;var t=n(jr()),i=n(Fn()),u=n(zr()),p=n(wI()),m=n(Bi()),o=n(Fi()),_=n(Yi()),b=n(Ji()),E=n(Qi()),T=n(me);n(Cr());var M=n(hn()),I=n(py());n(el());var N=n(KS()),D=dy(),re=function(ee){(0,E.default)(J,ee);function J(){var Y,B;(0,m.default)(this,J);for(var V=arguments.length,K=new Array(V),ve=0;ve<V;ve++)K[ve]=arguments[ve];return B=(0,_.default)(this,(Y=(0,b.default)(J)).call.apply(Y,[this].concat(K))),B.ignoreNextBlur=!1,B.displayRef=null,B.isOpenControlled=B.props.open!==void 0,B.state={menuMinWidth:null,open:!1},B.update=function(de){var ie=de.event,we=de.open;if(B.isOpenControlled){we?B.props.onOpen(ie):B.props.onClose(ie);return}B.setState({menuMinWidth:B.props.autoWidth?null:B.displayRef.clientWidth,open:we})},B.handleClick=function(de){B.ignoreNextBlur=!0,B.update({open:!0,event:de})},B.handleClose=function(de){B.update({open:!1,event:de})},B.handleItemClick=function(de){return function(ie){B.props.multiple||B.update({open:!1,event:ie});var we=B.props,ze=we.onChange,De=we.name;if(ze){var ce;if(B.props.multiple){ce=Array.isArray(B.props.value)?(0,p.default)(B.props.value):[];var Pe=ce.indexOf(de.props.value);Pe===-1?ce.push(de.props.value):ce.splice(Pe,1)}else ce=de.props.value;ie.persist(),ie.target={value:ce,name:De},ze(ie,de)}}},B.handleBlur=function(de){if(B.ignoreNextBlur===!0){de.stopPropagation(),B.ignoreNextBlur=!1;return}if(B.props.onBlur){var ie=B.props,we=ie.value,ze=ie.name;de.persist(),de.target={value:we,name:ze},B.props.onBlur(de)}},B.handleKeyDown=function(de){B.props.readOnly||["space","up","down"].indexOf((0,I.default)(de))!==-1&&(de.preventDefault(),B.ignoreNextBlur=!0,B.update({open:!0,event:de}))},B.handleDisplayRef=function(de){B.displayRef=de},B.handleInputRef=function(de){var ie=B.props.inputRef;if(ie){var we={node:de,value:B.props.value};typeof ie=="function"?ie(we):ie.current=we}},B}return(0,o.default)(J,[{key:"componentDidMount",value:function(){this.isOpenControlled&&this.props.open&&(this.displayRef.focus(),this.forceUpdate()),this.props.autoFocus&&this.displayRef.focus()}},{key:"render",value:function(){var B=this,V=this.props,K=V.autoWidth,ve=V.children,de=V.classes,ie=V.className,we=V.disabled,ze=V.displayEmpty,De=V.IconComponent;V.inputRef;var ce=V.MenuProps,Pe=ce===void 0?{}:ce,gt=V.multiple,jt=V.name;V.onBlur,V.onChange,V.onClose;var Tt=V.onFocus;V.onOpen;var kt=V.open,Ir=V.readOnly,pr=V.renderValue;V.required;var Zt=V.SelectDisplayProps,Kt=V.tabIndex,Yt=V.type,Dt=Yt===void 0?"hidden":Yt,Gt=V.value,yr=(0,u.default)(V,["autoWidth","children","classes","className","disabled","displayEmpty","IconComponent","inputRef","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","required","SelectDisplayProps","tabIndex","type","value"]),Et=this.isOpenControlled&&this.displayRef?kt:this.state.open;delete yr["aria-invalid"];var er,mt="",$t=[],Nr=!1;((0,D.isFilled)(this.props)||ze)&&(pr?er=pr(Gt):Nr=!0);var Br=T.default.Children.map(ve,function(hr){if(!T.default.isValidElement(hr))return null;var dr;if(gt){if(!Array.isArray(Gt))throw new Error("Material-UI: the `value` property must be an array when using the `Select` component with `multiple`.");dr=Gt.indexOf(hr.props.value)!==-1,dr&&Nr&&$t.push(hr.props.children)}else dr=Gt===hr.props.value,dr&&Nr&&(mt=hr.props.children);return T.default.cloneElement(hr,{onClick:B.handleItemClick(hr),role:"option",selected:dr,value:void 0,"data-value":hr.props.value})});Nr&&(er=gt?$t.join(", "):mt);var It=this.state.menuMinWidth;!K&&this.isOpenControlled&&this.displayRef&&(It=this.displayRef.clientWidth);var $r;return typeof Kt<"u"?$r=Kt:$r=we?null:0,T.default.createElement("div",{className:de.root},T.default.createElement("div",(0,t.default)({className:(0,M.default)(de.select,de.selectMenu,(0,i.default)({},de.disabled,we),ie),ref:this.handleDisplayRef,"aria-pressed":Et?"true":"false",tabIndex:$r,role:"button","aria-owns":Et?"menu-".concat(jt||""):null,"aria-haspopup":"true",onKeyDown:this.handleKeyDown,onBlur:this.handleBlur,onClick:we||Ir?null:this.handleClick,onFocus:Tt},Zt),er||T.default.createElement("span",{dangerouslySetInnerHTML:{__html:"&#8203;"}})),T.default.createElement("input",(0,t.default)({value:Array.isArray(Gt)?Gt.join(","):Gt,name:jt,ref:this.handleInputRef,type:Dt},yr)),T.default.createElement(De,{className:de.icon}),T.default.createElement(N.default,(0,t.default)({id:"menu-".concat(jt||""),anchorEl:this.displayRef,open:Et,onClose:this.handleClose},Pe,{MenuListProps:(0,t.default)({role:"listbox"},Pe.MenuListProps),PaperProps:(0,t.default)({},Pe.PaperProps,{style:(0,t.default)({minWidth:It},Pe.PaperProps!=null?Pe.PaperProps.style:null)})}),Br))}}]),J}(T.default.Component);re.propTypes={};var W=re;return Yp.default=W,Yp}var rx;function kM(){if(rx)return iu;rx=1;var n=Ct;Object.defineProperty(iu,"__esModule",{value:!0}),iu.default=iu.styles=void 0;var t=n(jr()),i=n(zr()),u=n(me);n(Cr());var p=n(AM()),m=n(dn()),o=n(mC()),_=n(QS()),b=n(sm),E=RM(),T=n(JS()),M=E.styles;iu.styles=M;function I(D){var re=D.autoWidth,W=D.children,ee=D.classes,J=D.displayEmpty,Y=D.IconComponent,B=D.input,V=D.inputProps,K=D.MenuProps,ve=D.multiple,de=D.native,ie=D.onClose,we=D.onOpen,ze=D.open,De=D.renderValue,ce=D.SelectDisplayProps,Pe=(0,i.default)(D,["autoWidth","children","classes","displayEmpty","IconComponent","input","inputProps","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps"]),gt=de?T.default:p.default;return u.default.cloneElement(B,(0,t.default)({inputComponent:gt,inputProps:(0,t.default)({children:W,IconComponent:Y,type:void 0},de?{}:{autoWidth:re,displayEmpty:J,MenuProps:K,multiple:ve,onClose:ie,onOpen:we,open:ze,renderValue:De,SelectDisplayProps:ce},V,{classes:V?(0,o.default)({baseClasses:ee,newClasses:V.classes,Component:I}):ee},B?B.props.inputProps:{})},Pe))}I.propTypes={},I.defaultProps={autoWidth:!1,displayEmpty:!1,IconComponent:_.default,input:u.default.createElement(b.default,null),multiple:!1,native:!1},I.muiName="Select";var N=(0,m.default)(E.styles,{name:"MuiSelect"})(I);return iu.default=N,iu}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(kM())})(my);const DM=_n(my);var e2={},au={},nx;function LM(){if(nx)return au;nx=1;var n=Ct;Object.defineProperty(au,"__esModule",{value:!0}),au.default=au.styles=void 0;var t=n(jr()),i=n(zr()),u=n(me);n(Cr());var p=n(hn()),m=n(dn()),o=fu(),_=n(RI()),b=function(I){return{root:{display:"inline-flex",width:62,position:"relative",flexShrink:0,verticalAlign:"middle"},icon:{boxShadow:I.shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"},iconChecked:{boxShadow:I.shadows[2]},switchBase:{zIndex:1,color:I.palette.type==="light"?I.palette.grey[50]:I.palette.grey[400],transition:I.transitions.create("transform",{duration:I.transitions.duration.shortest})},checked:{transform:"translateX(14px)","& + $bar":{opacity:.5}},colorPrimary:{"&$checked":{color:I.palette.primary.main,"& + $bar":{backgroundColor:I.palette.primary.main}}},colorSecondary:{"&$checked":{color:I.palette.secondary.main,"& + $bar":{backgroundColor:I.palette.secondary.main}}},disabled:{"& + $bar":{opacity:I.palette.type==="light"?.12:.1},"& $icon":{boxShadow:I.shadows[1]},"&$switchBase":{color:I.palette.type==="light"?I.palette.grey[400]:I.palette.grey[800],"& + $bar":{backgroundColor:I.palette.type==="light"?I.palette.common.black:I.palette.common.white}}},bar:{borderRadius:14/2,display:"block",position:"absolute",width:34,height:14,top:"50%",left:"50%",marginTop:-7,marginLeft:-17,transition:I.transitions.create(["opacity","background-color"],{duration:I.transitions.duration.shortest}),backgroundColor:I.palette.type==="light"?I.palette.common.black:I.palette.common.white,opacity:I.palette.type==="light"?.38:.3}}};au.styles=b;function E(M){var I=M.classes,N=M.className,D=M.color,re=(0,i.default)(M,["classes","className","color"]);return u.default.createElement("span",{className:(0,p.default)(I.root,N)},u.default.createElement(_.default,(0,t.default)({type:"checkbox",icon:u.default.createElement("span",{className:I.icon}),classes:{root:(0,p.default)(I.switchBase,I["color".concat((0,o.capitalize)(D))]),checked:I.checked,disabled:I.disabled},checkedIcon:u.default.createElement("span",{className:(0,p.default)(I.icon,I.iconChecked)})},re)),u.default.createElement("span",{className:I.bar}))}E.propTypes={},E.defaultProps={color:"secondary"};var T=(0,m.default)(b,{name:"MuiSwitch"})(E);return au.default=T,au}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(LM())})(e2);const zM=_n(e2);var t2={},Jp={},ix;function jM(){if(ix)return Jp;ix=1;var n=Ct;Object.defineProperty(Jp,"__esModule",{value:!0}),Jp.default=void 0;var t=n(jr()),i=n(zr()),u=n(me);n(el()),n(Cr());var p=n(sm),m=n($S),o=n(hy),_=n(FS),b=n(my);function E(M){var I=M.autoComplete,N=M.autoFocus,D=M.children,re=M.className,W=M.defaultValue,ee=M.error,J=M.FormHelperTextProps,Y=M.fullWidth,B=M.helperText,V=M.id,K=M.InputLabelProps,ve=M.inputProps,de=M.InputProps,ie=M.inputRef,we=M.label,ze=M.multiline,De=M.name,ce=M.onBlur,Pe=M.onChange,gt=M.onFocus,jt=M.placeholder,Tt=M.required,kt=M.rows,Ir=M.rowsMax,pr=M.select,Zt=M.SelectProps,Kt=M.type,Yt=M.value,Dt=(0,i.default)(M,["autoComplete","autoFocus","children","className","defaultValue","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","rowsMax","select","SelectProps","type","value"]),Gt=B&&V?"".concat(V,"-helper-text"):void 0,yr=u.default.createElement(p.default,(0,t.default)({autoComplete:I,autoFocus:N,defaultValue:W,fullWidth:Y,multiline:ze,name:De,rows:kt,rowsMax:Ir,type:Kt,value:Yt,id:V,inputRef:ie,onBlur:ce,onChange:Pe,onFocus:gt,placeholder:jt,inputProps:ve},de));return u.default.createElement(o.default,(0,t.default)({"aria-describedby":Gt,className:re,error:ee,fullWidth:Y,required:Tt},Dt),we&&u.default.createElement(m.default,(0,t.default)({htmlFor:V},K),we),pr?u.default.createElement(b.default,(0,t.default)({value:Yt,input:yr},Zt),D):yr,B&&u.default.createElement(_.default,(0,t.default)({id:Gt},J),B))}E.propTypes={},E.defaultProps={required:!1,select:!1};var T=E;return Jp.default=T,Jp}(function(n){var t=Ct;Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return i.default}});var i=t(jM())})(t2);const gg=_n(t2);/**
 * @remix-run/router v1.15.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yg(){return yg=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&(n[u]=i[u])}return n},yg.apply(this,arguments)}var ax;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(ax||(ax={}));function ys(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function ox(n){let{pathname:t="/",search:i="",hash:u=""}=n;return i&&i!=="?"&&(t+=i.charAt(0)==="?"?i:"?"+i),u&&u!=="#"&&(t+=u.charAt(0)==="#"?u:"#"+u),t}function r2(n){let t={};if(n){let i=n.indexOf("#");i>=0&&(t.hash=n.substr(i),n=n.substr(0,i));let u=n.indexOf("?");u>=0&&(t.search=n.substr(u),n=n.substr(0,u)),n&&(t.pathname=n)}return t}var sx;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(sx||(sx={}));function NM(n,t){if(t==="/")return n;if(!n.toLowerCase().startsWith(t.toLowerCase()))return null;let i=t.endsWith("/")?t.length-1:t.length,u=n.charAt(i);return u&&u!=="/"?null:n.slice(i)||"/"}function BM(n,t){t===void 0&&(t="/");let{pathname:i,search:u="",hash:p=""}=typeof n=="string"?r2(n):n;return{pathname:i?i.startsWith("/")?i:FM(i,t):t,search:VM(u),hash:qM(p)}}function FM(n,t){let i=t.replace(/\/+$/,"").split("/");return n.split("/").forEach(p=>{p===".."?i.length>1&&i.pop():p!=="."&&i.push(p)}),i.length>1?i.join("/"):"/"}function Iv(n,t,i,u){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(u)+"].  Please separate it out to the ")+("`to."+i+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function UM(n){return n.filter((t,i)=>i===0||t.route.path&&t.route.path.length>0)}function n2(n,t){let i=UM(n);return t?i.map((u,p)=>p===n.length-1?u.pathname:u.pathnameBase):i.map(u=>u.pathnameBase)}function i2(n,t,i,u){u===void 0&&(u=!1);let p;typeof n=="string"?p=r2(n):(p=yg({},n),ys(!p.pathname||!p.pathname.includes("?"),Iv("?","pathname","search",p)),ys(!p.pathname||!p.pathname.includes("#"),Iv("#","pathname","hash",p)),ys(!p.search||!p.search.includes("#"),Iv("#","search","hash",p)));let m=n===""||p.pathname==="",o=m?"/":p.pathname,_;if(o==null)_=i;else{let M=t.length-1;if(!u&&o.startsWith("..")){let I=o.split("/");for(;I[0]==="..";)I.shift(),M-=1;p.pathname=I.join("/")}_=M>=0?t[M]:"/"}let b=BM(p,_),E=o&&o!=="/"&&o.endsWith("/"),T=(m||o===".")&&i.endsWith("/");return!b.pathname.endsWith("/")&&(E||T)&&(b.pathname+="/"),b}const a2=n=>n.join("/").replace(/\/\/+/g,"/"),VM=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,qM=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,o2=["post","put","patch","delete"];new Set(o2);const $M=["get",...o2];new Set($M);/**
 * React Router v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _g(){return _g=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&(n[u]=i[u])}return n},_g.apply(this,arguments)}const s2=me.createContext(null),Ph=me.createContext(null),l2=me.createContext(null),lm=me.createContext({outlet:null,matches:[],isDataRoute:!1});function WM(n,t){let{relative:i}=t===void 0?{}:t;vy()||ys(!1);let{basename:u,navigator:p}=me.useContext(Ph),{hash:m,pathname:o,search:_}=c2(n,{relative:i}),b=o;return u!=="/"&&(b=o==="/"?u:a2([u,o])),p.createHref({pathname:b,search:_,hash:m})}function vy(){return me.useContext(l2)!=null}function gy(){return vy()||ys(!1),me.useContext(l2).location}function u2(n){me.useContext(Ph).static||me.useLayoutEffect(n)}function HM(){let{isDataRoute:n}=me.useContext(lm);return n?YM():ZM()}function ZM(){vy()||ys(!1);let n=me.useContext(s2),{basename:t,future:i,navigator:u}=me.useContext(Ph),{matches:p}=me.useContext(lm),{pathname:m}=gy(),o=JSON.stringify(n2(p,i.v7_relativeSplatPath)),_=me.useRef(!1);return u2(()=>{_.current=!0}),me.useCallback(function(E,T){if(T===void 0&&(T={}),!_.current)return;if(typeof E=="number"){u.go(E);return}let M=i2(E,JSON.parse(o),m,T.relative==="path");n==null&&t!=="/"&&(M.pathname=M.pathname==="/"?t:a2([t,M.pathname])),(T.replace?u.replace:u.push)(M,T.state,T)},[t,u,o,m,n])}function c2(n,t){let{relative:i}=t===void 0?{}:t,{future:u}=me.useContext(Ph),{matches:p}=me.useContext(lm),{pathname:m}=gy(),o=JSON.stringify(n2(p,u.v7_relativeSplatPath));return me.useMemo(()=>i2(n,JSON.parse(o),m,i==="path"),[n,o,m,i])}var p2=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(p2||{}),h2=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(h2||{});function GM(n){let t=me.useContext(s2);return t||ys(!1),t}function XM(n){let t=me.useContext(lm);return t||ys(!1),t}function KM(n){let t=XM(),i=t.matches[t.matches.length-1];return i.route.id||ys(!1),i.route.id}function YM(){let{router:n}=GM(p2.UseNavigateStable),t=KM(h2.UseNavigateStable),i=me.useRef(!1);return u2(()=>{i.current=!0}),me.useCallback(function(p,m){m===void 0&&(m={}),i.current&&(typeof p=="number"?n.navigate(p):n.navigate(p,_g({fromRouteId:t},m)))},[n,t])}new Promise(()=>{});/**
 * React Router DOM v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bg(){return bg=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&(n[u]=i[u])}return n},bg.apply(this,arguments)}function JM(n,t){if(n==null)return{};var i={},u=Object.keys(n),p,m;for(m=0;m<u.length;m++)p=u[m],!(t.indexOf(p)>=0)&&(i[p]=n[p]);return i}function QM(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function eO(n,t){return n.button===0&&(!t||t==="_self")&&!QM(n)}const tO=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],rO="6";try{window.__reactRouterVersion=rO}catch{}const nO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",iO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,aO=me.forwardRef(function(t,i){let{onClick:u,relative:p,reloadDocument:m,replace:o,state:_,target:b,to:E,preventScrollReset:T,unstable_viewTransition:M}=t,I=JM(t,tO),{basename:N}=me.useContext(Ph),D,re=!1;if(typeof E=="string"&&iO.test(E)&&(D=E,nO))try{let Y=new URL(window.location.href),B=E.startsWith("//")?new URL(Y.protocol+E):new URL(E),V=NM(B.pathname,N);B.origin===Y.origin&&V!=null?E=V+B.search+B.hash:re=!0}catch{}let W=WM(E,{relative:p}),ee=oO(E,{replace:o,state:_,target:b,preventScrollReset:T,relative:p,unstable_viewTransition:M});function J(Y){u&&u(Y),Y.defaultPrevented||ee(Y)}return me.createElement("a",bg({},I,{href:D||W,onClick:re||m?u:J,ref:i,target:b}))});var lx;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(lx||(lx={}));var ux;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(ux||(ux={}));function oO(n,t){let{target:i,replace:u,state:p,preventScrollReset:m,relative:o,unstable_viewTransition:_}=t===void 0?{}:t,b=HM(),E=gy(),T=c2(n,{relative:o});return me.useCallback(M=>{if(eO(M,i)){M.preventDefault();let I=u!==void 0?u:ox(E)===ox(T);b(n,{replace:I,state:p,preventScrollReset:m,relative:o,unstable_viewTransition:_})}},[E,b,T,u,p,i,n,m,o,_])}function sO(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"me";return mu.get("v1/".concat(n,"/"))}function xg(n,t){(t==null||t>n.length)&&(t=n.length);for(var i=0,u=new Array(t);i<t;i++)u[i]=n[i];return u}function lO(n){if(Array.isArray(n))return xg(n)}function uO(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function d2(n,t){if(n){if(typeof n=="string")return xg(n,t);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(n);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return xg(n,t)}}function cO(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pO(n){return lO(n)||uO(n)||d2(n)||cO()}var Qp={};function hO(n,t,i){return wg.apply(this,arguments)}function wg(){return wg=Jw(Lf.mark(function n(t,i,u){var p;return Lf.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(p=t,i!==void 0&&(p+="?".concat(vC.stringify(i))),!(Qp[p]&&!u)){o.next=4;break}return o.abrupt("return",Qp[p]);case 4:return o.next=6,mu.get(p);case 6:return Qp[p]=o.sent,setTimeout(function(){delete Qp[p]},1e3*60*45),o.abrupt("return",Qp[p]);case 9:case"end":return o.stop()}},n)})),wg.apply(this,arguments)}function dO(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;return hO("v1/route/".concat(n,"/files"),i,t)}function fO(n,t,i){return Sg.apply(this,arguments)}function Sg(){return Sg=Jw(Lf.mark(function n(t,i,u){return Lf.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",mu.post("v1/".concat(t,"/upload_urls/"),{paths:i,expiry_days:u}));case 1:case"end":return m.stop()}},n)})),Sg.apply(this,arguments)}function mO(n,t,i,u,p){return mu.post("v1/navigation/".concat(n,"/set_destination"),{latitude:t,longitude:i,place_name:u,place_details:p})}function vO(n){return mu.get("v1/navigation/".concat(n,"/locations"))}function gO(n,t,i,u,p,m,o){return mu.put("v1/navigation/".concat(n,"/locations"),{latitude:t,longitude:i,place_name:u,place_details:p,save_type:m,label:o})}function yO(n,t){return mu.delete("v1/navigation/".concat(n,"/locations"),{id:t})}const _O="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAsCAQAAABFhskHAAAAAXNSR0IArs4c6QAAAZdJREFUeNrtljtLXEEYhj8hxCzmQiDBkARCCAkWSQxEEPFSiDYiFmqnIFuoeAUR7BQWrERWtNBGC0FFsZAVFNzCG6KIonhD5tc8wstyZIVddmexWx4485755ns4nClmDEtLIZMc04KlJ305xCJOdPhriljBBXT5ad6yjktiMHvNe2JqXdNzlyONI9lpPrKttgV+aYzxk1Ol0cw1n4irZZVXlCjFMf5woTxOQWaahcQXvMH4q7yv+XKu9daamWYOxw4flEvVeICJWm5xNGamCVHFa+ypRnznX1YbnkIjnl1TTANheulLUJNCEw5W9NBOJaFHzTumuMclMZZCc4JL4oww0rxkQxNeGtGPGe04ccUS0YDmFJpIsGKGTZy4pdhYUozz2eMX13OneptxqtDkuVMzqkeMe4UST02/6lHDiW+emm7Vp/OavCaJH6pu5aQRAyxTkbtG5DV5zfNobhT+e2qG1T1h7CkMeUkKiKl7xIgq3NDJVwqzoIjfzOJEnVGGy5FdXgRnjTfnlJK4mFQzz6WH4pAIXzDsAebVfPqM6YXGAAAAAElFTkSuQmCC";var cx={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const bO=async()=>{await bs.logOut(),window.location&&(window.location=window.location.origin)},xO=({profile:n,open:t,anchorEl:i,onClose:u,...p})=>{const[m,o]=me.useState(""),[_,b]=me.useState("");me.useEffect(()=>{var M;b(((M=cx.VITE_APP_GIT_SHA)==null?void 0:M.substring(0,7))||"dev");const T=cx.VITE_APP_GIT_TIMESTAMP;T&&o(`, ${ui(T).fromNow()}`)},[]);const E=me.useCallback(()=>{u(),bO()},[u]);return R.jsxs(Bf,{open:t,onClose:u,anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},...p,children:[R.jsxs(vg,{className:"text-white py-3 px-4 flex-col items-start",children:[R.jsx("span",{className:"font-bold",children:n.email}),R.jsx("span",{className:"text-xs text-[#ffffff66] pt-2",children:n.user_id}),R.jsx("span",{className:"text-xs text-[#ffffff66] pt-2",children:`Version: ${_}${m}`})]}),R.jsx(Ja,{}),R.jsx(yi,{className:"py-3 px-4",component:"a",href:"https://useradmin.comma.ai/",target:"_blank",children:"Manage Account"}),R.jsx(yi,{className:"py-3 px-4",onClick:E,children:"Log out"})]})};var wO=om();const yy=_n(wO);class f2 extends me.Component{constructor(t){super(t),this.prevVisibleCall=0,this.intervalHandle=null,this.handleVisibilityChange=this.handleVisibilityChange.bind(this),this.handleFocus=this.handleFocus.bind(this),this.handleBlur=this.handleBlur.bind(this),this.onVisibilityEvent=yy(this.onVisibilityEvent.bind(this),1e3,!0)}componentDidMount(){document.addEventListener("visibilitychange",this.handleVisibilityChange),document.addEventListener("focus",this.handleFocus),document.addEventListener("blur",this.handleBlur),this.prevVisibleCall=Date.now()/1e3;const{onInit:t,onInterval:i,onVisible:u}=this.props;t&&u(),i&&(this.intervalHandle=setInterval(this.handleVisibilityChange,i*1e3))}componentDidUpdate(t){const{dongleId:i,onDongleId:u,onVisible:p}=this.props;u&&t.dongleId!==i&&(this.prevVisibleCall=Date.now()/1e3,p())}componentWillUnmount(){document.removeEventListener("visibilitychange",this.handleVisibilityChange),document.removeEventListener("focus",this.handleFocus),document.removeEventListener("blur",this.handleBlur),this.intervalHandle&&(clearInterval(this.intervalHandle),this.intervalHandle=null)}handleFocus(){this.onVisibilityEvent(!0)}handleBlur(){this.onVisibilityEvent(!1)}handleVisibilityChange(){document.visibilityState==="visible"?this.onVisibilityEvent(!0):document.visibilityState==="hidden"&&this.onVisibilityEvent(!1)}onVisibilityEvent(t){const{minInterval:i,onVisible:u,resetOnHidden:p}=this.props,m=Date.now()/1e3,o=m-this.prevVisibleCall;t&&(!i||o>i)&&(this.prevVisibleCall=m,u()),!t&&p&&(this.prevVisibleCall=m)}render(){return null}}const SO=pi({dongleId:"dongleId"});f2.propTypes={onVisible:kn.func.isRequired,onInit:kn.bool,onDongleId:kn.bool,onInterval:kn.number,minInterval:kn.number,resetOnHidden:kn.bool};const Th=Kn(SO)(f2),EO=n=>({modal:{position:"absolute",padding:n.spacing.unit*2,width:n.spacing.unit*50,maxWidth:"90%",margin:"0 auto",left:"50%",top:"40%",transform:"translate(-50%, -50%)",outline:"none"},buttonGroup:{marginTop:20,textAlign:"right"},headerDropdown:{fontWeight:500,marginRight:12,width:310,maxWidth:"90%",textAlign:"center"},datePickerContainer:{display:"flex",marginBottom:20,"& aside":{width:100}},cancelButton:{backgroundColor:Ue.grey200,color:Ue.white,"&:hover":{backgroundColor:Ue.grey400}},saveButton:{backgroundColor:Ue.white,color:Ue.grey800,"&:hover":{backgroundColor:Ue.white70}}}),PO=365*24*3600*1e3;class TO extends me.Component{constructor(t){super(t),this.state={showPicker:!1},this.handleSelectChange=this.handleSelectChange.bind(this),this.handleClose=this.handleClose.bind(this),this.changeStart=this.changeStart.bind(this),this.changeEnd=this.changeEnd.bind(this),this.handleSave=this.handleSave.bind(this),this.onVisible=this.onVisible.bind(this)}handleSelectChange(t){const i=t.target.value,u=new Date;switch(u.setHours(u.getHours()+1,0,0,0),i){case"24-hours":this.props.dispatch(zp(u.getTime()-1e3*60*60*24,u.getTime()));break;case"1-week":this.props.dispatch(zp(u.getTime()-1e3*60*60*24*7,u.getTime()));break;case"2-weeks":this.props.dispatch(zp(u.getTime()-1e3*60*60*24*14,u.getTime()));break;case"custom":this.setState({showPicker:!0,start:this.props.filter.start,end:this.props.filter.end});break}}handleClose(){this.setState({showPicker:!1})}changeStart(t){t.target.valueAsDate&&this.setState({start:t.target.valueAsDate.setHours(0,0,0,0)})}changeEnd(t){t.target.valueAsDate&&this.setState({end:t.target.valueAsDate.setHours(23,59,59,999)})}handleSave(){this.props.dispatch(zp(this.state.start,this.state.end)),this.setState({showPicker:!1,start:null,end:null})}selectedOption(){const t=this.props.filter.end-this.props.filter.start;if(Math.abs(this.props.filter.end-Date.now())<1e3*60*60){if(t===1e3*60*60*24*14)return"2-weeks";if(t===1e3*60*60*24*7)return"1-week";if(t===1e3*60*60*24)return"24-hours"}return"custom"}customText(){const{filter:t}=this.props,i=ui(t.start).format("MMM D"),u=ui(t.end).format("MMM D");let p=`Custom: ${i}`;return i!==u&&(p+=` - ${u}`),p}lastWeekText(){return`Last week (since ${ui().subtract(1,"week").format("MMM D")})`}last2WeeksText(){return`Last 2 weeks (since ${ui().subtract(14,"day").format("MMM D")})`}onVisible(){const t=gC();this.props.dispatch(zp(t.start,t.end))}render(){const{classes:t}=this.props,i=ui().subtract(PO,"millisecond").format("YYYY-MM-DD"),u=ui().format("YYYY-MM-DD"),p=ui(this.state.start||this.props.filter.start).format("YYYY-MM-DD"),m=ui(this.state.end||this.props.filter.end).format("YYYY-MM-DD");return R.jsxs(R.Fragment,{children:[R.jsx(Th,{onVisible:this.onVisible,minInterval:300,resetOnHidden:!0}),R.jsx(mM,{children:R.jsxs(DM,{name:"timerange",value:this.selectedOption(),onChange:this.handleSelectChange,className:t.headerDropdown,children:[R.jsx(yi,{value:"custom",children:this.customText()}),R.jsx(yi,{value:"24-hours",children:"Last 24 Hours"}),R.jsx(yi,{value:"1-week",children:this.lastWeekText()}),R.jsx(yi,{value:"2-weeks",children:this.last2WeeksText()})]})}),R.jsx(Mc,{"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",open:this.state.showPicker,onClose:this.handleClose,children:R.jsxs(Ic,{className:t.modal,children:[R.jsxs("div",{className:t.datePickerContainer,children:[R.jsx(dt,{variant:"body2",children:"Start date:"}),R.jsx("input",{label:"Start date",type:"date",min:i,max:u,onChange:this.changeStart,value:p})]}),R.jsxs("div",{className:t.datePickerContainer,children:[R.jsx(dt,{variant:"body2",children:"End date:"}),R.jsx("input",{label:"End date",type:"date",min:i,max:u,onChange:this.changeEnd,value:m})]}),R.jsx(Ja,{}),R.jsxs("div",{className:t.buttonGroup,children:[R.jsx(an,{variant:"contained",className:t.cancelButton,onClick:this.handleClose,children:"Cancel"})," ",R.jsx(an,{variant:"contained",className:t.saveButton,onClick:this.handleSave,children:"Save"})]})]})})]})}}const CO=pi({filter:"filter"}),IO=Kn(CO)(ci.withStyles(EO)(TO)),MO=()=>({header:{backgroundColor:"#1D2225",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:7.5,flexWrap:"wrap"},titleContainer:{display:"flex",alignItems:"center",flexWrap:"nowrap"},logo:{alignItems:"center",display:"flex",maxWidth:200,textDecoration:"none"},logoImgLink:{lineHeight:0},logoImg:{height:34,width:18.9,margin:"0px 28px"},logoText:{fontSize:20,fontWeight:800},accountIcon:{color:Ue.white30,height:34,width:34}}),OO=({profile:n,classes:t,dispatch:i,drawerIsOpen:u,annotating:p,showDrawerButton:m,forwardRef:o,handleDrawerStateChanged:_,primeNav:b,dongleId:E})=>{const[T,M]=me.useState(null),I=me.useCallback(W=>{bs.isAuthenticated()?M(W.currentTarget):window.location&&(window.location=window.location.origin)},[]),N=me.useCallback(()=>{M(null)},[]),D=me.useCallback(()=>{i(_(!u))},[i,u,_]),re=!!T;return R.jsxs(R.Fragment,{children:[R.jsx(CI,{position:"sticky",elevation:1,children:R.jsxs("div",{ref:o,className:t.header,children:[R.jsxs("div",{className:t.titleContainer,children:[m?R.jsx(Da,{"aria-label":"menu",className:"mr-3",onClick:D,children:R.jsx(xM,{children:"menu"})}):R.jsx("a",{href:`/${E}`,className:t.logoImgLink,onClick:mh(()=>i(Ks(E))),children:R.jsx("img",{alt:"comma",src:"/images/comma-white.png",className:t.logoImg})}),R.jsx("a",{href:`/${E}`,onClick:mh(()=>i(Ks(E))),children:R.jsx(dt,{className:t.logoText,children:"connect"})})]}),R.jsx("div",{className:"flex order-4 w-full justify-center sm:order-none sm:w-auto",children:!!(!b&&!p&&E)&&R.jsx(IO,{})}),R.jsxs("div",{className:"flex flex-row gap-2",children:[R.jsx(me.Suspense,{children:R.jsx(SI,{})}),R.jsx(Da,{"aria-owns":re?"menu-appbar":null,"aria-haspopup":"true",onClick:I,"aria-label":"account menu",children:R.jsx(yC,{className:t.accountIcon})})]})]})}),!!(bs.isAuthenticated()&&n)&&R.jsx(xO,{id:"menu-appbar",open:re,anchorEl:T,onClose:N,profile:n})]})},RO=pi({dongleId:"dongleId",filter:"filter",profile:"profile",primeNav:"primeNav"}),AO=Kn(RO)(ci.withStyles(MO)(OO)),kO=150,m2=()=>{const[n,t]=me.useState(window.innerWidth),i=me.useRef(null);return me.useEffect(()=>{const u=()=>{i.current&&window.clearTimeout(i.current),i.current=window.setTimeout(()=>{t(window.innerWidth),i.current=null},kO)};return window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u),i.current&&window.clearTimeout(i.current)}},[]),n},DO=()=>({zeroState:{flex:"0"}}),LO=n=>{const t=m2(),{classes:i,device:u,routes:p}=n;let m=null;u&&p===null?m=R.jsx(dt,{children:"Loading..."}):(p==null?void 0:p.length)===0&&(m=R.jsx(dt,{children:"No routes found in selected time range."}));const o=t>520?36:16;return R.jsx(zf,{container:!0,className:i.zeroState,style:{padding:`16px ${o}px`},children:m})},zO=ci.withStyles(DO)(LO);function jO(n){if(Array.isArray(n))return n}function NO(n,t){var i=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(i!=null){var u,p,m,o,_=[],b=!0,E=!1;try{if(m=(i=i.call(n)).next,t===0){if(Object(i)!==i)return;b=!1}else for(;!(b=(u=m.call(i)).done)&&(_.push(u.value),_.length!==t);b=!0);}catch(T){E=!0,p=T}finally{try{if(!b&&i.return!=null&&(o=i.return(),Object(o)!==o))return}finally{if(E)throw p}}return _}}function BO(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bn(n,t){return jO(n)||NO(n,t)||d2(n,t)||BO()}var zi=1e-6,Oc=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});function FO(){var n=new Oc(4);return Oc!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function UO(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n}function VO(n,t,i){var u=t[0],p=t[1],m=t[2],o=t[3];return n[0]=i[0]*u+i[4]*p+i[8]*m+i[12]*o,n[1]=i[1]*u+i[5]*p+i[9]*m+i[13]*o,n[2]=i[2]*u+i[6]*p+i[10]*m+i[14]*o,n[3]=i[3]*u+i[7]*p+i[11]*m+i[15]*o,n}(function(){var n=FO();return function(t,i,u,p,m,o){var _,b;for(i||(i=4),u||(u=0),p?b=Math.min(p*i+u,t.length):b=t.length,_=u;_<b;_+=i)n[0]=t[_],n[1]=t[_+1],n[2]=t[_+2],n[3]=t[_+3],m(n,n,o),t[_]=n[0],t[_+1]=n[1],t[_+2]=n[2],t[_+3]=n[3];return t}})();function If(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function wc(n,t){const i=VO([],t,n);return UO(i,i,1/i[3]),i}function px(n,t){const i=n%t;return i<0?t+i:i}function qO(n,t,i){return i*t+(1-i)*n}function Eg(n,t,i){return n<t?t:n>i?i:n}function $O(n){return Math.log(n)*Math.LOG2E}const _y=Math.log2||$O;function WO(n,t){var i=t[0],u=t[1],p=t[2],m=t[3],o=t[4],_=t[5],b=t[6],E=t[7],T=t[8],M=t[9],I=t[10],N=t[11],D=t[12],re=t[13],W=t[14],ee=t[15],J=i*_-u*o,Y=i*b-p*o,B=i*E-m*o,V=u*b-p*_,K=u*E-m*_,ve=p*E-m*b,de=T*re-M*D,ie=T*W-I*D,we=T*ee-N*D,ze=M*W-I*re,De=M*ee-N*re,ce=I*ee-N*W,Pe=J*ce-Y*De+B*ze+V*we-K*ie+ve*de;return Pe?(Pe=1/Pe,n[0]=(_*ce-b*De+E*ze)*Pe,n[1]=(p*De-u*ce-m*ze)*Pe,n[2]=(re*ve-W*K+ee*V)*Pe,n[3]=(I*K-M*ve-N*V)*Pe,n[4]=(b*we-o*ce-E*ie)*Pe,n[5]=(i*ce-p*we+m*ie)*Pe,n[6]=(W*B-D*ve-ee*Y)*Pe,n[7]=(T*ve-I*B+N*Y)*Pe,n[8]=(o*De-_*we+E*de)*Pe,n[9]=(u*we-i*De-m*de)*Pe,n[10]=(D*K-re*B+ee*J)*Pe,n[11]=(M*B-T*K-N*J)*Pe,n[12]=(_*ie-o*ze-b*de)*Pe,n[13]=(i*ze-u*ie+p*de)*Pe,n[14]=(re*Y-D*V-W*J)*Pe,n[15]=(T*V-M*Y+I*J)*Pe,n):null}function Mv(n,t,i){var u=t[0],p=t[1],m=t[2],o=t[3],_=t[4],b=t[5],E=t[6],T=t[7],M=t[8],I=t[9],N=t[10],D=t[11],re=t[12],W=t[13],ee=t[14],J=t[15],Y=i[0],B=i[1],V=i[2],K=i[3];return n[0]=Y*u+B*_+V*M+K*re,n[1]=Y*p+B*b+V*I+K*W,n[2]=Y*m+B*E+V*N+K*ee,n[3]=Y*o+B*T+V*D+K*J,Y=i[4],B=i[5],V=i[6],K=i[7],n[4]=Y*u+B*_+V*M+K*re,n[5]=Y*p+B*b+V*I+K*W,n[6]=Y*m+B*E+V*N+K*ee,n[7]=Y*o+B*T+V*D+K*J,Y=i[8],B=i[9],V=i[10],K=i[11],n[8]=Y*u+B*_+V*M+K*re,n[9]=Y*p+B*b+V*I+K*W,n[10]=Y*m+B*E+V*N+K*ee,n[11]=Y*o+B*T+V*D+K*J,Y=i[12],B=i[13],V=i[14],K=i[15],n[12]=Y*u+B*_+V*M+K*re,n[13]=Y*p+B*b+V*I+K*W,n[14]=Y*m+B*E+V*N+K*ee,n[15]=Y*o+B*T+V*D+K*J,n}function Pg(n,t,i){var u=i[0],p=i[1],m=i[2],o,_,b,E,T,M,I,N,D,re,W,ee;return t===n?(n[12]=t[0]*u+t[4]*p+t[8]*m+t[12],n[13]=t[1]*u+t[5]*p+t[9]*m+t[13],n[14]=t[2]*u+t[6]*p+t[10]*m+t[14],n[15]=t[3]*u+t[7]*p+t[11]*m+t[15]):(o=t[0],_=t[1],b=t[2],E=t[3],T=t[4],M=t[5],I=t[6],N=t[7],D=t[8],re=t[9],W=t[10],ee=t[11],n[0]=o,n[1]=_,n[2]=b,n[3]=E,n[4]=T,n[5]=M,n[6]=I,n[7]=N,n[8]=D,n[9]=re,n[10]=W,n[11]=ee,n[12]=o*u+T*p+D*m+t[12],n[13]=_*u+M*p+re*m+t[13],n[14]=b*u+I*p+W*m+t[14],n[15]=E*u+N*p+ee*m+t[15]),n}function v2(n,t,i){var u=i[0],p=i[1],m=i[2];return n[0]=t[0]*u,n[1]=t[1]*u,n[2]=t[2]*u,n[3]=t[3]*u,n[4]=t[4]*p,n[5]=t[5]*p,n[6]=t[6]*p,n[7]=t[7]*p,n[8]=t[8]*m,n[9]=t[9]*m,n[10]=t[10]*m,n[11]=t[11]*m,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function HO(n,t,i){var u=Math.sin(i),p=Math.cos(i),m=t[4],o=t[5],_=t[6],b=t[7],E=t[8],T=t[9],M=t[10],I=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=m*p+E*u,n[5]=o*p+T*u,n[6]=_*p+M*u,n[7]=b*p+I*u,n[8]=E*p-m*u,n[9]=T*p-o*u,n[10]=M*p-_*u,n[11]=I*p-b*u,n}function ZO(n,t,i){var u=Math.sin(i),p=Math.cos(i),m=t[0],o=t[1],_=t[2],b=t[3],E=t[4],T=t[5],M=t[6],I=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=m*p+E*u,n[1]=o*p+T*u,n[2]=_*p+M*u,n[3]=b*p+I*u,n[4]=E*p-m*u,n[5]=T*p-o*u,n[6]=M*p-_*u,n[7]=I*p-b*u,n}function GO(n,t,i,u,p){var m=1/Math.tan(t/2),o;return n[0]=m/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=m,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,p!=null&&p!==1/0?(o=1/(u-p),n[10]=(p+u)*o,n[14]=2*p*u*o):(n[10]=-1,n[14]=-2*u),n}var XO=GO;function hx(n,t){var i=n[0],u=n[1],p=n[2],m=n[3],o=n[4],_=n[5],b=n[6],E=n[7],T=n[8],M=n[9],I=n[10],N=n[11],D=n[12],re=n[13],W=n[14],ee=n[15],J=t[0],Y=t[1],B=t[2],V=t[3],K=t[4],ve=t[5],de=t[6],ie=t[7],we=t[8],ze=t[9],De=t[10],ce=t[11],Pe=t[12],gt=t[13],jt=t[14],Tt=t[15];return Math.abs(i-J)<=zi*Math.max(1,Math.abs(i),Math.abs(J))&&Math.abs(u-Y)<=zi*Math.max(1,Math.abs(u),Math.abs(Y))&&Math.abs(p-B)<=zi*Math.max(1,Math.abs(p),Math.abs(B))&&Math.abs(m-V)<=zi*Math.max(1,Math.abs(m),Math.abs(V))&&Math.abs(o-K)<=zi*Math.max(1,Math.abs(o),Math.abs(K))&&Math.abs(_-ve)<=zi*Math.max(1,Math.abs(_),Math.abs(ve))&&Math.abs(b-de)<=zi*Math.max(1,Math.abs(b),Math.abs(de))&&Math.abs(E-ie)<=zi*Math.max(1,Math.abs(E),Math.abs(ie))&&Math.abs(T-we)<=zi*Math.max(1,Math.abs(T),Math.abs(we))&&Math.abs(M-ze)<=zi*Math.max(1,Math.abs(M),Math.abs(ze))&&Math.abs(I-De)<=zi*Math.max(1,Math.abs(I),Math.abs(De))&&Math.abs(N-ce)<=zi*Math.max(1,Math.abs(N),Math.abs(ce))&&Math.abs(D-Pe)<=zi*Math.max(1,Math.abs(D),Math.abs(Pe))&&Math.abs(re-gt)<=zi*Math.max(1,Math.abs(re),Math.abs(gt))&&Math.abs(W-jt)<=zi*Math.max(1,Math.abs(W),Math.abs(jt))&&Math.abs(ee-Tt)<=zi*Math.max(1,Math.abs(ee),Math.abs(Tt))}function KO(){var n=new Oc(2);return Oc!=Float32Array&&(n[0]=0,n[1]=0),n}function Tg(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n}function YO(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n}function JO(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n}function QO(n){var t=n[0],i=n[1];return Math.hypot(t,i)}function eR(n,t){return n[0]=-t[0],n[1]=-t[1],n}function g2(n,t,i,u){var p=t[0],m=t[1];return n[0]=p+u*(i[0]-p),n[1]=m+u*(i[1]-m),n}var tR=YO;(function(){var n=KO();return function(t,i,u,p,m,o){var _,b;for(i||(i=2),u||(u=0),p?b=Math.min(p*i+u,t.length):b=t.length,_=u;_<b;_+=i)n[0]=t[_],n[1]=t[_+1],m(n,n,o),t[_]=n[0],t[_+1]=n[1];return t}})();function rR(){var n=new Oc(3);return Oc!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function nR(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n}function iR(n,t,i){return n[0]=t[0]*i[0],n[1]=t[1]*i[1],n[2]=t[2]*i[2],n}function aR(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n}var oR=iR;(function(){var n=rR();return function(t,i,u,p,m,o){var _,b;for(i||(i=3),u||(u=0),p?b=Math.min(p*i+u,t.length):b=t.length,_=u;_<b;_+=i)n[0]=t[_],n[1]=t[_+1],n[2]=t[_+2],m(n,n,o),t[_]=n[0],t[_+1]=n[1],t[_+2]=n[2];return t}})();function Ys(n,t){if(!n)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const Qa=Math.PI,y2=Qa/4,ko=Qa/180,Cg=180/Qa,gh=512,dx=4003e4,nf=85.051129,_2=1.5;function Ig(n){return Math.pow(2,n)}function sR(n){return _y(n)}function Zs(n){const[t,i]=n;Ys(Number.isFinite(t)),Ys(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude");const u=t*ko,p=i*ko,m=gh*(u+Qa)/(2*Qa),o=gh*(Qa+Math.log(Math.tan(y2+p*.5)))/(2*Qa);return[m,o]}function Xs(n){const[t,i]=n,u=t/gh*(2*Qa)-Qa,p=2*(Math.atan(Math.exp(i/gh*(2*Qa)-Qa))-y2);return[u*Cg,p*Cg]}function lR(n){const{latitude:t,longitude:i,highPrecision:u=!1}=n;Ys(Number.isFinite(t)&&Number.isFinite(i));const p=gh,m=Math.cos(t*ko),o=p/360,_=o/m,b=p/dx/m,E={unitsPerMeter:[b,b,b],metersPerUnit:[1/b,1/b,1/b],unitsPerDegree:[o,_,b],degreesPerUnit:[1/o,1/_,1/b]};if(u){const T=ko*Math.tan(t*ko)/m,M=o*T/2,I=p/dx*T,N=I/_*b;E.unitsPerDegree2=[0,M,I],E.unitsPerMeter2=[N,0,N]}return E}function uR(n){const{height:t,pitch:i,bearing:u,altitude:p,scale:m,center:o}=n,_=If();Pg(_,_,[0,0,-p]),HO(_,_,-i*ko),ZO(_,_,u*ko);const b=m/t;return v2(_,_,[b,b,b]),o&&Pg(_,_,aR([],o)),_}function cR(n){const{width:t,height:i,altitude:u,pitch:p=0,offset:m,center:o,scale:_,nearZMultiplier:b=1,farZMultiplier:E=1}=n;let{fovy:T=Ff(_2)}=n;u!==void 0&&(T=Ff(u));const M=T*ko,I=p*ko,N=b2(T);let D=N;o&&(D+=o[2]*_/Math.cos(I)/i);const re=M*(.5+(m?m[1]:0)/i),W=Math.sin(re)*D/Math.sin(Eg(Math.PI/2-I-re,.01,Math.PI-.01)),ee=Math.sin(I)*W+D,J=D*10,Y=Math.min(ee*E,J);return{fov:M,aspect:t/i,focalDistance:N,near:b,far:Y}}function pR(n){const{fov:t,aspect:i,near:u,far:p}=cR(n);return XO([],t,i,u,p)}function Ff(n){return 2*Math.atan(.5/n)*Cg}function b2(n){return .5/Math.tan(.5*n*ko)}function hR(n,t){const[i,u,p=0]=n;return Ys(Number.isFinite(i)&&Number.isFinite(u)&&Number.isFinite(p)),wc(t,[i,u,p,1])}function fx(n,t,i=0){const[u,p,m]=n;if(Ys(Number.isFinite(u)&&Number.isFinite(p),"invalid pixel coordinate"),Number.isFinite(m))return wc(t,[u,p,m,1]);const o=wc(t,[u,p,0,1]),_=wc(t,[u,p,1,1]),b=o[2],E=_[2],T=b===E?0:((i||0)-b)/(E-b);return g2([],o,_,T)}function dR(n){const{width:t,height:i,bounds:u,minExtent:p=0,maxZoom:m=24,offset:o=[0,0]}=n,[[_,b],[E,T]]=u,M=fR(n.padding),I=Zs([_,Eg(T,-nf,nf)]),N=Zs([E,Eg(b,-nf,nf)]),D=[Math.max(Math.abs(N[0]-I[0]),p),Math.max(Math.abs(N[1]-I[1]),p)],re=[t-M.left-M.right-Math.abs(o[0])*2,i-M.top-M.bottom-Math.abs(o[1])*2];Ys(re[0]>0&&re[1]>0);const W=re[0]/D[0],ee=re[1]/D[1],J=(M.right-M.left)/2/W,Y=(M.top-M.bottom)/2/ee,B=[(N[0]+I[0])/2+J,(N[1]+I[1])/2+Y],V=Xs(B),K=Math.min(m,_y(Math.abs(Math.min(W,ee))));return Ys(Number.isFinite(K)),{longitude:V[0],latitude:V[1],zoom:K}}function fR(n=0){return typeof n=="number"?{top:n,bottom:n,left:n,right:n}:(Ys(Number.isFinite(n.top)&&Number.isFinite(n.bottom)&&Number.isFinite(n.left)&&Number.isFinite(n.right)),n)}const mx=Math.PI/180;function mR(n,t=0){const{width:i,height:u,unproject:p}=n,m={targetZ:t},o=p([0,u],m),_=p([i,u],m);let b,E;const T=n.fovy?.5*n.fovy*mx:Math.atan(.5/n.altitude),M=(90-n.pitch)*mx;return T>M-.01?(b=vx(n,0,t),E=vx(n,i,t)):(b=p([0,0],m),E=p([i,0],m)),[o,_,E,b]}function vx(n,t,i){const{pixelUnprojectionMatrix:u}=n,p=wc(u,[t,0,1,1]),m=wc(u,[t,n.height,1,1]),_=(i*n.distanceScales.unitsPerMeter[2]-p[2])/(m[2]-p[2]),b=g2([],p,m,_),E=Xs(b);return E.push(i),E}class Ea{constructor(t={width:1,height:1}){ft(this,"latitude",void 0),ft(this,"longitude",void 0),ft(this,"zoom",void 0),ft(this,"pitch",void 0),ft(this,"bearing",void 0),ft(this,"altitude",void 0),ft(this,"fovy",void 0),ft(this,"meterOffset",void 0),ft(this,"center",void 0),ft(this,"width",void 0),ft(this,"height",void 0),ft(this,"scale",void 0),ft(this,"distanceScales",void 0),ft(this,"viewMatrix",void 0),ft(this,"projectionMatrix",void 0),ft(this,"viewProjectionMatrix",void 0),ft(this,"pixelProjectionMatrix",void 0),ft(this,"pixelUnprojectionMatrix",void 0),ft(this,"equals",ee=>ee instanceof Ea?ee.width===this.width&&ee.height===this.height&&hx(ee.projectionMatrix,this.projectionMatrix)&&hx(ee.viewMatrix,this.viewMatrix):!1),ft(this,"project",(ee,J={})=>{const{topLeft:Y=!0}=J,B=this.projectPosition(ee),V=hR(B,this.pixelProjectionMatrix),[K,ve]=V,de=Y?ve:this.height-ve;return ee.length===2?[K,de]:[K,de,V[2]]}),ft(this,"unproject",(ee,J={})=>{const{topLeft:Y=!0,targetZ:B=void 0}=J,[V,K,ve]=ee,de=Y?K:this.height-K,ie=B&&B*this.distanceScales.unitsPerMeter[2],we=fx([V,de,ve],this.pixelUnprojectionMatrix,ie),[ze,De,ce]=this.unprojectPosition(we);return Number.isFinite(ve)?[ze,De,ce]:Number.isFinite(B)?[ze,De,B]:[ze,De]}),ft(this,"projectPosition",ee=>{const[J,Y]=Zs(ee),B=(ee[2]||0)*this.distanceScales.unitsPerMeter[2];return[J,Y,B]}),ft(this,"unprojectPosition",ee=>{const[J,Y]=Xs(ee),B=(ee[2]||0)*this.distanceScales.metersPerUnit[2];return[J,Y,B]});let{width:i,height:u,altitude:p=null,fovy:m=null}=t;const{latitude:o=0,longitude:_=0,zoom:b=0,pitch:E=0,bearing:T=0,position:M=null,nearZMultiplier:I=.02,farZMultiplier:N=1.01}=t;i=i||1,u=u||1,m===null&&p===null?(p=_2,m=Ff(p)):m===null?m=Ff(p):p===null&&(p=b2(m));const D=Ig(b);p=Math.max(.75,p);const re=lR({longitude:_,latitude:o}),W=Zs([_,o]);W.push(0),M&&nR(W,W,oR([],M,re.unitsPerMeter)),this.projectionMatrix=pR({width:i,height:u,scale:D,center:W,pitch:E,fovy:m,nearZMultiplier:I,farZMultiplier:N}),this.viewMatrix=uR({height:u,scale:D,center:W,pitch:E,bearing:T,altitude:p}),this.width=i,this.height=u,this.scale=D,this.latitude=o,this.longitude=_,this.zoom=b,this.pitch=E,this.bearing=T,this.altitude=p,this.fovy=m,this.center=W,this.meterOffset=M||[0,0,0],this.distanceScales=re,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:t,height:i,projectionMatrix:u,viewMatrix:p}=this,m=If();Mv(m,m,u),Mv(m,m,p),this.viewProjectionMatrix=m;const o=If();v2(o,o,[t/2,-i/2,1]),Pg(o,o,[1,-1,0]),Mv(o,o,m);const _=WO(If(),o);if(!_)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=_}projectFlat(t){return Zs(t)}unprojectFlat(t){return Xs(t)}getMapCenterByLngLatPosition({lngLat:t,pos:i}){const u=fx(i,this.pixelUnprojectionMatrix),p=Zs(t),m=Tg([],p,eR([],u)),o=Tg([],this.center,m);return Xs(o)}fitBounds(t,i={}){const{width:u,height:p}=this,{longitude:m,latitude:o,zoom:_}=dR(Object.assign({width:u,height:p,bounds:t},i));return new Ea({width:u,height:p,longitude:m,latitude:o,zoom:_})}getBounds(t){const i=this.getBoundingRegion(t),u=Math.min(...i.map(_=>_[0])),p=Math.max(...i.map(_=>_[0])),m=Math.min(...i.map(_=>_[1])),o=Math.max(...i.map(_=>_[1]));return[[u,m],[p,o]]}getBoundingRegion(t={}){return mR(this,t.z||0)}getLocationAtPoint({lngLat:t,pos:i}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:i})}}const gx=512;function vR(n){const{width:t,height:i,pitch:u=0}=n;let{longitude:p,latitude:m,zoom:o,bearing:_=0}=n;(p<-180||p>180)&&(p=px(p+180,360)-180),(_<-180||_>180)&&(_=px(_+180,360)-180);const b=_y(i/gx);if(o<=b)o=b,m=0;else{const E=i/2/Math.pow(2,o),T=Xs([0,E])[1];if(m<T)m=T;else{const M=Xs([0,gx-E])[1];m>M&&(m=M)}}return{width:t,height:i,longitude:p,latitude:m,zoom:o,pitch:u,bearing:_}}const x2=.01,gR=["longitude","latitude","zoom"],w2={curve:1.414,speed:1.2};function yR(n,t,i,u){const{startZoom:p,startCenterXY:m,uDelta:o,w0:_,u1:b,S:E,rho:T,rho2:M,r0:I}=S2(n,t,u);if(b<x2){const B={};for(const V of gR){const K=n[V],ve=t[V];B[V]=qO(K,ve,i)}return B}const N=i*E,D=Math.cosh(I)/Math.cosh(I+T*N),re=_*((Math.cosh(I)*Math.tanh(I+T*N)-Math.sinh(I))/M)/b,W=1/D,ee=p+sR(W),J=JO([],o,re);Tg(J,J,m);const Y=Xs(J);return{longitude:Y[0],latitude:Y[1],zoom:ee}}function _R(n,t,i){const u={...w2,...i},{screenSpeed:p,speed:m,maxDuration:o}=u,{S:_,rho:b}=S2(n,t,u),E=1e3*_;let T;return Number.isFinite(p)?T=E/(p/b):T=E/m,Number.isFinite(o)&&T>o?0:T}function S2(n,t,i){i=Object.assign({},w2,i);const u=i.curve,p=n.zoom,m=[n.longitude,n.latitude],o=Ig(p),_=t.zoom,b=[t.longitude,t.latitude],E=Ig(_-p),T=Zs(m),M=Zs(b),I=tR([],M,T),N=Math.max(n.width,n.height),D=N/E,re=QO(I)*o,W=Math.max(re,x2),ee=u*u,J=(D*D-N*N+ee*ee*W*W)/(2*N*ee*W),Y=(D*D-N*N-ee*ee*W*W)/(2*D*ee*W),B=Math.log(Math.sqrt(J*J+1)-J),V=Math.log(Math.sqrt(Y*Y+1)-Y),K=(V-B)/u;return{startZoom:p,startCenterXY:T,uDelta:I,w0:N,u1:re,S:K,rho:u,rho2:ee,r0:B,r1:V}}var E2=function(){if(typeof Map<"u")return Map;function n(t,i){var u=-1;return t.some(function(p,m){return p[0]===i?(u=m,!0):!1}),u}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(i){var u=n(this.__entries__,i),p=this.__entries__[u];return p&&p[1]},t.prototype.set=function(i,u){var p=n(this.__entries__,i);~p?this.__entries__[p][1]=u:this.__entries__.push([i,u])},t.prototype.delete=function(i){var u=this.__entries__,p=n(u,i);~p&&u.splice(p,1)},t.prototype.has=function(i){return!!~n(this.__entries__,i)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(i,u){u===void 0&&(u=null);for(var p=0,m=this.__entries__;p<m.length;p++){var o=m[p];i.call(u,o[1],o[0])}},t}()}(),Mg=typeof window<"u"&&typeof document<"u"&&window.document===document,Uf=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),bR=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Uf):function(n){return setTimeout(function(){return n(Date.now())},1e3/60)}}(),xR=2;function wR(n,t){var i=!1,u=!1,p=0;function m(){i&&(i=!1,n()),u&&_()}function o(){bR(m)}function _(){var b=Date.now();if(i){if(b-p<xR)return;u=!0}else i=!0,u=!1,setTimeout(o,t);p=b}return _}var SR=20,ER=["top","right","bottom","left","width","height","size","weight"],PR=typeof MutationObserver<"u",TR=function(){function n(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=wR(this.refresh.bind(this),SR)}return n.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},n.prototype.removeObserver=function(t){var i=this.observers_,u=i.indexOf(t);~u&&i.splice(u,1),!i.length&&this.connected_&&this.disconnect_()},n.prototype.refresh=function(){var t=this.updateObservers_();t&&this.refresh()},n.prototype.updateObservers_=function(){var t=this.observers_.filter(function(i){return i.gatherActive(),i.hasActive()});return t.forEach(function(i){return i.broadcastActive()}),t.length>0},n.prototype.connect_=function(){!Mg||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),PR?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},n.prototype.disconnect_=function(){!Mg||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},n.prototype.onTransitionEnd_=function(t){var i=t.propertyName,u=i===void 0?"":i,p=ER.some(function(m){return!!~u.indexOf(m)});p&&this.refresh()},n.getInstance=function(){return this.instance_||(this.instance_=new n),this.instance_},n.instance_=null,n}(),P2=function(n,t){for(var i=0,u=Object.keys(t);i<u.length;i++){var p=u[i];Object.defineProperty(n,p,{value:t[p],enumerable:!1,writable:!1,configurable:!0})}return n},Rc=function(n){var t=n&&n.ownerDocument&&n.ownerDocument.defaultView;return t||Uf},T2=um(0,0,0,0);function Vf(n){return parseFloat(n)||0}function yx(n){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return t.reduce(function(u,p){var m=n["border-"+p+"-width"];return u+Vf(m)},0)}function CR(n){for(var t=["top","right","bottom","left"],i={},u=0,p=t;u<p.length;u++){var m=p[u],o=n["padding-"+m];i[m]=Vf(o)}return i}function IR(n){var t=n.getBBox();return um(0,0,t.width,t.height)}function MR(n){var t=n.clientWidth,i=n.clientHeight;if(!t&&!i)return T2;var u=Rc(n).getComputedStyle(n),p=CR(u),m=p.left+p.right,o=p.top+p.bottom,_=Vf(u.width),b=Vf(u.height);if(u.boxSizing==="border-box"&&(Math.round(_+m)!==t&&(_-=yx(u,"left","right")+m),Math.round(b+o)!==i&&(b-=yx(u,"top","bottom")+o)),!RR(n)){var E=Math.round(_+m)-t,T=Math.round(b+o)-i;Math.abs(E)!==1&&(_-=E),Math.abs(T)!==1&&(b-=T)}return um(p.left,p.top,_,b)}var OR=function(){return typeof SVGGraphicsElement<"u"?function(n){return n instanceof Rc(n).SVGGraphicsElement}:function(n){return n instanceof Rc(n).SVGElement&&typeof n.getBBox=="function"}}();function RR(n){return n===Rc(n).document.documentElement}function AR(n){return Mg?OR(n)?IR(n):MR(n):T2}function kR(n){var t=n.x,i=n.y,u=n.width,p=n.height,m=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,o=Object.create(m.prototype);return P2(o,{x:t,y:i,width:u,height:p,top:i,right:t+u,bottom:p+i,left:t}),o}function um(n,t,i,u){return{x:n,y:t,width:i,height:u}}var DR=function(){function n(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=um(0,0,0,0),this.target=t}return n.prototype.isActive=function(){var t=AR(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},n.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},n}(),LR=function(){function n(t,i){var u=kR(i);P2(this,{target:t,contentRect:u})}return n}(),zR=function(){function n(t,i,u){if(this.activeObservations_=[],this.observations_=new E2,typeof t!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=i,this.callbackCtx_=u}return n.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof Rc(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var i=this.observations_;i.has(t)||(i.set(t,new DR(t)),this.controller_.addObserver(this),this.controller_.refresh())}},n.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof Rc(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var i=this.observations_;i.has(t)&&(i.delete(t),i.size||this.controller_.removeObserver(this))}},n.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},n.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(i){i.isActive()&&t.activeObservations_.push(i)})},n.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,i=this.activeObservations_.map(function(u){return new LR(u.target,u.broadcastRect())});this.callback_.call(t,i,t),this.clearActive()}},n.prototype.clearActive=function(){this.activeObservations_.splice(0)},n.prototype.hasActive=function(){return this.activeObservations_.length>0},n}(),C2=typeof WeakMap<"u"?new WeakMap:new E2,I2=function(){function n(t){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=TR.getInstance(),u=new zR(t,i,this);C2.set(this,u)}return n}();["observe","unobserve","disconnect"].forEach(function(n){I2.prototype[n]=function(){var t;return(t=C2.get(this))[n].apply(t,arguments)}});var M2=function(){return typeof Uf.ResizeObserver<"u"?Uf.ResizeObserver:I2}(),ms=typeof document<"u"?document:{};function _x(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function af(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?_x(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):_x(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function bx(n,t){var i;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(i=jR(n))||t){i&&(n=i);var u=0,p=function(){};return{s:p,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(E){throw E},f:p}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,o=!1,_;return{s:function(){i=n[Symbol.iterator]()},n:function(){var E=i.next();return m=E.done,E},e:function(E){o=!0,_=E},f:function(){try{!m&&i.return!=null&&i.return()}finally{if(o)throw _}}}}function jR(n,t){if(n){if(typeof n=="string")return xx(n,t);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(n);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return xx(n,t)}}function xx(n,t){t=n.length;for(var i=0,u=new Array(t);i<t;i++)u[i]=n[i];return u}var NR=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ov(n){if(!n)return null;if(typeof n=="string")return n;n.toJS&&(n=n.toJS());var t={},i=bx(n.layers),u;try{for(i.s();!(u=i.n()).done;){var p=u.value;t[p.id]=p}}catch(o){i.e(o)}finally{i.f()}var m=n.layers.map(function(o){var _=t[o.ref],b=null;if("interactive"in o&&(b=af({},o),delete b.interactive),_){b=b||af({},o),delete b.ref;var E=bx(NR),T;try{for(E.s();!(T=E.n()).done;){var M=T.value;M in _&&(b[M]=_[M])}}catch(I){E.e(I)}finally{E.f()}}return b||o});return af(af({},n),{},{layers:m})}var wx={};function BR(){}function FR(n){n&&console.error(n.error)}var O2={container:Oe.object,gl:Oe.object,mapboxApiAccessToken:Oe.string,mapboxApiUrl:Oe.string,attributionControl:Oe.bool,preserveDrawingBuffer:Oe.bool,reuseMaps:Oe.bool,transformRequest:Oe.func,mapOptions:Oe.object,mapStyle:Oe.oneOfType([Oe.string,Oe.object]),preventStyleDiffing:Oe.bool,visible:Oe.bool,asyncRender:Oe.bool,onLoad:Oe.func,onError:Oe.func,width:Oe.number,height:Oe.number,viewState:Oe.object,longitude:Oe.number,latitude:Oe.number,zoom:Oe.number,bearing:Oe.number,pitch:Oe.number,altitude:Oe.number},Mf={container:ms.body,mapboxApiAccessToken:UR(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",preventStyleDiffing:!1,visible:!0,asyncRender:!1,onLoad:BR,onError:FR,width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function UR(){var n=null;if(typeof window<"u"&&window.location){var t=window.location.search.match(/access_token=([^&\/]*)/);n=t&&t[1]}return!n&&typeof process<"u"&&(n=n||wx.MapboxAccessToken||wx.REACT_APP_MAPBOX_ACCESS_TOKEN),n||"no-token"}function Sx(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"component";n.debug&&Oe.checkPropTypes(O2,n,"prop",t)}var vu=function(){function n(t){var i=this;if(rl(this,n),ft(this,"props",Mf),ft(this,"width",0),ft(this,"height",0),ft(this,"_fireLoadEvent",function(){i.props.onLoad({type:"load",target:i._map})}),ft(this,"_handleError",function(u){i.props.onError(u)}),!t.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=t.mapboxgl,n.initialized||(n.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(t)}return tl(n,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(i){return this._update(this.props,i),this}},{key:"redraw",value:function(){var i=this._map;i.style&&(i._frame&&(i._frame.cancel(),i._frame=null),i._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(i){this._map=n.savedMap;var u=this._map.getContainer(),p=i.container;for(p.classList.add("mapboxgl-map");u.childNodes.length>0;)p.appendChild(u.childNodes[0]);this._map._container=p,n.savedMap=null,i.mapStyle&&this._map.setStyle(Ov(i.mapStyle),{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(i){if(i.reuseMaps&&n.savedMap)this._reuse(i);else{if(i.gl){var u=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=u,i.gl}}var p={container:i.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:Ov(i.mapStyle),interactive:!1,trackResize:!1,attributionControl:i.attributionControl,preserveDrawingBuffer:i.preserveDrawingBuffer};i.transformRequest&&(p.transformRequest=i.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},p,i.mapOptions)),this._map.once("load",this._fireLoadEvent),this._map.on("error",this._handleError)}return this}},{key:"_destroy",value:function(){this._map&&(this.props.reuseMaps&&!n.savedMap?(n.savedMap=this._map,this._map.off("load",this._fireLoadEvent),this._map.off("error",this._handleError),this._map.off("styledata",this._fireLoadEvent)):this._map.remove(),this._map=null)}},{key:"_initialize",value:function(i){var u=this;i=Object.assign({},Mf,i),Sx(i,"Mapbox"),this.mapboxgl.accessToken=i.mapboxApiAccessToken||Mf.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=i.mapboxApiUrl,this._create(i);var p=i,m=p.container;Object.defineProperty(m,"offsetWidth",{configurable:!0,get:function(){return u.width}}),Object.defineProperty(m,"clientWidth",{configurable:!0,get:function(){return u.width}}),Object.defineProperty(m,"offsetHeight",{configurable:!0,get:function(){return u.height}}),Object.defineProperty(m,"clientHeight",{configurable:!0,get:function(){return u.height}});var o=this._map.getCanvas();o&&(o.style.outline="none"),this._updateMapViewport({},i),this._updateMapSize({},i),this.props=i}},{key:"_update",value:function(i,u){if(this._map){u=Object.assign({},this.props,u),Sx(u,"Mapbox");var p=this._updateMapViewport(i,u),m=this._updateMapSize(i,u);this._updateMapStyle(i,u),!u.asyncRender&&(p||m)&&this.redraw(),this.props=u}}},{key:"_updateMapStyle",value:function(i,u){var p=i.mapStyle!==u.mapStyle;p&&this._map.setStyle(Ov(u.mapStyle),{diff:!u.preventStyleDiffing})}},{key:"_updateMapSize",value:function(i,u){var p=i.width!==u.width||i.height!==u.height;return p&&(this.width=u.width,this.height=u.height,this._map.resize()),p}},{key:"_updateMapViewport",value:function(i,u){var p=this._getViewState(i),m=this._getViewState(u),o=m.latitude!==p.latitude||m.longitude!==p.longitude||m.zoom!==p.zoom||m.pitch!==p.pitch||m.bearing!==p.bearing||m.altitude!==p.altitude;return o&&(this._map.jumpTo(this._viewStateToMapboxProps(m)),m.altitude!==p.altitude&&(this._map.transform.altitude=m.altitude)),o}},{key:"_getViewState",value:function(i){var u=i.viewState||i,p=u.longitude,m=u.latitude,o=u.zoom,_=u.pitch,b=_===void 0?0:_,E=u.bearing,T=E===void 0?0:E,M=u.altitude,I=M===void 0?1.5:M;return{longitude:p,latitude:m,zoom:o,pitch:b,bearing:T,altitude:I}}},{key:"_checkStyleSheet",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"0.47.0";if(!(typeof ms>"u"))try{var u=ms.createElement("div");u.className="mapboxgl-map",u.style.display="none",ms.body.appendChild(u);var p=window.getComputedStyle(u).position!=="static";if(!p){var m=ms.createElement("link");m.setAttribute("rel","stylesheet"),m.setAttribute("type","text/css"),m.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(i,"/mapbox-gl.css")),ms.head.appendChild(m)}}catch{}}},{key:"_viewStateToMapboxProps",value:function(i){return{center:[i.longitude,i.latitude],zoom:i.zoom,bearing:i.bearing,pitch:i.pitch}}}]),n}();ft(vu,"initialized",!1);ft(vu,"propTypes",O2);ft(vu,"defaultProps",Mf);ft(vu,"savedMap",null);var R2={exports:{}};(function(n,t){(function(i,u){n.exports=u()})(Sa,function(){var i,u,p;function m(o,_){if(!i)i=_;else if(!u)u=_;else{var b="var sharedChunk = {}; ("+i+")(sharedChunk); ("+u+")(sharedChunk);",E={};i(E),p=_(E),typeof window<"u"&&(p.workerUrl=window.URL.createObjectURL(new Blob([b],{type:"text/javascript"})))}}return m(["exports"],function(o){function _(e,r){return e(r={exports:{}},r.exports),r.exports}var b=E;function E(e,r,a,h){this.cx=3*e,this.bx=3*(a-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(h-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=h,this.p2x=a,this.p2y=h}E.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},E.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},E.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},E.prototype.solveCurveX=function(e,r){var a,h,f,v,y;for(r===void 0&&(r=1e-6),f=e,y=0;y<8;y++){if(v=this.sampleCurveX(f)-e,Math.abs(v)<r)return f;var S=this.sampleCurveDerivativeX(f);if(Math.abs(S)<1e-6)break;f-=v/S}if((f=e)<(a=0))return a;if(f>(h=1))return h;for(;a<h;){if(v=this.sampleCurveX(f),Math.abs(v-e)<r)return f;e>v?a=f:h=f,f=.5*(h-a)+a}return f},E.prototype.solve=function(e,r){return this.sampleCurveY(this.solveCurveX(e,r))};var T=M;function M(e,r){this.x=e,this.y=r}M.prototype={clone:function(){return new M(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,r){return this.clone()._rotateAround(e,r)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var r=e.x-this.x,a=e.y-this.y;return r*r+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,r){return Math.atan2(this.x*r-this.y*e,this.x*e+this.y*r)},_matMult:function(e){var r=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var r=Math.cos(e),a=Math.sin(e),h=a*this.x+r*this.y;return this.x=r*this.x-a*this.y,this.y=h,this},_rotateAround:function(e,r){var a=Math.cos(e),h=Math.sin(e),f=r.y+h*(this.x-r.x)+a*(this.y-r.y);return this.x=r.x+a*(this.x-r.x)-h*(this.y-r.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},M.convert=function(e){return e instanceof M?e:Array.isArray(e)?new M(e[0],e[1]):e};var I=typeof self<"u"?self:{},N=Math.pow(2,53)-1;function D(e,r,a,h){var f=new b(e,r,a,h);return function(v){return f.solve(v)}}var re=D(.25,.1,.25,1);function W(e,r,a){return Math.min(a,Math.max(r,e))}function ee(e,r,a){var h=a-r,f=((e-r)%h+h)%h+r;return f===r?a:f}function J(e){for(var r=[],a=arguments.length-1;a-- >0;)r[a]=arguments[a+1];for(var h=0,f=r;h<f.length;h+=1){var v=f[h];for(var y in v)e[y]=v[y]}return e}var Y=1;function B(){return Y++}function V(){return function e(r){return r?(r^16*Math.random()>>r/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function K(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function ve(e,r){e.forEach(function(a){r[a]&&(r[a]=r[a].bind(r))})}function de(e,r){return e.indexOf(r,e.length-r.length)!==-1}function ie(e,r,a){var h={};for(var f in e)h[f]=r.call(a||this,e[f],f,e);return h}function we(e,r,a){var h={};for(var f in e)r.call(a||this,e[f],f,e)&&(h[f]=e[f]);return h}function ze(e){return Array.isArray(e)?e.map(ze):typeof e=="object"&&e?ie(e,ze):e}var De={};function ce(e){De[e]||(typeof console<"u"&&console.warn(e),De[e]=!0)}function Pe(e,r,a){return(a.y-e.y)*(r.x-e.x)>(r.y-e.y)*(a.x-e.x)}function gt(e){for(var r=0,a=0,h=e.length,f=h-1,v=void 0,y=void 0;a<h;f=a++)r+=((y=e[f]).x-(v=e[a]).x)*(v.y+y.y);return r}function jt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Tt(e){var r={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(h,f,v,y){var S=v||y;return r[f]=!S||S.toLowerCase(),""}),r["max-age"]){var a=parseInt(r["max-age"],10);isNaN(a)?delete r["max-age"]:r["max-age"]=a}return r}var kt=null;function Ir(e){if(kt==null){var r=e.navigator?e.navigator.userAgent:null;kt=!!e.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return kt}function pr(e){try{var r=I[e];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch{return!1}}var Zt,Kt,Yt,Dt,Gt=I.performance&&I.performance.now?I.performance.now.bind(I.performance):Date.now.bind(Date),yr=I.requestAnimationFrame||I.mozRequestAnimationFrame||I.webkitRequestAnimationFrame||I.msRequestAnimationFrame,Et=I.cancelAnimationFrame||I.mozCancelAnimationFrame||I.webkitCancelAnimationFrame||I.msCancelAnimationFrame,er={now:Gt,frame:function(e){var r=yr(e);return{cancel:function(){return Et(r)}}},getImageData:function(e,r){r===void 0&&(r=0);var a=I.document.createElement("canvas"),h=a.getContext("2d");if(!h)throw new Error("failed to create canvas 2d context");return a.width=e.width,a.height=e.height,h.drawImage(e,0,0,e.width,e.height),h.getImageData(-r,-r,e.width+2*r,e.height+2*r)},resolveURL:function(e){return Zt||(Zt=I.document.createElement("a")),Zt.href=e,Zt.href},hardwareConcurrency:I.navigator&&I.navigator.hardwareConcurrency||4,get devicePixelRatio(){return I.devicePixelRatio},get prefersReducedMotion(){return!!I.matchMedia&&(Kt==null&&(Kt=I.matchMedia("(prefers-reduced-motion: reduce)")),Kt.matches)}},mt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},$t={supported:!1,testSupport:function(e){!Nr&&Dt&&(Br?It(e):Yt=e)}},Nr=!1,Br=!1;function It(e){var r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Dt),e.isContextLost())return;$t.supported=!0}catch{}e.deleteTexture(r),Nr=!0}I.document&&((Dt=I.document.createElement("img")).onload=function(){Yt&&It(Yt),Yt=null,Br=!0},Dt.onerror=function(){Nr=!0,Yt=null},Dt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var $r="01",hr=function(e,r){this._transformRequestFn=e,this._customAccessToken=r,this._createSkuToken()};function dr(e){return e.indexOf("mapbox:")===0}hr.prototype._createSkuToken=function(){var e=function(){for(var r="",a=0;a<10;a++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",$r,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},hr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},hr.prototype.transformRequest=function(e,r){return this._transformRequestFn&&this._transformRequestFn(e,r)||{url:e}},hr.prototype.normalizeStyleURL=function(e,r){if(!dr(e))return e;var a=bn(e);return a.path="/styles/v1"+a.path,this._makeAPIURL(a,this._customAccessToken||r)},hr.prototype.normalizeGlyphsURL=function(e,r){if(!dr(e))return e;var a=bn(e);return a.path="/fonts/v1"+a.path,this._makeAPIURL(a,this._customAccessToken||r)},hr.prototype.normalizeSourceURL=function(e,r){if(!dr(e))return e;var a=bn(e);return a.path="/v4/"+a.authority+".json",a.params.push("secure"),this._makeAPIURL(a,this._customAccessToken||r)},hr.prototype.normalizeSpriteURL=function(e,r,a,h){var f=bn(e);return dr(e)?(f.path="/styles/v1"+f.path+"/sprite"+r+a,this._makeAPIURL(f,this._customAccessToken||h)):(f.path+=""+r+a,en(f))},hr.prototype.normalizeTileURL=function(e,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!dr(e))return e;var a=bn(e);a.path=a.path.replace(/(\.(png|jpg)\d*)(?=$)/,(er.devicePixelRatio>=2||r===512?"@2x":"")+($t.supported?".webp":"$1")),a.path=a.path.replace(/^.+\/v4\//,"/"),a.path="/v4"+a.path;var h=this._customAccessToken||function(f){for(var v=0,y=f;v<y.length;v+=1){var S=y[v].match(/^access_token=(.*)$/);if(S)return S[1]}return null}(a.params)||mt.ACCESS_TOKEN;return mt.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&a.params.push("sku="+this._skuToken),this._makeAPIURL(a,h)},hr.prototype.canonicalizeTileURL=function(e,r){var a=bn(e);if(!a.path.match(/(^\/v4\/)/)||!a.path.match(/\.[\w]+$/))return e;var h="mapbox://tiles/";h+=a.path.replace("/v4/","");var f=a.params;return r&&(f=f.filter(function(v){return!v.match(/^access_token=/)})),f.length&&(h+="?"+f.join("&")),h},hr.prototype.canonicalizeTileset=function(e,r){for(var a=!!r&&dr(r),h=[],f=0,v=e.tiles||[];f<v.length;f+=1){var y=v[f];Tn(y)?h.push(this.canonicalizeTileURL(y,a)):h.push(y)}return h},hr.prototype._makeAPIURL=function(e,r){var a="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",h=bn(mt.API_URL);if(e.protocol=h.protocol,e.authority=h.authority,e.protocol==="http"){var f=e.params.indexOf("secure");f>=0&&e.params.splice(f,1)}if(h.path!=="/"&&(e.path=""+h.path+e.path),!mt.REQUIRE_ACCESS_TOKEN)return en(e);if(!(r=r||mt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+a);if(r[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+a);return e.params=e.params.filter(function(v){return v.indexOf("access_token")===-1}),e.params.push("access_token="+r),en(e)};var Un=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Tn(e){return Un.test(e)}var Pi=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function bn(e){var r=e.match(Pi);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function en(e){var r=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+r}function ea(e){if(!e)return null;var r=e.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(decodeURIComponent(I.atob(r[1]).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Wt=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Wt.prototype.getStorageKey=function(e){var r,a=ea(mt.ACCESS_TOKEN);return r=a&&a.u?I.btoa(encodeURIComponent(a.u).replace(/%([0-9A-F]{2})/g,function(h,f){return String.fromCharCode(+("0x"+f))})):mt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+r:"mapbox.eventData:"+r},Wt.prototype.fetchEventData=function(){var e=pr("localStorage"),r=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{var h=I.localStorage.getItem(r);h&&(this.eventData=JSON.parse(h));var f=I.localStorage.getItem(a);f&&(this.anonId=f)}catch{ce("Unable to read from LocalStorage")}},Wt.prototype.saveEventData=function(){var e=pr("localStorage"),r=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{I.localStorage.setItem(a,this.anonId),Object.keys(this.eventData).length>=1&&I.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{ce("Unable to write to LocalStorage")}},Wt.prototype.processRequests=function(e){},Wt.prototype.postEvent=function(e,r,a,h){var f=this;if(mt.EVENTS_URL){var v=bn(mt.EVENTS_URL);v.params.push("access_token="+(h||mt.ACCESS_TOKEN||""));var y={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:$r,userId:this.anonId},S=r?J(y,r):y,C={url:en(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([S])};this.pendingRequest=tn(C,function(O){f.pendingRequest=null,a(O),f.saveEventData(),f.processRequests(h)})}},Wt.prototype.queueRequest=function(e,r){this.queue.push(e),this.processRequests(r)};var lt,Mt,nr=function(e){function r(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.postMapLoadEvent=function(a,h,f,v){this.skuToken=f;var y=!(!v&&!mt.ACCESS_TOKEN),S=Array.isArray(a)&&a.some(function(C){return dr(C)||Tn(C)});mt.EVENTS_URL&&y&&S&&this.queueRequest({id:h,timestamp:Date.now()},v)},r.prototype.processRequests=function(a){var h=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),v=f.id,y=f.timestamp;v&&this.success[v]||(this.anonId||this.fetchEventData(),K(this.anonId)||(this.anonId=V()),this.postEvent(y,{skuToken:this.skuToken},function(S){S||v&&(h.success[v]=!0)},a))}},r}(Wt),xn=new(function(e){function r(a){e.call(this,"appUserTurnstile"),this._customAccessToken=a}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.postTurnstileEvent=function(a,h){mt.EVENTS_URL&&mt.ACCESS_TOKEN&&Array.isArray(a)&&a.some(function(f){return dr(f)||Tn(f)})&&this.queueRequest(Date.now(),h)},r.prototype.processRequests=function(a){var h=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=ea(mt.ACCESS_TOKEN),v=f?f.u:mt.ACCESS_TOKEN,y=v!==this.eventData.tokenU;K(this.anonId)||(this.anonId=V(),y=!0);var S=this.queue.shift();if(this.eventData.lastSuccess){var C=new Date(this.eventData.lastSuccess),O=new Date(S),k=(S-this.eventData.lastSuccess)/864e5;y=y||k>=1||k<-1||C.getDate()!==O.getDate()}else y=!0;if(!y)return this.processRequests();this.postEvent(S,{"enabled.telemetry":!1},function(L){L||(h.eventData.lastSuccess=S,h.eventData.tokenU=v)},a)}},r}(Wt)),Cn=xn.postTurnstileEvent.bind(xn),ri=new nr,Ui=ri.postMapLoadEvent.bind(ri),da=500,to=50;function ro(){I.caches&&!lt&&(lt=I.caches.open("mapbox-tiles"))}function Lo(e){var r=e.indexOf("?");return r<0?e:e.slice(0,r)}var za,zo=1/0;function jo(){return za==null&&(za=I.OffscreenCanvas&&new I.OffscreenCanvas(1,1).getContext("2d")&&typeof I.createImageBitmap=="function"),za}var ja={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ja);var ws=function(e){function r(a,h,f){h===401&&Tn(f)&&(a+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,a),this.status=h,this.url=f,this.name=this.constructor.name,this.message=a}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},r}(Error),Na=jt()?function(){return self.worker&&self.worker.referrer}:function(){return(I.location.protocol==="blob:"?I.parent:I).location.href},ta,ra,Ta=function(e,r){if(!(/^file:/.test(a=e.url)||/^file:/.test(Na())&&!/^\w+:/.test(a))){if(I.fetch&&I.Request&&I.AbortController&&I.Request.prototype.hasOwnProperty("signal"))return function(h,f){var v,y=new I.AbortController,S=new I.Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:Na(),signal:y.signal}),C=!1,O=!1,k=(v=S.url).indexOf("sku=")>0&&Tn(v);h.type==="json"&&S.headers.set("Accept","application/json");var L=function($,oe,le){if(!O){if($&&$.message!=="SecurityError"&&ce($),oe&&le)return U(oe);var _e=Date.now();I.fetch(S).then(function(fe){if(fe.ok){var Te=k?fe.clone():null;return U(fe,Te,_e)}return f(new ws(fe.statusText,fe.status,h.url))}).catch(function(fe){fe.code!==20&&f(new Error(fe.message))})}},U=function($,oe,le){(h.type==="arrayBuffer"?$.arrayBuffer():h.type==="json"?$.json():$.text()).then(function(_e){O||(oe&&le&&function(fe,Te,Me){if(ro(),lt){var Re={status:Te.status,statusText:Te.statusText,headers:new I.Headers};Te.headers.forEach(function(Ve,Ze){return Re.headers.set(Ze,Ve)});var Le=Tt(Te.headers.get("Cache-Control")||"");Le["no-store"]||(Le["max-age"]&&Re.headers.set("Expires",new Date(Me+1e3*Le["max-age"]).toUTCString()),new Date(Re.headers.get("Expires")).getTime()-Me<42e4||function(Ve,Ze){if(Mt===void 0)try{new Response(new ReadableStream),Mt=!0}catch{Mt=!1}Mt?Ze(Ve.body):Ve.blob().then(Ze)}(Te,function(Ve){var Ze=new I.Response(Ve,Re);ro(),lt&&lt.then(function(Qe){return Qe.put(Lo(fe.url),Ze)}).catch(function(Qe){return ce(Qe.message)})}))}}(S,oe,le),C=!0,f(null,_e,$.headers.get("Cache-Control"),$.headers.get("Expires")))}).catch(function(_e){O||f(new Error(_e.message))})};return k?function($,oe){if(ro(),!lt)return oe(null);var le=Lo($.url);lt.then(function(_e){_e.match(le).then(function(fe){var Te=function(Me){if(!Me)return!1;var Re=new Date(Me.headers.get("Expires")||0),Le=Tt(Me.headers.get("Cache-Control")||"");return Re>Date.now()&&!Le["no-cache"]}(fe);_e.delete(le),Te&&_e.put(le,fe.clone()),oe(null,fe,Te)}).catch(oe)}).catch(oe)}(S,L):L(null,null),{cancel:function(){O=!0,C||y.abort()}}}(e,r);if(jt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,r,void 0,!0)}var a;return function(h,f){var v=new I.XMLHttpRequest;for(var y in v.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(v.responseType="arraybuffer"),h.headers)v.setRequestHeader(y,h.headers[y]);return h.type==="json"&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials=h.credentials==="include",v.onerror=function(){f(new Error(v.statusText))},v.onload=function(){if((v.status>=200&&v.status<300||v.status===0)&&v.response!==null){var S=v.response;if(h.type==="json")try{S=JSON.parse(v.response)}catch(C){return f(C)}f(null,S,v.getResponseHeader("Cache-Control"),v.getResponseHeader("Expires"))}else f(new ws(v.statusText,v.status,h.url))},v.send(h.body),{cancel:function(){return v.abort()}}}(e,r)},No=function(e,r){return Ta(J(e,{type:"arrayBuffer"}),r)},tn=function(e,r){return Ta(J(e,{method:"POST"}),r)},z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";ta=[],ra=0;var F=function(e,r){if($t.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),ra>=mt.MAX_PARALLEL_IMAGE_REQUESTS){var a={requestParameters:e,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return ta.push(a),a}ra++;var h=!1,f=function(){if(!h)for(h=!0,ra--;ta.length&&ra<mt.MAX_PARALLEL_IMAGE_REQUESTS;){var y=ta.shift();y.cancelled||(y.cancel=F(y.requestParameters,y.callback).cancel)}},v=No(e,function(y,S,C,O){f(),y?r(y):S&&(jo()?function(k,L){var U=new I.Blob([new Uint8Array(k)],{type:"image/png"});I.createImageBitmap(U).then(function($){L(null,$)}).catch(function($){L(new Error("Could not load image because of "+$.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(S,r):function(k,L,U,$){var oe=new I.Image,le=I.URL;oe.onload=function(){L(null,oe),le.revokeObjectURL(oe.src),oe.onload=null,I.requestAnimationFrame(function(){oe.src=z})},oe.onerror=function(){return L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var _e=new I.Blob([new Uint8Array(k)],{type:"image/png"});oe.cacheControl=U,oe.expires=$,oe.src=k.byteLength?le.createObjectURL(_e):z}(S,r,C,O))});return{cancel:function(){v.cancel(),f()}}};function q(e,r,a){a[e]&&a[e].indexOf(r)!==-1||(a[e]=a[e]||[],a[e].push(r))}function te(e,r,a){if(a&&a[e]){var h=a[e].indexOf(r);h!==-1&&a[e].splice(h,1)}}var ue=function(e,r){r===void 0&&(r={}),J(this,r),this.type=e},xe=function(e){function r(a,h){h===void 0&&(h={}),e.call(this,"error",J({error:a},h))}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r}(ue),Se=function(){};Se.prototype.on=function(e,r){return this._listeners=this._listeners||{},q(e,r,this._listeners),this},Se.prototype.off=function(e,r){return te(e,r,this._listeners),te(e,r,this._oneTimeListeners),this},Se.prototype.once=function(e,r){return this._oneTimeListeners=this._oneTimeListeners||{},q(e,r,this._oneTimeListeners),this},Se.prototype.fire=function(e,r){typeof e=="string"&&(e=new ue(e,r||{}));var a=e.type;if(this.listens(a)){e.target=this;for(var h=0,f=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];h<f.length;h+=1)f[h].call(this,e);for(var v=0,y=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];v<y.length;v+=1){var S=y[v];te(a,S,this._oneTimeListeners),S.call(this,e)}var C=this._eventedParent;C&&(J(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),C.fire(e))}else e instanceof xe&&console.error(e.error);return this},Se.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Se.prototype.setEventedParent=function(e,r){return this._eventedParent=e,this._eventedParentData=r,this};var G={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},he=function(e,r,a,h){this.message=(e?e+": ":"")+a,h&&(this.identifier=h),r!=null&&r.__line__&&(this.line=r.__line__)};function Ce(e){var r=e.value;return r?[new he(e.key,r,"constants have been deprecated as of v8")]:[]}function $e(e){for(var r=[],a=arguments.length-1;a-- >0;)r[a]=arguments[a+1];for(var h=0,f=r;h<f.length;h+=1){var v=f[h];for(var y in v)e[y]=v[y]}return e}function He(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Ne(e){if(Array.isArray(e))return e.map(Ne);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var r={};for(var a in e)r[a]=Ne(e[a]);return r}return He(e)}var We=function(e){function r(a,h){e.call(this,h),this.message=h,this.key=a}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r}(Error),ct=function(e,r){r===void 0&&(r=[]),this.parent=e,this.bindings={};for(var a=0,h=r;a<h.length;a+=1){var f=h[a];this.bindings[f[0]]=f[1]}};ct.prototype.concat=function(e){return new ct(this,e)},ct.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},ct.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var ot={kind:"null"},Fe={kind:"number"},rt={kind:"string"},Ye={kind:"boolean"},Je={kind:"color"},Bt={kind:"object"},tt={kind:"value"},tr={kind:"collator"},Mr={kind:"formatted"},Jt={kind:"resolvedImage"};function lr(e,r){return{kind:"array",itemType:e,N:r}}function Ft(e){if(e.kind==="array"){var r=Ft(e.itemType);return typeof e.N=="number"?"array<"+r+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+r+">"}return e.kind}var fn=[ot,Fe,rt,Ye,Je,Mr,Bt,lr(tt),Jt];function ar(e,r){if(r.kind==="error")return null;if(e.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!ar(e.itemType,r.itemType))&&(typeof e.N!="number"||e.N===r.N))return null}else{if(e.kind===r.kind)return null;if(e.kind==="value"){for(var a=0,h=fn;a<h.length;a+=1)if(!ar(h[a],r))return null}}return"Expected "+Ft(e)+" but found "+Ft(r)+" instead."}function Or(e,r){return r.some(function(a){return a.kind===e.kind})}function gr(e,r){return r.some(function(a){return a==="null"?e===null:a==="array"?Array.isArray(e):a==="object"?e&&!Array.isArray(e)&&typeof e=="object":a===typeof e})}var Ut=_(function(e,r){var a={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function h(S){return(S=Math.round(S))<0?0:S>255?255:S}function f(S){return h(S[S.length-1]==="%"?parseFloat(S)/100*255:parseInt(S))}function v(S){return(C=S[S.length-1]==="%"?parseFloat(S)/100:parseFloat(S))<0?0:C>1?1:C;var C}function y(S,C,O){return O<0?O+=1:O>1&&(O-=1),6*O<1?S+(C-S)*O*6:2*O<1?C:3*O<2?S+(C-S)*(2/3-O)*6:S}try{r.parseCSSColor=function(S){var C,O=S.replace(/ /g,"").toLowerCase();if(O in a)return a[O].slice();if(O[0]==="#")return O.length===4?(C=parseInt(O.substr(1),16))>=0&&C<=4095?[(3840&C)>>4|(3840&C)>>8,240&C|(240&C)>>4,15&C|(15&C)<<4,1]:null:O.length===7&&(C=parseInt(O.substr(1),16))>=0&&C<=16777215?[(16711680&C)>>16,(65280&C)>>8,255&C,1]:null;var k=O.indexOf("("),L=O.indexOf(")");if(k!==-1&&L+1===O.length){var U=O.substr(0,k),$=O.substr(k+1,L-(k+1)).split(","),oe=1;switch(U){case"rgba":if($.length!==4)return null;oe=v($.pop());case"rgb":return $.length!==3?null:[f($[0]),f($[1]),f($[2]),oe];case"hsla":if($.length!==4)return null;oe=v($.pop());case"hsl":if($.length!==3)return null;var le=(parseFloat($[0])%360+360)%360/360,_e=v($[1]),fe=v($[2]),Te=fe<=.5?fe*(_e+1):fe+_e-fe*_e,Me=2*fe-Te;return[h(255*y(Me,Te,le+1/3)),h(255*y(Me,Te,le)),h(255*y(Me,Te,le-1/3)),oe];default:return null}}return null}}catch{}}).parseCSSColor,Qt=function(e,r,a,h){h===void 0&&(h=1),this.r=e,this.g=r,this.b=a,this.a=h};Qt.parse=function(e){if(e){if(e instanceof Qt)return e;if(typeof e=="string"){var r=Ut(e);if(r)return new Qt(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3])}}},Qt.prototype.toString=function(){var e=this.toArray(),r=e[1],a=e[2],h=e[3];return"rgba("+Math.round(e[0])+","+Math.round(r)+","+Math.round(a)+","+h+")"},Qt.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Qt.black=new Qt(0,0,0,1),Qt.white=new Qt(1,1,1,1),Qt.transparent=new Qt(0,0,0,0),Qt.red=new Qt(1,0,0,1);var Yn=function(e,r,a){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Yn.prototype.compare=function(e,r){return this.collator.compare(e,r)},Yn.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var no=function(e,r,a,h,f){this.text=e,this.image=r,this.scale=a,this.fontStack=h,this.textColor=f},on=function(e){this.sections=e};on.fromString=function(e){return new on([new no(e,null,null,null,null)])},on.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},on.factory=function(e){return e instanceof on?e:on.fromString(e)},on.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},on.prototype.serialize=function(){for(var e=["format"],r=0,a=this.sections;r<a.length;r+=1){var h=a[r];if(h.image)e.push(["image",h.image.name]);else{e.push(h.text);var f={};h.fontStack&&(f["text-font"]=["literal",h.fontStack.split(",")]),h.scale&&(f["font-scale"]=h.scale),h.textColor&&(f["text-color"]=["rgba"].concat(h.textColor.toArray())),e.push(f)}}return e};var Hr=function(e){this.name=e.name,this.available=e.available};function io(e,r,a,h){return typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof a=="number"&&a>=0&&a<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:"Invalid rgba value ["+[e,r,a,h].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof h=="number"?[e,r,a,h]:[e,r,a]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Ba(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof Qt||e instanceof Yn||e instanceof on||e instanceof Hr)return!0;if(Array.isArray(e)){for(var r=0,a=e;r<a.length;r+=1)if(!Ba(a[r]))return!1;return!0}if(typeof e=="object"){for(var h in e)if(!Ba(e[h]))return!1;return!0}return!1}function Zr(e){if(e===null)return ot;if(typeof e=="string")return rt;if(typeof e=="boolean")return Ye;if(typeof e=="number")return Fe;if(e instanceof Qt)return Je;if(e instanceof Yn)return tr;if(e instanceof on)return Mr;if(e instanceof Hr)return Jt;if(Array.isArray(e)){for(var r,a=e.length,h=0,f=e;h<f.length;h+=1){var v=Zr(f[h]);if(r){if(r===v)continue;r=tt;break}r=v}return lr(r||tt,a)}return Bt}function Fa(e){var r=typeof e;return e===null?"":r==="string"||r==="number"||r==="boolean"?String(e):e instanceof Qt||e instanceof on||e instanceof Hr?e.toString():JSON.stringify(e)}Hr.prototype.toString=function(){return this.name},Hr.fromString=function(e){return e?new Hr({name:e,available:!1}):null},Hr.prototype.serialize=function(){return["image",this.name]};var Dn=function(e,r){this.type=e,this.value=r};Dn.parse=function(e,r){if(e.length!==2)return r.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Ba(e[1]))return r.error("invalid value");var a=e[1],h=Zr(a),f=r.expectedType;return h.kind!=="array"||h.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(h=f),new Dn(h,a)},Dn.prototype.evaluate=function(){return this.value},Dn.prototype.eachChild=function(){},Dn.prototype.outputDefined=function(){return!0},Dn.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Qt?["rgba"].concat(this.value.toArray()):this.value instanceof on?this.value.serialize():this.value};var sn=function(e){this.name="ExpressionEvaluationError",this.message=e};sn.prototype.toJSON=function(){return this.message};var In={string:rt,number:Fe,boolean:Ye,object:Bt},Fr=function(e,r){this.type=e,this.args=r};Fr.parse=function(e,r){if(e.length<2)return r.error("Expected at least one argument.");var a,h=1,f=e[0];if(f==="array"){var v,y;if(e.length>2){var S=e[1];if(typeof S!="string"||!(S in In)||S==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);v=In[S],h++}else v=tt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);y=e[2],h++}a=lr(v,y)}else a=In[f];for(var C=[];h<e.length;h++){var O=r.parse(e[h],h,tt);if(!O)return null;C.push(O)}return new Fr(a,C)},Fr.prototype.evaluate=function(e){for(var r=0;r<this.args.length;r++){var a=this.args[r].evaluate(e);if(!ar(this.type,Zr(a)))return a;if(r===this.args.length-1)throw new sn("Expected value to be of type "+Ft(this.type)+", but found "+Ft(Zr(a))+" instead.")}return null},Fr.prototype.eachChild=function(e){this.args.forEach(e)},Fr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Fr.prototype.serialize=function(){var e=this.type,r=[e.kind];if(e.kind==="array"){var a=e.itemType;if(a.kind==="string"||a.kind==="number"||a.kind==="boolean"){r.push(a.kind);var h=e.N;(typeof h=="number"||this.args.length>1)&&r.push(h)}}return r.concat(this.args.map(function(f){return f.serialize()}))};var Ti=function(e){this.type=Mr,this.sections=e};Ti.parse=function(e,r){if(e.length<2)return r.error("Expected at least one argument.");var a=e[1];if(!Array.isArray(a)&&typeof a=="object")return r.error("First argument must be an image or text section.");for(var h=[],f=!1,v=1;v<=e.length-1;++v){var y=e[v];if(f&&typeof y=="object"&&!Array.isArray(y)){f=!1;var S=null;if(y["font-scale"]&&!(S=r.parse(y["font-scale"],1,Fe)))return null;var C=null;if(y["text-font"]&&!(C=r.parse(y["text-font"],1,lr(rt))))return null;var O=null;if(y["text-color"]&&!(O=r.parse(y["text-color"],1,Je)))return null;var k=h[h.length-1];k.scale=S,k.font=C,k.textColor=O}else{var L=r.parse(e[v],1,tt);if(!L)return null;var U=L.type.kind;if(U!=="string"&&U!=="value"&&U!=="null"&&U!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,h.push({content:L,scale:null,font:null,textColor:null})}}return new Ti(h)},Ti.prototype.evaluate=function(e){return new on(this.sections.map(function(r){var a=r.content.evaluate(e);return Zr(a)===Jt?new no("",a,null,null,null):new no(Fa(a),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))},Ti.prototype.eachChild=function(e){for(var r=0,a=this.sections;r<a.length;r+=1){var h=a[r];e(h.content),h.scale&&e(h.scale),h.font&&e(h.font),h.textColor&&e(h.textColor)}},Ti.prototype.outputDefined=function(){return!1},Ti.prototype.serialize=function(){for(var e=["format"],r=0,a=this.sections;r<a.length;r+=1){var h=a[r];e.push(h.content.serialize());var f={};h.scale&&(f["font-scale"]=h.scale.serialize()),h.font&&(f["text-font"]=h.font.serialize()),h.textColor&&(f["text-color"]=h.textColor.serialize()),e.push(f)}return e};var ni=function(e){this.type=Jt,this.input=e};ni.parse=function(e,r){if(e.length!==2)return r.error("Expected two arguments.");var a=r.parse(e[1],1,rt);return a?new ni(a):r.error("No image name provided.")},ni.prototype.evaluate=function(e){var r=this.input.evaluate(e),a=Hr.fromString(r);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(r)>-1),a},ni.prototype.eachChild=function(e){e(this.input)},ni.prototype.outputDefined=function(){return!1},ni.prototype.serialize=function(){return["image",this.input.serialize()]};var ol={"to-boolean":Ye,"to-color":Je,"to-number":Fe,"to-string":rt},Ci=function(e,r){this.type=e,this.args=r};Ci.parse=function(e,r){if(e.length<2)return r.error("Expected at least one argument.");var a=e[0];if((a==="to-boolean"||a==="to-string")&&e.length!==2)return r.error("Expected one argument.");for(var h=ol[a],f=[],v=1;v<e.length;v++){var y=r.parse(e[v],v,tt);if(!y)return null;f.push(y)}return new Ci(h,f)},Ci.prototype.evaluate=function(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){for(var r,a,h=0,f=this.args;h<f.length;h+=1){if(a=null,(r=f[h].evaluate(e))instanceof Qt)return r;if(typeof r=="string"){var v=e.parseColor(r);if(v)return v}else if(Array.isArray(r)&&!(a=r.length<3||r.length>4?"Invalid rbga value "+JSON.stringify(r)+": expected an array containing either three or four numeric values.":io(r[0],r[1],r[2],r[3])))return new Qt(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new sn(a||"Could not parse color from value '"+(typeof r=="string"?r:String(JSON.stringify(r)))+"'")}if(this.type.kind==="number"){for(var y=null,S=0,C=this.args;S<C.length;S+=1){if((y=C[S].evaluate(e))===null)return 0;var O=Number(y);if(!isNaN(O))return O}throw new sn("Could not convert "+JSON.stringify(y)+" to number.")}return this.type.kind==="formatted"?on.fromString(Fa(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Hr.fromString(Fa(this.args[0].evaluate(e))):Fa(this.args[0].evaluate(e))},Ci.prototype.eachChild=function(e){this.args.forEach(e)},Ci.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ci.prototype.serialize=function(){if(this.type.kind==="formatted")return new Ti([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new ni(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(r){e.push(r.serialize())}),e};var Uc=["Unknown","Point","LineString","Polygon"],H=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};H.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},H.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Uc[this.feature.type]:this.feature.type:null},H.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},H.prototype.canonicalID=function(){return this.canonical},H.prototype.properties=function(){return this.feature&&this.feature.properties||{}},H.prototype.parseColor=function(e){var r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=Qt.parse(e)),r};var ne=function(e,r,a,h){this.name=e,this.type=r,this._evaluate=a,this.args=h};ne.prototype.evaluate=function(e){return this._evaluate(e,this.args)},ne.prototype.eachChild=function(e){this.args.forEach(e)},ne.prototype.outputDefined=function(){return!1},ne.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},ne.parse=function(e,r){var a,h=e[0],f=ne.definitions[h];if(!f)return r.error('Unknown expression "'+h+'". If you wanted a literal array, use ["literal", [...]].',0);for(var v=Array.isArray(f)?f[0]:f.type,y=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,S=y.filter(function(xt){var it=xt[0];return!Array.isArray(it)||it.length===e.length-1}),C=null,O=0,k=S;O<k.length;O+=1){var L=k[O],U=L[0],$=L[1];C=new lo(r.registry,r.path,null,r.scope);for(var oe=[],le=!1,_e=1;_e<e.length;_e++){var fe=e[_e],Te=Array.isArray(U)?U[_e-1]:U.type,Me=C.parse(fe,1+oe.length,Te);if(!Me){le=!0;break}oe.push(Me)}if(!le)if(Array.isArray(U)&&U.length!==oe.length)C.error("Expected "+U.length+" arguments, but found "+oe.length+" instead.");else{for(var Re=0;Re<oe.length;Re++){var Le=Array.isArray(U)?U[Re]:U.type,Ve=oe[Re];C.concat(Re+1).checkSubtype(Le,Ve.type)}if(C.errors.length===0)return new ne(h,v,$,oe)}}if(S.length===1)(a=r.errors).push.apply(a,C.errors);else{for(var Ze=(S.length?S:y).map(function(xt){var it;return it=xt[0],Array.isArray(it)?"("+it.map(Ft).join(", ")+")":"("+Ft(it.type)+"...)"}).join(" | "),Qe=[],vt=1;vt<e.length;vt++){var nt=r.parse(e[vt],1+Qe.length);if(!nt)return null;Qe.push(Ft(nt.type))}r.error("Expected arguments of type "+Ze+", but found ("+Qe.join(", ")+") instead.")}return null},ne.register=function(e,r){for(var a in ne.definitions=r,r)e[a]=ne};var be=function(e,r,a){this.type=tr,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=r};function Ae(e,r){e[0]=Math.min(e[0],r[0]),e[1]=Math.min(e[1],r[1]),e[2]=Math.max(e[2],r[0]),e[3]=Math.max(e[3],r[1])}function Ge(e,r){return!(e[0]<=r[0]||e[2]>=r[2]||e[1]<=r[1]||e[3]>=r[3])}function yt(e,r){var a=(180+e[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,r.z);return[Math.round(a*f*8192),Math.round(h*f*8192)]}function fr(e,r,a){return r[1]>e[1]!=a[1]>e[1]&&e[0]<(a[0]-r[0])*(e[1]-r[1])/(a[1]-r[1])+r[0]}function wn(e,r){for(var a,h,f,v,y,S,C,O=!1,k=0,L=r.length;k<L;k++)for(var U=r[k],$=0,oe=U.length;$<oe-1;$++){if((v=(a=e)[0]-(h=U[$])[0])*(C=a[1]-(f=U[$+1])[1])-(S=a[0]-f[0])*(y=a[1]-h[1])==0&&v*S<=0&&y*C<=0)return!1;fr(e,U[$],U[$+1])&&(O=!O)}return O}function Vn(e,r){for(var a=0;a<r.length;a++)if(wn(e,r[a]))return!0;return!1}function Jn(e,r,a,h){var f=h[0]-a[0],v=h[1]-a[1],y=(e[0]-a[0])*v-f*(e[1]-a[1]),S=(r[0]-a[0])*v-f*(r[1]-a[1]);return y>0&&S<0||y<0&&S>0}function na(e,r,a){for(var h=0,f=a;h<f.length;h+=1)for(var v=f[h],y=0;y<v.length-1;++y)if((L=[(k=v[y+1])[0]-(O=v[y])[0],k[1]-O[1]])[0]*(U=[(C=r)[0]-(S=e)[0],C[1]-S[1]])[1]-L[1]*U[0]!=0&&Jn(S,C,O,k)&&Jn(O,k,S,C))return!0;var S,C,O,k,L,U;return!1}function Nh(e,r){for(var a=0;a<e.length;++a)if(!wn(e[a],r))return!1;for(var h=0;h<e.length-1;++h)if(na(e[h],e[h+1],r))return!1;return!0}function Bh(e,r){for(var a=0;a<r.length;a++)if(Nh(e,r[a]))return!0;return!1}function Ss(e,r,a){for(var h=[],f=0;f<e.length;f++){for(var v=[],y=0;y<e[f].length;y++){var S=yt(e[f][y],a);Ae(r,S),v.push(S)}h.push(v)}return h}function Vc(e,r,a){for(var h=[],f=0;f<e.length;f++){var v=Ss(e[f],r,a);h.push(v)}return h}function sl(e,r,a,h){if(e[0]<a[0]||e[0]>a[2]){var f=.5*h,v=e[0]-a[0]>f?-h:a[0]-e[0]>f?h:0;v===0&&(v=e[0]-a[2]>f?-h:a[2]-e[0]>f?h:0),e[0]+=v}Ae(r,e)}function Fh(e,r,a,h){for(var f=8192*Math.pow(2,h.z),v=[8192*h.x,8192*h.y],y=[],S=0,C=e;S<C.length;S+=1)for(var O=0,k=C[S];O<k.length;O+=1){var L=k[O],U=[L.x+v[0],L.y+v[1]];sl(U,r,a,f),y.push(U)}return y}function gu(e,r,a,h){for(var f,v=8192*Math.pow(2,h.z),y=[8192*h.x,8192*h.y],S=[],C=0,O=e;C<O.length;C+=1){for(var k=[],L=0,U=O[C];L<U.length;L+=1){var $=U[L],oe=[$.x+y[0],$.y+y[1]];Ae(r,oe),k.push(oe)}S.push(k)}if(r[2]-r[0]<=v/2){(f=r)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var le=0,_e=S;le<_e.length;le+=1)for(var fe=0,Te=_e[le];fe<Te.length;fe+=1)sl(Te[fe],r,a,v)}return S}be.parse=function(e,r){if(e.length!==2)return r.error("Expected one argument.");var a=e[1];if(typeof a!="object"||Array.isArray(a))return r.error("Collator options argument must be an object.");var h=r.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,Ye);if(!h)return null;var f=r.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,Ye);if(!f)return null;var v=null;return a.locale&&!(v=r.parse(a.locale,1,rt))?null:new be(h,f,v)},be.prototype.evaluate=function(e){return new Yn(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},be.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},be.prototype.outputDefined=function(){return!1},be.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var ia=function(e,r){this.type=Ye,this.geojson=e,this.geometries=r};function ao(e){if(e instanceof ne&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof ia)return!1;var r=!0;return e.eachChild(function(a){r&&!ao(a)&&(r=!1)}),r}function oo(e){if(e instanceof ne&&e.name==="feature-state")return!1;var r=!0;return e.eachChild(function(a){r&&!oo(a)&&(r=!1)}),r}function Bo(e,r){if(e instanceof ne&&r.indexOf(e.name)>=0)return!1;var a=!0;return e.eachChild(function(h){a&&!Bo(h,r)&&(a=!1)}),a}ia.parse=function(e,r){if(e.length!==2)return r.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Ba(e[1])){var a=e[1];if(a.type==="FeatureCollection")for(var h=0;h<a.features.length;++h){var f=a.features[h].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new ia(a,a.features[h].geometry)}else if(a.type==="Feature"){var v=a.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new ia(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new ia(a,a)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ia.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,a){var h=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],v=r.canonicalID();if(a.type==="Polygon"){var y=Ss(a.coordinates,f,v),S=Fh(r.geometry(),h,f,v);if(!Ge(h,f))return!1;for(var C=0,O=S;C<O.length;C+=1)if(!wn(O[C],y))return!1}if(a.type==="MultiPolygon"){var k=Vc(a.coordinates,f,v),L=Fh(r.geometry(),h,f,v);if(!Ge(h,f))return!1;for(var U=0,$=L;U<$.length;U+=1)if(!Vn($[U],k))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,a){var h=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],v=r.canonicalID();if(a.type==="Polygon"){var y=Ss(a.coordinates,f,v),S=gu(r.geometry(),h,f,v);if(!Ge(h,f))return!1;for(var C=0,O=S;C<O.length;C+=1)if(!Nh(O[C],y))return!1}if(a.type==="MultiPolygon"){var k=Vc(a.coordinates,f,v),L=gu(r.geometry(),h,f,v);if(!Ge(h,f))return!1;for(var U=0,$=L;U<$.length;U+=1)if(!Bh($[U],k))return!1}return!0}(e,this.geometries)}return!1},ia.prototype.eachChild=function(){},ia.prototype.outputDefined=function(){return!0},ia.prototype.serialize=function(){return["within",this.geojson]};var so=function(e,r){this.type=r.type,this.name=e,this.boundExpression=r};so.parse=function(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");var a=e[1];return r.scope.has(a)?new so(a,r.scope.get(a)):r.error('Unknown variable "'+a+'". Make sure "'+a+'" has been bound in an enclosing "let" expression before using it.',1)},so.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},so.prototype.eachChild=function(){},so.prototype.outputDefined=function(){return!1},so.prototype.serialize=function(){return["var",this.name]};var lo=function(e,r,a,h,f){r===void 0&&(r=[]),h===void 0&&(h=new ct),f===void 0&&(f=[]),this.registry=e,this.path=r,this.key=r.map(function(v){return"["+v+"]"}).join(""),this.scope=h,this.errors=f,this.expectedType=a};function yu(e,r){for(var a,h=e.length-1,f=0,v=h,y=0;f<=v;)if((a=e[y=Math.floor((f+v)/2)])<=r){if(y===h||r<e[y+1])return y;f=y+1}else{if(!(a>r))throw new sn("Input is not a number.");v=y-1}return 0}lo.prototype.parse=function(e,r,a,h,f){return f===void 0&&(f={}),r?this.concat(r,a,h)._parse(e,f):this._parse(e,f)},lo.prototype._parse=function(e,r){function a(O,k,L){return L==="assert"?new Fr(k,[O]):L==="coerce"?new Ci(k,[O]):O}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var h=e[0];if(typeof h!="string")return this.error("Expression name must be a string, but found "+typeof h+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[h];if(f){var v=f.parse(e,this);if(!v)return null;if(this.expectedType){var y=this.expectedType,S=v.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||S.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string"){if(this.checkSubtype(y,S))return null}else v=a(v,y,r.typeAnnotation||"coerce");else v=a(v,y,r.typeAnnotation||"assert")}if(!(v instanceof Dn)&&v.type.kind!=="resolvedImage"&&function O(k){if(k instanceof so)return O(k.boundExpression);if(k instanceof ne&&k.name==="error"||k instanceof be||k instanceof ia)return!1;var L=k instanceof Ci||k instanceof Fr,U=!0;return k.eachChild(function($){U=L?U&&O($):U&&$ instanceof Dn}),!!U&&ao(k)&&Bo(k,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(v)){var C=new H;try{v=new Dn(v.type,v.evaluate(C))}catch(O){return this.error(O.message),null}}return v}return this.error('Unknown expression "'+h+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},lo.prototype.concat=function(e,r,a){var h=typeof e=="number"?this.path.concat(e):this.path,f=a?this.scope.concat(a):this.scope;return new lo(this.registry,h,r||null,f,this.errors)},lo.prototype.error=function(e){for(var r=[],a=arguments.length-1;a-- >0;)r[a]=arguments[a+1];var h=""+this.key+r.map(function(f){return"["+f+"]"}).join("");this.errors.push(new We(h,e))},lo.prototype.checkSubtype=function(e,r){var a=ar(e,r);return a&&this.error(a),a};var Ii=function(e,r,a){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(var h=0,f=a;h<f.length;h+=1){var v=f[h],y=v[1];this.labels.push(v[0]),this.outputs.push(y)}};function Sn(e,r,a){return e*(1-a)+r*a}Ii.parse=function(e,r){if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");var a=r.parse(e[1],1,Fe);if(!a)return null;var h=[],f=null;r.expectedType&&r.expectedType.kind!=="value"&&(f=r.expectedType);for(var v=1;v<e.length;v+=2){var y=v===1?-1/0:e[v],S=e[v+1],C=v,O=v+1;if(typeof y!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(h.length&&h[h.length-1][0]>=y)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);var k=r.parse(S,O,f);if(!k)return null;f=f||k.type,h.push([y,k])}return new Ii(f,a,h)},Ii.prototype.evaluate=function(e){var r=this.labels,a=this.outputs;if(r.length===1)return a[0].evaluate(e);var h=this.input.evaluate(e);if(h<=r[0])return a[0].evaluate(e);var f=r.length;return h>=r[f-1]?a[f-1].evaluate(e):a[yu(r,h)].evaluate(e)},Ii.prototype.eachChild=function(e){e(this.input);for(var r=0,a=this.outputs;r<a.length;r+=1)e(a[r])},Ii.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Ii.prototype.serialize=function(){for(var e=["step",this.input.serialize()],r=0;r<this.labels.length;r++)r>0&&e.push(this.labels[r]),e.push(this.outputs[r].serialize());return e};var Es=Object.freeze({__proto__:null,number:Sn,color:function(e,r,a){return new Qt(Sn(e.r,r.r,a),Sn(e.g,r.g,a),Sn(e.b,r.b,a),Sn(e.a,r.a,a))},array:function(e,r,a){return e.map(function(h,f){return Sn(h,r[f],a)})}}),Uh=6/29*3*(6/29),wm=Math.PI/180,Sm=180/Math.PI;function qc(e){return e>.008856451679035631?Math.pow(e,1/3):e/Uh+4/29}function $c(e){return e>6/29?e*e*e:Uh*(e-4/29)}function Wc(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Hc(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Vh(e){var r=Hc(e.r),a=Hc(e.g),h=Hc(e.b),f=qc((.4124564*r+.3575761*a+.1804375*h)/.95047),v=qc((.2126729*r+.7151522*a+.072175*h)/1);return{l:116*v-16,a:500*(f-v),b:200*(v-qc((.0193339*r+.119192*a+.9503041*h)/1.08883)),alpha:e.a}}function qh(e){var r=(e.l+16)/116,a=isNaN(e.a)?r:r+e.a/500,h=isNaN(e.b)?r:r-e.b/200;return r=1*$c(r),a=.95047*$c(a),h=1.08883*$c(h),new Qt(Wc(3.2404542*a-1.5371385*r-.4985314*h),Wc(-.969266*a+1.8760108*r+.041556*h),Wc(.0556434*a-.2040259*r+1.0572252*h),e.alpha)}function Em(e,r,a){var h=r-e;return e+a*(h>180||h<-180?h-360*Math.round(h/360):h)}var ll={forward:Vh,reverse:qh,interpolate:function(e,r,a){return{l:Sn(e.l,r.l,a),a:Sn(e.a,r.a,a),b:Sn(e.b,r.b,a),alpha:Sn(e.alpha,r.alpha,a)}}},ul={forward:function(e){var r=Vh(e),a=r.l,h=r.a,f=r.b,v=Math.atan2(f,h)*Sm;return{h:v<0?v+360:v,c:Math.sqrt(h*h+f*f),l:a,alpha:e.a}},reverse:function(e){var r=e.h*wm,a=e.c;return qh({l:e.l,a:Math.cos(r)*a,b:Math.sin(r)*a,alpha:e.alpha})},interpolate:function(e,r,a){return{h:Em(e.h,r.h,a),c:Sn(e.c,r.c,a),l:Sn(e.l,r.l,a),alpha:Sn(e.alpha,r.alpha,a)}}},$h=Object.freeze({__proto__:null,lab:ll,hcl:ul}),Qn=function(e,r,a,h,f){this.type=e,this.operator=r,this.interpolation=a,this.input=h,this.labels=[],this.outputs=[];for(var v=0,y=f;v<y.length;v+=1){var S=y[v],C=S[1];this.labels.push(S[0]),this.outputs.push(C)}};function Zc(e,r,a,h){var f=h-a,v=e-a;return f===0?0:r===1?v/f:(Math.pow(r,v)-1)/(Math.pow(r,f)-1)}Qn.interpolationFactor=function(e,r,a,h){var f=0;if(e.name==="exponential")f=Zc(r,e.base,a,h);else if(e.name==="linear")f=Zc(r,1,a,h);else if(e.name==="cubic-bezier"){var v=e.controlPoints;f=new b(v[0],v[1],v[2],v[3]).solve(Zc(r,1,a,h))}return f},Qn.parse=function(e,r){var a=e[0],h=e[1],f=e[2],v=e.slice(3);if(!Array.isArray(h)||h.length===0)return r.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){var y=h[1];if(typeof y!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:y}}else{if(h[0]!=="cubic-bezier")return r.error("Unknown interpolation type "+String(h[0]),1,0);var S=h.slice(1);if(S.length!==4||S.some(function(_e){return typeof _e!="number"||_e<0||_e>1}))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:S}}if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(!(f=r.parse(f,2,Fe)))return null;var C=[],O=null;a==="interpolate-hcl"||a==="interpolate-lab"?O=Je:r.expectedType&&r.expectedType.kind!=="value"&&(O=r.expectedType);for(var k=0;k<v.length;k+=2){var L=v[k],U=v[k+1],$=k+3,oe=k+4;if(typeof L!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(C.length&&C[C.length-1][0]>=L)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);var le=r.parse(U,oe,O);if(!le)return null;O=O||le.type,C.push([L,le])}return O.kind==="number"||O.kind==="color"||O.kind==="array"&&O.itemType.kind==="number"&&typeof O.N=="number"?new Qn(O,a,h,f,C):r.error("Type "+Ft(O)+" is not interpolatable.")},Qn.prototype.evaluate=function(e){var r=this.labels,a=this.outputs;if(r.length===1)return a[0].evaluate(e);var h=this.input.evaluate(e);if(h<=r[0])return a[0].evaluate(e);var f=r.length;if(h>=r[f-1])return a[f-1].evaluate(e);var v=yu(r,h),y=Qn.interpolationFactor(this.interpolation,h,r[v],r[v+1]),S=a[v].evaluate(e),C=a[v+1].evaluate(e);return this.operator==="interpolate"?Es[this.type.kind.toLowerCase()](S,C,y):this.operator==="interpolate-hcl"?ul.reverse(ul.interpolate(ul.forward(S),ul.forward(C),y)):ll.reverse(ll.interpolate(ll.forward(S),ll.forward(C),y))},Qn.prototype.eachChild=function(e){e(this.input);for(var r=0,a=this.outputs;r<a.length;r+=1)e(a[r])},Qn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Qn.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var r=[this.operator,e,this.input.serialize()],a=0;a<this.labels.length;a++)r.push(this.labels[a],this.outputs[a].serialize());return r};var uo=function(e,r){this.type=e,this.args=r};uo.parse=function(e,r){if(e.length<2)return r.error("Expectected at least one argument.");var a=null,h=r.expectedType;h&&h.kind!=="value"&&(a=h);for(var f=[],v=0,y=e.slice(1);v<y.length;v+=1){var S=r.parse(y[v],1+f.length,a,void 0,{typeAnnotation:"omit"});if(!S)return null;a=a||S.type,f.push(S)}var C=h&&f.some(function(O){return ar(h,O.type)});return new uo(C?tt:a,f)},uo.prototype.evaluate=function(e){for(var r,a=null,h=0,f=0,v=this.args;f<v.length&&(h++,(a=v[f].evaluate(e))&&a instanceof Hr&&!a.available&&(r||(r=a.name),a=null,h===this.args.length&&(a=r)),a===null);f+=1);return a},uo.prototype.eachChild=function(e){this.args.forEach(e)},uo.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},uo.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(r){e.push(r.serialize())}),e};var co=function(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r};co.prototype.evaluate=function(e){return this.result.evaluate(e)},co.prototype.eachChild=function(e){for(var r=0,a=this.bindings;r<a.length;r+=1)e(a[r][1]);e(this.result)},co.parse=function(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var a=[],h=1;h<e.length-1;h+=2){var f=e[h];if(typeof f!="string")return r.error("Expected string, but found "+typeof f+" instead.",h);if(/[^a-zA-Z0-9_]/.test(f))return r.error("Variable names must contain only alphanumeric characters or '_'.",h);var v=r.parse(e[h+1],h+1);if(!v)return null;a.push([f,v])}var y=r.parse(e[e.length-1],e.length-1,r.expectedType,a);return y?new co(a,y):null},co.prototype.outputDefined=function(){return this.result.outputDefined()},co.prototype.serialize=function(){for(var e=["let"],r=0,a=this.bindings;r<a.length;r+=1){var h=a[r];e.push(h[0],h[1].serialize())}return e.push(this.result.serialize()),e};var Fo=function(e,r,a){this.type=e,this.index=r,this.input=a};Fo.parse=function(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var a=r.parse(e[1],1,Fe),h=r.parse(e[2],2,lr(r.expectedType||tt));return a&&h?new Fo(h.type.itemType,a,h):null},Fo.prototype.evaluate=function(e){var r=this.index.evaluate(e),a=this.input.evaluate(e);if(r<0)throw new sn("Array index out of bounds: "+r+" < 0.");if(r>=a.length)throw new sn("Array index out of bounds: "+r+" > "+(a.length-1)+".");if(r!==Math.floor(r))throw new sn("Array index must be an integer, but found "+r+" instead.");return a[r]},Fo.prototype.eachChild=function(e){e(this.index),e(this.input)},Fo.prototype.outputDefined=function(){return!1},Fo.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Uo=function(e,r){this.type=Ye,this.needle=e,this.haystack=r};Uo.parse=function(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var a=r.parse(e[1],1,tt),h=r.parse(e[2],2,tt);return a&&h?Or(a.type,[Ye,rt,Fe,ot,tt])?new Uo(a,h):r.error("Expected first argument to be of type boolean, string, number or null, but found "+Ft(a.type)+" instead"):null},Uo.prototype.evaluate=function(e){var r=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!a)return!1;if(!gr(r,["boolean","string","number","null"]))throw new sn("Expected first argument to be of type boolean, string, number or null, but found "+Ft(Zr(r))+" instead.");if(!gr(a,["string","array"]))throw new sn("Expected second argument to be of type array or string, but found "+Ft(Zr(a))+" instead.");return a.indexOf(r)>=0},Uo.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},Uo.prototype.outputDefined=function(){return!0},Uo.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var po=function(e,r,a){this.type=Fe,this.needle=e,this.haystack=r,this.fromIndex=a};po.parse=function(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var a=r.parse(e[1],1,tt),h=r.parse(e[2],2,tt);if(!a||!h)return null;if(!Or(a.type,[Ye,rt,Fe,ot,tt]))return r.error("Expected first argument to be of type boolean, string, number or null, but found "+Ft(a.type)+" instead");if(e.length===4){var f=r.parse(e[3],3,Fe);return f?new po(a,h,f):null}return new po(a,h)},po.prototype.evaluate=function(e){var r=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!gr(r,["boolean","string","number","null"]))throw new sn("Expected first argument to be of type boolean, string, number or null, but found "+Ft(Zr(r))+" instead.");if(!gr(a,["string","array"]))throw new sn("Expected second argument to be of type array or string, but found "+Ft(Zr(a))+" instead.");if(this.fromIndex){var h=this.fromIndex.evaluate(e);return a.indexOf(r,h)}return a.indexOf(r)},po.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},po.prototype.outputDefined=function(){return!1},po.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Vo=function(e,r,a,h,f,v){this.inputType=e,this.type=r,this.input=a,this.cases=h,this.outputs=f,this.otherwise=v};Vo.parse=function(e,r){if(e.length<5)return r.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return r.error("Expected an even number of arguments.");var a,h;r.expectedType&&r.expectedType.kind!=="value"&&(h=r.expectedType);for(var f={},v=[],y=2;y<e.length-1;y+=2){var S=e[y],C=e[y+1];Array.isArray(S)||(S=[S]);var O=r.concat(y);if(S.length===0)return O.error("Expected at least one branch label.");for(var k=0,L=S;k<L.length;k+=1){var U=L[k];if(typeof U!="number"&&typeof U!="string")return O.error("Branch labels must be numbers or strings.");if(typeof U=="number"&&Math.abs(U)>Number.MAX_SAFE_INTEGER)return O.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof U=="number"&&Math.floor(U)!==U)return O.error("Numeric branch labels must be integer values.");if(a){if(O.checkSubtype(a,Zr(U)))return null}else a=Zr(U);if(f[String(U)]!==void 0)return O.error("Branch labels must be unique.");f[String(U)]=v.length}var $=r.parse(C,y,h);if(!$)return null;h=h||$.type,v.push($)}var oe=r.parse(e[1],1,tt);if(!oe)return null;var le=r.parse(e[e.length-1],e.length-1,h);return le?oe.type.kind!=="value"&&r.concat(1).checkSubtype(a,oe.type)?null:new Vo(a,h,oe,f,v,le):null},Vo.prototype.evaluate=function(e){var r=this.input.evaluate(e);return(Zr(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)},Vo.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Vo.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},Vo.prototype.serialize=function(){for(var e=this,r=["match",this.input.serialize()],a=[],h={},f=0,v=Object.keys(this.cases).sort();f<v.length;f+=1){var y=v[f];(L=h[this.cases[y]])===void 0?(h[this.cases[y]]=a.length,a.push([this.cases[y],[y]])):a[L][1].push(y)}for(var S=function($){return e.inputType.kind==="number"?Number($):$},C=0,O=a;C<O.length;C+=1){var k=O[C],L=k[0],U=k[1];r.push(U.length===1?S(U[0]):U.map(S)),r.push(this.outputs[outputIndex$1].serialize())}return r.push(this.otherwise.serialize()),r};var qo=function(e,r,a){this.type=e,this.branches=r,this.otherwise=a};qo.parse=function(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return r.error("Expected an odd number of arguments.");var a;r.expectedType&&r.expectedType.kind!=="value"&&(a=r.expectedType);for(var h=[],f=1;f<e.length-1;f+=2){var v=r.parse(e[f],f,Ye);if(!v)return null;var y=r.parse(e[f+1],f+1,a);if(!y)return null;h.push([v,y]),a=a||y.type}var S=r.parse(e[e.length-1],e.length-1,a);return S?new qo(a,h,S):null},qo.prototype.evaluate=function(e){for(var r=0,a=this.branches;r<a.length;r+=1){var h=a[r],f=h[1];if(h[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},qo.prototype.eachChild=function(e){for(var r=0,a=this.branches;r<a.length;r+=1){var h=a[r],f=h[1];e(h[0]),e(f)}e(this.otherwise)},qo.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},qo.prototype.serialize=function(){var e=["case"];return this.eachChild(function(r){e.push(r.serialize())}),e};var ho=function(e,r,a,h){this.type=e,this.input=r,this.beginIndex=a,this.endIndex=h};function Wh(e,r){return e==="=="||e==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function Hh(e,r,a,h){return h.compare(r,a)===0}function Dr(e,r,a){var h=e!=="=="&&e!=="!=";return function(){function f(v,y,S){this.type=Ye,this.lhs=v,this.rhs=y,this.collator=S,this.hasUntypedArgument=v.type.kind==="value"||y.type.kind==="value"}return f.parse=function(v,y){if(v.length!==3&&v.length!==4)return y.error("Expected two or three arguments.");var S=v[0],C=y.parse(v[1],1,tt);if(!C)return null;if(!Wh(S,C.type))return y.concat(1).error('"'+S+`" comparisons are not supported for type '`+Ft(C.type)+"'.");var O=y.parse(v[2],2,tt);if(!O)return null;if(!Wh(S,O.type))return y.concat(2).error('"'+S+`" comparisons are not supported for type '`+Ft(O.type)+"'.");if(C.type.kind!==O.type.kind&&C.type.kind!=="value"&&O.type.kind!=="value")return y.error("Cannot compare types '"+Ft(C.type)+"' and '"+Ft(O.type)+"'.");h&&(C.type.kind==="value"&&O.type.kind!=="value"?C=new Fr(O.type,[C]):C.type.kind!=="value"&&O.type.kind==="value"&&(O=new Fr(C.type,[O])));var k=null;if(v.length===4){if(C.type.kind!=="string"&&O.type.kind!=="string"&&C.type.kind!=="value"&&O.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(!(k=y.parse(v[3],3,tr)))return null}return new f(C,O,k)},f.prototype.evaluate=function(v){var y=this.lhs.evaluate(v),S=this.rhs.evaluate(v);if(h&&this.hasUntypedArgument){var C=Zr(y),O=Zr(S);if(C.kind!==O.kind||C.kind!=="string"&&C.kind!=="number")throw new sn('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+C.kind+", "+O.kind+") instead.")}if(this.collator&&!h&&this.hasUntypedArgument){var k=Zr(y),L=Zr(S);if(k.kind!=="string"||L.kind!=="string")return r(v,y,S)}return this.collator?a(v,y,S,this.collator.evaluate(v)):r(v,y,S)},f.prototype.eachChild=function(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var v=[e];return this.eachChild(function(y){v.push(y.serialize())}),v},f}()}ho.parse=function(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var a=r.parse(e[1],1,tt),h=r.parse(e[2],2,Fe);if(!a||!h)return null;if(!Or(a.type,[lr(tt),rt,tt]))return r.error("Expected first argument to be of type array or string, but found "+Ft(a.type)+" instead");if(e.length===4){var f=r.parse(e[3],3,Fe);return f?new ho(a.type,a,h,f):null}return new ho(a.type,a,h)},ho.prototype.evaluate=function(e){var r=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!gr(r,["string","array"]))throw new sn("Expected first argument to be of type array or string, but found "+Ft(Zr(r))+" instead.");if(this.endIndex){var h=this.endIndex.evaluate(e);return r.slice(a,h)}return r.slice(a)},ho.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},ho.prototype.outputDefined=function(){return!1},ho.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Pm=Dr("==",function(e,r,a){return r===a},Hh),_u=Dr("!=",function(e,r,a){return r!==a},function(e,r,a,h){return!Hh(0,r,a,h)}),Zh=Dr("<",function(e,r,a){return r<a},function(e,r,a,h){return h.compare(r,a)<0}),Gh=Dr(">",function(e,r,a){return r>a},function(e,r,a,h){return h.compare(r,a)>0}),Xh=Dr("<=",function(e,r,a){return r<=a},function(e,r,a,h){return h.compare(r,a)<=0}),Kh=Dr(">=",function(e,r,a){return r>=a},function(e,r,a,h){return h.compare(r,a)>=0}),$o=function(e,r,a,h,f){this.type=rt,this.number=e,this.locale=r,this.currency=a,this.minFractionDigits=h,this.maxFractionDigits=f};$o.parse=function(e,r){if(e.length!==3)return r.error("Expected two arguments.");var a=r.parse(e[1],1,Fe);if(!a)return null;var h=e[2];if(typeof h!="object"||Array.isArray(h))return r.error("NumberFormat options argument must be an object.");var f=null;if(h.locale&&!(f=r.parse(h.locale,1,rt)))return null;var v=null;if(h.currency&&!(v=r.parse(h.currency,1,rt)))return null;var y=null;if(h["min-fraction-digits"]&&!(y=r.parse(h["min-fraction-digits"],1,Fe)))return null;var S=null;return h["max-fraction-digits"]&&!(S=r.parse(h["max-fraction-digits"],1,Fe))?null:new $o(a,f,v,y,S)},$o.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},$o.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},$o.prototype.outputDefined=function(){return!1},$o.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var fo=function(e){this.type=Fe,this.input=e};fo.parse=function(e,r){if(e.length!==2)return r.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var a=r.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?r.error("Expected argument of type string or array, but found "+Ft(a.type)+" instead."):new fo(a):null},fo.prototype.evaluate=function(e){var r=this.input.evaluate(e);if(typeof r=="string"||Array.isArray(r))return r.length;throw new sn("Expected value to be of type string or array, but found "+Ft(Zr(r))+" instead.")},fo.prototype.eachChild=function(e){e(this.input)},fo.prototype.outputDefined=function(){return!1},fo.prototype.serialize=function(){var e=["length"];return this.eachChild(function(r){e.push(r.serialize())}),e};var Wo={"==":Pm,"!=":_u,">":Gh,"<":Zh,">=":Kh,"<=":Xh,array:Fr,at:Fo,boolean:Fr,case:qo,coalesce:uo,collator:be,format:Ti,image:ni,in:Uo,"index-of":po,interpolate:Qn,"interpolate-hcl":Qn,"interpolate-lab":Qn,length:fo,let:co,literal:Dn,match:Vo,number:Fr,"number-format":$o,object:Fr,slice:ho,step:Ii,string:Fr,"to-boolean":Ci,"to-color":Ci,"to-number":Ci,"to-string":Ci,var:so,within:ia};function Yh(e,r){var a=r[0],h=r[1],f=r[2],v=r[3];a=a.evaluate(e),h=h.evaluate(e),f=f.evaluate(e);var y=v?v.evaluate(e):1,S=io(a,h,f,y);if(S)throw new sn(S);return new Qt(a/255*y,h/255*y,f/255*y,y)}function Jh(e,r){return e in r}function Gc(e,r){var a=r[e];return a===void 0?null:a}function Ho(e){return{type:e}}function Qh(e){return{result:"success",value:e}}function Zo(e){return{result:"error",value:e}}function Go(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function ed(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function cl(e){return!!e.expression&&e.expression.interpolated}function Ur(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function bu(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Tm(e){return e}function Ps(e,r,a){return e!==void 0?e:r!==void 0?r:a!==void 0?a:void 0}function td(e,r,a,h,f){return Ps(typeof a===f?h[a]:void 0,e.default,r.default)}function Cm(e,r,a){if(Ur(a)!=="number")return Ps(e.default,r.default);var h=e.stops.length;if(h===1||a<=e.stops[0][0])return e.stops[0][1];if(a>=e.stops[h-1][0])return e.stops[h-1][1];var f=yu(e.stops.map(function(v){return v[0]}),a);return e.stops[f][1]}function rd(e,r,a){var h=e.base!==void 0?e.base:1;if(Ur(a)!=="number")return Ps(e.default,r.default);var f=e.stops.length;if(f===1||a<=e.stops[0][0])return e.stops[0][1];if(a>=e.stops[f-1][0])return e.stops[f-1][1];var v=yu(e.stops.map(function(L){return L[0]}),a),y=function(L,U,$,oe){var le=oe-$,_e=L-$;return le===0?0:U===1?_e/le:(Math.pow(U,_e)-1)/(Math.pow(U,le)-1)}(a,h,e.stops[v][0],e.stops[v+1][0]),S=e.stops[v][1],C=e.stops[v+1][1],O=Es[r.type]||Tm;if(e.colorSpace&&e.colorSpace!=="rgb"){var k=$h[e.colorSpace];O=function(L,U){return k.reverse(k.interpolate(k.forward(L),k.forward(U),y))}}return typeof S.evaluate=="function"?{evaluate:function(){for(var L=[],U=arguments.length;U--;)L[U]=arguments[U];var $=S.evaluate.apply(void 0,L),oe=C.evaluate.apply(void 0,L);if($!==void 0&&oe!==void 0)return O($,oe,y)}}:O(S,C,y)}function xu(e,r,a){return r.type==="color"?a=Qt.parse(a):r.type==="formatted"?a=on.fromString(a.toString()):r.type==="resolvedImage"?a=Hr.fromString(a.toString()):Ur(a)===r.type||r.type==="enum"&&r.values[a]||(a=void 0),Ps(a,e.default,r.default)}ne.register(Wo,{error:[{kind:"error"},[rt],function(e,r){throw new sn(r[0].evaluate(e))}],typeof:[rt,[tt],function(e,r){return Ft(Zr(r[0].evaluate(e)))}],"to-rgba":[lr(Fe,4),[Je],function(e,r){return r[0].evaluate(e).toArray()}],rgb:[Je,[Fe,Fe,Fe],Yh],rgba:[Je,[Fe,Fe,Fe,Fe],Yh],has:{type:Ye,overloads:[[[rt],function(e,r){return Jh(r[0].evaluate(e),e.properties())}],[[rt,Bt],function(e,r){var a=r[1];return Jh(r[0].evaluate(e),a.evaluate(e))}]]},get:{type:tt,overloads:[[[rt],function(e,r){return Gc(r[0].evaluate(e),e.properties())}],[[rt,Bt],function(e,r){var a=r[1];return Gc(r[0].evaluate(e),a.evaluate(e))}]]},"feature-state":[tt,[rt],function(e,r){return Gc(r[0].evaluate(e),e.featureState||{})}],properties:[Bt,[],function(e){return e.properties()}],"geometry-type":[rt,[],function(e){return e.geometryType()}],id:[tt,[],function(e){return e.id()}],zoom:[Fe,[],function(e){return e.globals.zoom}],"heatmap-density":[Fe,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Fe,[],function(e){return e.globals.lineProgress||0}],accumulated:[tt,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[Fe,Ho(Fe),function(e,r){for(var a=0,h=0,f=r;h<f.length;h+=1)a+=f[h].evaluate(e);return a}],"*":[Fe,Ho(Fe),function(e,r){for(var a=1,h=0,f=r;h<f.length;h+=1)a*=f[h].evaluate(e);return a}],"-":{type:Fe,overloads:[[[Fe,Fe],function(e,r){var a=r[1];return r[0].evaluate(e)-a.evaluate(e)}],[[Fe],function(e,r){return-r[0].evaluate(e)}]]},"/":[Fe,[Fe,Fe],function(e,r){var a=r[1];return r[0].evaluate(e)/a.evaluate(e)}],"%":[Fe,[Fe,Fe],function(e,r){var a=r[1];return r[0].evaluate(e)%a.evaluate(e)}],ln2:[Fe,[],function(){return Math.LN2}],pi:[Fe,[],function(){return Math.PI}],e:[Fe,[],function(){return Math.E}],"^":[Fe,[Fe,Fe],function(e,r){var a=r[1];return Math.pow(r[0].evaluate(e),a.evaluate(e))}],sqrt:[Fe,[Fe],function(e,r){return Math.sqrt(r[0].evaluate(e))}],log10:[Fe,[Fe],function(e,r){return Math.log(r[0].evaluate(e))/Math.LN10}],ln:[Fe,[Fe],function(e,r){return Math.log(r[0].evaluate(e))}],log2:[Fe,[Fe],function(e,r){return Math.log(r[0].evaluate(e))/Math.LN2}],sin:[Fe,[Fe],function(e,r){return Math.sin(r[0].evaluate(e))}],cos:[Fe,[Fe],function(e,r){return Math.cos(r[0].evaluate(e))}],tan:[Fe,[Fe],function(e,r){return Math.tan(r[0].evaluate(e))}],asin:[Fe,[Fe],function(e,r){return Math.asin(r[0].evaluate(e))}],acos:[Fe,[Fe],function(e,r){return Math.acos(r[0].evaluate(e))}],atan:[Fe,[Fe],function(e,r){return Math.atan(r[0].evaluate(e))}],min:[Fe,Ho(Fe),function(e,r){return Math.min.apply(Math,r.map(function(a){return a.evaluate(e)}))}],max:[Fe,Ho(Fe),function(e,r){return Math.max.apply(Math,r.map(function(a){return a.evaluate(e)}))}],abs:[Fe,[Fe],function(e,r){return Math.abs(r[0].evaluate(e))}],round:[Fe,[Fe],function(e,r){var a=r[0].evaluate(e);return a<0?-Math.round(-a):Math.round(a)}],floor:[Fe,[Fe],function(e,r){return Math.floor(r[0].evaluate(e))}],ceil:[Fe,[Fe],function(e,r){return Math.ceil(r[0].evaluate(e))}],"filter-==":[Ye,[rt,tt],function(e,r){var a=r[0],h=r[1];return e.properties()[a.value]===h.value}],"filter-id-==":[Ye,[tt],function(e,r){var a=r[0];return e.id()===a.value}],"filter-type-==":[Ye,[rt],function(e,r){var a=r[0];return e.geometryType()===a.value}],"filter-<":[Ye,[rt,tt],function(e,r){var a=r[0],h=r[1],f=e.properties()[a.value],v=h.value;return typeof f==typeof v&&f<v}],"filter-id-<":[Ye,[tt],function(e,r){var a=r[0],h=e.id(),f=a.value;return typeof h==typeof f&&h<f}],"filter->":[Ye,[rt,tt],function(e,r){var a=r[0],h=r[1],f=e.properties()[a.value],v=h.value;return typeof f==typeof v&&f>v}],"filter-id->":[Ye,[tt],function(e,r){var a=r[0],h=e.id(),f=a.value;return typeof h==typeof f&&h>f}],"filter-<=":[Ye,[rt,tt],function(e,r){var a=r[0],h=r[1],f=e.properties()[a.value],v=h.value;return typeof f==typeof v&&f<=v}],"filter-id-<=":[Ye,[tt],function(e,r){var a=r[0],h=e.id(),f=a.value;return typeof h==typeof f&&h<=f}],"filter->=":[Ye,[rt,tt],function(e,r){var a=r[0],h=r[1],f=e.properties()[a.value],v=h.value;return typeof f==typeof v&&f>=v}],"filter-id->=":[Ye,[tt],function(e,r){var a=r[0],h=e.id(),f=a.value;return typeof h==typeof f&&h>=f}],"filter-has":[Ye,[tt],function(e,r){return r[0].value in e.properties()}],"filter-has-id":[Ye,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Ye,[lr(rt)],function(e,r){return r[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Ye,[lr(tt)],function(e,r){return r[0].value.indexOf(e.id())>=0}],"filter-in-small":[Ye,[rt,lr(tt)],function(e,r){var a=r[0];return r[1].value.indexOf(e.properties()[a.value])>=0}],"filter-in-large":[Ye,[rt,lr(tt)],function(e,r){var a=r[0],h=r[1];return function(f,v,y,S){for(;y<=S;){var C=y+S>>1;if(v[C]===f)return!0;v[C]>f?S=C-1:y=C+1}return!1}(e.properties()[a.value],h.value,0,h.value.length-1)}],all:{type:Ye,overloads:[[[Ye,Ye],function(e,r){var a=r[1];return r[0].evaluate(e)&&a.evaluate(e)}],[Ho(Ye),function(e,r){for(var a=0,h=r;a<h.length;a+=1)if(!h[a].evaluate(e))return!1;return!0}]]},any:{type:Ye,overloads:[[[Ye,Ye],function(e,r){var a=r[1];return r[0].evaluate(e)||a.evaluate(e)}],[Ho(Ye),function(e,r){for(var a=0,h=r;a<h.length;a+=1)if(h[a].evaluate(e))return!0;return!1}]]},"!":[Ye,[Ye],function(e,r){return!r[0].evaluate(e)}],"is-supported-script":[Ye,[rt],function(e,r){var a=e.globals&&e.globals.isSupportedScript;return!a||a(r[0].evaluate(e))}],upcase:[rt,[rt],function(e,r){return r[0].evaluate(e).toUpperCase()}],downcase:[rt,[rt],function(e,r){return r[0].evaluate(e).toLowerCase()}],concat:[rt,Ho(tt),function(e,r){return r.map(function(a){return Fa(a.evaluate(e))}).join("")}],"resolved-locale":[rt,[tr],function(e,r){return r[0].evaluate(e).resolvedLocale()}]});var Ts=function(e,r){this.expression=e,this._warningHistory={},this._evaluator=new H,this._defaultValue=r?function(a){return a.type==="color"&&bu(a.default)?new Qt(0,0,0,0):a.type==="color"?Qt.parse(a.default)||null:a.default===void 0?null:a.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null};function pl(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in Wo}function wu(e,r){var a=new lo(Wo,[],r?function(f){var v={color:Je,string:rt,number:Fe,enum:rt,boolean:Ye,formatted:Mr,resolvedImage:Jt};return f.type==="array"?lr(v[f.value]||tt,f.length):v[f.type]}(r):void 0),h=a.parse(e,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?Qh(new Ts(h,r)):Zo(a.errors)}Ts.prototype.evaluateWithoutErrorHandling=function(e,r,a,h,f,v){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=a,this._evaluator.canonical=h,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)},Ts.prototype.evaluate=function(e,r,a,h,f,v){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=a||null,this._evaluator.canonical=h,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=v||null;try{var y=this.expression.evaluate(this._evaluator);if(y==null||typeof y=="number"&&y!=y)return this._defaultValue;if(this._enumValues&&!(y in this._enumValues))throw new sn("Expected value to be one of "+Object.keys(this._enumValues).map(function(S){return JSON.stringify(S)}).join(", ")+", but found "+JSON.stringify(y)+" instead.");return y}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}};var hl=function(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!oo(r.expression)};hl.prototype.evaluateWithoutErrorHandling=function(e,r,a,h,f,v){return this._styleExpression.evaluateWithoutErrorHandling(e,r,a,h,f,v)},hl.prototype.evaluate=function(e,r,a,h,f,v){return this._styleExpression.evaluate(e,r,a,h,f,v)};var Cs=function(e,r,a,h){this.kind=e,this.zoomStops=a,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!oo(r.expression),this.interpolationType=h};function nd(e,r){if((e=wu(e,r)).result==="error")return e;var a=e.value.expression,h=ao(a);if(!h&&!Go(r))return Zo([new We("","data expressions not supported")]);var f=Bo(a,["zoom"]);if(!f&&!ed(r))return Zo([new We("","zoom expressions not supported")]);var v=function y(S){var C=null;if(S instanceof co)C=y(S.result);else if(S instanceof uo)for(var O=0,k=S.args;O<k.length&&!(C=y(k[O]));O+=1);else(S instanceof Ii||S instanceof Qn)&&S.input instanceof ne&&S.input.name==="zoom"&&(C=S);return C instanceof We||S.eachChild(function(L){var U=y(L);U instanceof We?C=U:!C&&U?C=new We("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):C&&U&&C!==U&&(C=new We("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),C}(a);return v||f?v instanceof We?Zo([v]):v instanceof Qn&&!cl(r)?Zo([new We("",'"interpolate" expressions cannot be used with this property')]):Qh(v?new Cs(h?"camera":"composite",e.value,v.labels,v instanceof Qn?v.interpolation:void 0):new hl(h?"constant":"source",e.value)):Zo([new We("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Cs.prototype.evaluateWithoutErrorHandling=function(e,r,a,h,f,v){return this._styleExpression.evaluateWithoutErrorHandling(e,r,a,h,f,v)},Cs.prototype.evaluate=function(e,r,a,h,f,v){return this._styleExpression.evaluate(e,r,a,h,f,v)},Cs.prototype.interpolationFactor=function(e,r,a){return this.interpolationType?Qn.interpolationFactor(this.interpolationType,e,r,a):0};var Is=function(e,r){this._parameters=e,this._specification=r,$e(this,function a(h,f){var v,y,S,C=f.type==="color",O=h.stops&&typeof h.stops[0][0]=="object",k=O||!(O||h.property!==void 0),L=h.type||(cl(f)?"exponential":"interval");if(C&&((h=$e({},h)).stops&&(h.stops=h.stops.map(function(nt){return[nt[0],Qt.parse(nt[1])]})),h.default=Qt.parse(h.default?h.default:f.default)),h.colorSpace&&h.colorSpace!=="rgb"&&!$h[h.colorSpace])throw new Error("Unknown color space: "+h.colorSpace);if(L==="exponential")v=rd;else if(L==="interval")v=Cm;else if(L==="categorical"){v=td,y=Object.create(null);for(var U=0,$=h.stops;U<$.length;U+=1){var oe=$[U];y[oe[0]]=oe[1]}S=typeof h.stops[0][0]}else{if(L!=="identity")throw new Error('Unknown function type "'+L+'"');v=xu}if(O){for(var le={},_e=[],fe=0;fe<h.stops.length;fe++){var Te=h.stops[fe],Me=Te[0].zoom;le[Me]===void 0&&(le[Me]={zoom:Me,type:h.type,property:h.property,default:h.default,stops:[]},_e.push(Me)),le[Me].stops.push([Te[0].value,Te[1]])}for(var Re=[],Le=0,Ve=_e;Le<Ve.length;Le+=1){var Ze=Ve[Le];Re.push([le[Ze].zoom,a(le[Ze],f)])}var Qe={name:"linear"};return{kind:"composite",interpolationType:Qe,interpolationFactor:Qn.interpolationFactor.bind(void 0,Qe),zoomStops:Re.map(function(nt){return nt[0]}),evaluate:function(nt,xt){var it=nt.zoom;return rd({stops:Re,base:h.base},f,it).evaluate(it,xt)}}}if(k){var vt=L==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:vt,interpolationFactor:Qn.interpolationFactor.bind(void 0,vt),zoomStops:h.stops.map(function(nt){return nt[0]}),evaluate:function(nt){return v(h,f,nt.zoom,y,S)}}}return{kind:"source",evaluate:function(nt,xt){var it=xt&&xt.properties?xt.properties[h.property]:void 0;return it===void 0?Ps(h.default,f.default):v(h,f,it,y,S)}}}(this._parameters,this._specification))};function fa(e){var r=e.key,a=e.value,h=e.valueSpec||{},f=e.objectElementValidators||{},v=e.style,y=e.styleSpec,S=[],C=Ur(a);if(C!=="object")return[new he(r,a,"object expected, "+C+" found")];for(var O in a){var k=O.split(".")[0],L=h[k]||h["*"],U=void 0;if(f[k])U=f[k];else if(h[k])U=ur;else if(f["*"])U=f["*"];else{if(!h["*"]){S.push(new he(r,a[O],'unknown property "'+O+'"'));continue}U=ur}S=S.concat(U({key:(r&&r+".")+O,value:a[O],valueSpec:L,style:v,styleSpec:y,object:a,objectKey:O},a))}for(var $ in h)f[$]||h[$].required&&h[$].default===void 0&&a[$]===void 0&&S.push(new he(r,a,'missing required property "'+$+'"'));return S}function id(e){var r=e.value,a=e.valueSpec,h=e.style,f=e.styleSpec,v=e.key,y=e.arrayElementValidator||ur;if(Ur(r)!=="array")return[new he(v,r,"array expected, "+Ur(r)+" found")];if(a.length&&r.length!==a.length)return[new he(v,r,"array length "+a.length+" expected, length "+r.length+" found")];if(a["min-length"]&&r.length<a["min-length"])return[new he(v,r,"array length at least "+a["min-length"]+" expected, length "+r.length+" found")];var S={type:a.value,values:a.values};f.$version<7&&(S.function=a.function),Ur(a.value)==="object"&&(S=a.value);for(var C=[],O=0;O<r.length;O++)C=C.concat(y({array:r,arrayIndex:O,value:r[O],valueSpec:S,style:h,styleSpec:f,key:v+"["+O+"]"}));return C}function ad(e){var r=e.key,a=e.value,h=e.valueSpec,f=Ur(a);return f==="number"&&a!=a&&(f="NaN"),f!=="number"?[new he(r,a,"number expected, "+f+" found")]:"minimum"in h&&a<h.minimum?[new he(r,a,a+" is less than the minimum value "+h.minimum)]:"maximum"in h&&a>h.maximum?[new he(r,a,a+" is greater than the maximum value "+h.maximum)]:[]}function od(e){var r,a,h,f=e.valueSpec,v=He(e.value.type),y={},S=v!=="categorical"&&e.value.property===void 0,C=!S,O=Ur(e.value.stops)==="array"&&Ur(e.value.stops[0])==="array"&&Ur(e.value.stops[0][0])==="object",k=fa({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function($){if(v==="identity")return[new he($.key,$.value,'identity function may not have a "stops" property')];var oe=[],le=$.value;return oe=oe.concat(id({key:$.key,value:le,valueSpec:$.valueSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:L})),Ur(le)==="array"&&le.length===0&&oe.push(new he($.key,le,"array must have at least one stop")),oe},default:function($){return ur({key:$.key,value:$.value,valueSpec:f,style:$.style,styleSpec:$.styleSpec})}}});return v==="identity"&&S&&k.push(new he(e.key,e.value,'missing required property "property"')),v==="identity"||e.value.stops||k.push(new he(e.key,e.value,'missing required property "stops"')),v==="exponential"&&e.valueSpec.expression&&!cl(e.valueSpec)&&k.push(new he(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(C&&!Go(e.valueSpec)?k.push(new he(e.key,e.value,"property functions not supported")):S&&!ed(e.valueSpec)&&k.push(new he(e.key,e.value,"zoom functions not supported"))),v!=="categorical"&&!O||e.value.property!==void 0||k.push(new he(e.key,e.value,'"property" property is required')),k;function L($){var oe=[],le=$.value,_e=$.key;if(Ur(le)!=="array")return[new he(_e,le,"array expected, "+Ur(le)+" found")];if(le.length!==2)return[new he(_e,le,"array length 2 expected, length "+le.length+" found")];if(O){if(Ur(le[0])!=="object")return[new he(_e,le,"object expected, "+Ur(le[0])+" found")];if(le[0].zoom===void 0)return[new he(_e,le,"object stop key must have zoom")];if(le[0].value===void 0)return[new he(_e,le,"object stop key must have value")];if(h&&h>He(le[0].zoom))return[new he(_e,le[0].zoom,"stop zoom values must appear in ascending order")];He(le[0].zoom)!==h&&(h=He(le[0].zoom),a=void 0,y={}),oe=oe.concat(fa({key:_e+"[0]",value:le[0],valueSpec:{zoom:{}},style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:ad,value:U}}))}else oe=oe.concat(U({key:_e+"[0]",value:le[0],valueSpec:{},style:$.style,styleSpec:$.styleSpec},le));return pl(Ne(le[1]))?oe.concat([new he(_e+"[1]",le[1],"expressions are not allowed in function stops.")]):oe.concat(ur({key:_e+"[1]",value:le[1],valueSpec:f,style:$.style,styleSpec:$.styleSpec}))}function U($,oe){var le=Ur($.value),_e=He($.value),fe=$.value!==null?$.value:oe;if(r){if(le!==r)return[new he($.key,fe,le+" stop domain type must match previous stop domain type "+r)]}else r=le;if(le!=="number"&&le!=="string"&&le!=="boolean")return[new he($.key,fe,"stop domain value must be a number, string, or boolean")];if(le!=="number"&&v!=="categorical"){var Te="number expected, "+le+" found";return Go(f)&&v===void 0&&(Te+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new he($.key,fe,Te)]}return v!=="categorical"||le!=="number"||isFinite(_e)&&Math.floor(_e)===_e?v!=="categorical"&&le==="number"&&a!==void 0&&_e<a?[new he($.key,fe,"stop domain values must appear in ascending order")]:(a=_e,v==="categorical"&&_e in y?[new he($.key,fe,"stop domain values must be unique")]:(y[_e]=!0,[])):[new he($.key,fe,"integer expected, found "+_e)]}}function Xo(e){var r=(e.expressionContext==="property"?nd:wu)(Ne(e.value),e.valueSpec);if(r.result==="error")return r.value.map(function(h){return new he(""+e.key+h.key,e.value,h.message)});var a=r.value.expression||r.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!a.outputDefined())return[new he(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!oo(a))return[new he(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!oo(a))return[new he(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!Bo(a,["zoom","feature-state"]))return[new he(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!ao(a))return[new he(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function dl(e){var r=e.key,a=e.value,h=e.valueSpec,f=[];return Array.isArray(h.values)?h.values.indexOf(He(a))===-1&&f.push(new he(r,a,"expected one of ["+h.values.join(", ")+"], "+JSON.stringify(a)+" found")):Object.keys(h.values).indexOf(He(a))===-1&&f.push(new he(r,a,"expected one of ["+Object.keys(h.values).join(", ")+"], "+JSON.stringify(a)+" found")),f}function Su(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var r=0,a=e.slice(1);r<a.length;r+=1){var h=a[r];if(!Su(h)&&typeof h!="boolean")return!1}return!0;default:return!0}}Is.deserialize=function(e){return new Is(e._parameters,e._specification)},Is.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Xc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Eu(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Su(e)||(e=Pu(e));var r=wu(e,Xc);if(r.result==="error")throw new Error(r.value.map(function(a){return a.key+": "+a.message}).join(", "));return{filter:function(a,h,f){return r.value.evaluate(a,h,{},f)},needGeometry:function a(h){if(!Array.isArray(h))return!1;if(h[0]==="within")return!0;for(var f=1;f<h.length;f++)if(a(h[f]))return!0;return!1}(e)}}function Im(e,r){return e<r?-1:e>r?1:0}function Pu(e){if(!e)return!0;var r,a=e[0];return e.length<=1?a!=="any":a==="=="?Kc(e[1],e[2],"=="):a==="!="?Tu(Kc(e[1],e[2],"==")):a==="<"||a===">"||a==="<="||a===">="?Kc(e[1],e[2],a):a==="any"?(r=e.slice(1),["any"].concat(r.map(Pu))):a==="all"?["all"].concat(e.slice(1).map(Pu)):a==="none"?["all"].concat(e.slice(1).map(Pu).map(Tu)):a==="in"?sd(e[1],e.slice(2)):a==="!in"?Tu(sd(e[1],e.slice(2))):a==="has"?ld(e[1]):a==="!has"?Tu(ld(e[1])):a!=="within"||e}function Kc(e,r,a){switch(e){case"$type":return["filter-type-"+a,r];case"$id":return["filter-id-"+a,r];default:return["filter-"+a,e,r]}}function sd(e,r){if(r.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(function(a){return typeof a!=typeof r[0]})?["filter-in-large",e,["literal",r.sort(Im)]]:["filter-in-small",e,["literal",r]]}}function ld(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Tu(e){return["!",e]}function Yc(e){return Su(Ne(e.value))?Xo($e({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function r(a){var h=a.value,f=a.key;if(Ur(h)!=="array")return[new he(f,h,"array expected, "+Ur(h)+" found")];var v,y=a.styleSpec,S=[];if(h.length<1)return[new he(f,h,"filter array must have at least 1 element")];switch(S=S.concat(dl({key:f+"[0]",value:h[0],valueSpec:y.filter_operator,style:a.style,styleSpec:a.styleSpec})),He(h[0])){case"<":case"<=":case">":case">=":h.length>=2&&He(h[1])==="$type"&&S.push(new he(f,h,'"$type" cannot be use with operator "'+h[0]+'"'));case"==":case"!=":h.length!==3&&S.push(new he(f,h,'filter array for operator "'+h[0]+'" must have 3 elements'));case"in":case"!in":h.length>=2&&(v=Ur(h[1]))!=="string"&&S.push(new he(f+"[1]",h[1],"string expected, "+v+" found"));for(var C=2;C<h.length;C++)v=Ur(h[C]),He(h[1])==="$type"?S=S.concat(dl({key:f+"["+C+"]",value:h[C],valueSpec:y.geometry_type,style:a.style,styleSpec:a.styleSpec})):v!=="string"&&v!=="number"&&v!=="boolean"&&S.push(new he(f+"["+C+"]",h[C],"string, number, or boolean expected, "+v+" found"));break;case"any":case"all":case"none":for(var O=1;O<h.length;O++)S=S.concat(r({key:f+"["+O+"]",value:h[O],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":v=Ur(h[1]),h.length!==2?S.push(new he(f,h,'filter array for "'+h[0]+'" operator must have 2 elements')):v!=="string"&&S.push(new he(f+"[1]",h[1],"string expected, "+v+" found"));break;case"within":v=Ur(h[1]),h.length!==2?S.push(new he(f,h,'filter array for "'+h[0]+'" operator must have 2 elements')):v!=="object"&&S.push(new he(f+"[1]",h[1],"object expected, "+v+" found"))}return S}(e)}function Jc(e,r){var a=e.key,h=e.style,f=e.styleSpec,v=e.value,y=e.objectKey,S=f[r+"_"+e.layerType];if(!S)return[];var C=y.match(/^(.*)-transition$/);if(r==="paint"&&C&&S[C[1]]&&S[C[1]].transition)return ur({key:a,value:v,valueSpec:f.transition,style:h,styleSpec:f});var O,k=e.valueSpec||S[y];if(!k)return[new he(a,v,'unknown property "'+y+'"')];if(Ur(v)==="string"&&Go(k)&&!k.tokens&&(O=/^{([^}]+)}$/.exec(v)))return[new he(a,v,'"'+y+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(O[1])+" }`.")];var L=[];return e.layerType==="symbol"&&(y==="text-field"&&h&&!h.glyphs&&L.push(new he(a,v,'use of "text-field" requires a style "glyphs" property')),y==="text-font"&&bu(Ne(v))&&He(v.type)==="identity"&&L.push(new he(a,v,'"text-font" does not support identity functions'))),L.concat(ur({key:e.key,value:v,valueSpec:k,style:h,styleSpec:f,expressionContext:"property",propertyType:r,propertyKey:y}))}function Qc(e){return Jc(e,"paint")}function fl(e){return Jc(e,"layout")}function ud(e){var r=[],a=e.value,h=e.key,f=e.style,v=e.styleSpec;a.type||a.ref||r.push(new he(h,a,'either "type" or "ref" is required'));var y,S=He(a.type),C=He(a.ref);if(a.id)for(var O=He(a.id),k=0;k<e.arrayIndex;k++){var L=f.layers[k];He(L.id)===O&&r.push(new he(h,a.id,'duplicate layer id "'+a.id+'", previously used at line '+L.id.__line__))}if("ref"in a)["type","source","source-layer","filter","layout"].forEach(function(oe){oe in a&&r.push(new he(h,a[oe],'"'+oe+'" is prohibited for ref layers'))}),f.layers.forEach(function(oe){He(oe.id)===C&&(y=oe)}),y?y.ref?r.push(new he(h,a.ref,"ref cannot reference another ref layer")):S=He(y.type):r.push(new he(h,a.ref,'ref layer "'+C+'" not found'));else if(S!=="background")if(a.source){var U=f.sources&&f.sources[a.source],$=U&&He(U.type);U?$==="vector"&&S==="raster"?r.push(new he(h,a.source,'layer "'+a.id+'" requires a raster source')):$==="raster"&&S!=="raster"?r.push(new he(h,a.source,'layer "'+a.id+'" requires a vector source')):$!=="vector"||a["source-layer"]?$==="raster-dem"&&S!=="hillshade"?r.push(new he(h,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):S!=="line"||!a.paint||!a.paint["line-gradient"]||$==="geojson"&&U.lineMetrics||r.push(new he(h,a,'layer "'+a.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):r.push(new he(h,a,'layer "'+a.id+'" must specify a "source-layer"')):r.push(new he(h,a.source,'source "'+a.source+'" not found'))}else r.push(new he(h,a,'missing required property "source"'));return r=r.concat(fa({key:h,value:a,valueSpec:v.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return ur({key:h+".type",value:a.type,valueSpec:v.layer.type,style:e.style,styleSpec:e.styleSpec,object:a,objectKey:"type"})},filter:Yc,layout:function(oe){return fa({layer:a,key:oe.key,value:oe.value,style:oe.style,styleSpec:oe.styleSpec,objectElementValidators:{"*":function(le){return fl($e({layerType:S},le))}}})},paint:function(oe){return fa({layer:a,key:oe.key,value:oe.value,style:oe.style,styleSpec:oe.styleSpec,objectElementValidators:{"*":function(le){return Qc($e({layerType:S},le))}}})}}}))}function Ko(e){var r=e.value,a=e.key,h=Ur(r);return h!=="string"?[new he(a,r,"string expected, "+h+" found")]:[]}var Gr={promoteId:function(e){var r=e.key,a=e.value;if(Ur(a)==="string")return Ko({key:r,value:a});var h=[];for(var f in a)h.push.apply(h,Ko({key:r+"."+f,value:a[f]}));return h}};function Cu(e){var r=e.value,a=e.key,h=e.styleSpec,f=e.style;if(!r.type)return[new he(a,r,'"type" is required')];var v,y=He(r.type);switch(y){case"vector":case"raster":case"raster-dem":return fa({key:a,value:r,valueSpec:h["source_"+y.replace("-","_")],style:e.style,styleSpec:h,objectElementValidators:Gr});case"geojson":if(v=fa({key:a,value:r,valueSpec:h.source_geojson,style:f,styleSpec:h,objectElementValidators:Gr}),r.cluster)for(var S in r.clusterProperties){var C=r.clusterProperties[S],O=C[0],k=typeof O=="string"?[O,["accumulated"],["get",S]]:O;v.push.apply(v,Xo({key:a+"."+S+".map",value:C[1],expressionContext:"cluster-map"})),v.push.apply(v,Xo({key:a+"."+S+".reduce",value:k,expressionContext:"cluster-reduce"}))}return v;case"video":return fa({key:a,value:r,valueSpec:h.source_video,style:f,styleSpec:h});case"image":return fa({key:a,value:r,valueSpec:h.source_image,style:f,styleSpec:h});case"canvas":return[new he(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return dl({key:a+".type",value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:h})}}function Yo(e){var r=e.value,a=e.styleSpec,h=a.light,f=e.style,v=[],y=Ur(r);if(r===void 0)return v;if(y!=="object")return v.concat([new he("light",r,"object expected, "+y+" found")]);for(var S in r){var C=S.match(/^(.*)-transition$/);v=v.concat(C&&h[C[1]]&&h[C[1]].transition?ur({key:S,value:r[S],valueSpec:a.transition,style:f,styleSpec:a}):h[S]?ur({key:S,value:r[S],valueSpec:h[S],style:f,styleSpec:a}):[new he(S,r[S],'unknown property "'+S+'"')])}return v}var mo={"*":function(){return[]},array:id,boolean:function(e){var r=e.value,a=e.key,h=Ur(r);return h!=="boolean"?[new he(a,r,"boolean expected, "+h+" found")]:[]},number:ad,color:function(e){var r=e.key,a=e.value,h=Ur(a);return h!=="string"?[new he(r,a,"color expected, "+h+" found")]:Ut(a)===null?[new he(r,a,'color expected, "'+a+'" found')]:[]},constants:Ce,enum:dl,filter:Yc,function:od,layer:ud,object:fa,source:Cu,light:Yo,string:Ko,formatted:function(e){return Ko(e).length===0?[]:Xo(e)},resolvedImage:function(e){return Ko(e).length===0?[]:Xo(e)}};function ur(e){var r=e.value,a=e.valueSpec,h=e.styleSpec;return a.expression&&bu(He(r))?od(e):a.expression&&pl(Ne(r))?Xo(e):a.type&&mo[a.type]?mo[a.type](e):fa($e({},e,{valueSpec:a.type?h[a.type]:a}))}function Vr(e){var r=e.value,a=e.key,h=Ko(e);return h.length||(r.indexOf("{fontstack}")===-1&&h.push(new he(a,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&h.push(new he(a,r,'"glyphs" url must include a "{range}" token'))),h}function Vi(e,r){r===void 0&&(r=G);var a=[];return a=a.concat(ur({key:"",value:e,valueSpec:r.$root,styleSpec:r,style:e,objectElementValidators:{glyphs:Vr,"*":function(){return[]}}})),e.constants&&(a=a.concat(Ce({key:"constants",value:e.constants,style:e,styleSpec:r}))),ml(a)}function ml(e){return[].concat(e).sort(function(r,a){return r.line-a.line})}function Ms(e){return function(){for(var r=[],a=arguments.length;a--;)r[a]=arguments[a];return ml(e.apply(this,r))}}Vi.source=Ms(Cu),Vi.light=Ms(Yo),Vi.layer=Ms(ud),Vi.filter=Ms(Yc),Vi.paintProperty=Ms(Qc),Vi.layoutProperty=Ms(fl);var vl=Vi,Mm=vl.light,Om=vl.paintProperty,gl=vl.layoutProperty;function yl(e,r){var a=!1;if(r&&r.length)for(var h=0,f=r;h<f.length;h+=1)e.fire(new xe(new Error(f[h].message))),a=!0;return a}var Ua=Mn;function Mn(e,r,a){var h=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(r=f[1])+2*(a=f[2]);for(var v=0;v<this.d*this.d;v++){var y=f[3+v],S=f[3+v+1];h.push(y===S?null:f.subarray(y,S))}var C=f[3+h.length+1];this.keys=f.subarray(f[3+h.length],C),this.bboxes=f.subarray(C),this.insert=this._insertReadonly}else{this.d=r+2*a;for(var O=0;O<this.d*this.d;O++)h.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=a,this.scale=r/e,this.uid=0;var k=a/r*e;this.min=-k,this.max=e+k}Mn.prototype.insert=function(e,r,a,h,f){this._forEachCell(r,a,h,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(f)},Mn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Mn.prototype._insertCell=function(e,r,a,h,f,v){this.cells[f].push(v)},Mn.prototype.query=function(e,r,a,h,f){var v=this.min,y=this.max;if(e<=v&&r<=v&&y<=a&&y<=h&&!f)return Array.prototype.slice.call(this.keys);var S=[];return this._forEachCell(e,r,a,h,this._queryCell,S,{},f),S},Mn.prototype._queryCell=function(e,r,a,h,f,v,y,S){var C=this.cells[f];if(C!==null)for(var O=this.keys,k=this.bboxes,L=0;L<C.length;L++){var U=C[L];if(y[U]===void 0){var $=4*U;(S?S(k[$+0],k[$+1],k[$+2],k[$+3]):e<=k[$+2]&&r<=k[$+3]&&a>=k[$+0]&&h>=k[$+1])?(y[U]=!0,v.push(O[U])):y[U]=!1}}},Mn.prototype._forEachCell=function(e,r,a,h,f,v,y,S){for(var C=this._convertToCellCoord(e),O=this._convertToCellCoord(r),k=this._convertToCellCoord(a),L=this._convertToCellCoord(h),U=C;U<=k;U++)for(var $=O;$<=L;$++){var oe=this.d*$+U;if((!S||S(this._convertFromCellCoord(U),this._convertFromCellCoord($),this._convertFromCellCoord(U+1),this._convertFromCellCoord($+1)))&&f.call(this,e,r,a,h,oe,v,y,S))return}},Mn.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Mn.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Mn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,r=3+this.cells.length+1+1,a=0,h=0;h<this.cells.length;h++)a+=this.cells[h].length;var f=new Int32Array(r+a+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var v=r,y=0;y<e.length;y++){var S=e[y];f[3+y]=v,f.set(S,v),v+=S.length}return f[3+e.length]=v,f.set(this.keys,v),f[3+e.length+1]=v+=this.keys.length,f.set(this.bboxes,v),v+=this.bboxes.length,f.buffer};var _l=I.ImageData,cd=I.ImageBitmap,En={};function ut(e,r,a){a===void 0&&(a={}),Object.defineProperty(r,"_classRegistryKey",{value:e,writeable:!1}),En[e]={klass:r,omit:a.omit||[],shallow:a.shallow||[]}}for(var Mi in ut("Object",Object),Ua.serialize=function(e,r){var a=e.toArrayBuffer();return r&&r.push(a),{buffer:a}},Ua.deserialize=function(e){return new Ua(e.buffer)},ut("Grid",Ua),ut("Color",Qt),ut("Error",Error),ut("ResolvedImage",Hr),ut("StylePropertyFunction",Is),ut("StyleExpression",Ts,{omit:["_evaluator"]}),ut("ZoomDependentExpression",Cs),ut("ZoomConstantExpression",hl),ut("CompoundExpression",ne,{omit:["_evaluate"]}),Wo)Wo[Mi]._classRegistryKey||ut("Expression_"+Mi,Wo[Mi]);function Iu(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Os(e){return cd&&e instanceof cd}function ma(e,r){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Iu(e)||Os(e))return r&&r.push(e),e;if(ArrayBuffer.isView(e)){var a=e;return r&&r.push(a.buffer),a}if(e instanceof _l)return r&&r.push(e.data.buffer),e;if(Array.isArray(e)){for(var h=[],f=0,v=e;f<v.length;f+=1)h.push(ma(v[f],r));return h}if(typeof e=="object"){var y=e.constructor,S=y._classRegistryKey;if(!S)throw new Error("can't serialize object of unregistered class");var C=y.serialize?y.serialize(e,r):{};if(!y.serialize){for(var O in e)if(e.hasOwnProperty(O)&&!(En[S].omit.indexOf(O)>=0)){var k=e[O];C[O]=En[S].shallow.indexOf(O)>=0?k:ma(k,r)}e instanceof Error&&(C.message=e.message)}if(C.$name)throw new Error("$name property is reserved for worker serialization logic.");return S!=="Object"&&(C.$name=S),C}throw new Error("can't serialize object of type "+typeof e)}function Oi(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Iu(e)||Os(e)||ArrayBuffer.isView(e)||e instanceof _l)return e;if(Array.isArray(e))return e.map(Oi);if(typeof e=="object"){var r=e.$name||"Object",a=En[r].klass;if(!a)throw new Error("can't deserialize unregistered class "+r);if(a.deserialize)return a.deserialize(e);for(var h=Object.create(a.prototype),f=0,v=Object.keys(e);f<v.length;f+=1){var y=v[f];if(y!=="$name"){var S=e[y];h[y]=En[r].shallow.indexOf(y)>=0?S:Oi(S)}}return h}throw new Error("can't deserialize object of type "+typeof e)}var ep=function(){this.first=!0};ep.prototype.update=function(e,r){var a=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=r),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=a,!0))};var et={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function tp(e){for(var r=0,a=e;r<a.length;r+=1)if(Mu(a[r].charCodeAt(0)))return!0;return!1}function Mu(e){return!(e!==746&&e!==747&&(e<4352||!(et["Bopomofo Extended"](e)||et.Bopomofo(e)||et["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||et["CJK Compatibility Ideographs"](e)||et["CJK Compatibility"](e)||et["CJK Radicals Supplement"](e)||et["CJK Strokes"](e)||!(!et["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||et["CJK Unified Ideographs Extension A"](e)||et["CJK Unified Ideographs"](e)||et["Enclosed CJK Letters and Months"](e)||et["Hangul Compatibility Jamo"](e)||et["Hangul Jamo Extended-A"](e)||et["Hangul Jamo Extended-B"](e)||et["Hangul Jamo"](e)||et["Hangul Syllables"](e)||et.Hiragana(e)||et["Ideographic Description Characters"](e)||et.Kanbun(e)||et["Kangxi Radicals"](e)||et["Katakana Phonetic Extensions"](e)||et.Katakana(e)&&e!==12540||!(!et["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!et["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||et["Unified Canadian Aboriginal Syllabics"](e)||et["Unified Canadian Aboriginal Syllabics Extended"](e)||et["Vertical Forms"](e)||et["Yijing Hexagram Symbols"](e)||et["Yi Syllables"](e)||et["Yi Radicals"](e))))}function rp(e){return!(Mu(e)||function(r){return!!(et["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||et["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||et["Letterlike Symbols"](r)||et["Number Forms"](r)||et["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||et["Control Pictures"](r)&&r!==9251||et["Optical Character Recognition"](r)||et["Enclosed Alphanumerics"](r)||et["Geometric Shapes"](r)||et["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||et["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||et["CJK Symbols and Punctuation"](r)||et.Katakana(r)||et["Private Use Area"](r)||et["CJK Compatibility Forms"](r)||et["Small Form Variants"](r)||et["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(e))}function aa(e){return e>=1424&&e<=2303||et["Arabic Presentation Forms-A"](e)||et["Arabic Presentation Forms-B"](e)}function Ri(e,r){return!(!r&&aa(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||et.Khmer(e))}function Ou(e){for(var r=0,a=e;r<a.length;r+=1)if(aa(a[r].charCodeAt(0)))return!0;return!1}var Ru=null,Ai="unavailable",Va=null,pd=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(Ai="error"),Ru&&Ru(e)};function bl(){np.fire(new ue("pluginStateChange",{pluginStatus:Ai,pluginURL:Va}))}var np=new Se,ip=function(){return Ai},va=function(){if(Ai!=="deferred"||!Va)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ai="loading",bl(),Va&&No({url:Va},function(e){e?pd(e):(Ai="loaded",bl())})},qi={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Ai==="loaded"||qi.applyArabicShaping!=null},isLoading:function(){return Ai==="loading"},setState:function(e){Ai=e.pluginStatus,Va=e.pluginURL},isParsed:function(){return qi.applyArabicShaping!=null&&qi.processBidirectionalText!=null&&qi.processStyledBidirectionalText!=null},getPluginURL:function(){return Va}},ir=function(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ep,this.transition={})};ir.prototype.isSupportedScript=function(e){return function(r,a){for(var h=0,f=r;h<f.length;h+=1)if(!Ri(f[h].charCodeAt(0),a))return!1;return!0}(e,qi.isLoaded())},ir.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ir.prototype.getCrossfadeParameters=function(){var e=this.zoom,r=e-Math.floor(e),a=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*r}};var Ca=function(e,r){this.property=e,this.value=r,this.expression=function(a,h){if(bu(a))return new Is(a,h);if(pl(a)){var f=nd(a,h);if(f.result==="error")throw new Error(f.value.map(function(y){return y.key+": "+y.message}).join(", "));return f.value}var v=a;return typeof a=="string"&&h.type==="color"&&(v=Qt.parse(a)),{kind:"constant",evaluate:function(){return v}}}(r===void 0?e.specification.default:r,e.specification)};Ca.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Ca.prototype.possiblyEvaluate=function(e,r,a){return this.property.possiblyEvaluate(this,e,r,a)};var oa=function(e){this.property=e,this.value=new Ca(e,void 0)};oa.prototype.transitioned=function(e,r){return new Jo(this.property,this.value,r,J({},e.transition,this.transition),e.now)},oa.prototype.untransitioned=function(){return new Jo(this.property,this.value,null,{},0)};var ei=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};ei.prototype.getValue=function(e){return ze(this._values[e].value.value)},ei.prototype.setValue=function(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new oa(this._values[e].property)),this._values[e].value=new Ca(this._values[e].property,r===null?void 0:ze(r))},ei.prototype.getTransition=function(e){return ze(this._values[e].transition)},ei.prototype.setTransition=function(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new oa(this._values[e].property)),this._values[e].transition=ze(r)||void 0},ei.prototype.serialize=function(){for(var e={},r=0,a=Object.keys(this._values);r<a.length;r+=1){var h=a[r],f=this.getValue(h);f!==void 0&&(e[h]=f);var v=this.getTransition(h);v!==void 0&&(e[h+"-transition"]=v)}return e},ei.prototype.transitioned=function(e,r){for(var a=new vo(this._properties),h=0,f=Object.keys(this._values);h<f.length;h+=1){var v=f[h];a._values[v]=this._values[v].transitioned(e,r._values[v])}return a},ei.prototype.untransitioned=function(){for(var e=new vo(this._properties),r=0,a=Object.keys(this._values);r<a.length;r+=1){var h=a[r];e._values[h]=this._values[h].untransitioned()}return e};var Jo=function(e,r,a,h,f){this.property=e,this.value=r,this.begin=f+h.delay||0,this.end=this.begin+h.duration||0,e.specification.transition&&(h.delay||h.duration)&&(this.prior=a)};Jo.prototype.possiblyEvaluate=function(e,r,a){var h=e.now||0,f=this.value.possiblyEvaluate(e,r,a),v=this.prior;if(v){if(h>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(h<this.begin)return v.possiblyEvaluate(e,r,a);var y=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(e,r,a),f,function(S){if(S<=0)return 0;if(S>=1)return 1;var C=S*S,O=C*S;return 4*(S<.5?O:3*(S-C)+O-.75)}(y))}return f};var vo=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};vo.prototype.possiblyEvaluate=function(e,r,a){for(var h=new xl(this._properties),f=0,v=Object.keys(this._values);f<v.length;f+=1){var y=v[f];h._values[y]=this._values[y].possiblyEvaluate(e,r,a)}return h},vo.prototype.hasTransition=function(){for(var e=0,r=Object.keys(this._values);e<r.length;e+=1)if(this._values[r[e]].prior)return!0;return!1};var ga=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};ga.prototype.getValue=function(e){return ze(this._values[e].value)},ga.prototype.setValue=function(e,r){this._values[e]=new Ca(this._values[e].property,r===null?void 0:ze(r))},ga.prototype.serialize=function(){for(var e={},r=0,a=Object.keys(this._values);r<a.length;r+=1){var h=a[r],f=this.getValue(h);f!==void 0&&(e[h]=f)}return e},ga.prototype.possiblyEvaluate=function(e,r,a){for(var h=new xl(this._properties),f=0,v=Object.keys(this._values);f<v.length;f+=1){var y=v[f];h._values[y]=this._values[y].possiblyEvaluate(e,r,a)}return h};var hi=function(e,r,a){this.property=e,this.value=r,this.parameters=a};hi.prototype.isConstant=function(){return this.value.kind==="constant"},hi.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},hi.prototype.evaluate=function(e,r,a,h){return this.property.evaluate(this.value,this.parameters,e,r,a,h)};var xl=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};xl.prototype.get=function(e){return this._values[e]};var _t=function(e){this.specification=e};_t.prototype.possiblyEvaluate=function(e,r){return e.expression.evaluate(r)},_t.prototype.interpolate=function(e,r,a){var h=Es[this.specification.type];return h?h(e,r,a):e};var pt=function(e,r){this.specification=e,this.overrides=r};pt.prototype.possiblyEvaluate=function(e,r,a,h){return new hi(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(r,null,{},a,h)}:e.expression,r)},pt.prototype.interpolate=function(e,r,a){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new hi(this,{kind:"constant",value:void 0},e.parameters);var h=Es[this.specification.type];return h?new hi(this,{kind:"constant",value:h(e.value.value,r.value.value,a)},e.parameters):e},pt.prototype.evaluate=function(e,r,a,h,f,v){return e.kind==="constant"?e.value:e.evaluate(r,a,h,f,v)};var Au=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.possiblyEvaluate=function(a,h,f,v){if(a.value===void 0)return new hi(this,{kind:"constant",value:void 0},h);if(a.expression.kind==="constant"){var y=a.expression.evaluate(h,null,{},f,v),S=a.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,C=this._calculate(S,S,S,h);return new hi(this,{kind:"constant",value:C},h)}if(a.expression.kind==="camera"){var O=this._calculate(a.expression.evaluate({zoom:h.zoom-1}),a.expression.evaluate({zoom:h.zoom}),a.expression.evaluate({zoom:h.zoom+1}),h);return new hi(this,{kind:"constant",value:O},h)}return new hi(this,a.expression,h)},r.prototype.evaluate=function(a,h,f,v,y,S){if(a.kind==="source"){var C=a.evaluate(h,f,v,y,S);return this._calculate(C,C,C,h)}return a.kind==="composite"?this._calculate(a.evaluate({zoom:Math.floor(h.zoom)-1},f,v),a.evaluate({zoom:Math.floor(h.zoom)},f,v),a.evaluate({zoom:Math.floor(h.zoom)+1},f,v),h):a.value},r.prototype._calculate=function(a,h,f,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:a,to:h}:{from:f,to:h}},r.prototype.interpolate=function(a){return a},r}(pt),di=function(e){this.specification=e};di.prototype.possiblyEvaluate=function(e,r,a,h){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(r,null,{},a,h);return this._calculate(f,f,f,r)}return this._calculate(e.expression.evaluate(new ir(Math.floor(r.zoom-1),r)),e.expression.evaluate(new ir(Math.floor(r.zoom),r)),e.expression.evaluate(new ir(Math.floor(r.zoom+1),r)),r)}},di.prototype._calculate=function(e,r,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:a,to:r}},di.prototype.interpolate=function(e){return e};var ya=function(e){this.specification=e};ya.prototype.possiblyEvaluate=function(e,r,a,h){return!!e.expression.evaluate(r,null,{},a,h)},ya.prototype.interpolate=function(){return!1};var ti=function(e){for(var r in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var a=e[r];a.specification.overridable&&this.overridableProperties.push(r);var h=this.defaultPropertyValues[r]=new Ca(a,void 0),f=this.defaultTransitionablePropertyValues[r]=new oa(a);this.defaultTransitioningPropertyValues[r]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=h.possiblyEvaluate({})}};ut("DataDrivenProperty",pt),ut("DataConstantProperty",_t),ut("CrossFadedDataDrivenProperty",Au),ut("CrossFadedProperty",di),ut("ColorRampProperty",ya);var Ia=function(e){function r(a,h){if(e.call(this),this.id=a.id,this.type=a.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},a.type!=="custom"&&(this.metadata=(a=a).metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),h.layout&&(this._unevaluatedLayout=new ga(h.layout)),h.paint)){for(var f in this._transitionablePaint=new ei(h.paint),a.paint)this.setPaintProperty(f,a.paint[f],{validate:!1});for(var v in a.layout)this.setLayoutProperty(v,a.layout[v],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new xl(h.paint)}}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},r.prototype.getLayoutProperty=function(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)},r.prototype.setLayoutProperty=function(a,h,f){f===void 0&&(f={}),h!=null&&this._validate(gl,"layers."+this.id+".layout."+a,a,h,f)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,h):this.visibility=h)},r.prototype.getPaintProperty=function(a){return de(a,"-transition")?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)},r.prototype.setPaintProperty=function(a,h,f){if(f===void 0&&(f={}),h!=null&&this._validate(Om,"layers."+this.id+".paint."+a,a,h,f))return!1;if(de(a,"-transition"))return this._transitionablePaint.setTransition(a.slice(0,-11),h||void 0),!1;var v=this._transitionablePaint._values[a],y=v.property.specification["property-type"]==="cross-faded-data-driven",S=v.value.isDataDriven(),C=v.value;this._transitionablePaint.setValue(a,h),this._handleSpecialPaintPropertyUpdate(a);var O=this._transitionablePaint._values[a].value;return O.isDataDriven()||S||y||this._handleOverridablePaintPropertyUpdate(a,C,O)},r.prototype._handleSpecialPaintPropertyUpdate=function(a){},r.prototype._handleOverridablePaintPropertyUpdate=function(a,h,f){return!1},r.prototype.isHidden=function(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"},r.prototype.updateTransitions=function(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)},r.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},r.prototype.recalculate=function(a,h){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,h)},r.prototype.serialize=function(){var a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),we(a,function(h,f){return!(h===void 0||f==="layout"&&!Object.keys(h).length||f==="paint"&&!Object.keys(h).length)})},r.prototype._validate=function(a,h,f,v,y){return y===void 0&&(y={}),(!y||y.validate!==!1)&&yl(this,a.call(vl,{key:h,layerType:this.type,objectKey:f,value:v,styleSpec:G,style:{glyphs:!0,sprite:!0}}))},r.prototype.is3D=function(){return!1},r.prototype.isTileClipped=function(){return!1},r.prototype.hasOffscreenPass=function(){return!1},r.prototype.resize=function(){},r.prototype.isStateDependent=function(){for(var a in this.paint._values){var h=this.paint.get(a);if(h instanceof hi&&Go(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1},r}(Se),ap={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},ku=function(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Tr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function qn(e,r){r===void 0&&(r=1);var a=0,h=0;return{members:e.map(function(f){var v=ap[f.type].BYTES_PER_ELEMENT,y=a=hd(a,Math.max(r,v)),S=f.components||1;return h=Math.max(h,v),a+=v*S,{name:f.name,type:f.type,components:S,offset:y}}),size:hd(a,Math.max(h,r)),alignment:r}}function hd(e,r){return Math.ceil(e/r)*r}Tr.serialize=function(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Tr.deserialize=function(e){var r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r},Tr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Tr.prototype.clear=function(){this.length=0},Tr.prototype.resize=function(e){this.reserve(e),this.length=e},Tr.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}},Tr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Qo=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h){var f=this.length;return this.resize(f+1),this.emplace(f,a,h)},r.prototype.emplace=function(a,h,f){var v=2*a;return this.int16[v+0]=h,this.int16[v+1]=f,a},r}(Tr);Qo.prototype.bytesPerElement=4,ut("StructArrayLayout2i4",Qo);var op=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f,v){var y=this.length;return this.resize(y+1),this.emplace(y,a,h,f,v)},r.prototype.emplace=function(a,h,f,v,y){var S=4*a;return this.int16[S+0]=h,this.int16[S+1]=f,this.int16[S+2]=v,this.int16[S+3]=y,a},r}(Tr);op.prototype.bytesPerElement=8,ut("StructArrayLayout4i8",op);var qa=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f,v,y,S){var C=this.length;return this.resize(C+1),this.emplace(C,a,h,f,v,y,S)},r.prototype.emplace=function(a,h,f,v,y,S,C){var O=6*a;return this.int16[O+0]=h,this.int16[O+1]=f,this.int16[O+2]=v,this.int16[O+3]=y,this.int16[O+4]=S,this.int16[O+5]=C,a},r}(Tr);qa.prototype.bytesPerElement=12,ut("StructArrayLayout2i4i12",qa);var ki=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f,v,y,S){var C=this.length;return this.resize(C+1),this.emplace(C,a,h,f,v,y,S)},r.prototype.emplace=function(a,h,f,v,y,S,C){var O=4*a,k=8*a;return this.int16[O+0]=h,this.int16[O+1]=f,this.uint8[k+4]=v,this.uint8[k+5]=y,this.uint8[k+6]=S,this.uint8[k+7]=C,a},r}(Tr);ki.prototype.bytesPerElement=8,ut("StructArrayLayout2i4ub8",ki);var Rs=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h){var f=this.length;return this.resize(f+1),this.emplace(f,a,h)},r.prototype.emplace=function(a,h,f){var v=2*a;return this.float32[v+0]=h,this.float32[v+1]=f,a},r}(Tr);Rs.prototype.bytesPerElement=8,ut("StructArrayLayout2f8",Rs);var Ma=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f,v,y,S,C,O,k,L){var U=this.length;return this.resize(U+1),this.emplace(U,a,h,f,v,y,S,C,O,k,L)},r.prototype.emplace=function(a,h,f,v,y,S,C,O,k,L,U){var $=10*a;return this.uint16[$+0]=h,this.uint16[$+1]=f,this.uint16[$+2]=v,this.uint16[$+3]=y,this.uint16[$+4]=S,this.uint16[$+5]=C,this.uint16[$+6]=O,this.uint16[$+7]=k,this.uint16[$+8]=L,this.uint16[$+9]=U,a},r}(Tr);Ma.prototype.bytesPerElement=20,ut("StructArrayLayout10ui20",Ma);var Du=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f,v,y,S,C,O,k,L,U,$){var oe=this.length;return this.resize(oe+1),this.emplace(oe,a,h,f,v,y,S,C,O,k,L,U,$)},r.prototype.emplace=function(a,h,f,v,y,S,C,O,k,L,U,$,oe){var le=12*a;return this.int16[le+0]=h,this.int16[le+1]=f,this.int16[le+2]=v,this.int16[le+3]=y,this.uint16[le+4]=S,this.uint16[le+5]=C,this.uint16[le+6]=O,this.uint16[le+7]=k,this.int16[le+8]=L,this.int16[le+9]=U,this.int16[le+10]=$,this.int16[le+11]=oe,a},r}(Tr);Du.prototype.bytesPerElement=24,ut("StructArrayLayout4i4ui4i24",Du);var As=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f){var v=this.length;return this.resize(v+1),this.emplace(v,a,h,f)},r.prototype.emplace=function(a,h,f,v){var y=3*a;return this.float32[y+0]=h,this.float32[y+1]=f,this.float32[y+2]=v,a},r}(Tr);As.prototype.bytesPerElement=12,ut("StructArrayLayout3f12",As);var wl=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a){var h=this.length;return this.resize(h+1),this.emplace(h,a)},r.prototype.emplace=function(a,h){return this.uint32[1*a+0]=h,a},r}(Tr);wl.prototype.bytesPerElement=4,ut("StructArrayLayout1ul4",wl);var sp=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f,v,y,S,C,O,k){var L=this.length;return this.resize(L+1),this.emplace(L,a,h,f,v,y,S,C,O,k)},r.prototype.emplace=function(a,h,f,v,y,S,C,O,k,L){var U=10*a,$=5*a;return this.int16[U+0]=h,this.int16[U+1]=f,this.int16[U+2]=v,this.int16[U+3]=y,this.int16[U+4]=S,this.int16[U+5]=C,this.uint32[$+3]=O,this.uint16[U+8]=k,this.uint16[U+9]=L,a},r}(Tr);sp.prototype.bytesPerElement=20,ut("StructArrayLayout6i1ul2ui20",sp);var ks=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f,v,y,S){var C=this.length;return this.resize(C+1),this.emplace(C,a,h,f,v,y,S)},r.prototype.emplace=function(a,h,f,v,y,S,C){var O=6*a;return this.int16[O+0]=h,this.int16[O+1]=f,this.int16[O+2]=v,this.int16[O+3]=y,this.int16[O+4]=S,this.int16[O+5]=C,a},r}(Tr);ks.prototype.bytesPerElement=12,ut("StructArrayLayout2i2i2i12",ks);var es=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f,v,y){var S=this.length;return this.resize(S+1),this.emplace(S,a,h,f,v,y)},r.prototype.emplace=function(a,h,f,v,y,S){var C=4*a,O=8*a;return this.float32[C+0]=h,this.float32[C+1]=f,this.float32[C+2]=v,this.int16[O+6]=y,this.int16[O+7]=S,a},r}(Tr);es.prototype.bytesPerElement=16,ut("StructArrayLayout2f1f2i16",es);var lp=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f,v){var y=this.length;return this.resize(y+1),this.emplace(y,a,h,f,v)},r.prototype.emplace=function(a,h,f,v,y){var S=12*a,C=3*a;return this.uint8[S+0]=h,this.uint8[S+1]=f,this.float32[C+1]=v,this.float32[C+2]=y,a},r}(Tr);lp.prototype.bytesPerElement=12,ut("StructArrayLayout2ub2f12",lp);var go=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f){var v=this.length;return this.resize(v+1),this.emplace(v,a,h,f)},r.prototype.emplace=function(a,h,f,v){var y=3*a;return this.uint16[y+0]=h,this.uint16[y+1]=f,this.uint16[y+2]=v,a},r}(Tr);go.prototype.bytesPerElement=6,ut("StructArrayLayout3ui6",go);var yo=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f,v,y,S,C,O,k,L,U,$,oe,le,_e,fe,Te){var Me=this.length;return this.resize(Me+1),this.emplace(Me,a,h,f,v,y,S,C,O,k,L,U,$,oe,le,_e,fe,Te)},r.prototype.emplace=function(a,h,f,v,y,S,C,O,k,L,U,$,oe,le,_e,fe,Te,Me){var Re=24*a,Le=12*a,Ve=48*a;return this.int16[Re+0]=h,this.int16[Re+1]=f,this.uint16[Re+2]=v,this.uint16[Re+3]=y,this.uint32[Le+2]=S,this.uint32[Le+3]=C,this.uint32[Le+4]=O,this.uint16[Re+10]=k,this.uint16[Re+11]=L,this.uint16[Re+12]=U,this.float32[Le+7]=$,this.float32[Le+8]=oe,this.uint8[Ve+36]=le,this.uint8[Ve+37]=_e,this.uint8[Ve+38]=fe,this.uint32[Le+10]=Te,this.int16[Re+22]=Me,a},r}(Tr);yo.prototype.bytesPerElement=48,ut("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",yo);var Lu=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f,v,y,S,C,O,k,L,U,$,oe,le,_e,fe,Te,Me,Re,Le,Ve,Ze,Qe,vt,nt,xt,it,Xt){var Rt=this.length;return this.resize(Rt+1),this.emplace(Rt,a,h,f,v,y,S,C,O,k,L,U,$,oe,le,_e,fe,Te,Me,Re,Le,Ve,Ze,Qe,vt,nt,xt,it,Xt)},r.prototype.emplace=function(a,h,f,v,y,S,C,O,k,L,U,$,oe,le,_e,fe,Te,Me,Re,Le,Ve,Ze,Qe,vt,nt,xt,it,Xt,Rt){var ht=34*a,rr=17*a;return this.int16[ht+0]=h,this.int16[ht+1]=f,this.int16[ht+2]=v,this.int16[ht+3]=y,this.int16[ht+4]=S,this.int16[ht+5]=C,this.int16[ht+6]=O,this.int16[ht+7]=k,this.uint16[ht+8]=L,this.uint16[ht+9]=U,this.uint16[ht+10]=$,this.uint16[ht+11]=oe,this.uint16[ht+12]=le,this.uint16[ht+13]=_e,this.uint16[ht+14]=fe,this.uint16[ht+15]=Te,this.uint16[ht+16]=Me,this.uint16[ht+17]=Re,this.uint16[ht+18]=Le,this.uint16[ht+19]=Ve,this.uint16[ht+20]=Ze,this.uint16[ht+21]=Qe,this.uint16[ht+22]=vt,this.uint32[rr+12]=nt,this.float32[rr+13]=xt,this.float32[rr+14]=it,this.float32[rr+15]=Xt,this.float32[rr+16]=Rt,a},r}(Tr);Lu.prototype.bytesPerElement=68,ut("StructArrayLayout8i15ui1ul4f68",Lu);var _o=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a){var h=this.length;return this.resize(h+1),this.emplace(h,a)},r.prototype.emplace=function(a,h){return this.float32[1*a+0]=h,a},r}(Tr);_o.prototype.bytesPerElement=4,ut("StructArrayLayout1f4",_o);var sa=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f){var v=this.length;return this.resize(v+1),this.emplace(v,a,h,f)},r.prototype.emplace=function(a,h,f,v){var y=3*a;return this.int16[y+0]=h,this.int16[y+1]=f,this.int16[y+2]=v,a},r}(Tr);sa.prototype.bytesPerElement=6,ut("StructArrayLayout3i6",sa);var up=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f){var v=this.length;return this.resize(v+1),this.emplace(v,a,h,f)},r.prototype.emplace=function(a,h,f,v){var y=4*a;return this.uint32[2*a+0]=h,this.uint16[y+2]=f,this.uint16[y+3]=v,a},r}(Tr);up.prototype.bytesPerElement=8,ut("StructArrayLayout1ul2ui8",up);var Sl=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h){var f=this.length;return this.resize(f+1),this.emplace(f,a,h)},r.prototype.emplace=function(a,h,f){var v=2*a;return this.uint16[v+0]=h,this.uint16[v+1]=f,a},r}(Tr);Sl.prototype.bytesPerElement=4,ut("StructArrayLayout2ui4",Sl);var cp=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a){var h=this.length;return this.resize(h+1),this.emplace(h,a)},r.prototype.emplace=function(a,h){return this.uint16[1*a+0]=h,a},r}(Tr);cp.prototype.bytesPerElement=2,ut("StructArrayLayout1ui2",cp);var zu=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(a,h,f,v){var y=this.length;return this.resize(y+1),this.emplace(y,a,h,f,v)},r.prototype.emplace=function(a,h,f,v,y){var S=4*a;return this.float32[S+0]=h,this.float32[S+1]=f,this.float32[S+2]=v,this.float32[S+3]=y,a},r}(Tr);zu.prototype.bytesPerElement=16,ut("StructArrayLayout4f16",zu);var s=function(e){function r(){e.apply(this,arguments)}e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r;var a={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return a.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},a.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},a.x1.get=function(){return this._structArray.int16[this._pos2+2]},a.y1.get=function(){return this._structArray.int16[this._pos2+3]},a.x2.get=function(){return this._structArray.int16[this._pos2+4]},a.y2.get=function(){return this._structArray.int16[this._pos2+5]},a.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},a.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},a.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},a.anchorPoint.get=function(){return new T(this.anchorPointX,this.anchorPointY)},Object.defineProperties(r.prototype,a),r}(ku);s.prototype.size=20;var c=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.get=function(a){return new s(this,a)},r}(sp);ut("CollisionBoxArray",c);var l=function(e){function r(){e.apply(this,arguments)}e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r;var a={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return a.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},a.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},a.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},a.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},a.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},a.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},a.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},a.segment.get=function(){return this._structArray.uint16[this._pos2+10]},a.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},a.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},a.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},a.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},a.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},a.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},a.placedOrientation.set=function(h){this._structArray.uint8[this._pos1+37]=h},a.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},a.hidden.set=function(h){this._structArray.uint8[this._pos1+38]=h},a.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},a.crossTileID.set=function(h){this._structArray.uint32[this._pos4+10]=h},a.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(r.prototype,a),r}(ku);l.prototype.size=48;var d=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.get=function(a){return new l(this,a)},r}(yo);ut("PlacedSymbolArray",d);var g=function(e){function r(){e.apply(this,arguments)}e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r;var a={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return a.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},a.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},a.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},a.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},a.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},a.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},a.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},a.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},a.key.get=function(){return this._structArray.uint16[this._pos2+8]},a.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},a.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},a.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},a.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},a.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},a.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},a.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},a.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},a.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},a.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},a.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},a.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},a.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},a.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},a.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},a.crossTileID.set=function(h){this._structArray.uint32[this._pos4+12]=h},a.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},a.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},a.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},a.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(r.prototype,a),r}(ku);g.prototype.size=68;var x=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.get=function(a){return new g(this,a)},r}(Lu);ut("SymbolInstanceArray",x);var w=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.getoffsetX=function(a){return this.float32[1*a+0]},r}(_o);ut("GlyphOffsetArray",w);var P=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.getx=function(a){return this.int16[3*a+0]},r.prototype.gety=function(a){return this.int16[3*a+1]},r.prototype.gettileUnitDistanceFromAnchor=function(a){return this.int16[3*a+2]},r}(sa);ut("SymbolLineVertexArray",P);var A=function(e){function r(){e.apply(this,arguments)}e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r;var a={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return a.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},a.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},a.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(r.prototype,a),r}(ku);A.prototype.size=8;var j=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.get=function(a){return new A(this,a)},r}(up);ut("FeatureIndexArray",j);var Z=qn([{name:"a_pos",components:2,type:"Int16"}],4).members,X=function(e){e===void 0&&(e=[]),this.segments=e};function Q(e,r){return 256*(e=W(Math.floor(e),0,255))+W(Math.floor(r),0,255)}X.prototype.prepareSegment=function(e,r,a,h){var f=this.segments[this.segments.length-1];return e>X.MAX_VERTEX_ARRAY_LENGTH&&ce("Max vertices per segment is "+X.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>X.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==h)&&(f={vertexOffset:r.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},h!==void 0&&(f.sortKey=h),this.segments.push(f)),f},X.prototype.get=function(){return this.segments},X.prototype.destroy=function(){for(var e=0,r=this.segments;e<r.length;e+=1){var a=r[e];for(var h in a.vaos)a.vaos[h].destroy()}},X.simpleSegment=function(e,r,a,h){return new X([{vertexOffset:e,primitiveOffset:r,vertexLength:a,primitiveLength:h,vaos:{},sortKey:0}])},X.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ut("SegmentVector",X);var pe=qn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),se=_(function(e){e.exports=function(r,a){var h,f,v,y,S,C,O,k;for(f=r.length-(h=3&r.length),v=a,S=3432918353,C=461845907,k=0;k<f;)O=255&r.charCodeAt(k)|(255&r.charCodeAt(++k))<<8|(255&r.charCodeAt(++k))<<16|(255&r.charCodeAt(++k))<<24,++k,v=27492+(65535&(y=5*(65535&(v=(v^=O=(65535&(O=(O=(65535&O)*S+(((O>>>16)*S&65535)<<16)&4294967295)<<15|O>>>17))*C+(((O>>>16)*C&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(O=0,h){case 3:O^=(255&r.charCodeAt(k+2))<<16;case 2:O^=(255&r.charCodeAt(k+1))<<8;case 1:v^=O=(65535&(O=(O=(65535&(O^=255&r.charCodeAt(k)))*S+(((O>>>16)*S&65535)<<16)&4294967295)<<15|O>>>17))*C+(((O>>>16)*C&65535)<<16)&4294967295}return v^=r.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}}),ye=_(function(e){e.exports=function(r,a){for(var h,f=r.length,v=a^f,y=0;f>=4;)h=1540483477*(65535&(h=255&r.charCodeAt(y)|(255&r.charCodeAt(++y))<<8|(255&r.charCodeAt(++y))<<16|(255&r.charCodeAt(++y))<<24))+((1540483477*(h>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),f-=4,++y;switch(f){case 3:v^=(255&r.charCodeAt(y+2))<<16;case 2:v^=(255&r.charCodeAt(y+1))<<8;case 1:v=1540483477*(65535&(v^=255&r.charCodeAt(y)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}}),ae=se,ge=ye;ae.murmur3=se,ae.murmur2=ge;var Ee=function(){this.ids=[],this.positions=[],this.indexed=!1};Ee.prototype.add=function(e,r,a,h){this.ids.push(je(e)),this.positions.push(r,a,h)},Ee.prototype.getPositions=function(e){for(var r=je(e),a=0,h=this.ids.length-1;a<h;){var f=a+h>>1;this.ids[f]>=r?h=f:a=f+1}for(var v=[];this.ids[a]===r;)v.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return v},Ee.serialize=function(e,r){var a=new Float64Array(e.ids),h=new Uint32Array(e.positions);return function f(v,y,S,C){for(;S<C;){for(var O=v[S+C>>1],k=S-1,L=C+1;;){do k++;while(v[k]<O);do L--;while(v[L]>O);if(k>=L)break;ke(v,k,L),ke(y,3*k,3*L),ke(y,3*k+1,3*L+1),ke(y,3*k+2,3*L+2)}L-S<C-L?(f(v,y,S,L),S=L+1):(f(v,y,L+1,C),C=L)}}(a,h,0,a.length-1),r&&r.push(a.buffer,h.buffer),{ids:a,positions:h}},Ee.deserialize=function(e){var r=new Ee;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r};var Ie=Math.pow(2,53)-1;function je(e){var r=+e;return!isNaN(r)&&r<=Ie?r:ae(String(e))}function ke(e,r,a){var h=e[r];e[r]=e[a],e[a]=h}ut("FeaturePositionMap",Ee);var Be=function(e,r){this.gl=e.gl,this.location=r},qe=function(e){function r(a,h){e.call(this,a,h),this.current=0}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.set=function(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))},r}(Be),Ke=function(e){function r(a,h){e.call(this,a,h),this.current=0}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.set=function(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))},r}(Be),Xe=function(e){function r(a,h){e.call(this,a,h),this.current=[0,0]}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.set=function(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))},r}(Be),at=function(e){function r(a,h){e.call(this,a,h),this.current=[0,0,0]}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.set=function(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))},r}(Be),bt=function(e){function r(a,h){e.call(this,a,h),this.current=[0,0,0,0]}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.set=function(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))},r}(Be),Pt=function(e){function r(a,h){e.call(this,a,h),this.current=Qt.transparent}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.set=function(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))},r}(Be),St=new Float32Array(16),mr=function(e){function r(a,h){e.call(this,a,h),this.current=St}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.set=function(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(var h=1;h<16;h++)if(a[h]!==this.current[h]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}},r}(Be);function st(e){return[Q(255*e.r,255*e.g),Q(255*e.b,255*e.a)]}var Nt=function(e,r,a){this.value=e,this.uniformNames=r.map(function(h){return"u_"+h}),this.type=a};Nt.prototype.setUniform=function(e,r,a){e.set(a.constantOr(this.value))},Nt.prototype.getBinding=function(e,r,a){return this.type==="color"?new Pt(e,r):new Ke(e,r)};var Ht=function(e,r){this.uniformNames=r.map(function(a){return"u_"+a}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Ht.prototype.setConstantPatternPositions=function(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr},Ht.prototype.setUniform=function(e,r,a,h){var f=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},Ht.prototype.getBinding=function(e,r,a){return a.substr(0,9)==="u_pattern"?new bt(e,r):new Ke(e,r)};var zt=function(e,r,a,h){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=r.map(function(f){return{name:"a_"+f,type:"Float32",components:a==="color"?2:1,offset:0}}),this.paintVertexArray=new h};zt.prototype.populatePaintArray=function(e,r,a,h,f){var v=this.paintVertexArray.length,y=this.expression.evaluate(new ir(0),r,{},h,[],f);this.paintVertexArray.resize(e),this._setPaintValue(v,e,y)},zt.prototype.updatePaintArray=function(e,r,a,h){var f=this.expression.evaluate({zoom:0},a,h);this._setPaintValue(e,r,f)},zt.prototype._setPaintValue=function(e,r,a){if(this.type==="color")for(var h=st(a),f=e;f<r;f++)this.paintVertexArray.emplace(f,h[0],h[1]);else{for(var v=e;v<r;v++)this.paintVertexArray.emplace(v,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}},zt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},zt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Lt=function(e,r,a,h,f,v){this.expression=e,this.uniformNames=r.map(function(y){return"u_"+y+"_t"}),this.type=a,this.useIntegerZoom=h,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=r.map(function(y){return{name:"a_"+y,type:"Float32",components:a==="color"?4:2,offset:0}}),this.paintVertexArray=new v};Lt.prototype.populatePaintArray=function(e,r,a,h,f){var v=this.expression.evaluate(new ir(this.zoom),r,{},h,[],f),y=this.expression.evaluate(new ir(this.zoom+1),r,{},h,[],f),S=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(S,e,v,y)},Lt.prototype.updatePaintArray=function(e,r,a,h){var f=this.expression.evaluate({zoom:this.zoom},a,h),v=this.expression.evaluate({zoom:this.zoom+1},a,h);this._setPaintValue(e,r,f,v)},Lt.prototype._setPaintValue=function(e,r,a,h){if(this.type==="color")for(var f=st(a),v=st(h),y=e;y<r;y++)this.paintVertexArray.emplace(y,f[0],f[1],v[0],v[1]);else{for(var S=e;S<r;S++)this.paintVertexArray.emplace(S,a,h);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(h))}},Lt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Lt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Lt.prototype.setUniform=function(e,r){var a=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,h=W(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);e.set(h)},Lt.prototype.getBinding=function(e,r,a){return new Ke(e,r)};var qt=function(e,r,a,h,f,v){this.expression=e,this.type=r,this.useIntegerZoom=a,this.zoom=h,this.layerId=v,this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f};qt.prototype.populatePaintArray=function(e,r,a){var h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(h,e,r.patterns&&r.patterns[this.layerId],a)},qt.prototype.updatePaintArray=function(e,r,a,h,f){this._setPaintValues(e,r,a.patterns&&a.patterns[this.layerId],f)},qt.prototype._setPaintValues=function(e,r,a,h){if(h&&a){var f=h[a.min],v=h[a.mid],y=h[a.max];if(f&&v&&y)for(var S=e;S<r;S++)this.zoomInPaintVertexArray.emplace(S,v.tl[0],v.tl[1],v.br[0],v.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],v.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(S,v.tl[0],v.tl[1],v.br[0],v.br[1],y.tl[0],y.tl[1],y.br[0],y.br[1],v.pixelRatio,y.pixelRatio)}},qt.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,pe.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,pe.members,this.expression.isStateDependent))},qt.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var At=function(e,r,a){this.binders={},this._buffers=[];var h=[];for(var f in e.paint._values)if(a(f)){var v=e.paint.get(f);if(v instanceof hi&&Go(v.property.specification)){var y=Ln(f,e.type),S=v.value,C=v.property.specification.type,O=v.property.useIntegerZoom,k=v.property.specification["property-type"],L=k==="cross-faded"||k==="cross-faded-data-driven";if(S.kind==="constant")this.binders[f]=L?new Ht(S.value,y):new Nt(S.value,y,C),h.push("/u_"+f);else if(S.kind==="source"||L){var U=ln(f,C,"source");this.binders[f]=L?new qt(S,C,O,r,U,e.id):new zt(S,y,C,U),h.push("/a_"+f)}else{var $=ln(f,C,"composite");this.binders[f]=new Lt(S,y,C,O,r,$),h.push("/z_"+f)}}}this.cacheKey=h.sort().join("")};At.prototype.getMaxValue=function(e){var r=this.binders[e];return r instanceof zt||r instanceof Lt?r.maxValue:0},At.prototype.populatePaintArrays=function(e,r,a,h,f){for(var v in this.binders){var y=this.binders[v];(y instanceof zt||y instanceof Lt||y instanceof qt)&&y.populatePaintArray(e,r,a,h,f)}},At.prototype.setConstantPatternPositions=function(e,r){for(var a in this.binders){var h=this.binders[a];h instanceof Ht&&h.setConstantPatternPositions(e,r)}},At.prototype.updatePaintArrays=function(e,r,a,h,f){var v=!1;for(var y in e)for(var S=0,C=r.getPositions(y);S<C.length;S+=1){var O=C[S],k=a.feature(O.index);for(var L in this.binders){var U=this.binders[L];if((U instanceof zt||U instanceof Lt||U instanceof qt)&&U.expression.isStateDependent===!0){var $=h.paint.get(L);U.expression=$.value,U.updatePaintArray(O.start,O.end,k,e[y],f),v=!0}}}return v},At.prototype.defines=function(){var e=[];for(var r in this.binders){var a=this.binders[r];(a instanceof Nt||a instanceof Ht)&&e.push.apply(e,a.uniformNames.map(function(h){return"#define HAS_UNIFORM_"+h}))}return e},At.prototype.getBinderAttributes=function(){var e=[];for(var r in this.binders){var a=this.binders[r];if(a instanceof zt||a instanceof Lt)for(var h=0;h<a.paintVertexAttributes.length;h++)e.push(a.paintVertexAttributes[h].name);else if(a instanceof qt)for(var f=0;f<pe.members.length;f++)e.push(pe.members[f].name)}return e},At.prototype.getBinderUniforms=function(){var e=[];for(var r in this.binders){var a=this.binders[r];if(a instanceof Nt||a instanceof Ht||a instanceof Lt)for(var h=0,f=a.uniformNames;h<f.length;h+=1)e.push(f[h])}return e},At.prototype.getPaintVertexBuffers=function(){return this._buffers},At.prototype.getUniforms=function(e,r){var a=[];for(var h in this.binders){var f=this.binders[h];if(f instanceof Nt||f instanceof Ht||f instanceof Lt)for(var v=0,y=f.uniformNames;v<y.length;v+=1){var S=y[v];if(r[S]){var C=f.getBinding(e,r[S],S);a.push({name:S,property:h,binding:C})}}}return a},At.prototype.setUniforms=function(e,r,a,h){for(var f=0,v=r;f<v.length;f+=1){var y=v[f],S=y.name,C=y.property;this.binders[C].setUniform(y.binding,h,a.get(C),S)}},At.prototype.updatePaintBuffers=function(e){for(var r in this._buffers=[],this.binders){var a=this.binders[r];if(e&&a instanceof qt){var h=e.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(a instanceof zt||a instanceof Lt)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}},At.prototype.upload=function(e){for(var r in this.binders){var a=this.binders[r];(a instanceof zt||a instanceof Lt||a instanceof qt)&&a.upload(e)}this.updatePaintBuffers()},At.prototype.destroy=function(){for(var e in this.binders){var r=this.binders[e];(r instanceof zt||r instanceof Lt||r instanceof qt)&&r.destroy()}};var Ot=function(e,r,a){a===void 0&&(a=function(){return!0}),this.programConfigurations={};for(var h=0,f=e;h<f.length;h+=1){var v=f[h];this.programConfigurations[v.id]=new At(v,r,a)}this.needsUpload=!1,this._featureMap=new Ee,this._bufferOffset=0};function Ln(e,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(r+"-","").replace(/-/g,"_")]}function ln(e,r,a){var h={color:{source:Rs,composite:zu},number:{source:_o,composite:Rs}},f=function(v){return{"line-pattern":{source:Ma,composite:Ma},"fill-pattern":{source:Ma,composite:Ma},"fill-extrusion-pattern":{source:Ma,composite:Ma}}[v]}(e);return f&&f[a]||h[r][a]}Ot.prototype.populatePaintArrays=function(e,r,a,h,f,v){for(var y in this.programConfigurations)this.programConfigurations[y].populatePaintArrays(e,r,h,f,v);r.id!==void 0&&this._featureMap.add(r.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Ot.prototype.updatePaintArrays=function(e,r,a,h){for(var f=0,v=a;f<v.length;f+=1){var y=v[f];this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(e,this._featureMap,r,y,h)||this.needsUpload}},Ot.prototype.get=function(e){return this.programConfigurations[e]},Ot.prototype.upload=function(e){if(this.needsUpload){for(var r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}},Ot.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},ut("ConstantBinder",Nt),ut("CrossFadedConstantBinder",Ht),ut("SourceExpressionBinder",zt),ut("CrossFadedCompositeBinder",qt),ut("CompositeExpressionBinder",Lt),ut("ProgramConfiguration",At,{omit:["_buffers"]}),ut("ProgramConfigurationSet",Ot);var ii=Math.pow(2,14)-1,$n=-ii-1;function rn(e){for(var r=8192/e.extent,a=e.loadGeometry(),h=0;h<a.length;h++)for(var f=a[h],v=0;v<f.length;v++){var y=f[v],S=Math.round(y.x*r),C=Math.round(y.y*r);y.x=W(S,$n,ii),y.y=W(C,$n,ii),(S<y.x||S>y.x+1||C<y.y||C>y.y+1)&&ce("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return a}function mn(e,r){return{type:e.type,id:e.id,properties:e.properties,geometry:r?rn(e):[]}}function Di(e,r,a,h,f){e.emplaceBack(2*r+(h+1)/2,2*a+(f+1)/2)}var fi=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Qo,this.indexArray=new go,this.segments=new X,this.programConfigurations=new Ot(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function bo(e,r){for(var a=0;a<e.length;a++)if(Oa(r,e[a]))return!0;for(var h=0;h<r.length;h++)if(Oa(e,r[h]))return!0;return!!El(e,r)}function _i(e,r,a){return!!Oa(e,r)||!!xo(r,e,a)}function _a(e,r){if(e.length===1)return Pl(r,e[0]);for(var a=0;a<r.length;a++)for(var h=r[a],f=0;f<h.length;f++)if(Oa(e,h[f]))return!0;for(var v=0;v<e.length;v++)if(Pl(r,e[v]))return!0;for(var y=0;y<r.length;y++)if(El(e,r[y]))return!0;return!1}function la(e,r,a){if(e.length>1){if(El(e,r))return!0;for(var h=0;h<r.length;h++)if(xo(r[h],e,a))return!0}for(var f=0;f<e.length;f++)if(xo(e[f],r,a))return!0;return!1}function El(e,r){if(e.length===0||r.length===0)return!1;for(var a=0;a<e.length-1;a++)for(var h=e[a],f=e[a+1],v=0;v<r.length-1;v++)if(Ds(h,f,r[v],r[v+1]))return!0;return!1}function Ds(e,r,a,h){return Pe(e,a,h)!==Pe(r,a,h)&&Pe(e,r,a)!==Pe(e,r,h)}function xo(e,r,a){var h=a*a;if(r.length===1)return e.distSqr(r[0])<h;for(var f=1;f<r.length;f++)if(Ls(e,r[f-1],r[f])<h)return!0;return!1}function Ls(e,r,a){var h=r.distSqr(a);if(h===0)return e.distSqr(r);var f=((e.x-r.x)*(a.x-r.x)+(e.y-r.y)*(a.y-r.y))/h;return e.distSqr(f<0?r:f>1?a:a.sub(r)._mult(f)._add(r))}function Pl(e,r){for(var a,h,f,v=!1,y=0;y<e.length;y++)for(var S=0,C=(a=e[y]).length-1;S<a.length;C=S++)(h=a[S]).y>r.y!=(f=a[C]).y>r.y&&r.x<(f.x-h.x)*(r.y-h.y)/(f.y-h.y)+h.x&&(v=!v);return v}function Oa(e,r){for(var a=!1,h=0,f=e.length-1;h<e.length;f=h++){var v=e[h],y=e[f];v.y>r.y!=y.y>r.y&&r.x<(y.x-v.x)*(r.y-v.y)/(y.y-v.y)+v.x&&(a=!a)}return a}function Tl(e,r,a){var h=a[0],f=a[2];if(e.x<h.x&&r.x<h.x||e.x>f.x&&r.x>f.x||e.y<h.y&&r.y<h.y||e.y>f.y&&r.y>f.y)return!1;var v=Pe(e,r,a[0]);return v!==Pe(e,r,a[1])||v!==Pe(e,r,a[2])||v!==Pe(e,r,a[3])}function Ra(e,r,a){var h=r.paint.get(e).value;return h.kind==="constant"?h.value:a.programConfigurations.get(r.id).getMaxValue(e)}function zn(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function $a(e,r,a,h,f){if(!r[0]&&!r[1])return e;var v=T.convert(r)._mult(f);a==="viewport"&&v._rotate(-h);for(var y=[],S=0;S<e.length;S++)y.push(e[S].sub(v));return y}fi.prototype.populate=function(e,r,a){var h=this.layers[0],f=[],v=null;h.type==="circle"&&(v=h.layout.get("circle-sort-key"));for(var y=0,S=e;y<S.length;y+=1){var C=S[y],O=C.feature,k=C.id,L=C.index,U=C.sourceLayerIndex,$=this.layers[0]._featureFilter.needGeometry,oe=mn(O,$);if(this.layers[0]._featureFilter.filter(new ir(this.zoom),oe,a)){var le=v?v.evaluate(oe,{},a):void 0,_e={id:k,properties:O.properties,type:O.type,sourceLayerIndex:U,index:L,geometry:$?oe.geometry:rn(O),patterns:{},sortKey:le};f.push(_e)}}v&&f.sort(function(Qe,vt){return Qe.sortKey-vt.sortKey});for(var fe=0,Te=f;fe<Te.length;fe+=1){var Me=Te[fe],Re=Me.geometry,Le=Me.index,Ve=Me.sourceLayerIndex,Ze=e[Le].feature;this.addFeature(Me,Re,Le,a),r.featureIndex.insert(Ze,Re,Le,Ve,this.index)}},fi.prototype.update=function(e,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a)},fi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},fi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},fi.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Z),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},fi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},fi.prototype.addFeature=function(e,r,a,h){for(var f=0,v=r;f<v.length;f+=1)for(var y=0,S=v[f];y<S.length;y+=1){var C=S[y],O=C.x,k=C.y;if(!(O<0||O>=8192||k<0||k>=8192)){var L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),U=L.vertexLength;Di(this.layoutVertexArray,O,k,-1,-1),Di(this.layoutVertexArray,O,k,1,-1),Di(this.layoutVertexArray,O,k,1,1),Di(this.layoutVertexArray,O,k,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+3,U+2),L.vertexLength+=4,L.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},h)},ut("CircleBucket",fi,{omit:["layers"]});var wo=new ti({"circle-sort-key":new pt(G.layout_circle["circle-sort-key"])}),ts={paint:new ti({"circle-radius":new pt(G.paint_circle["circle-radius"]),"circle-color":new pt(G.paint_circle["circle-color"]),"circle-blur":new pt(G.paint_circle["circle-blur"]),"circle-opacity":new pt(G.paint_circle["circle-opacity"]),"circle-translate":new _t(G.paint_circle["circle-translate"]),"circle-translate-anchor":new _t(G.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new _t(G.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new _t(G.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new pt(G.paint_circle["circle-stroke-width"]),"circle-stroke-color":new pt(G.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new pt(G.paint_circle["circle-stroke-opacity"])}),layout:wo},Sr=typeof Float32Array<"u"?Float32Array:Array;function $i(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function bi(e,r,a){var h=r[0],f=r[1],v=r[2],y=r[3],S=r[4],C=r[5],O=r[6],k=r[7],L=r[8],U=r[9],$=r[10],oe=r[11],le=r[12],_e=r[13],fe=r[14],Te=r[15],Me=a[0],Re=a[1],Le=a[2],Ve=a[3];return e[0]=Me*h+Re*S+Le*L+Ve*le,e[1]=Me*f+Re*C+Le*U+Ve*_e,e[2]=Me*v+Re*O+Le*$+Ve*fe,e[3]=Me*y+Re*k+Le*oe+Ve*Te,e[4]=(Me=a[4])*h+(Re=a[5])*S+(Le=a[6])*L+(Ve=a[7])*le,e[5]=Me*f+Re*C+Le*U+Ve*_e,e[6]=Me*v+Re*O+Le*$+Ve*fe,e[7]=Me*y+Re*k+Le*oe+Ve*Te,e[8]=(Me=a[8])*h+(Re=a[9])*S+(Le=a[10])*L+(Ve=a[11])*le,e[9]=Me*f+Re*C+Le*U+Ve*_e,e[10]=Me*v+Re*O+Le*$+Ve*fe,e[11]=Me*y+Re*k+Le*oe+Ve*Te,e[12]=(Me=a[12])*h+(Re=a[13])*S+(Le=a[14])*L+(Ve=a[15])*le,e[13]=Me*f+Re*C+Le*U+Ve*_e,e[14]=Me*v+Re*O+Le*$+Ve*fe,e[15]=Me*y+Re*k+Le*oe+Ve*Te,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,r=0,a=arguments.length;a--;)r+=e[a]*e[a];return Math.sqrt(r)});var rs,Rm=bi;function ju(e,r,a){var h=r[0],f=r[1],v=r[2],y=r[3];return e[0]=a[0]*h+a[4]*f+a[8]*v+a[12]*y,e[1]=a[1]*h+a[5]*f+a[9]*v+a[13]*y,e[2]=a[2]*h+a[6]*f+a[10]*v+a[14]*y,e[3]=a[3]*h+a[7]*f+a[11]*v+a[15]*y,e}rs=new Sr(3),Sr!=Float32Array&&(rs[0]=0,rs[1]=0,rs[2]=0),function(){var e=new Sr(4);Sr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Am=(function(){var e=new Sr(2);Sr!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function r(a){e.call(this,a,ts)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.createBucket=function(a){return new fi(a)},r.prototype.queryRadius=function(a){var h=a;return Ra("circle-radius",this,h)+Ra("circle-stroke-width",this,h)+zn(this.paint.get("circle-translate"))},r.prototype.queryIntersectsFeature=function(a,h,f,v,y,S,C,O){for(var k=$a(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),S.angle,C),L=this.paint.get("circle-radius").evaluate(h,f)+this.paint.get("circle-stroke-width").evaluate(h,f),U=this.paint.get("circle-pitch-alignment")==="map",$=U?k:function(Ze,Qe){return Ze.map(function(vt){return Cl(vt,Qe)})}(k,O),oe=U?L*C:L,le=0,_e=v;le<_e.length;le+=1)for(var fe=0,Te=_e[le];fe<Te.length;fe+=1){var Me=Te[fe],Re=U?Me:Cl(Me,O),Le=oe,Ve=ju([],[Me.x,Me.y,0,1],O);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Le*=Ve[3]/S.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Le*=S.cameraToCenterDistance/Ve[3]),_i($,Re,Le))return!0}return!1},r}(Ia));function Cl(e,r){var a=ju([],[e.x,e.y,0,1],r);return new T(a[0]/a[3],a[1]/a[3])}var dd=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r}(fi);function zs(e,r,a,h){var f=r.width,v=r.height;if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==f*v*a)throw new RangeError("mismatched image size")}else h=new Uint8Array(f*v*a);return e.width=f,e.height=v,e.data=h,e}function Nu(e,r,a){var h=r.width,f=r.height;if(h!==e.width||f!==e.height){var v=zs({},{width:h,height:f},a);km(e,v,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,h),height:Math.min(e.height,f)},a),e.width=h,e.height=f,e.data=v.data}}function km(e,r,a,h,f,v){if(f.width===0||f.height===0)return r;if(f.width>e.width||f.height>e.height||a.x>e.width-f.width||a.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>r.width||f.height>r.height||h.x>r.width-f.width||h.y>r.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var y=e.data,S=r.data,C=0;C<f.height;C++)for(var O=((a.y+C)*e.width+a.x)*v,k=((h.y+C)*r.width+h.x)*v,L=0;L<f.width*v;L++)S[k+L]=y[O+L];return r}ut("HeatmapBucket",dd,{omit:["layers"]});var Il=function(e,r){zs(this,e,1,r)};Il.prototype.resize=function(e){Nu(this,e,1)},Il.prototype.clone=function(){return new Il({width:this.width,height:this.height},new Uint8Array(this.data))},Il.copy=function(e,r,a,h,f){km(e,r,a,h,f,1)};var Li=function(e,r){zs(this,e,4,r)};Li.prototype.resize=function(e){Nu(this,e,4)},Li.prototype.replace=function(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Li.prototype.clone=function(){return new Li({width:this.width,height:this.height},new Uint8Array(this.data))},Li.copy=function(e,r,a,h,f){km(e,r,a,h,f,4)},ut("AlphaImage",Il),ut("RGBAImage",Li);var zP={paint:new ti({"heatmap-radius":new pt(G.paint_heatmap["heatmap-radius"]),"heatmap-weight":new pt(G.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new _t(G.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ya(G.paint_heatmap["heatmap-color"]),"heatmap-opacity":new _t(G.paint_heatmap["heatmap-opacity"])})};function d_(e){var r={},a=e.resolution||256,h=e.clips?e.clips.length:1,f=e.image||new Li({width:a,height:h}),v=function(oe,le,_e){r[e.evaluationKey]=_e;var fe=e.expression.evaluate(r);f.data[oe+le+0]=Math.floor(255*fe.r/fe.a),f.data[oe+le+1]=Math.floor(255*fe.g/fe.a),f.data[oe+le+2]=Math.floor(255*fe.b/fe.a),f.data[oe+le+3]=Math.floor(255*fe.a)};if(e.clips)for(var y=0,S=0;y<h;++y,S+=4*a)for(var C=0,O=0;C<a;C++,O+=4){var k=C/(a-1),L=e.clips[y];v(S,O,L.start*(1-k)+L.end*k)}else for(var U=0,$=0;U<a;U++,$+=4)v(0,$,U/(a-1));return f}var jP=function(e){function r(a){e.call(this,a,zP),this._updateColorRamp()}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.createBucket=function(a){return new dd(a)},r.prototype._handleSpecialPaintPropertyUpdate=function(a){a==="heatmap-color"&&this._updateColorRamp()},r.prototype._updateColorRamp=function(){this.colorRamp=d_({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},r.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},r.prototype.queryRadius=function(){return 0},r.prototype.queryIntersectsFeature=function(){return!1},r.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},r}(Ia),NP={paint:new ti({"hillshade-illumination-direction":new _t(G.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new _t(G.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new _t(G.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new _t(G.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new _t(G.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new _t(G.paint_hillshade["hillshade-accent-color"])})},BP=function(e){function r(a){e.call(this,a,NP)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},r}(Ia),FP=qn([{name:"a_pos",components:2,type:"Int16"}],4).members,Dm=fd,UP=fd;function fd(e,r,a){a=a||2;var h,f,v,y,S,C,O,k=r&&r.length,L=k?r[0]*a:e.length,U=f_(e,0,L,a,!0),$=[];if(!U||U.next===U.prev)return $;if(k&&(U=function(le,_e,fe,Te){var Me,Re,Le,Ve=[];for(Me=0,Re=_e.length;Me<Re;Me++)(Le=f_(le,_e[Me]*Te,Me<Re-1?_e[Me+1]*Te:le.length,Te,!1))===Le.next&&(Le.steiner=!0),Ve.push(XP(Le));for(Ve.sort(HP),Me=0;Me<Ve.length;Me++)ZP(Ve[Me],fe),fe=js(fe,fe.next);return fe}(e,r,U,a)),e.length>80*a){h=v=e[0],f=y=e[1];for(var oe=a;oe<L;oe+=a)(S=e[oe])<h&&(h=S),(C=e[oe+1])<f&&(f=C),S>v&&(v=S),C>y&&(y=C);O=(O=Math.max(v-h,y-f))!==0?1/O:0}return pp(U,$,a,h,f,O),$}function f_(e,r,a,h,f){var v,y;if(f===jm(e,r,a,h)>0)for(v=r;v<a;v+=h)y=g_(v,e[v],e[v+1],y);else for(v=a-h;v>=r;v-=h)y=g_(v,e[v],e[v+1],y);return y&&md(y,y.next)&&(dp(y),y=y.next),y}function js(e,r){if(!e)return e;r||(r=e);var a,h=e;do if(a=!1,h.steiner||!md(h,h.next)&&On(h.prev,h,h.next)!==0)h=h.next;else{if(dp(h),(h=r=h.prev)===h.next)break;a=!0}while(a||h!==r);return r}function pp(e,r,a,h,f,v,y){if(e){!y&&v&&function(k,L,U,$){var oe=k;do oe.z===null&&(oe.z=Lm(oe.x,oe.y,L,U,$)),oe.prevZ=oe.prev,oe.nextZ=oe.next,oe=oe.next;while(oe!==k);oe.prevZ.nextZ=null,oe.prevZ=null,function(le){var _e,fe,Te,Me,Re,Le,Ve,Ze,Qe=1;do{for(fe=le,le=null,Re=null,Le=0;fe;){for(Le++,Te=fe,Ve=0,_e=0;_e<Qe&&(Ve++,Te=Te.nextZ);_e++);for(Ze=Qe;Ve>0||Ze>0&&Te;)Ve!==0&&(Ze===0||!Te||fe.z<=Te.z)?(Me=fe,fe=fe.nextZ,Ve--):(Me=Te,Te=Te.nextZ,Ze--),Re?Re.nextZ=Me:le=Me,Me.prevZ=Re,Re=Me;fe=Te}Re.nextZ=null,Qe*=2}while(Le>1)}(oe)}(e,h,f,v);for(var S,C,O=e;e.prev!==e.next;)if(S=e.prev,C=e.next,v?qP(e,h,f,v):VP(e))r.push(S.i/a),r.push(e.i/a),r.push(C.i/a),dp(e),e=C.next,O=C.next;else if((e=C)===O){y?y===1?pp(e=$P(js(e),r,a),r,a,h,f,v,2):y===2&&WP(e,r,a,h,f,v):pp(js(e),r,a,h,f,v,1);break}}}function VP(e){var r=e.prev,a=e,h=e.next;if(On(r,a,h)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(Bu(r.x,r.y,a.x,a.y,h.x,h.y,f.x,f.y)&&On(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function qP(e,r,a,h){var f=e.prev,v=e,y=e.next;if(On(f,v,y)>=0)return!1;for(var S=f.x>v.x?f.x>y.x?f.x:y.x:v.x>y.x?v.x:y.x,C=f.y>v.y?f.y>y.y?f.y:y.y:v.y>y.y?v.y:y.y,O=Lm(f.x<v.x?f.x<y.x?f.x:y.x:v.x<y.x?v.x:y.x,f.y<v.y?f.y<y.y?f.y:y.y:v.y<y.y?v.y:y.y,r,a,h),k=Lm(S,C,r,a,h),L=e.prevZ,U=e.nextZ;L&&L.z>=O&&U&&U.z<=k;){if(L!==e.prev&&L!==e.next&&Bu(f.x,f.y,v.x,v.y,y.x,y.y,L.x,L.y)&&On(L.prev,L,L.next)>=0||(L=L.prevZ,U!==e.prev&&U!==e.next&&Bu(f.x,f.y,v.x,v.y,y.x,y.y,U.x,U.y)&&On(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;L&&L.z>=O;){if(L!==e.prev&&L!==e.next&&Bu(f.x,f.y,v.x,v.y,y.x,y.y,L.x,L.y)&&On(L.prev,L,L.next)>=0)return!1;L=L.prevZ}for(;U&&U.z<=k;){if(U!==e.prev&&U!==e.next&&Bu(f.x,f.y,v.x,v.y,y.x,y.y,U.x,U.y)&&On(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function $P(e,r,a){var h=e;do{var f=h.prev,v=h.next.next;!md(f,v)&&m_(f,h,h.next,v)&&hp(f,v)&&hp(v,f)&&(r.push(f.i/a),r.push(h.i/a),r.push(v.i/a),dp(h),dp(h.next),h=e=v),h=h.next}while(h!==e);return js(h)}function WP(e,r,a,h,f,v){var y=e;do{for(var S=y.next.next;S!==y.prev;){if(y.i!==S.i&&KP(y,S)){var C=v_(y,S);return y=js(y,y.next),C=js(C,C.next),pp(y,r,a,h,f,v),void pp(C,r,a,h,f,v)}S=S.next}y=y.next}while(y!==e)}function HP(e,r){return e.x-r.x}function ZP(e,r){if(r=function(h,f){var v,y=f,S=h.x,C=h.y,O=-1/0;do{if(C<=y.y&&C>=y.next.y&&y.next.y!==y.y){var k=y.x+(C-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(k<=S&&k>O){if(O=k,k===S){if(C===y.y)return y;if(C===y.next.y)return y.next}v=y.x<y.next.x?y:y.next}}y=y.next}while(y!==f);if(!v)return null;if(S===O)return v;var L,U=v,$=v.x,oe=v.y,le=1/0;y=v;do S>=y.x&&y.x>=$&&S!==y.x&&Bu(C<oe?S:O,C,$,oe,C<oe?O:S,C,y.x,y.y)&&(L=Math.abs(C-y.y)/(S-y.x),hp(y,h)&&(L<le||L===le&&(y.x>v.x||y.x===v.x&&GP(v,y)))&&(v=y,le=L)),y=y.next;while(y!==U);return v}(e,r)){var a=v_(r,e);js(r,r.next),js(a,a.next)}}function GP(e,r){return On(e.prev,e,r.prev)<0&&On(r.next,e,e.next)<0}function Lm(e,r,a,h,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-a)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-h)*f)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function XP(e){var r=e,a=e;do(r.x<a.x||r.x===a.x&&r.y<a.y)&&(a=r),r=r.next;while(r!==e);return a}function Bu(e,r,a,h,f,v,y,S){return(f-y)*(r-S)-(e-y)*(v-S)>=0&&(e-y)*(h-S)-(a-y)*(r-S)>=0&&(a-y)*(v-S)-(f-y)*(h-S)>=0}function KP(e,r){return e.next.i!==r.i&&e.prev.i!==r.i&&!function(a,h){var f=a;do{if(f.i!==a.i&&f.next.i!==a.i&&f.i!==h.i&&f.next.i!==h.i&&m_(f,f.next,a,h))return!0;f=f.next}while(f!==a);return!1}(e,r)&&(hp(e,r)&&hp(r,e)&&function(a,h){var f=a,v=!1,y=(a.x+h.x)/2,S=(a.y+h.y)/2;do f.y>S!=f.next.y>S&&f.next.y!==f.y&&y<(f.next.x-f.x)*(S-f.y)/(f.next.y-f.y)+f.x&&(v=!v),f=f.next;while(f!==a);return v}(e,r)&&(On(e.prev,e,r.prev)||On(e,r.prev,r))||md(e,r)&&On(e.prev,e,e.next)>0&&On(r.prev,r,r.next)>0)}function On(e,r,a){return(r.y-e.y)*(a.x-r.x)-(r.x-e.x)*(a.y-r.y)}function md(e,r){return e.x===r.x&&e.y===r.y}function m_(e,r,a,h){var f=gd(On(e,r,a)),v=gd(On(e,r,h)),y=gd(On(a,h,e)),S=gd(On(a,h,r));return f!==v&&y!==S||!(f!==0||!vd(e,a,r))||!(v!==0||!vd(e,h,r))||!(y!==0||!vd(a,e,h))||!(S!==0||!vd(a,r,h))}function vd(e,r,a){return r.x<=Math.max(e.x,a.x)&&r.x>=Math.min(e.x,a.x)&&r.y<=Math.max(e.y,a.y)&&r.y>=Math.min(e.y,a.y)}function gd(e){return e>0?1:e<0?-1:0}function hp(e,r){return On(e.prev,e,e.next)<0?On(e,r,e.next)>=0&&On(e,e.prev,r)>=0:On(e,r,e.prev)<0||On(e,e.next,r)<0}function v_(e,r){var a=new zm(e.i,e.x,e.y),h=new zm(r.i,r.x,r.y),f=e.next,v=r.prev;return e.next=r,r.prev=e,a.next=f,f.prev=a,h.next=a,a.prev=h,v.next=h,h.prev=v,h}function g_(e,r,a,h){var f=new zm(e,r,a);return h?(f.next=h.next,f.prev=h,h.next.prev=f,h.next=f):(f.prev=f,f.next=f),f}function dp(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function zm(e,r,a){this.i=e,this.x=r,this.y=a,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function jm(e,r,a,h){for(var f=0,v=r,y=a-h;v<a;v+=h)f+=(e[y]-e[v])*(e[v+1]+e[y+1]),y=v;return f}function YP(e,r,a,h,f){(function v(y,S,C,O,k){for(;O>C;){if(O-C>600){var L=O-C+1,U=S-C+1,$=Math.log(L),oe=.5*Math.exp(2*$/3),le=.5*Math.sqrt($*oe*(L-oe)/L)*(U-L/2<0?-1:1);v(y,S,Math.max(C,Math.floor(S-U*oe/L+le)),Math.min(O,Math.floor(S+(L-U)*oe/L+le)),k)}var _e=y[S],fe=C,Te=O;for(fp(y,C,S),k(y[O],_e)>0&&fp(y,C,O);fe<Te;){for(fp(y,fe,Te),fe++,Te--;k(y[fe],_e)<0;)fe++;for(;k(y[Te],_e)>0;)Te--}k(y[C],_e)===0?fp(y,C,Te):fp(y,++Te,O),Te<=S&&(C=Te+1),S<=Te&&(O=Te-1)}})(e,r,a,h||e.length-1,f||JP)}function fp(e,r,a){var h=e[r];e[r]=e[a],e[a]=h}function JP(e,r){return e<r?-1:e>r?1:0}function Nm(e,r){var a=e.length;if(a<=1)return[e];for(var h,f,v=[],y=0;y<a;y++){var S=gt(e[y]);S!==0&&(e[y].area=Math.abs(S),f===void 0&&(f=S<0),f===S<0?(h&&v.push(h),h=[e[y]]):h.push(e[y]))}if(h&&v.push(h),r>1)for(var C=0;C<v.length;C++)v[C].length<=r||(YP(v[C],r,1,v[C].length-1,QP),v[C]=v[C].slice(0,r));return v}function QP(e,r){return r.area-e.area}function Bm(e,r,a){for(var h=a.patternDependencies,f=!1,v=0,y=r;v<y.length;v+=1){var S=y[v].paint.get(e+"-pattern");S.isConstant()||(f=!0);var C=S.constantOr(null);C&&(f=!0,h[C.to]=!0,h[C.from]=!0)}return f}function Fm(e,r,a,h,f){for(var v=f.patternDependencies,y=0,S=r;y<S.length;y+=1){var C=S[y],O=C.paint.get(e+"-pattern").value;if(O.kind!=="constant"){var k=O.evaluate({zoom:h-1},a,{},f.availableImages),L=O.evaluate({zoom:h},a,{},f.availableImages),U=O.evaluate({zoom:h+1},a,{},f.availableImages);L=L&&L.name?L.name:L,U=U&&U.name?U.name:U,v[k=k&&k.name?k.name:k]=!0,v[L]=!0,v[U]=!0,a.patterns[C.id]={min:k,mid:L,max:U}}}return a}fd.deviation=function(e,r,a,h){var f=r&&r.length,v=Math.abs(jm(e,0,f?r[0]*a:e.length,a));if(f)for(var y=0,S=r.length;y<S;y++)v-=Math.abs(jm(e,r[y]*a,y<S-1?r[y+1]*a:e.length,a));var C=0;for(y=0;y<h.length;y+=3){var O=h[y]*a,k=h[y+1]*a,L=h[y+2]*a;C+=Math.abs((e[O]-e[L])*(e[k+1]-e[O+1])-(e[O]-e[k])*(e[L+1]-e[O+1]))}return v===0&&C===0?0:Math.abs((C-v)/v)},fd.flatten=function(e){for(var r=e[0][0].length,a={vertices:[],holes:[],dimensions:r},h=0,f=0;f<e.length;f++){for(var v=0;v<e[f].length;v++)for(var y=0;y<r;y++)a.vertices.push(e[f][v][y]);f>0&&a.holes.push(h+=e[f-1].length)}return a},Dm.default=UP;var Wa=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Qo,this.indexArray=new go,this.indexArray2=new Sl,this.programConfigurations=new Ot(e.layers,e.zoom),this.segments=new X,this.segments2=new X,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Wa.prototype.populate=function(e,r,a){this.hasPattern=Bm("fill",this.layers,r);for(var h=this.layers[0].layout.get("fill-sort-key"),f=[],v=0,y=e;v<y.length;v+=1){var S=y[v],C=S.feature,O=S.id,k=S.index,L=S.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,$=mn(C,U);if(this.layers[0]._featureFilter.filter(new ir(this.zoom),$,a)){var oe=h?h.evaluate($,{},a,r.availableImages):void 0,le={id:O,properties:C.properties,type:C.type,sourceLayerIndex:L,index:k,geometry:U?$.geometry:rn(C),patterns:{},sortKey:oe};f.push(le)}}h&&f.sort(function(Ze,Qe){return Ze.sortKey-Qe.sortKey});for(var _e=0,fe=f;_e<fe.length;_e+=1){var Te=fe[_e],Me=Te.geometry,Re=Te.index,Le=Te.sourceLayerIndex;if(this.hasPattern){var Ve=Fm("fill",this.layers,Te,this.zoom,r);this.patternFeatures.push(Ve)}else this.addFeature(Te,Me,Re,a,{});r.featureIndex.insert(e[Re].feature,Me,Re,Le,this.index)}},Wa.prototype.update=function(e,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a)},Wa.prototype.addFeatures=function(e,r,a){for(var h=0,f=this.patternFeatures;h<f.length;h+=1){var v=f[h];this.addFeature(v,v.geometry,v.index,r,a)}},Wa.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Wa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Wa.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,FP),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Wa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Wa.prototype.addFeature=function(e,r,a,h,f){for(var v=0,y=Nm(r,500);v<y.length;v+=1){for(var S=y[v],C=0,O=0,k=S;O<k.length;O+=1)C+=k[O].length;for(var L=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray),U=L.vertexLength,$=[],oe=[],le=0,_e=S;le<_e.length;le+=1){var fe=_e[le];if(fe.length!==0){fe!==S[0]&&oe.push($.length/2);var Te=this.segments2.prepareSegment(fe.length,this.layoutVertexArray,this.indexArray2),Me=Te.vertexLength;this.layoutVertexArray.emplaceBack(fe[0].x,fe[0].y),this.indexArray2.emplaceBack(Me+fe.length-1,Me),$.push(fe[0].x),$.push(fe[0].y);for(var Re=1;Re<fe.length;Re++)this.layoutVertexArray.emplaceBack(fe[Re].x,fe[Re].y),this.indexArray2.emplaceBack(Me+Re-1,Me+Re),$.push(fe[Re].x),$.push(fe[Re].y);Te.vertexLength+=fe.length,Te.primitiveLength+=fe.length}}for(var Le=Dm($,oe),Ve=0;Ve<Le.length;Ve+=3)this.indexArray.emplaceBack(U+Le[Ve],U+Le[Ve+1],U+Le[Ve+2]);L.vertexLength+=C,L.primitiveLength+=Le.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,f,h)},ut("FillBucket",Wa,{omit:["layers","patternFeatures"]});var eT=new ti({"fill-sort-key":new pt(G.layout_fill["fill-sort-key"])}),tT={paint:new ti({"fill-antialias":new _t(G.paint_fill["fill-antialias"]),"fill-opacity":new pt(G.paint_fill["fill-opacity"]),"fill-color":new pt(G.paint_fill["fill-color"]),"fill-outline-color":new pt(G.paint_fill["fill-outline-color"]),"fill-translate":new _t(G.paint_fill["fill-translate"]),"fill-translate-anchor":new _t(G.paint_fill["fill-translate-anchor"]),"fill-pattern":new Au(G.paint_fill["fill-pattern"])}),layout:eT},rT=function(e){function r(a){e.call(this,a,tT)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.recalculate=function(a,h){e.prototype.recalculate.call(this,a,h);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},r.prototype.createBucket=function(a){return new Wa(a)},r.prototype.queryRadius=function(){return zn(this.paint.get("fill-translate"))},r.prototype.queryIntersectsFeature=function(a,h,f,v,y,S,C){return _a($a(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),S.angle,C),v)},r.prototype.isTileClipped=function(){return!0},r}(Ia),nT=qn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,y_=Fu;function Fu(e,r,a,h,f){this.properties={},this.extent=a,this.type=0,this._pbf=e,this._geometry=-1,this._keys=h,this._values=f,e.readFields(iT,this,r)}function iT(e,r,a){e==1?r.id=a.readVarint():e==2?function(h,f){for(var v=h.readVarint()+h.pos;h.pos<v;){var y=f._keys[h.readVarint()],S=f._values[h.readVarint()];f.properties[y]=S}}(a,r):e==3?r.type=a.readVarint():e==4&&(r._geometry=a.pos)}function aT(e){for(var r,a,h=0,f=0,v=e.length,y=v-1;f<v;y=f++)h+=((a=e[y]).x-(r=e[f]).x)*(r.y+a.y);return h}Fu.types=["Unknown","Point","LineString","Polygon"],Fu.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var r,a=e.readVarint()+e.pos,h=1,f=0,v=0,y=0,S=[];e.pos<a;){if(f<=0){var C=e.readVarint();h=7&C,f=C>>3}if(f--,h===1||h===2)v+=e.readSVarint(),y+=e.readSVarint(),h===1&&(r&&S.push(r),r=[]),r.push(new T(v,y));else{if(h!==7)throw new Error("unknown command "+h);r&&r.push(r[0].clone())}}return r&&S.push(r),S},Fu.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var r=e.readVarint()+e.pos,a=1,h=0,f=0,v=0,y=1/0,S=-1/0,C=1/0,O=-1/0;e.pos<r;){if(h<=0){var k=e.readVarint();a=7&k,h=k>>3}if(h--,a===1||a===2)(f+=e.readSVarint())<y&&(y=f),f>S&&(S=f),(v+=e.readSVarint())<C&&(C=v),v>O&&(O=v);else if(a!==7)throw new Error("unknown command "+a)}return[y,C,S,O]},Fu.prototype.toGeoJSON=function(e,r,a){var h,f,v=this.extent*Math.pow(2,a),y=this.extent*e,S=this.extent*r,C=this.loadGeometry(),O=Fu.types[this.type];function k($){for(var oe=0;oe<$.length;oe++){var le=$[oe];$[oe]=[360*(le.x+y)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(le.y+S)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var L=[];for(h=0;h<C.length;h++)L[h]=C[h][0];k(C=L);break;case 2:for(h=0;h<C.length;h++)k(C[h]);break;case 3:for(C=function($){var oe=$.length;if(oe<=1)return[$];for(var le,_e,fe=[],Te=0;Te<oe;Te++){var Me=aT($[Te]);Me!==0&&(_e===void 0&&(_e=Me<0),_e===Me<0?(le&&fe.push(le),le=[$[Te]]):le.push($[Te]))}return le&&fe.push(le),fe}(C),h=0;h<C.length;h++)for(f=0;f<C[h].length;f++)k(C[h][f])}C.length===1?C=C[0]:O="Multi"+O;var U={type:"Feature",geometry:{type:O,coordinates:C},properties:this.properties};return"id"in this&&(U.id=this.id),U};var __=b_;function b_(e,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(oT,this,r),this.length=this._features.length}function oT(e,r,a){e===15?r.version=a.readVarint():e===1?r.name=a.readString():e===5?r.extent=a.readVarint():e===2?r._features.push(a.pos):e===3?r._keys.push(a.readString()):e===4&&r._values.push(function(h){for(var f=null,v=h.readVarint()+h.pos;h.pos<v;){var y=h.readVarint()>>3;f=y===1?h.readString():y===2?h.readFloat():y===3?h.readDouble():y===4?h.readVarint64():y===5?h.readVarint():y===6?h.readSVarint():y===7?h.readBoolean():null}return f}(a))}function sT(e,r,a){if(e===3){var h=new __(a,a.readVarint()+a.pos);h.length&&(r[h.name]=h)}}b_.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var r=this._pbf.readVarint()+this._pbf.pos;return new y_(this._pbf,r,this.extent,this._keys,this._values)};var Uu={VectorTile:function(e,r){this.layers=e.readFields(sT,{},r)},VectorTileFeature:y_,VectorTileLayer:__},lT=Uu.VectorTileFeature.types,Um=Math.pow(2,13);function mp(e,r,a,h,f,v,y,S){e.emplaceBack(r,a,2*Math.floor(h*Um)+y,f*Um*2,v*Um*2,Math.round(S))}var Ha=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new qa,this.indexArray=new go,this.programConfigurations=new Ot(e.layers,e.zoom),this.segments=new X,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function uT(e,r){return e.x===r.x&&(e.x<0||e.x>8192)||e.y===r.y&&(e.y<0||e.y>8192)}Ha.prototype.populate=function(e,r,a){this.features=[],this.hasPattern=Bm("fill-extrusion",this.layers,r);for(var h=0,f=e;h<f.length;h+=1){var v=f[h],y=v.feature,S=v.id,C=v.index,O=v.sourceLayerIndex,k=this.layers[0]._featureFilter.needGeometry,L=mn(y,k);if(this.layers[0]._featureFilter.filter(new ir(this.zoom),L,a)){var U={id:S,sourceLayerIndex:O,index:C,geometry:k?L.geometry:rn(y),properties:y.properties,type:y.type,patterns:{}};this.hasPattern?this.features.push(Fm("fill-extrusion",this.layers,U,this.zoom,r)):this.addFeature(U,U.geometry,C,a,{}),r.featureIndex.insert(y,U.geometry,C,O,this.index,!0)}}},Ha.prototype.addFeatures=function(e,r,a){for(var h=0,f=this.features;h<f.length;h+=1){var v=f[h];this.addFeature(v,v.geometry,v.index,r,a)}},Ha.prototype.update=function(e,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a)},Ha.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ha.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ha.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,nT),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ha.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ha.prototype.addFeature=function(e,r,a,h,f){for(var v=0,y=Nm(r,500);v<y.length;v+=1){for(var S=y[v],C=0,O=0,k=S;O<k.length;O+=1)C+=k[O].length;for(var L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),U=0,$=S;U<$.length;U+=1){var oe=$[U];if(oe.length!==0&&!((rr=oe).every(function(Vt){return Vt.x<0})||rr.every(function(Vt){return Vt.x>8192})||rr.every(function(Vt){return Vt.y<0})||rr.every(function(Vt){return Vt.y>8192})))for(var le=0,_e=0;_e<oe.length;_e++){var fe=oe[_e];if(_e>=1){var Te=oe[_e-1];if(!uT(fe,Te)){L.vertexLength+4>X.MAX_VERTEX_ARRAY_LENGTH&&(L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Me=fe.sub(Te)._perp()._unit(),Re=Te.dist(fe);le+Re>32768&&(le=0),mp(this.layoutVertexArray,fe.x,fe.y,Me.x,Me.y,0,0,le),mp(this.layoutVertexArray,fe.x,fe.y,Me.x,Me.y,0,1,le),mp(this.layoutVertexArray,Te.x,Te.y,Me.x,Me.y,0,0,le+=Re),mp(this.layoutVertexArray,Te.x,Te.y,Me.x,Me.y,0,1,le);var Le=L.vertexLength;this.indexArray.emplaceBack(Le,Le+2,Le+1),this.indexArray.emplaceBack(Le+1,Le+2,Le+3),L.vertexLength+=4,L.primitiveLength+=2}}}}if(L.vertexLength+C>X.MAX_VERTEX_ARRAY_LENGTH&&(L=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray)),lT[e.type]==="Polygon"){for(var Ve=[],Ze=[],Qe=L.vertexLength,vt=0,nt=S;vt<nt.length;vt+=1){var xt=nt[vt];if(xt.length!==0){xt!==S[0]&&Ze.push(Ve.length/2);for(var it=0;it<xt.length;it++){var Xt=xt[it];mp(this.layoutVertexArray,Xt.x,Xt.y,0,0,1,1,0),Ve.push(Xt.x),Ve.push(Xt.y)}}}for(var Rt=Dm(Ve,Ze),ht=0;ht<Rt.length;ht+=3)this.indexArray.emplaceBack(Qe+Rt[ht],Qe+Rt[ht+2],Qe+Rt[ht+1]);L.primitiveLength+=Rt.length/3,L.vertexLength+=C}}var rr;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,f,h)},ut("FillExtrusionBucket",Ha,{omit:["layers","features"]});var cT={paint:new ti({"fill-extrusion-opacity":new _t(G["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new pt(G["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new _t(G["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new _t(G["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Au(G["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new pt(G["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new pt(G["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new _t(G["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},pT=function(e){function r(a){e.call(this,a,cT)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.createBucket=function(a){return new Ha(a)},r.prototype.queryRadius=function(){return zn(this.paint.get("fill-extrusion-translate"))},r.prototype.is3D=function(){return!0},r.prototype.queryIntersectsFeature=function(a,h,f,v,y,S,C,O){var k=$a(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),S.angle,C),L=this.paint.get("fill-extrusion-height").evaluate(h,f),U=this.paint.get("fill-extrusion-base").evaluate(h,f),$=function(le,_e,fe,Te){for(var Me=[],Re=0,Le=le;Re<Le.length;Re+=1){var Ve=Le[Re],Ze=[Ve.x,Ve.y,0,1];ju(Ze,Ze,_e),Me.push(new T(Ze[0]/Ze[3],Ze[1]/Ze[3]))}return Me}(k,O),oe=function(le,_e,fe,Te){for(var Me=[],Re=[],Le=Te[8]*_e,Ve=Te[9]*_e,Ze=Te[10]*_e,Qe=Te[11]*_e,vt=Te[8]*fe,nt=Te[9]*fe,xt=Te[10]*fe,it=Te[11]*fe,Xt=0,Rt=le;Xt<Rt.length;Xt+=1){for(var ht=[],rr=[],Vt=0,cr=Rt[Xt];Vt<cr.length;Vt+=1){var wt=cr[Vt],_r=wt.x,Kr=wt.y,un=Te[0]*_r+Te[4]*Kr+Te[12],nn=Te[1]*_r+Te[5]*Kr+Te[13],Yr=Te[2]*_r+Te[6]*Kr+Te[14],cn=Te[3]*_r+Te[7]*Kr+Te[15],jn=Yr+Ze,Nn=cn+Qe,vi=un+vt,Hn=nn+nt,gi=Yr+xt,vn=cn+it,Zn=new T((un+Le)/Nn,(nn+Ve)/Nn);Zn.z=jn/Nn,ht.push(Zn);var or=new T(vi/vn,Hn/vn);or.z=gi/vn,rr.push(or)}Me.push(ht),Re.push(rr)}return[Me,Re]}(v,U,L,O);return function(le,_e,fe){var Te=1/0;_a(fe,_e)&&(Te=x_(fe,_e[0]));for(var Me=0;Me<_e.length;Me++)for(var Re=_e[Me],Le=le[Me],Ve=0;Ve<Re.length-1;Ve++){var Ze=Re[Ve],Qe=[Ze,Re[Ve+1],Le[Ve+1],Le[Ve],Ze];bo(fe,Qe)&&(Te=Math.min(Te,x_(fe,Qe)))}return Te!==1/0&&Te}(oe[0],oe[1],$)},r}(Ia);function vp(e,r){return e.x*r.x+e.y*r.y}function x_(e,r){if(e.length===1){for(var a,h=0,f=r[h++];!a||f.equals(a);)if(!(a=r[h++]))return 1/0;for(;h<r.length;h++){var v=r[h],y=e[0],S=a.sub(f),C=v.sub(f),O=y.sub(f),k=vp(S,S),L=vp(S,C),U=vp(C,C),$=vp(O,S),oe=vp(O,C),le=k*U-L*L,_e=(U*$-L*oe)/le,fe=(k*oe-L*$)/le,Te=f.z*(1-_e-fe)+a.z*_e+v.z*fe;if(isFinite(Te))return Te}return 1/0}for(var Me=1/0,Re=0,Le=r;Re<Le.length;Re+=1)Me=Math.min(Me,Le[Re].z);return Me}var hT=qn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,dT=qn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,fT=Uu.VectorTileFeature.types,mT=Math.cos(Math.PI/180*37.5),w_=Math.pow(2,14)/.5,xi=function(e){var r=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(a){r.gradients[a.id]={}}),this.layoutVertexArray=new ki,this.layoutVertexArray2=new Rs,this.indexArray=new go,this.programConfigurations=new Ot(e.layers,e.zoom),this.segments=new X,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};xi.prototype.populate=function(e,r,a){this.hasPattern=Bm("line",this.layers,r);for(var h=this.layers[0].layout.get("line-sort-key"),f=[],v=0,y=e;v<y.length;v+=1){var S=y[v],C=S.feature,O=S.id,k=S.index,L=S.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,$=mn(C,U);if(this.layers[0]._featureFilter.filter(new ir(this.zoom),$,a)){var oe=h?h.evaluate($,{},a):void 0,le={id:O,properties:C.properties,type:C.type,sourceLayerIndex:L,index:k,geometry:U?$.geometry:rn(C),patterns:{},sortKey:oe};f.push(le)}}h&&f.sort(function(Ze,Qe){return Ze.sortKey-Qe.sortKey});for(var _e=0,fe=f;_e<fe.length;_e+=1){var Te=fe[_e],Me=Te.geometry,Re=Te.index,Le=Te.sourceLayerIndex;if(this.hasPattern){var Ve=Fm("line",this.layers,Te,this.zoom,r);this.patternFeatures.push(Ve)}else this.addFeature(Te,Me,Re,a,{});r.featureIndex.insert(e[Re].feature,Me,Re,Le,this.index)}},xi.prototype.update=function(e,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a)},xi.prototype.addFeatures=function(e,r,a){for(var h=0,f=this.patternFeatures;h<f.length;h+=1){var v=f[h];this.addFeature(v,v.geometry,v.index,r,a)}},xi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},xi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xi.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,dT)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,hT),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},xi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},xi.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},xi.prototype.addFeature=function(e,r,a,h,f){var v=this.layers[0].layout,y=v.get("line-join").evaluate(e,{}),S=v.get("line-cap"),C=v.get("line-miter-limit"),O=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var k=0,L=r;k<L.length;k+=1)this.addLine(L[k],e,y,S,C,O);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,f,h)},xi.prototype.addLine=function(e,r,a,h,f,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var y=0;y<e.length-1;y++)this.totalDistance+=e[y].dist(e[y+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var S=fT[r.type]==="Polygon",C=e.length;C>=2&&e[C-1].equals(e[C-2]);)C--;for(var O=0;O<C-1&&e[O].equals(e[O+1]);)O++;if(!(C<(S?3:2))){a==="bevel"&&(f=1.05);var k,L=this.overscaling<=16?122880/(512*this.overscaling):0,U=this.segments.prepareSegment(10*C,this.layoutVertexArray,this.indexArray),$=void 0,oe=void 0,le=void 0,_e=void 0;this.e1=this.e2=-1,S&&(_e=e[O].sub(k=e[C-2])._unit()._perp());for(var fe=O;fe<C;fe++)if(!(oe=fe===C-1?S?e[O+1]:void 0:e[fe+1])||!e[fe].equals(oe)){_e&&(le=_e),k&&($=k),k=e[fe],_e=oe?oe.sub(k)._unit()._perp():le;var Te=(le=le||_e).add(_e);Te.x===0&&Te.y===0||Te._unit();var Me=le.x*_e.x+le.y*_e.y,Re=Te.x*_e.x+Te.y*_e.y,Le=Re!==0?1/Re:1/0,Ve=2*Math.sqrt(2-2*Re),Ze=Re<mT&&$&&oe,Qe=le.x*_e.y-le.y*_e.x>0;if(Ze&&fe>O){var vt=k.dist($);if(vt>2*L){var nt=k.sub(k.sub($)._mult(L/vt)._round());this.updateDistance($,nt),this.addCurrentVertex(nt,le,0,0,U),$=nt}}var xt=$&&oe,it=xt?a:S?"butt":h;if(xt&&it==="round"&&(Le<v?it="miter":Le<=2&&(it="fakeround")),it==="miter"&&Le>f&&(it="bevel"),it==="bevel"&&(Le>2&&(it="flipbevel"),Le<f&&(it="miter")),$&&this.updateDistance($,k),it==="miter")Te._mult(Le),this.addCurrentVertex(k,Te,0,0,U);else if(it==="flipbevel"){if(Le>100)Te=_e.mult(-1);else{var Xt=Le*le.add(_e).mag()/le.sub(_e).mag();Te._perp()._mult(Xt*(Qe?-1:1))}this.addCurrentVertex(k,Te,0,0,U),this.addCurrentVertex(k,Te.mult(-1),0,0,U)}else if(it==="bevel"||it==="fakeround"){var Rt=-Math.sqrt(Le*Le-1),ht=Qe?Rt:0,rr=Qe?0:Rt;if($&&this.addCurrentVertex(k,le,ht,rr,U),it==="fakeround")for(var Vt=Math.round(180*Ve/Math.PI/20),cr=1;cr<Vt;cr++){var wt=cr/Vt;if(wt!==.5){var _r=wt-.5;wt+=wt*_r*(wt-1)*((1.0904+Me*(Me*(3.55645-1.43519*Me)-3.2452))*_r*_r+(.848013+Me*(.215638*Me-1.06021)))}var Kr=_e.sub(le)._mult(wt)._add(le)._unit()._mult(Qe?-1:1);this.addHalfVertex(k,Kr.x,Kr.y,!1,Qe,0,U)}oe&&this.addCurrentVertex(k,_e,-ht,-rr,U)}else if(it==="butt")this.addCurrentVertex(k,Te,0,0,U);else if(it==="square"){var un=$?1:-1;this.addCurrentVertex(k,Te,un,un,U)}else it==="round"&&($&&(this.addCurrentVertex(k,le,0,0,U),this.addCurrentVertex(k,le,1,1,U,!0)),oe&&(this.addCurrentVertex(k,_e,-1,-1,U,!0),this.addCurrentVertex(k,_e,0,0,U)));if(Ze&&fe<C-1){var nn=k.dist(oe);if(nn>2*L){var Yr=k.add(oe.sub(k)._mult(L/nn)._round());this.updateDistance(k,Yr),this.addCurrentVertex(Yr,_e,0,0,U),k=Yr}}}}},xi.prototype.addCurrentVertex=function(e,r,a,h,f,v){v===void 0&&(v=!1);var y=r.y*h-r.x,S=-r.y-r.x*h;this.addHalfVertex(e,r.x+r.y*a,r.y-r.x*a,v,!1,a,f),this.addHalfVertex(e,y,S,v,!0,-h,f),this.distance>w_/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,r,a,h,f,v))},xi.prototype.addHalfVertex=function(e,r,a,h,f,v,y){var S=.5*(this.lineClips?this.scaledDistance*(w_-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(h?1:0),(e.y<<1)+(f?1:0),Math.round(63*r)+128,Math.round(63*a)+128,1+(v===0?0:v<0?-1:1)|(63&S)<<2,S>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var C=y.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,C),y.primitiveLength++),f?this.e2=C:this.e1=C},xi.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},xi.prototype.updateDistance=function(e,r){this.distance+=e.dist(r),this.updateScaledDistance()},ut("LineBucket",xi,{omit:["layers","patternFeatures"]});var vT=new ti({"line-cap":new _t(G.layout_line["line-cap"]),"line-join":new pt(G.layout_line["line-join"]),"line-miter-limit":new _t(G.layout_line["line-miter-limit"]),"line-round-limit":new _t(G.layout_line["line-round-limit"]),"line-sort-key":new pt(G.layout_line["line-sort-key"])}),S_={paint:new ti({"line-opacity":new pt(G.paint_line["line-opacity"]),"line-color":new pt(G.paint_line["line-color"]),"line-translate":new _t(G.paint_line["line-translate"]),"line-translate-anchor":new _t(G.paint_line["line-translate-anchor"]),"line-width":new pt(G.paint_line["line-width"]),"line-gap-width":new pt(G.paint_line["line-gap-width"]),"line-offset":new pt(G.paint_line["line-offset"]),"line-blur":new pt(G.paint_line["line-blur"]),"line-dasharray":new di(G.paint_line["line-dasharray"]),"line-pattern":new Au(G.paint_line["line-pattern"]),"line-gradient":new ya(G.paint_line["line-gradient"])}),layout:vT},E_=new(function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.possiblyEvaluate=function(a,h){return h=new ir(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),e.prototype.possiblyEvaluate.call(this,a,h)},r.prototype.evaluate=function(a,h,f,v){return h=J({},h,{zoom:Math.floor(h.zoom)}),e.prototype.evaluate.call(this,a,h,f,v)},r}(pt))(S_.paint.properties["line-width"].specification);E_.useIntegerZoom=!0;var gT=function(e){function r(a){e.call(this,a,S_),this.gradientVersion=0}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._handleSpecialPaintPropertyUpdate=function(a){a==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ii,this.gradientVersion=(this.gradientVersion+1)%N)},r.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},r.prototype.recalculate=function(a,h){e.prototype.recalculate.call(this,a,h),this.paint._values["line-floorwidth"]=E_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)},r.prototype.createBucket=function(a){return new xi(a)},r.prototype.queryRadius=function(a){var h=a,f=P_(Ra("line-width",this,h),Ra("line-gap-width",this,h)),v=Ra("line-offset",this,h);return f/2+Math.abs(v)+zn(this.paint.get("line-translate"))},r.prototype.queryIntersectsFeature=function(a,h,f,v,y,S,C){var O=$a(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),S.angle,C),k=C/2*P_(this.paint.get("line-width").evaluate(h,f),this.paint.get("line-gap-width").evaluate(h,f)),L=this.paint.get("line-offset").evaluate(h,f);return L&&(v=function(U,$){for(var oe=[],le=new T(0,0),_e=0;_e<U.length;_e++){for(var fe=U[_e],Te=[],Me=0;Me<fe.length;Me++){var Re=fe[Me],Le=fe[Me+1],Ve=Me===0?le:Re.sub(fe[Me-1])._unit()._perp(),Ze=Me===fe.length-1?le:Le.sub(Re)._unit()._perp(),Qe=Ve._add(Ze)._unit();Qe._mult(1/(Qe.x*Ze.x+Qe.y*Ze.y)),Te.push(Qe._mult($)._add(Re))}oe.push(Te)}return oe}(v,L*C)),function(U,$,oe){for(var le=0;le<$.length;le++){var _e=$[le];if(U.length>=3){for(var fe=0;fe<_e.length;fe++)if(Oa(U,_e[fe]))return!0}if(la(U,_e,oe))return!0}return!1}(O,v,k)},r.prototype.isTileClipped=function(){return!0},r}(Ia);function P_(e,r){return r>0?r+2*e:e}var yT=qn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),_T=qn([{name:"a_projected_pos",components:3,type:"Float32"}],4),bT=(qn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),qn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),T_=(qn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),qn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),xT=qn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function wT(e,r,a){return e.sections.forEach(function(h){h.text=function(f,v,y){var S=v.layout.get("text-transform").evaluate(y,{});return S==="uppercase"?f=f.toLocaleUpperCase():S==="lowercase"&&(f=f.toLocaleLowerCase()),qi.applyArabicShaping&&(f=qi.applyArabicShaping(f)),f}(h.text,r,a)}),e}qn([{name:"triangle",components:3,type:"Uint16"}]),qn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),qn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),qn([{type:"Float32",name:"offsetX"}]),qn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var gp={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},C_=function(e,r,a,h,f){var v,y,S=8*f-h-1,C=(1<<S)-1,O=C>>1,k=-7,L=f-1,U=-1,$=e[r+L];for(L+=U,v=$&(1<<-k)-1,$>>=-k,k+=S;k>0;v=256*v+e[r+L],L+=U,k-=8);for(y=v&(1<<-k)-1,v>>=-k,k+=h;k>0;y=256*y+e[r+L],L+=U,k-=8);if(v===0)v=1-O;else{if(v===C)return y?NaN:1/0*($?-1:1);y+=Math.pow(2,h),v-=O}return($?-1:1)*y*Math.pow(2,v-h)},I_=function(e,r,a,h,f,v){var y,S,C,O=8*v-f-1,k=(1<<O)-1,L=k>>1,U=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=0,oe=1,le=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(S=isNaN(r)?1:0,y=k):(y=Math.floor(Math.log(r)/Math.LN2),r*(C=Math.pow(2,-y))<1&&(y--,C*=2),(r+=y+L>=1?U/C:U*Math.pow(2,1-L))*C>=2&&(y++,C/=2),y+L>=k?(S=0,y=k):y+L>=1?(S=(r*C-1)*Math.pow(2,f),y+=L):(S=r*Math.pow(2,L-1)*Math.pow(2,f),y=0));f>=8;e[a+$]=255&S,$+=oe,S/=256,f-=8);for(y=y<<f|S,O+=f;O>0;e[a+$]=255&y,$+=oe,y/=256,O-=8);e[a+$-oe]|=128*le},yd=qr;function qr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}qr.Varint=0,qr.Fixed64=1,qr.Bytes=2,qr.Fixed32=5;var M_=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ns(e){return e.type===qr.Bytes?e.readVarint()+e.pos:e.pos+1}function Vu(e,r,a){return a?4294967296*r+(e>>>0):4294967296*(r>>>0)+(e>>>0)}function O_(e,r,a){var h=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));a.realloc(h);for(var f=a.pos-1;f>=e;f--)a.buf[f+h]=a.buf[f]}function ST(e,r){for(var a=0;a<e.length;a++)r.writeVarint(e[a])}function ET(e,r){for(var a=0;a<e.length;a++)r.writeSVarint(e[a])}function PT(e,r){for(var a=0;a<e.length;a++)r.writeFloat(e[a])}function TT(e,r){for(var a=0;a<e.length;a++)r.writeDouble(e[a])}function CT(e,r){for(var a=0;a<e.length;a++)r.writeBoolean(e[a])}function IT(e,r){for(var a=0;a<e.length;a++)r.writeFixed32(e[a])}function MT(e,r){for(var a=0;a<e.length;a++)r.writeSFixed32(e[a])}function OT(e,r){for(var a=0;a<e.length;a++)r.writeFixed64(e[a])}function RT(e,r){for(var a=0;a<e.length;a++)r.writeSFixed64(e[a])}function _d(e,r){return(e[r]|e[r+1]<<8|e[r+2]<<16)+16777216*e[r+3]}function qu(e,r,a){e[a]=r,e[a+1]=r>>>8,e[a+2]=r>>>16,e[a+3]=r>>>24}function R_(e,r){return(e[r]|e[r+1]<<8|e[r+2]<<16)+(e[r+3]<<24)}function AT(e,r,a){e===1&&a.readMessage(kT,r)}function kT(e,r,a){if(e===3){var h=a.readMessage(DT,{}),f=h.width,v=h.height,y=h.left,S=h.top,C=h.advance;r.push({id:h.id,bitmap:new Il({width:f+6,height:v+6},h.bitmap),metrics:{width:f,height:v,left:y,top:S,advance:C}})}}function DT(e,r,a){e===1?r.id=a.readVarint():e===2?r.bitmap=a.readBytes():e===3?r.width=a.readVarint():e===4?r.height=a.readVarint():e===5?r.left=a.readSVarint():e===6?r.top=a.readSVarint():e===7&&(r.advance=a.readVarint())}function A_(e){for(var r=0,a=0,h=0,f=e;h<f.length;h+=1){var v=f[h];r+=v.w*v.h,a=Math.max(a,v.w)}e.sort(function(le,_e){return _e.h-le.h});for(var y=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),a),h:1/0}],S=0,C=0,O=0,k=e;O<k.length;O+=1)for(var L=k[O],U=y.length-1;U>=0;U--){var $=y[U];if(!(L.w>$.w||L.h>$.h)){if(L.x=$.x,L.y=$.y,C=Math.max(C,L.y+L.h),S=Math.max(S,L.x+L.w),L.w===$.w&&L.h===$.h){var oe=y.pop();U<y.length&&(y[U]=oe)}else L.h===$.h?($.x+=L.w,$.w-=L.w):L.w===$.w?($.y+=L.h,$.h-=L.h):(y.push({x:$.x+L.w,y:$.y,w:$.w-L.w,h:L.h}),$.y+=L.h,$.h-=L.h);break}}return{w:S,h:C,fill:r/(S*C)||0}}qr.prototype={destroy:function(){this.buf=null},readFields:function(e,r,a){for(a=a||this.length;this.pos<a;){var h=this.readVarint(),f=h>>3,v=this.pos;this.type=7&h,e(f,r,this),this.pos===v&&this.skip(h)}return r},readMessage:function(e,r){return this.readFields(e,r,this.readVarint()+this.pos)},readFixed32:function(){var e=_d(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=R_(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=_d(this.buf,this.pos)+4294967296*_d(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=_d(this.buf,this.pos)+4294967296*R_(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=C_(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=C_(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var r,a,h=this.buf;return r=127&(a=h[this.pos++]),a<128?r:(r|=(127&(a=h[this.pos++]))<<7,a<128?r:(r|=(127&(a=h[this.pos++]))<<14,a<128?r:(r|=(127&(a=h[this.pos++]))<<21,a<128?r:function(f,v,y){var S,C,O=y.buf;if(S=(112&(C=O[y.pos++]))>>4,C<128||(S|=(127&(C=O[y.pos++]))<<3,C<128)||(S|=(127&(C=O[y.pos++]))<<10,C<128)||(S|=(127&(C=O[y.pos++]))<<17,C<128)||(S|=(127&(C=O[y.pos++]))<<24,C<128)||(S|=(1&(C=O[y.pos++]))<<31,C<128))return Vu(f,S,v);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(a=h[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,r=this.pos;return this.pos=e,e-r>=12&&M_?function(a,h,f){return M_.decode(a.subarray(h,f))}(this.buf,r,e):function(a,h,f){for(var v="",y=h;y<f;){var S,C,O,k=a[y],L=null,U=k>239?4:k>223?3:k>191?2:1;if(y+U>f)break;U===1?k<128&&(L=k):U===2?(192&(S=a[y+1]))==128&&(L=(31&k)<<6|63&S)<=127&&(L=null):U===3?(C=a[y+2],(192&(S=a[y+1]))==128&&(192&C)==128&&((L=(15&k)<<12|(63&S)<<6|63&C)<=2047||L>=55296&&L<=57343)&&(L=null)):U===4&&(C=a[y+2],O=a[y+3],(192&(S=a[y+1]))==128&&(192&C)==128&&(192&O)==128&&((L=(15&k)<<18|(63&S)<<12|(63&C)<<6|63&O)<=65535||L>=1114112)&&(L=null)),L===null?(L=65533,U=1):L>65535&&(L-=65536,v+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),v+=String.fromCharCode(L),y+=U}return v}(this.buf,r,e)},readBytes:function(){var e=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,e);return this.pos=e,r},readPackedVarint:function(e,r){if(this.type!==qr.Bytes)return e.push(this.readVarint(r));var a=ns(this);for(e=e||[];this.pos<a;)e.push(this.readVarint(r));return e},readPackedSVarint:function(e){if(this.type!==qr.Bytes)return e.push(this.readSVarint());var r=ns(this);for(e=e||[];this.pos<r;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==qr.Bytes)return e.push(this.readBoolean());var r=ns(this);for(e=e||[];this.pos<r;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==qr.Bytes)return e.push(this.readFloat());var r=ns(this);for(e=e||[];this.pos<r;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==qr.Bytes)return e.push(this.readDouble());var r=ns(this);for(e=e||[];this.pos<r;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==qr.Bytes)return e.push(this.readFixed32());var r=ns(this);for(e=e||[];this.pos<r;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==qr.Bytes)return e.push(this.readSFixed32());var r=ns(this);for(e=e||[];this.pos<r;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==qr.Bytes)return e.push(this.readFixed64());var r=ns(this);for(e=e||[];this.pos<r;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==qr.Bytes)return e.push(this.readSFixed64());var r=ns(this);for(e=e||[];this.pos<r;)e.push(this.readSFixed64());return e},skip:function(e){var r=7&e;if(r===qr.Varint)for(;this.buf[this.pos++]>127;);else if(r===qr.Bytes)this.pos=this.readVarint()+this.pos;else if(r===qr.Fixed32)this.pos+=4;else{if(r!==qr.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(e,r){this.writeVarint(e<<3|r)},realloc:function(e){for(var r=this.length||16;r<this.pos+e;)r*=2;if(r!==this.length){var a=new Uint8Array(r);a.set(this.buf),this.buf=a,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),qu(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),qu(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),qu(this.buf,-1&e,this.pos),qu(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),qu(this.buf,-1&e,this.pos),qu(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(r,a){var h,f;if(r>=0?(h=r%4294967296|0,f=r/4294967296|0):(f=~(-r/4294967296),4294967295^(h=~(-r%4294967296))?h=h+1|0:(h=0,f=f+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),function(v,y,S){S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,S.buf[S.pos]=127&(v>>>=7)}(h,0,a),function(v,y){var S=(7&v)<<4;y.buf[y.pos++]|=S|((v>>>=3)?128:0),v&&(y.buf[y.pos++]=127&v|((v>>>=7)?128:0),v&&(y.buf[y.pos++]=127&v|((v>>>=7)?128:0),v&&(y.buf[y.pos++]=127&v|((v>>>=7)?128:0),v&&(y.buf[y.pos++]=127&v|((v>>>=7)?128:0),v&&(y.buf[y.pos++]=127&v)))))}(f,a)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var r=this.pos;this.pos=function(h,f,v){for(var y,S,C=0;C<f.length;C++){if((y=f.charCodeAt(C))>55295&&y<57344){if(!S){y>56319||C+1===f.length?(h[v++]=239,h[v++]=191,h[v++]=189):S=y;continue}if(y<56320){h[v++]=239,h[v++]=191,h[v++]=189,S=y;continue}y=S-55296<<10|y-56320|65536,S=null}else S&&(h[v++]=239,h[v++]=191,h[v++]=189,S=null);y<128?h[v++]=y:(y<2048?h[v++]=y>>6|192:(y<65536?h[v++]=y>>12|224:(h[v++]=y>>18|240,h[v++]=y>>12&63|128),h[v++]=y>>6&63|128),h[v++]=63&y|128)}return v}(this.buf,e,this.pos);var a=this.pos-r;a>=128&&O_(r,a,this),this.pos=r-1,this.writeVarint(a),this.pos+=a},writeFloat:function(e){this.realloc(4),I_(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),I_(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var r=e.length;this.writeVarint(r),this.realloc(r);for(var a=0;a<r;a++)this.buf[this.pos++]=e[a]},writeRawMessage:function(e,r){this.pos++;var a=this.pos;e(r,this);var h=this.pos-a;h>=128&&O_(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h},writeMessage:function(e,r,a){this.writeTag(e,qr.Bytes),this.writeRawMessage(r,a)},writePackedVarint:function(e,r){r.length&&this.writeMessage(e,ST,r)},writePackedSVarint:function(e,r){r.length&&this.writeMessage(e,ET,r)},writePackedBoolean:function(e,r){r.length&&this.writeMessage(e,CT,r)},writePackedFloat:function(e,r){r.length&&this.writeMessage(e,PT,r)},writePackedDouble:function(e,r){r.length&&this.writeMessage(e,TT,r)},writePackedFixed32:function(e,r){r.length&&this.writeMessage(e,IT,r)},writePackedSFixed32:function(e,r){r.length&&this.writeMessage(e,MT,r)},writePackedFixed64:function(e,r){r.length&&this.writeMessage(e,OT,r)},writePackedSFixed64:function(e,r){r.length&&this.writeMessage(e,RT,r)},writeBytesField:function(e,r){this.writeTag(e,qr.Bytes),this.writeBytes(r)},writeFixed32Field:function(e,r){this.writeTag(e,qr.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(e,r){this.writeTag(e,qr.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(e,r){this.writeTag(e,qr.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(e,r){this.writeTag(e,qr.Fixed64),this.writeSFixed64(r)},writeVarintField:function(e,r){this.writeTag(e,qr.Varint),this.writeVarint(r)},writeSVarintField:function(e,r){this.writeTag(e,qr.Varint),this.writeSVarint(r)},writeStringField:function(e,r){this.writeTag(e,qr.Bytes),this.writeString(r)},writeFloatField:function(e,r){this.writeTag(e,qr.Fixed32),this.writeFloat(r)},writeDoubleField:function(e,r){this.writeTag(e,qr.Fixed64),this.writeDouble(r)},writeBooleanField:function(e,r){this.writeVarintField(e,!!r)}};var bd=function(e,r){var a=r.pixelRatio,h=r.version,f=r.stretchX,v=r.stretchY,y=r.content;this.paddedRect=e,this.pixelRatio=a,this.stretchX=f,this.stretchY=v,this.content=y,this.version=h},yp={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};yp.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},yp.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},yp.tlbr.get=function(){return this.tl.concat(this.br)},yp.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(bd.prototype,yp);var _p=function(e,r){var a={},h={};this.haveRenderCallbacks=[];var f=[];this.addImages(e,a,f),this.addImages(r,h,f);var v=A_(f),y=new Li({width:v.w||1,height:v.h||1});for(var S in e){var C=e[S],O=a[S].paddedRect;Li.copy(C.data,y,{x:0,y:0},{x:O.x+1,y:O.y+1},C.data)}for(var k in r){var L=r[k],U=h[k].paddedRect,$=U.x+1,oe=U.y+1,le=L.data.width,_e=L.data.height;Li.copy(L.data,y,{x:0,y:0},{x:$,y:oe},L.data),Li.copy(L.data,y,{x:0,y:_e-1},{x:$,y:oe-1},{width:le,height:1}),Li.copy(L.data,y,{x:0,y:0},{x:$,y:oe+_e},{width:le,height:1}),Li.copy(L.data,y,{x:le-1,y:0},{x:$-1,y:oe},{width:1,height:_e}),Li.copy(L.data,y,{x:0,y:0},{x:$+le,y:oe},{width:1,height:_e})}this.image=y,this.iconPositions=a,this.patternPositions=h};_p.prototype.addImages=function(e,r,a){for(var h in e){var f=e[h],v={x:0,y:0,w:f.data.width+2,h:f.data.height+2};a.push(v),r[h]=new bd(v,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(h)}},_p.prototype.patchUpdatedImages=function(e,r){for(var a in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),r),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),r)},_p.prototype.patchUpdatedImage=function(e,r,a){if(e&&r&&e.version!==r.version){e.version=r.version;var h=e.tl;a.update(r.data,void 0,{x:h[0],y:h[1]})}},ut("ImagePosition",bd),ut("ImageAtlas",_p);var ua={horizontal:1,vertical:2,horizontalOnly:3},$u=function(){this.scale=1,this.fontStack="",this.imageName=null};$u.forText=function(e,r){var a=new $u;return a.scale=e||1,a.fontStack=r,a},$u.forImage=function(e){var r=new $u;return r.imageName=e,r};var mi=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function xd(e,r,a,h,f,v,y,S,C,O,k,L,U,$,oe,le){var _e,fe=mi.fromFeature(e,f);L===ua.vertical&&fe.verticalizePunctuation();var Te=qi.processBidirectionalText,Me=qi.processStyledBidirectionalText;if(Te&&fe.sections.length===1){_e=[];for(var Re=0,Le=Te(fe.toString(),Vm(fe,O,v,r,h,$,oe));Re<Le.length;Re+=1){var Ve=Le[Re],Ze=new mi;Ze.text=Ve,Ze.sections=fe.sections;for(var Qe=0;Qe<Ve.length;Qe++)Ze.sectionIndex.push(0);_e.push(Ze)}}else if(Me){_e=[];for(var vt=0,nt=Me(fe.text,fe.sectionIndex,Vm(fe,O,v,r,h,$,oe));vt<nt.length;vt+=1){var xt=nt[vt],it=new mi;it.text=xt[0],it.sectionIndex=xt[1],it.sections=fe.sections,_e.push(it)}}else _e=function(ht,rr){for(var Vt=[],cr=ht.text,wt=0,_r=0,Kr=rr;_r<Kr.length;_r+=1){var un=Kr[_r];Vt.push(ht.substring(wt,un)),wt=un}return wt<cr.length&&Vt.push(ht.substring(wt,cr.length)),Vt}(fe,Vm(fe,O,v,r,h,$,oe));var Xt=[],Rt={positionedLines:Xt,text:fe.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:L,iconsInText:!1,verticalizable:!1};return function(ht,rr,Vt,cr,wt,_r,Kr,un,nn,Yr,cn,jn){for(var Nn=0,vi=-17,Hn=0,gi=0,vn=un==="right"?1:un==="left"?0:.5,Zn=0,or=0,Lr=wt;or<Lr.length;or+=1){var Rr=Lr[or];Rr.trim();var vr=Rr.getMaxScale(),wi=24*(vr-1),ai={positionedGlyphs:[],lineOffset:0};ht.positionedLines[Zn]=ai;var Wr=ai.positionedGlyphs,Pn=0;if(Rr.length()){for(var oi=0;oi<Rr.length();oi++){var br=Rr.getSection(oi),So=Rr.getSectionIndex(oi),ca=Rr.getCharCode(oi),Eo=0,gn=null,Po=null,Aa=null,Ju=24,Al=!(nn===ua.horizontal||!cn&&!Mu(ca)||cn&&(wd[ca]||(ss=ca,et.Arabic(ss)||et["Arabic Supplement"](ss)||et["Arabic Extended-A"](ss)||et["Arabic Presentation Forms-A"](ss)||et["Arabic Presentation Forms-B"](ss))));if(br.imageName){var Qu=cr[br.imageName];if(!Qu)continue;Aa=br.imageName,ht.iconsInText=ht.iconsInText||!0,Po=Qu.paddedRect;var os=Qu.displaySize;br.scale=24*br.scale/jn,Eo=wi+(24-os[1]*br.scale),Ju=(gn={width:os[0],height:os[1],left:1,top:-3,advance:Al?os[1]:os[0]}).advance;var ec=Al?os[0]*br.scale-24*vr:os[1]*br.scale-24*vr;ec>0&&ec>Pn&&(Pn=ec)}else{var Rd=Vt[br.fontStack],tc=Rd&&Rd[ca];if(tc&&tc.rect)Po=tc.rect,gn=tc.metrics;else{var wp=rr[br.fontStack],Ad=wp&&wp[ca];if(!Ad)continue;gn=Ad.metrics}Eo=24*(vr-br.scale)}Al?(ht.verticalizable=!0,Wr.push({glyph:ca,imageName:Aa,x:Nn,y:vi+Eo,vertical:Al,scale:br.scale,fontStack:br.fontStack,sectionIndex:So,metrics:gn,rect:Po}),Nn+=Ju*br.scale+Yr):(Wr.push({glyph:ca,imageName:Aa,x:Nn,y:vi+Eo,vertical:Al,scale:br.scale,fontStack:br.fontStack,sectionIndex:So,metrics:gn,rect:Po}),Nn+=gn.advance*br.scale+Yr)}Wr.length!==0&&(Hn=Math.max(Nn-Yr,Hn),zT(Wr,0,Wr.length-1,vn,Pn)),Nn=0;var kd=_r*vr+Pn;ai.lineOffset=Math.max(Pn,wi),vi+=kd,gi=Math.max(kd,gi),++Zn}else vi+=_r,++Zn}var ss,Sp=vi- -17,rc=qm(Kr),Bs=rc.horizontalAlign,nc=rc.verticalAlign;(function(Dd,Ld,Ep,Pp,zd,Tp,Cp,Ip,jd){var ic,Nd=(Ld-Ep)*zd;ic=Tp!==Cp?-Ip*Pp- -17:(-Pp*jd+.5)*Cp;for(var ac=0,Mp=Dd;ac<Mp.length;ac+=1)for(var kl=0,Op=Mp[ac].positionedGlyphs;kl<Op.length;kl+=1){var oc=Op[kl];oc.x+=Nd,oc.y+=ic}})(ht.positionedLines,vn,Bs,nc,Hn,gi,_r,Sp,wt.length),ht.top+=-nc*Sp,ht.bottom=ht.top+Sp,ht.left+=-Bs*Hn,ht.right=ht.left+Hn}(Rt,r,a,h,_e,y,S,C,L,O,U,le),!function(ht){for(var rr=0,Vt=ht;rr<Vt.length;rr+=1)if(Vt[rr].positionedGlyphs.length!==0)return!1;return!0}(Xt)&&Rt}mi.fromFeature=function(e,r){for(var a=new mi,h=0;h<e.sections.length;h++){var f=e.sections[h];f.image?a.addImageSection(f):a.addTextSection(f,r)}return a},mi.prototype.length=function(){return this.text.length},mi.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},mi.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},mi.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},mi.prototype.verticalizePunctuation=function(){this.text=function(e){for(var r="",a=0;a<e.length;a++){var h=e.charCodeAt(a+1)||null,f=e.charCodeAt(a-1)||null;r+=h&&rp(h)&&!gp[e[a+1]]||f&&rp(f)&&!gp[e[a-1]]||!gp[e[a]]?e[a]:gp[e[a]]}return r}(this.text)},mi.prototype.trim=function(){for(var e=0,r=0;r<this.text.length&&wd[this.text.charCodeAt(r)];r++)e++;for(var a=this.text.length,h=this.text.length-1;h>=0&&h>=e&&wd[this.text.charCodeAt(h)];h--)a--;this.text=this.text.substring(e,a),this.sectionIndex=this.sectionIndex.slice(e,a)},mi.prototype.substring=function(e,r){var a=new mi;return a.text=this.text.substring(e,r),a.sectionIndex=this.sectionIndex.slice(e,r),a.sections=this.sections,a},mi.prototype.toString=function(){return this.text},mi.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(r,a){return Math.max(r,e.sections[a].scale)},0)},mi.prototype.addTextSection=function(e,r){this.text+=e.text,this.sections.push($u.forText(e.scale,e.fontStack||r));for(var a=this.sections.length-1,h=0;h<e.text.length;++h)this.sectionIndex.push(a)},mi.prototype.addImageSection=function(e){var r=e.image?e.image.name:"";if(r.length!==0){var a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push($u.forImage(r)),this.sectionIndex.push(this.sections.length-1)):ce("Reached maximum number of images 6401")}else ce("Can't add FormattedSection with an empty image.")},mi.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var wd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Wi={};function k_(e,r,a,h,f,v){if(r.imageName){var y=h[r.imageName];return y?y.displaySize[0]*r.scale*24/v+f:0}var S=a[r.fontStack],C=S&&S[e];return C?C.metrics.advance*r.scale+f:0}function D_(e,r,a,h){var f=Math.pow(e-r,2);return h?e<r?f/2:2*f:f+Math.abs(a)*a}function LT(e,r,a){var h=0;return e===10&&(h-=1e4),a&&(h+=150),e!==40&&e!==65288||(h+=50),r!==41&&r!==65289||(h+=50),h}function L_(e,r,a,h,f,v){for(var y=null,S=D_(r,a,f,v),C=0,O=h;C<O.length;C+=1){var k=O[C],L=D_(r-k.x,a,f,v)+k.badness;L<=S&&(y=k,S=L)}return{index:e,x:r,priorBreak:y,badness:S}}function Vm(e,r,a,h,f,v,y){if(v!=="point")return[];if(!e)return[];for(var S,C=[],O=function(_e,fe,Te,Me,Re,Le){for(var Ve=0,Ze=0;Ze<_e.length();Ze++){var Qe=_e.getSection(Ze);Ve+=k_(_e.getCharCode(Ze),Qe,Me,Re,fe,Le)}return Ve/Math.max(1,Math.ceil(Ve/Te))}(e,r,a,h,f,y),k=e.text.indexOf("​")>=0,L=0,U=0;U<e.length();U++){var $=e.getSection(U),oe=e.getCharCode(U);if(wd[oe]||(L+=k_(oe,$,h,f,r,y)),U<e.length()-1){var le=!((S=oe)<11904||!(et["Bopomofo Extended"](S)||et.Bopomofo(S)||et["CJK Compatibility Forms"](S)||et["CJK Compatibility Ideographs"](S)||et["CJK Compatibility"](S)||et["CJK Radicals Supplement"](S)||et["CJK Strokes"](S)||et["CJK Symbols and Punctuation"](S)||et["CJK Unified Ideographs Extension A"](S)||et["CJK Unified Ideographs"](S)||et["Enclosed CJK Letters and Months"](S)||et["Halfwidth and Fullwidth Forms"](S)||et.Hiragana(S)||et["Ideographic Description Characters"](S)||et["Kangxi Radicals"](S)||et["Katakana Phonetic Extensions"](S)||et.Katakana(S)||et["Vertical Forms"](S)||et["Yi Radicals"](S)||et["Yi Syllables"](S)));(Wi[oe]||le||$.imageName)&&C.push(L_(U+1,L,O,C,LT(oe,e.getCharCode(U+1),le&&k),!1))}}return function _e(fe){return fe?_e(fe.priorBreak).concat(fe.index):[]}(L_(e.length(),L,O,C,0,!0))}function qm(e){var r=.5,a=.5;switch(e){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:r,verticalAlign:a}}function zT(e,r,a,h,f){if(h||f)for(var v=e[a],y=(e[a].x+v.metrics.advance*v.scale)*h,S=r;S<=a;S++)e[S].x-=y,e[S].y+=f}function z_(e,r,a,h,f,v){var y,S=e.image;if(S.content){var C=S.content,O=S.pixelRatio||1;y=[C[0]/O,C[1]/O,S.displaySize[0]-C[2]/O,S.displaySize[1]-C[3]/O]}var k,L,U,$,oe=r.left*v,le=r.right*v;a==="width"||a==="both"?($=f[0]+oe-h[3],L=f[0]+le+h[1]):L=($=f[0]+(oe+le-S.displaySize[0])/2)+S.displaySize[0];var _e=r.top*v,fe=r.bottom*v;return a==="height"||a==="both"?(k=f[1]+_e-h[0],U=f[1]+fe+h[2]):U=(k=f[1]+(_e+fe-S.displaySize[1])/2)+S.displaySize[1],{image:S,top:k,right:L,bottom:U,left:$,collisionPadding:y}}Wi[10]=!0,Wi[32]=!0,Wi[38]=!0,Wi[40]=!0,Wi[41]=!0,Wi[43]=!0,Wi[45]=!0,Wi[47]=!0,Wi[173]=!0,Wi[183]=!0,Wi[8203]=!0,Wi[8208]=!0,Wi[8211]=!0,Wi[8231]=!0;var Wu=function(e){function r(a,h,f,v){e.call(this,a,h),this.angle=f,v!==void 0&&(this.segment=v)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.clone=function(){return new r(this.x,this.y,this.angle,this.segment)},r}(T);function $m(e,r){var a=r.expression;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new ir(e+1))};if(a.kind==="source")return{kind:"source"};for(var h=a.zoomStops,f=a.interpolationType,v=0;v<h.length&&h[v]<=e;)v++;for(var y=v=Math.max(0,v-1);y<h.length&&h[y]<e+1;)y++;y=Math.min(h.length-1,y);var S=h[v],C=h[y];return a.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:C,interpolationType:f}:{kind:"camera",minZoom:S,maxZoom:C,minSize:a.evaluate(new ir(S)),maxSize:a.evaluate(new ir(C)),interpolationType:f}}function j_(e,r,a){var h=r.uSize,f=a.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?Sn(f/128,a.upperSize/128,r.uSizeT):h}function N_(e,r){var a=0,h=0;if(e.kind==="constant")h=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,v=f?W(Qn.interpolationFactor(f,r,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?h=Sn(e.minSize,e.maxSize,v):a=v}return{uSizeT:a,uSize:h}}ut("Anchor",Wu);var jT=Object.freeze({__proto__:null,getSizeData:$m,evaluateSizeForFeature:j_,evaluateSizeForZoom:N_,SIZE_PACK_FACTOR:128});function B_(e,r,a,h,f){if(r.segment===void 0)return!0;for(var v=r,y=r.segment+1,S=0;S>-a/2;){if(--y<0)return!1;S-=e[y].dist(v),v=e[y]}S+=e[y].dist(e[y+1]),y++;for(var C=[],O=0;S<a/2;){var k=e[y],L=e[y+1];if(!L)return!1;var U=e[y-1].angleTo(k)-k.angleTo(L);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:S,angleDelta:U}),O+=U;S-C[0].distance>h;)O-=C.shift().angleDelta;if(O>f)return!1;y++,S+=k.dist(L)}return!0}function F_(e){for(var r=0,a=0;a<e.length-1;a++)r+=e[a].dist(e[a+1]);return r}function U_(e,r,a){return e?.6*r*a:0}function V_(e,r){return Math.max(e?e.right-e.left:0,r?r.right-r.left:0)}function NT(e,r,a,h,f,v){for(var y=U_(a,f,v),S=V_(a,h)*v,C=0,O=F_(e)/2,k=0;k<e.length-1;k++){var L=e[k],U=e[k+1],$=L.dist(U);if(C+$>O){var oe=(O-C)/$,le=Sn(L.x,U.x,oe),_e=Sn(L.y,U.y,oe),fe=new Wu(le,_e,U.angleTo(L),k);return fe._round(),!y||B_(e,fe,S,y,r)?fe:void 0}C+=$}}function BT(e,r,a,h,f,v,y,S,C){var O=U_(h,v,y),k=V_(h,f),L=k*y,U=e[0].x===0||e[0].x===C||e[0].y===0||e[0].y===C;return r-L<r/4&&(r=L+r/4),function $(oe,le,_e,fe,Te,Me,Re,Le,Ve){for(var Ze=Me/2,Qe=F_(oe),vt=0,nt=le-_e,xt=[],it=0;it<oe.length-1;it++){for(var Xt=oe[it],Rt=oe[it+1],ht=Xt.dist(Rt),rr=Rt.angleTo(Xt);nt+_e<vt+ht;){var Vt=((nt+=_e)-vt)/ht,cr=Sn(Xt.x,Rt.x,Vt),wt=Sn(Xt.y,Rt.y,Vt);if(cr>=0&&cr<Ve&&wt>=0&&wt<Ve&&nt-Ze>=0&&nt+Ze<=Qe){var _r=new Wu(cr,wt,rr,it);_r._round(),fe&&!B_(oe,_r,Me,fe,Te)||xt.push(_r)}}vt+=ht}return Le||xt.length||Re||(xt=$(oe,vt/2,_e,fe,Te,Me,Re,!0,Ve)),xt}(e,U?r/2*S%r:(k/2+2*v)*y*S%r,r,O,a,L,U,!1,C)}function q_(e,r,a,h,f){for(var v=[],y=0;y<e.length;y++)for(var S=e[y],C=void 0,O=0;O<S.length-1;O++){var k=S[O],L=S[O+1];k.x<r&&L.x<r||(k.x<r?k=new T(r,k.y+(r-k.x)/(L.x-k.x)*(L.y-k.y))._round():L.x<r&&(L=new T(r,k.y+(r-k.x)/(L.x-k.x)*(L.y-k.y))._round()),k.y<a&&L.y<a||(k.y<a?k=new T(k.x+(a-k.y)/(L.y-k.y)*(L.x-k.x),a)._round():L.y<a&&(L=new T(k.x+(a-k.y)/(L.y-k.y)*(L.x-k.x),a)._round()),k.x>=h&&L.x>=h||(k.x>=h?k=new T(h,k.y+(h-k.x)/(L.x-k.x)*(L.y-k.y))._round():L.x>=h&&(L=new T(h,k.y+(h-k.x)/(L.x-k.x)*(L.y-k.y))._round()),k.y>=f&&L.y>=f||(k.y>=f?k=new T(k.x+(f-k.y)/(L.y-k.y)*(L.x-k.x),f)._round():L.y>=f&&(L=new T(k.x+(f-k.y)/(L.y-k.y)*(L.x-k.x),f)._round()),C&&k.equals(C[C.length-1])||v.push(C=[k]),C.push(L)))))}return v}function $_(e,r,a,h){var f=[],v=e.image,y=v.pixelRatio,S=v.paddedRect.w-2,C=v.paddedRect.h-2,O=e.right-e.left,k=e.bottom-e.top,L=v.stretchX||[[0,S]],U=v.stretchY||[[0,C]],$=function(cr,wt){return cr+wt[1]-wt[0]},oe=L.reduce($,0),le=U.reduce($,0),_e=S-oe,fe=C-le,Te=0,Me=oe,Re=0,Le=le,Ve=0,Ze=_e,Qe=0,vt=fe;if(v.content&&h){var nt=v.content;Te=Sd(L,0,nt[0]),Re=Sd(U,0,nt[1]),Me=Sd(L,nt[0],nt[2]),Le=Sd(U,nt[1],nt[3]),Ve=nt[0]-Te,Qe=nt[1]-Re,Ze=nt[2]-nt[0]-Me,vt=nt[3]-nt[1]-Le}var xt=function(cr,wt,_r,Kr){var un=Ed(cr.stretch-Te,Me,O,e.left),nn=Pd(cr.fixed-Ve,Ze,cr.stretch,oe),Yr=Ed(wt.stretch-Re,Le,k,e.top),cn=Pd(wt.fixed-Qe,vt,wt.stretch,le),jn=Ed(_r.stretch-Te,Me,O,e.left),Nn=Pd(_r.fixed-Ve,Ze,_r.stretch,oe),vi=Ed(Kr.stretch-Re,Le,k,e.top),Hn=Pd(Kr.fixed-Qe,vt,Kr.stretch,le),gi=new T(un,Yr),vn=new T(jn,Yr),Zn=new T(jn,vi),or=new T(un,vi),Lr=new T(nn/y,cn/y),Rr=new T(Nn/y,Hn/y),vr=r*Math.PI/180;if(vr){var wi=Math.sin(vr),ai=Math.cos(vr),Wr=[ai,-wi,wi,ai];gi._matMult(Wr),vn._matMult(Wr),or._matMult(Wr),Zn._matMult(Wr)}var Pn=cr.stretch+cr.fixed,oi=wt.stretch+wt.fixed;return{tl:gi,tr:vn,bl:or,br:Zn,tex:{x:v.paddedRect.x+1+Pn,y:v.paddedRect.y+1+oi,w:_r.stretch+_r.fixed-Pn,h:Kr.stretch+Kr.fixed-oi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Lr,pixelOffsetBR:Rr,minFontScaleX:Ze/y/O,minFontScaleY:vt/y/k,isSDF:a}};if(h&&(v.stretchX||v.stretchY))for(var it=W_(L,_e,oe),Xt=W_(U,fe,le),Rt=0;Rt<it.length-1;Rt++)for(var ht=it[Rt],rr=it[Rt+1],Vt=0;Vt<Xt.length-1;Vt++)f.push(xt(ht,Xt[Vt],rr,Xt[Vt+1]));else f.push(xt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:C+1}));return f}function Sd(e,r,a){for(var h=0,f=0,v=e;f<v.length;f+=1){var y=v[f];h+=Math.max(r,Math.min(a,y[1]))-Math.max(r,Math.min(a,y[0]))}return h}function W_(e,r,a){for(var h=[{fixed:-1,stretch:0}],f=0,v=e;f<v.length;f+=1){var y=v[f],S=y[0],C=y[1],O=h[h.length-1];h.push({fixed:S-O.stretch,stretch:O.stretch}),h.push({fixed:S-O.stretch,stretch:O.stretch+(C-S)})}return h.push({fixed:r+1,stretch:a}),h}function Ed(e,r,a,h){return e/r*a+h}function Pd(e,r,a,h){return e-r*a/h}var Td=function(e,r,a,h,f,v,y,S,C,O){if(this.boxStartIndex=e.length,C){var k=v.top,L=v.bottom,U=v.collisionPadding;U&&(k-=U[1],L+=U[3]);var $=L-k;$>0&&($=Math.max(10,$),this.circleDiameter=$)}else{var oe=v.top*y-S,le=v.bottom*y+S,_e=v.left*y-S,fe=v.right*y+S,Te=v.collisionPadding;if(Te&&(_e-=Te[0]*y,oe-=Te[1]*y,fe+=Te[2]*y,le+=Te[3]*y),O){var Me=new T(_e,oe),Re=new T(fe,oe),Le=new T(_e,le),Ve=new T(fe,le),Ze=O*Math.PI/180;Me._rotate(Ze),Re._rotate(Ze),Le._rotate(Ze),Ve._rotate(Ze),_e=Math.min(Me.x,Re.x,Le.x,Ve.x),fe=Math.max(Me.x,Re.x,Le.x,Ve.x),oe=Math.min(Me.y,Re.y,Le.y,Ve.y),le=Math.max(Me.y,Re.y,Le.y,Ve.y)}e.emplaceBack(r.x,r.y,_e,oe,fe,le,a,h,f)}this.boxEndIndex=e.length},Hu=function(e,r){if(e===void 0&&(e=[]),r===void 0&&(r=FT),this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(var a=(this.length>>1)-1;a>=0;a--)this._down(a)};function FT(e,r){return e<r?-1:e>r?1:0}function UT(e,r,a){a=!1;for(var h=1/0,f=1/0,v=-1/0,y=-1/0,S=e[0],C=0;C<S.length;C++){var O=S[C];(!C||O.x<h)&&(h=O.x),(!C||O.y<f)&&(f=O.y),(!C||O.x>v)&&(v=O.x),(!C||O.y>y)&&(y=O.y)}var k=Math.min(v-h,y-f),L=k/2,U=new Hu([],VT);if(k===0)return new T(h,f);for(var $=h;$<v;$+=k)for(var oe=f;oe<y;oe+=k)U.push(new Zu($+L,oe+L,L,e));for(var le=function(Te){for(var Me=0,Re=0,Le=0,Ve=Te[0],Ze=0,Qe=Ve.length,vt=Qe-1;Ze<Qe;vt=Ze++){var nt=Ve[Ze],xt=Ve[vt],it=nt.x*xt.y-xt.x*nt.y;Re+=(nt.x+xt.x)*it,Le+=(nt.y+xt.y)*it,Me+=3*it}return new Zu(Re/Me,Le/Me,0,Te)}(e),_e=U.length;U.length;){var fe=U.pop();(fe.d>le.d||!le.d)&&(le=fe),fe.max-le.d<=r||(U.push(new Zu(fe.p.x-(L=fe.h/2),fe.p.y-L,L,e)),U.push(new Zu(fe.p.x+L,fe.p.y-L,L,e)),U.push(new Zu(fe.p.x-L,fe.p.y+L,L,e)),U.push(new Zu(fe.p.x+L,fe.p.y+L,L,e)),_e+=4)}return le.p}function VT(e,r){return r.max-e.max}function Zu(e,r,a,h){this.p=new T(e,r),this.h=a,this.d=function(f,v){for(var y=!1,S=1/0,C=0;C<v.length;C++)for(var O=v[C],k=0,L=O.length,U=L-1;k<L;U=k++){var $=O[k],oe=O[U];$.y>f.y!=oe.y>f.y&&f.x<(oe.x-$.x)*(f.y-$.y)/(oe.y-$.y)+$.x&&(y=!y),S=Math.min(S,Ls(f,$,oe))}return(y?1:-1)*Math.sqrt(S)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}Hu.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},Hu.prototype.pop=function(){if(this.length!==0){var e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}},Hu.prototype.peek=function(){return this.data[0]},Hu.prototype._up=function(e){for(var r=this.data,a=this.compare,h=r[e];e>0;){var f=e-1>>1,v=r[f];if(a(h,v)>=0)break;r[e]=v,e=f}r[e]=h},Hu.prototype._down=function(e){for(var r=this.data,a=this.compare,h=this.length>>1,f=r[e];e<h;){var v=1+(e<<1),y=r[v],S=v+1;if(S<this.length&&a(r[S],y)<0&&(v=S,y=r[S]),a(y,f)>=0)break;r[e]=y,e=v}r[e]=f};var Wm=Number.POSITIVE_INFINITY;function H_(e,r){return r[1]!==Wm?function(a,h,f){var v=0,y=0;switch(h=Math.abs(h),f=Math.abs(f),a){case"top-right":case"top-left":case"top":y=f-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-f}switch(a){case"top-right":case"bottom-right":case"right":v=-h;break;case"top-left":case"bottom-left":case"left":v=h}return[v,y]}(e,r[0],r[1]):function(a,h){var f=0,v=0;h<0&&(h=0);var y=h/Math.sqrt(2);switch(a){case"top-right":case"top-left":v=y-7;break;case"bottom-right":case"bottom-left":v=7-y;break;case"bottom":v=7-h;break;case"top":v=h-7}switch(a){case"top-right":case"bottom-right":f=-y;break;case"top-left":case"bottom-left":f=y;break;case"left":f=h;break;case"right":f=-h}return[f,v]}(e,r[0])}function Hm(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Z_(e,r,a,h,f,v,y,S,C,O,k,L,U,$,oe){var le=function(Re,Le,Ve,Ze,Qe,vt,nt,xt){for(var it=Ze.layout.get("text-rotate").evaluate(vt,{})*Math.PI/180,Xt=[],Rt=0,ht=Le.positionedLines;Rt<ht.length;Rt+=1)for(var rr=ht[Rt],Vt=0,cr=rr.positionedGlyphs;Vt<cr.length;Vt+=1){var wt=cr[Vt];if(wt.rect){var _r=wt.rect||{},Kr=4,un=!0,nn=1,Yr=0,cn=(Qe||xt)&&wt.vertical,jn=wt.metrics.advance*wt.scale/2;if(xt&&Le.verticalizable&&(Yr=rr.lineOffset/2-(wt.imageName?-(24-wt.metrics.width*wt.scale)/2:24*(wt.scale-1))),wt.imageName){var Nn=nt[wt.imageName];un=Nn.sdf,Kr=1/(nn=Nn.pixelRatio)}var vi=Qe?[wt.x+jn,wt.y]:[0,0],Hn=Qe?[0,0]:[wt.x+jn+Ve[0],wt.y+Ve[1]-Yr],gi=[0,0];cn&&(gi=Hn,Hn=[0,0]);var vn=(wt.metrics.left-Kr)*wt.scale-jn+Hn[0],Zn=(-wt.metrics.top-Kr)*wt.scale+Hn[1],or=vn+_r.w*wt.scale/nn,Lr=Zn+_r.h*wt.scale/nn,Rr=new T(vn,Zn),vr=new T(or,Zn),wi=new T(vn,Lr),ai=new T(or,Lr);if(cn){var Wr=new T(-jn,jn- -17),Pn=-Math.PI/2,oi=12-jn,br=new T(22-oi,-(wt.imageName?oi:0)),So=new(Function.prototype.bind.apply(T,[null].concat(gi)));Rr._rotateAround(Pn,Wr)._add(br)._add(So),vr._rotateAround(Pn,Wr)._add(br)._add(So),wi._rotateAround(Pn,Wr)._add(br)._add(So),ai._rotateAround(Pn,Wr)._add(br)._add(So)}if(it){var ca=Math.sin(it),Eo=Math.cos(it),gn=[Eo,-ca,ca,Eo];Rr._matMult(gn),vr._matMult(gn),wi._matMult(gn),ai._matMult(gn)}var Po=new T(0,0),Aa=new T(0,0);Xt.push({tl:Rr,tr:vr,bl:wi,br:ai,tex:_r,writingMode:Le.writingMode,glyphOffset:vi,sectionIndex:wt.sectionIndex,isSDF:un,pixelOffsetTL:Po,pixelOffsetBR:Aa,minFontScaleX:0,minFontScaleY:0})}}return Xt}(0,a,S,f,v,y,h,e.allowVerticalPlacement),_e=e.textSizeData,fe=null;_e.kind==="source"?(fe=[128*f.layout.get("text-size").evaluate(y,{})])[0]>32640&&ce(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):_e.kind==="composite"&&((fe=[128*$.compositeTextSizes[0].evaluate(y,{},oe),128*$.compositeTextSizes[1].evaluate(y,{},oe)])[0]>32640||fe[1]>32640)&&ce(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,le,fe,S,v,y,O,r,C.lineStartIndex,C.lineLength,U,oe);for(var Te=0,Me=k;Te<Me.length;Te+=1)L[Me[Te]]=e.text.placedSymbolArray.length-1;return 4*le.length}function G_(e){for(var r in e)return e[r];return null}function qT(e,r,a,h){var f=e.compareText;if(r in f){for(var v=f[r],y=v.length-1;y>=0;y--)if(h.dist(v[y])<a)return!0}else f[r]=[];return f[r].push(h),!1}var $T=Uu.VectorTileFeature.types,WT=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Cd(e,r,a,h,f,v,y,S,C,O,k,L,U){var $=S?Math.min(32640,Math.round(S[0])):0,oe=S?Math.min(32640,Math.round(S[1])):0;e.emplaceBack(r,a,Math.round(32*h),Math.round(32*f),v,y,($<<1)+(C?1:0),oe,16*O,16*k,256*L,256*U)}function Zm(e,r,a){e.emplaceBack(r.x,r.y,a),e.emplaceBack(r.x,r.y,a),e.emplaceBack(r.x,r.y,a),e.emplaceBack(r.x,r.y,a)}function HT(e){for(var r=0,a=e.sections;r<a.length;r+=1)if(Ou(a[r].text))return!0;return!1}var Gu=function(e){this.layoutVertexArray=new Du,this.indexArray=new go,this.programConfigurations=e,this.segments=new X,this.dynamicLayoutVertexArray=new As,this.opacityVertexArray=new wl,this.placedSymbolArray=new d};Gu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Gu.prototype.upload=function(e,r,a,h){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,yT.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,_T.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,WT,!0),this.opacityVertexBuffer.itemSize=1),(a||h)&&this.programConfigurations.upload(e))},Gu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},ut("SymbolBuffers",Gu);var bp=function(e,r,a){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new a,this.segments=new X,this.collisionVertexArray=new lp};bp.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,bT.members,!0)},bp.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},ut("CollisionBuffers",bp);var kr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(v){return v.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=$i([]),this.placementViewportMatrix=$i([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=$m(this.zoom,r["text-size"]),this.iconSizeData=$m(this.zoom,r["icon-size"]);var a=this.layers[0].layout,h=a.get("symbol-sort-key"),f=a.get("symbol-z-order");this.canOverlap=a.get("text-allow-overlap")||a.get("icon-allow-overlap")||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,a.get("symbol-placement")==="point"&&(this.writingModes=a.get("text-writing-mode").map(function(v){return ua[v]})),this.stateDependentLayerIds=this.layers.filter(function(v){return v.isStateDependent()}).map(function(v){return v.id}),this.sourceID=e.sourceID};kr.prototype.createArrays=function(){this.text=new Gu(new Ot(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new Gu(new Ot(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new w,this.lineVertexArray=new P,this.symbolInstances=new x},kr.prototype.calculateGlyphDependencies=function(e,r,a,h,f){for(var v=0;v<e.length;v++)if(r[e.charCodeAt(v)]=!0,(a||h)&&f){var y=gp[e.charAt(v)];y&&(r[y.charCodeAt(0)]=!0)}},kr.prototype.populate=function(e,r,a){var h=this.layers[0],f=h.layout,v=f.get("text-font"),y=f.get("text-field"),S=f.get("icon-image"),C=(y.value.kind!=="constant"||y.value.value instanceof on&&!y.value.value.isEmpty()||y.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),O=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,k=f.get("symbol-sort-key");if(this.features=[],C||O){for(var L=r.iconDependencies,U=r.glyphDependencies,$=r.availableImages,oe=new ir(this.zoom),le=0,_e=e;le<_e.length;le+=1){var fe=_e[le],Te=fe.feature,Me=fe.id,Re=fe.index,Le=fe.sourceLayerIndex,Ve=h._featureFilter.needGeometry,Ze=mn(Te,Ve);if(h._featureFilter.filter(oe,Ze,a)){Ve||(Ze.geometry=rn(Te));var Qe=void 0;if(C){var vt=h.getValueAndResolveTokens("text-field",Ze,a,$),nt=on.factory(vt);HT(nt)&&(this.hasRTLText=!0),(!this.hasRTLText||ip()==="unavailable"||this.hasRTLText&&qi.isParsed())&&(Qe=wT(nt,h,Ze))}var xt=void 0;if(O){var it=h.getValueAndResolveTokens("icon-image",Ze,a,$);xt=it instanceof Hr?it:Hr.fromString(it)}if(Qe||xt){var Xt=this.sortFeaturesByKey?k.evaluate(Ze,{},a):void 0;if(this.features.push({id:Me,text:Qe,icon:xt,index:Re,sourceLayerIndex:Le,geometry:Ze.geometry,properties:Te.properties,type:$T[Te.type],sortKey:Xt}),xt&&(L[xt.name]=!0),Qe){var Rt=v.evaluate(Ze,{},a).join(","),ht=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ua.vertical)>=0;for(var rr=0,Vt=Qe.sections;rr<Vt.length;rr+=1){var cr=Vt[rr];if(cr.image)L[cr.image.name]=!0;else{var wt=tp(Qe.toString()),_r=cr.fontStack||Rt,Kr=U[_r]=U[_r]||{};this.calculateGlyphDependencies(cr.text,Kr,ht,this.allowVerticalPlacement,wt)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(un){var nn={},Yr={},cn=[],jn=0;function Nn(Wr){cn.push(un[Wr]),jn++}function vi(Wr,Pn,oi){var br=Yr[Wr];return delete Yr[Wr],Yr[Pn]=br,cn[br].geometry[0].pop(),cn[br].geometry[0]=cn[br].geometry[0].concat(oi[0]),br}function Hn(Wr,Pn,oi){var br=nn[Pn];return delete nn[Pn],nn[Wr]=br,cn[br].geometry[0].shift(),cn[br].geometry[0]=oi[0].concat(cn[br].geometry[0]),br}function gi(Wr,Pn,oi){var br=oi?Pn[0][Pn[0].length-1]:Pn[0][0];return Wr+":"+br.x+":"+br.y}for(var vn=0;vn<un.length;vn++){var Zn=un[vn],or=Zn.geometry,Lr=Zn.text?Zn.text.toString():null;if(Lr){var Rr=gi(Lr,or),vr=gi(Lr,or,!0);if(Rr in Yr&&vr in nn&&Yr[Rr]!==nn[vr]){var wi=Hn(Rr,vr,or),ai=vi(Rr,vr,cn[wi].geometry);delete nn[Rr],delete Yr[vr],Yr[gi(Lr,cn[ai].geometry,!0)]=ai,cn[wi].geometry=null}else Rr in Yr?vi(Rr,vr,or):vr in nn?Hn(Rr,vr,or):(Nn(vn),nn[Rr]=jn-1,Yr[vr]=jn-1)}else Nn(vn)}return cn.filter(function(Wr){return Wr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(un,nn){return un.sortKey-nn.sortKey})}},kr.prototype.update=function(e,r,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,a),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,a))},kr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},kr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},kr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},kr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},kr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},kr.prototype.addToLineVertexArray=function(e,r){var a=this.lineVertexArray.length;if(e.segment!==void 0){for(var h=e.dist(r[e.segment+1]),f=e.dist(r[e.segment]),v={},y=e.segment+1;y<r.length;y++)v[y]={x:r[y].x,y:r[y].y,tileUnitDistanceFromAnchor:h},y<r.length-1&&(h+=r[y+1].dist(r[y]));for(var S=e.segment||0;S>=0;S--)v[S]={x:r[S].x,y:r[S].y,tileUnitDistanceFromAnchor:f},S>0&&(f+=r[S-1].dist(r[S]));for(var C=0;C<r.length;C++){var O=v[C];this.lineVertexArray.emplaceBack(O.x,O.y,O.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}},kr.prototype.addSymbols=function(e,r,a,h,f,v,y,S,C,O,k,L){for(var U=e.indexArray,$=e.layoutVertexArray,oe=e.segments.prepareSegment(4*r.length,$,U,this.canOverlap?v.sortKey:void 0),le=this.glyphOffsetArray.length,_e=oe.vertexLength,fe=this.allowVerticalPlacement&&y===ua.vertical?Math.PI/2:0,Te=v.text&&v.text.sections,Me=0;Me<r.length;Me++){var Re=r[Me],Le=Re.tl,Ve=Re.tr,Ze=Re.bl,Qe=Re.br,vt=Re.tex,nt=Re.pixelOffsetTL,xt=Re.pixelOffsetBR,it=Re.minFontScaleX,Xt=Re.minFontScaleY,Rt=Re.glyphOffset,ht=Re.isSDF,rr=Re.sectionIndex,Vt=oe.vertexLength,cr=Rt[1];Cd($,S.x,S.y,Le.x,cr+Le.y,vt.x,vt.y,a,ht,nt.x,nt.y,it,Xt),Cd($,S.x,S.y,Ve.x,cr+Ve.y,vt.x+vt.w,vt.y,a,ht,xt.x,nt.y,it,Xt),Cd($,S.x,S.y,Ze.x,cr+Ze.y,vt.x,vt.y+vt.h,a,ht,nt.x,xt.y,it,Xt),Cd($,S.x,S.y,Qe.x,cr+Qe.y,vt.x+vt.w,vt.y+vt.h,a,ht,xt.x,xt.y,it,Xt),Zm(e.dynamicLayoutVertexArray,S,fe),U.emplaceBack(Vt,Vt+1,Vt+2),U.emplaceBack(Vt+1,Vt+2,Vt+3),oe.vertexLength+=4,oe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Rt[0]),Me!==r.length-1&&rr===r[Me+1].sectionIndex||e.programConfigurations.populatePaintArrays($.length,v,v.index,{},L,Te&&Te[rr])}e.placedSymbolArray.emplaceBack(S.x,S.y,le,this.glyphOffsetArray.length-le,_e,C,O,S.segment,a?a[0]:0,a?a[1]:0,h[0],h[1],y,0,!1,0,k)},kr.prototype._addCollisionDebugVertex=function(e,r,a,h,f,v){return r.emplaceBack(0,0),e.emplaceBack(a.x,a.y,h,f,Math.round(v.x),Math.round(v.y))},kr.prototype.addCollisionDebugVertices=function(e,r,a,h,f,v,y){var S=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),C=S.vertexLength,O=f.layoutVertexArray,k=f.collisionVertexArray,L=y.anchorX,U=y.anchorY;this._addCollisionDebugVertex(O,k,v,L,U,new T(e,r)),this._addCollisionDebugVertex(O,k,v,L,U,new T(a,r)),this._addCollisionDebugVertex(O,k,v,L,U,new T(a,h)),this._addCollisionDebugVertex(O,k,v,L,U,new T(e,h)),S.vertexLength+=4;var $=f.indexArray;$.emplaceBack(C,C+1),$.emplaceBack(C+1,C+2),$.emplaceBack(C+2,C+3),$.emplaceBack(C+3,C),S.primitiveLength+=4},kr.prototype.addDebugCollisionBoxes=function(e,r,a,h){for(var f=e;f<r;f++){var v=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,h?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,a)}},kr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new bp(ks,T_.members,Sl),this.iconCollisionBox=new bp(ks,T_.members,Sl);for(var e=0;e<this.symbolInstances.length;e++){var r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}},kr.prototype._deserializeCollisionBoxesForSymbol=function(e,r,a,h,f,v,y,S,C){for(var O={},k=r;k<a;k++){var L=e.get(k);O.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},O.textFeatureIndex=L.featureIndex;break}for(var U=h;U<f;U++){var $=e.get(U);O.verticalTextBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},O.verticalTextFeatureIndex=$.featureIndex;break}for(var oe=v;oe<y;oe++){var le=e.get(oe);O.iconBox={x1:le.x1,y1:le.y1,x2:le.x2,y2:le.y2,anchorPointX:le.anchorPointX,anchorPointY:le.anchorPointY},O.iconFeatureIndex=le.featureIndex;break}for(var _e=S;_e<C;_e++){var fe=e.get(_e);O.verticalIconBox={x1:fe.x1,y1:fe.y1,x2:fe.x2,y2:fe.y2,anchorPointX:fe.anchorPointX,anchorPointY:fe.anchorPointY},O.verticalIconFeatureIndex=fe.featureIndex;break}return O},kr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var r=0;r<this.symbolInstances.length;r++){var a=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}},kr.prototype.hasTextData=function(){return this.text.segments.get().length>0},kr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},kr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},kr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},kr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},kr.prototype.addIndicesForPlacedSymbol=function(e,r){for(var a=e.placedSymbolArray.get(r),h=a.vertexStartIndex+4*a.numGlyphs,f=a.vertexStartIndex;f<h;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},kr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var r=Math.sin(e),a=Math.cos(e),h=[],f=[],v=[],y=0;y<this.symbolInstances.length;++y){v.push(y);var S=this.symbolInstances.get(y);h.push(0|Math.round(r*S.anchorX+a*S.anchorY)),f.push(S.featureIndex)}return v.sort(function(C,O){return h[C]-h[O]||f[O]-f[C]}),v},kr.prototype.addToSortKeyRanges=function(e,r){var a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===r?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})},kr.prototype.sortFeatures=function(e){var r=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var a=0,h=this.symbolInstanceIndexes;a<h.length;a+=1){var f=this.symbolInstances.get(h[a]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(v,y,S){v>=0&&S.indexOf(v)===y&&r.addIndicesForPlacedSymbol(r.text,v)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},ut("SymbolBucket",kr,{omit:["layers","collisionBoxArray","features","compareText"]}),kr.MAX_GLYPHS=65535,kr.addDynamicAttributes=Zm;var ZT=new ti({"symbol-placement":new _t(G.layout_symbol["symbol-placement"]),"symbol-spacing":new _t(G.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new _t(G.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new pt(G.layout_symbol["symbol-sort-key"]),"symbol-z-order":new _t(G.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new _t(G.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new _t(G.layout_symbol["icon-ignore-placement"]),"icon-optional":new _t(G.layout_symbol["icon-optional"]),"icon-rotation-alignment":new _t(G.layout_symbol["icon-rotation-alignment"]),"icon-size":new pt(G.layout_symbol["icon-size"]),"icon-text-fit":new _t(G.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new _t(G.layout_symbol["icon-text-fit-padding"]),"icon-image":new pt(G.layout_symbol["icon-image"]),"icon-rotate":new pt(G.layout_symbol["icon-rotate"]),"icon-padding":new _t(G.layout_symbol["icon-padding"]),"icon-keep-upright":new _t(G.layout_symbol["icon-keep-upright"]),"icon-offset":new pt(G.layout_symbol["icon-offset"]),"icon-anchor":new pt(G.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new _t(G.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new _t(G.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new _t(G.layout_symbol["text-rotation-alignment"]),"text-field":new pt(G.layout_symbol["text-field"]),"text-font":new pt(G.layout_symbol["text-font"]),"text-size":new pt(G.layout_symbol["text-size"]),"text-max-width":new pt(G.layout_symbol["text-max-width"]),"text-line-height":new _t(G.layout_symbol["text-line-height"]),"text-letter-spacing":new pt(G.layout_symbol["text-letter-spacing"]),"text-justify":new pt(G.layout_symbol["text-justify"]),"text-radial-offset":new pt(G.layout_symbol["text-radial-offset"]),"text-variable-anchor":new _t(G.layout_symbol["text-variable-anchor"]),"text-anchor":new pt(G.layout_symbol["text-anchor"]),"text-max-angle":new _t(G.layout_symbol["text-max-angle"]),"text-writing-mode":new _t(G.layout_symbol["text-writing-mode"]),"text-rotate":new pt(G.layout_symbol["text-rotate"]),"text-padding":new _t(G.layout_symbol["text-padding"]),"text-keep-upright":new _t(G.layout_symbol["text-keep-upright"]),"text-transform":new pt(G.layout_symbol["text-transform"]),"text-offset":new pt(G.layout_symbol["text-offset"]),"text-allow-overlap":new _t(G.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new _t(G.layout_symbol["text-ignore-placement"]),"text-optional":new _t(G.layout_symbol["text-optional"])}),Gm={paint:new ti({"icon-opacity":new pt(G.paint_symbol["icon-opacity"]),"icon-color":new pt(G.paint_symbol["icon-color"]),"icon-halo-color":new pt(G.paint_symbol["icon-halo-color"]),"icon-halo-width":new pt(G.paint_symbol["icon-halo-width"]),"icon-halo-blur":new pt(G.paint_symbol["icon-halo-blur"]),"icon-translate":new _t(G.paint_symbol["icon-translate"]),"icon-translate-anchor":new _t(G.paint_symbol["icon-translate-anchor"]),"text-opacity":new pt(G.paint_symbol["text-opacity"]),"text-color":new pt(G.paint_symbol["text-color"],{runtimeType:Je,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new pt(G.paint_symbol["text-halo-color"]),"text-halo-width":new pt(G.paint_symbol["text-halo-width"]),"text-halo-blur":new pt(G.paint_symbol["text-halo-blur"]),"text-translate":new _t(G.paint_symbol["text-translate"]),"text-translate-anchor":new _t(G.paint_symbol["text-translate-anchor"])}),layout:ZT},Xu=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:ot,this.defaultValue=e};Xu.prototype.evaluate=function(e){if(e.formattedSection){var r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},Xu.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},Xu.prototype.outputDefined=function(){return!1},Xu.prototype.serialize=function(){return null},ut("FormatSectionOverride",Xu,{omit:["defaultValue"]});var GT=function(e){function r(a){e.call(this,a,Gm)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.recalculate=function(a,h){if(e.prototype.recalculate.call(this,a,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var v=[],y=0,S=f;y<S.length;y+=1){var C=S[y];v.indexOf(C)<0&&v.push(C)}this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},r.prototype.getValueAndResolveTokens=function(a,h,f,v){var y=this.layout.get(a).evaluate(h,{},f,v),S=this._unevaluatedLayout._values[a];return S.isDataDriven()||pl(S.value)||!y?y:function(C,O){return O.replace(/{([^{}]+)}/g,function(k,L){return L in C?String(C[L]):""})}(h.properties,y)},r.prototype.createBucket=function(a){return new kr(a)},r.prototype.queryRadius=function(){return 0},r.prototype.queryIntersectsFeature=function(){return!1},r.prototype._setPaintOverrides=function(){for(var a=0,h=Gm.paint.overridableProperties;a<h.length;a+=1){var f=h[a];if(r.hasPaintOverride(this.layout,f)){var v,y=this.paint.get(f),S=new Xu(y),C=new Ts(S,y.property.specification);v=y.value.kind==="constant"||y.value.kind==="source"?new hl("source",C):new Cs("composite",C,y.value.zoomStops,y.value._interpolationType),this.paint._values[f]=new hi(y.property,v,y.parameters)}}},r.prototype._handleOverridablePaintPropertyUpdate=function(a,h,f){return!(!this.layout||h.isDataDriven()||f.isDataDriven())&&r.hasPaintOverride(this.layout,a)},r.hasPaintOverride=function(a,h){var f=a.get("text-field"),v=Gm.paint.properties[h],y=!1,S=function(k){for(var L=0,U=k;L<U.length;L+=1)if(v.overrides&&v.overrides.hasOverride(U[L]))return void(y=!0)};if(f.value.kind==="constant"&&f.value.value instanceof on)S(f.value.value.sections);else if(f.value.kind==="source"){var C=function(k){y||(k instanceof Dn&&Zr(k.value)===Mr?S(k.value.sections):k instanceof Ti?S(k.sections):k.eachChild(C))},O=f.value;O._styleExpression&&C(O._styleExpression.expression)}return y},r}(Ia),XT={paint:new ti({"background-color":new _t(G.paint_background["background-color"]),"background-pattern":new di(G.paint_background["background-pattern"]),"background-opacity":new _t(G.paint_background["background-opacity"])})},KT=function(e){function r(a){e.call(this,a,XT)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r}(Ia),YT={paint:new ti({"raster-opacity":new _t(G.paint_raster["raster-opacity"]),"raster-hue-rotate":new _t(G.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new _t(G.paint_raster["raster-brightness-min"]),"raster-brightness-max":new _t(G.paint_raster["raster-brightness-max"]),"raster-saturation":new _t(G.paint_raster["raster-saturation"]),"raster-contrast":new _t(G.paint_raster["raster-contrast"]),"raster-resampling":new _t(G.paint_raster["raster-resampling"]),"raster-fade-duration":new _t(G.paint_raster["raster-fade-duration"])})},JT=function(e){function r(a){e.call(this,a,YT)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r}(Ia),QT=function(e){function r(a){e.call(this,a,{}),this.implementation=a}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},r.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},r.prototype.recalculate=function(){},r.prototype.updateTransitions=function(){},r.prototype.hasTransition=function(){},r.prototype.serialize=function(){},r.prototype.onAdd=function(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},r.prototype.onRemove=function(a){this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},r}(Ia),eC={circle:Am,heatmap:jP,hillshade:BP,fill:rT,"fill-extrusion":pT,line:gT,symbol:GT,background:KT,raster:JT},X_=I.HTMLImageElement,K_=I.HTMLCanvasElement,Y_=I.HTMLVideoElement,J_=I.ImageData,Id=I.ImageBitmap,Ml=function(e,r,a,h){this.context=e,this.format=a,this.texture=e.gl.createTexture(),this.update(r,h)};Ml.prototype.update=function(e,r,a){var h=e.width,f=e.height,v=!(this.size&&this.size[0]===h&&this.size[1]===f||a),y=this.context,S=y.gl;if(this.useMipmap=!!(r&&r.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!r||r.premultiply!==!1)),v)this.size=[h,f],e instanceof X_||e instanceof K_||e instanceof Y_||e instanceof J_||Id&&e instanceof Id?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,e):S.texImage2D(S.TEXTURE_2D,0,this.format,h,f,0,this.format,S.UNSIGNED_BYTE,e.data);else{var C=a||{x:0,y:0},O=C.x,k=C.y;e instanceof X_||e instanceof K_||e instanceof Y_||e instanceof J_||Id&&e instanceof Id?S.texSubImage2D(S.TEXTURE_2D,0,O,k,S.RGBA,S.UNSIGNED_BYTE,e):S.texSubImage2D(S.TEXTURE_2D,0,O,k,h,f,S.RGBA,S.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)},Ml.prototype.bind=function(e,r,a){var h=this.context.gl;h.bindTexture(h.TEXTURE_2D,this.texture),a!==h.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(a=h.LINEAR),e!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,e),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,a||e),this.filter=e),r!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,r),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,r),this.wrap=r)},Ml.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Ml.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Xm=function(e){var r=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})};Xm.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},Xm.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Ku=function(e,r,a){this.target=e,this.parent=r,this.mapId=a,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},ve(["receive","process"],this),this.invoker=new Xm(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=jt()?e:I};function Q_(e,r,a){var h=2*Math.PI*6378137/256/Math.pow(2,a);return[e*h-2*Math.PI*6378137/2,r*h-2*Math.PI*6378137/2]}Ku.prototype.send=function(e,r,a,h,f){var v=this;f===void 0&&(f=!1);var y=Math.round(1e18*Math.random()).toString(36).substring(0,10);a&&(this.callbacks[y]=a);var S=Ir(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:e,hasCallback:!!a,targetMapId:h,mustQueue:f,sourceMapId:this.mapId,data:ma(r,S)},S),{cancel:function(){a&&delete v.callbacks[y],v.target.postMessage({id:y,type:"<cancel>",targetMapId:h,sourceMapId:v.mapId})}}},Ku.prototype.receive=function(e){var r=e.data,a=r.id;if(a&&(!r.targetMapId||this.mapId===r.targetMapId))if(r.type==="<cancel>"){delete this.tasks[a];var h=this.cancelCallbacks[a];delete this.cancelCallbacks[a],h&&h()}else jt()||r.mustQueue?(this.tasks[a]=r,this.taskQueue.push(a),this.invoker.trigger()):this.processTask(a,r)},Ku.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),r=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),r&&this.processTask(e,r)}},Ku.prototype.processTask=function(e,r){var a=this;if(r.type==="<response>"){var h=this.callbacks[e];delete this.callbacks[e],h&&(r.error?h(Oi(r.error)):h(null,Oi(r.data)))}else{var f=!1,v=Ir(this.globalScope)?void 0:[],y=r.hasCallback?function(k,L){f=!0,delete a.cancelCallbacks[e],a.target.postMessage({id:e,type:"<response>",sourceMapId:a.mapId,error:k?ma(k):null,data:ma(L,v)},v)}:function(k){f=!0},S=null,C=Oi(r.data);if(this.parent[r.type])S=this.parent[r.type](r.sourceMapId,C,y);else if(this.parent.getWorkerSource){var O=r.type.split(".");S=this.parent.getWorkerSource(r.sourceMapId,O[0],C.source)[O[1]](C,y)}else y(new Error("Could not find function "+r.type));!f&&S&&S.cancel&&(this.cancelCallbacks[e]=S.cancel)}},Ku.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Rn=function(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Rn.prototype.setNorthEast=function(e){return this._ne=e instanceof Xr?new Xr(e.lng,e.lat):Xr.convert(e),this},Rn.prototype.setSouthWest=function(e){return this._sw=e instanceof Xr?new Xr(e.lng,e.lat):Xr.convert(e),this},Rn.prototype.extend=function(e){var r,a,h=this._sw,f=this._ne;if(e instanceof Xr)r=e,a=e;else{if(!(e instanceof Rn))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Rn.convert(e)):this.extend(Xr.convert(e)):this;if(a=e._ne,!(r=e._sw)||!a)return this}return h||f?(h.lng=Math.min(r.lng,h.lng),h.lat=Math.min(r.lat,h.lat),f.lng=Math.max(a.lng,f.lng),f.lat=Math.max(a.lat,f.lat)):(this._sw=new Xr(r.lng,r.lat),this._ne=new Xr(a.lng,a.lat)),this},Rn.prototype.getCenter=function(){return new Xr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Rn.prototype.getSouthWest=function(){return this._sw},Rn.prototype.getNorthEast=function(){return this._ne},Rn.prototype.getNorthWest=function(){return new Xr(this.getWest(),this.getNorth())},Rn.prototype.getSouthEast=function(){return new Xr(this.getEast(),this.getSouth())},Rn.prototype.getWest=function(){return this._sw.lng},Rn.prototype.getSouth=function(){return this._sw.lat},Rn.prototype.getEast=function(){return this._ne.lng},Rn.prototype.getNorth=function(){return this._ne.lat},Rn.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Rn.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Rn.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Rn.prototype.contains=function(e){var r=Xr.convert(e),a=r.lng,h=r.lat,f=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&f},Rn.convert=function(e){return!e||e instanceof Rn?e:new Rn(e)};var Xr=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid LngLat object: ("+e+", "+r+")");if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Xr.prototype.wrap=function(){return new Xr(ee(this.lng,-180,180),this.lat)},Xr.prototype.toArray=function(){return[this.lng,this.lat]},Xr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Xr.prototype.distanceTo=function(e){var r=Math.PI/180,a=this.lat*r,h=e.lat*r,f=Math.sin(a)*Math.sin(h)+Math.cos(a)*Math.cos(h)*Math.cos((e.lng-this.lng)*r);return 63710088e-1*Math.acos(Math.min(f,1))},Xr.prototype.toBounds=function(e){e===void 0&&(e=0);var r=360*e/40075017,a=r/Math.cos(Math.PI/180*this.lat);return new Rn(new Xr(this.lng-a,this.lat-r),new Xr(this.lng+a,this.lat+r))},Xr.convert=function(e){if(e instanceof Xr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Xr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Xr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var e0=2*Math.PI*63710088e-1;function t0(e){return e0*Math.cos(e*Math.PI/180)}function r0(e){return(180+e)/360}function n0(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function i0(e,r){return e/t0(r)}function Km(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Ol=function(e,r,a){a===void 0&&(a=0),this.x=+e,this.y=+r,this.z=+a};Ol.fromLngLat=function(e,r){r===void 0&&(r=0);var a=Xr.convert(e);return new Ol(r0(a.lng),n0(a.lat),i0(r,a.lat))},Ol.prototype.toLngLat=function(){return new Xr(360*this.x-180,Km(this.y))},Ol.prototype.toAltitude=function(){return this.z*t0(Km(this.y))},Ol.prototype.meterInMercatorCoordinateUnits=function(){return 1/e0*(e=Km(this.y),1/Math.cos(e*Math.PI/180));var e};var Rl=function(e,r,a){this.z=e,this.x=r,this.y=a,this.key=xp(0,e,e,r,a)};Rl.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Rl.prototype.url=function(e,r){var a,h,f,v,y,S=(h=this.y,f=this.z,v=Q_(256*(a=this.x),256*(h=Math.pow(2,f)-h-1),f),y=Q_(256*(a+1),256*(h+1),f),v[0]+","+v[1]+","+y[0]+","+y[1]),C=function(O,k,L){for(var U,$="",oe=O;oe>0;oe--)$+=(k&(U=1<<oe-1)?1:0)+(L&U?2:0);return $}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",C).replace("{bbox-epsg-3857}",S)},Rl.prototype.getTilePoint=function(e){var r=Math.pow(2,this.z);return new T(8192*(e.x*r-this.x),8192*(e.y*r-this.y))},Rl.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var a0=function(e,r){this.wrap=e,this.canonical=r,this.key=xp(e,r.z,r.z,r.x,r.y)},An=function(e,r,a,h,f){this.overscaledZ=e,this.wrap=r,this.canonical=new Rl(a,+h,+f),this.key=xp(r,e,a,h,f)};function xp(e,r,a,h,f){(e*=2)<0&&(e=-1*e-1);var v=1<<a;return(v*v*e+v*f+h).toString(36)+a.toString(36)+r.toString(36)}An.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},An.prototype.scaledTo=function(e){var r=this.canonical.z-e;return e>this.canonical.z?new An(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new An(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)},An.prototype.calculateScaledKey=function(e,r){var a=this.canonical.z-e;return e>this.canonical.z?xp(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):xp(this.wrap*+r,e,e,this.canonical.x>>a,this.canonical.y>>a)},An.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r},An.prototype.children=function(e){if(this.overscaledZ>=e)return[new An(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var r=this.canonical.z+1,a=2*this.canonical.x,h=2*this.canonical.y;return[new An(r,this.wrap,r,a,h),new An(r,this.wrap,r,a+1,h),new An(r,this.wrap,r,a,h+1),new An(r,this.wrap,r,a+1,h+1)]},An.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},An.prototype.wrapped=function(){return new An(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},An.prototype.unwrapTo=function(e){return new An(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},An.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},An.prototype.toUnwrapped=function(){return new a0(this.wrap,this.canonical)},An.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},An.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Ol(e.x-this.wrap,e.y))},ut("CanonicalTileID",Rl),ut("OverscaledTileID",An,{omit:["posMatrix"]});var is=function(e,r,a){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(a&&a!=="mapbox"&&a!=="terrarium")return ce('"'+a+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=r.height;var h=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=a||"mapbox";for(var f=0;f<h;f++)this.data[this._idx(-1,f)]=this.data[this._idx(0,f)],this.data[this._idx(h,f)]=this.data[this._idx(h-1,f)],this.data[this._idx(f,-1)]=this.data[this._idx(f,0)],this.data[this._idx(f,h)]=this.data[this._idx(f,h-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(h,-1)]=this.data[this._idx(h-1,0)],this.data[this._idx(-1,h)]=this.data[this._idx(0,h-1)],this.data[this._idx(h,h)]=this.data[this._idx(h-1,h-1)]};is.prototype.get=function(e,r){var a=new Uint8Array(this.data.buffer),h=4*this._idx(e,r);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(a[h],a[h+1],a[h+2])},is.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},is.prototype._idx=function(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)},is.prototype._unpackMapbox=function(e,r,a){return(256*e*256+256*r+a)/10-1e4},is.prototype._unpackTerrarium=function(e,r,a){return 256*e+r+a/256-32768},is.prototype.getPixels=function(){return new Li({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},is.prototype.backfillBorder=function(e,r,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var h=r*this.dim,f=r*this.dim+this.dim,v=a*this.dim,y=a*this.dim+this.dim;switch(r){case-1:h=f-1;break;case 1:f=h+1}switch(a){case-1:v=y-1;break;case 1:y=v+1}for(var S=-r*this.dim,C=-a*this.dim,O=v;O<y;O++)for(var k=h;k<f;k++)this.data[this._idx(k,O)]=e.data[this._idx(k+S,O+C)]},ut("DEMData",is);var Md=function(e){this._stringToNumber={},this._numberToString=[];for(var r=0;r<e.length;r++){var a=e[r];this._stringToNumber[a]=r,this._numberToString[r]=a}};Md.prototype.encode=function(e){return this._stringToNumber[e]},Md.prototype.decode=function(e){return this._numberToString[e]};var Od=function(e,r,a,h,f){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=a,e._y=h,this.properties=e.properties,this.id=f},Ym={geometry:{configurable:!0}};Ym.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Ym.geometry.set=function(e){this._geometry=e},Od.prototype.toJSON=function(){var e={geometry:this.geometry};for(var r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(e[r]=this[r]);return e},Object.defineProperties(Od.prototype,Ym);var Yu=function(){this.state={},this.stateChanges={},this.deletedStates={}};Yu.prototype.updateState=function(e,r,a){var h=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},J(this.stateChanges[e][h],a),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==h&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][h]===null)for(var v in this.deletedStates[e][h]={},this.state[e][h])a[v]||(this.deletedStates[e][h][v]=null);else for(var y in a)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][y]===null&&delete this.deletedStates[e][h][y]},Yu.prototype.removeFeatureState=function(e,r,a){if(this.deletedStates[e]!==null){var h=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},a&&r!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][a]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(a in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][a]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}},Yu.prototype.getState=function(e,r){var a=String(r),h=J({},(this.state[e]||{})[a],(this.stateChanges[e]||{})[a]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][r];if(f===null)return{};for(var v in f)delete h[v]}return h},Yu.prototype.initializeTileState=function(e,r){e.setFeatureState(this.state,r)},Yu.prototype.coalesceChanges=function(e,r){var a={};for(var h in this.stateChanges){this.state[h]=this.state[h]||{};var f={};for(var v in this.stateChanges[h])this.state[h][v]||(this.state[h][v]={}),J(this.state[h][v],this.stateChanges[h][v]),f[v]=this.state[h][v];a[h]=f}for(var y in this.deletedStates){this.state[y]=this.state[y]||{};var S={};if(this.deletedStates[y]===null)for(var C in this.state[y])S[C]={},this.state[y][C]={};else for(var O in this.deletedStates[y]){if(this.deletedStates[y][O]===null)this.state[y][O]={};else for(var k=0,L=Object.keys(this.deletedStates[y][O]);k<L.length;k+=1)delete this.state[y][O][L[k]];S[O]=this.state[y][O]}a[y]=a[y]||{},J(a[y],S)}if(this.stateChanges={},this.deletedStates={},Object.keys(a).length!==0)for(var U in e)e[U].setFeatureState(a,r)};var as=function(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ua(8192,16,0),this.grid3D=new Ua(8192,16,0),this.featureIndexArray=new j,this.promoteId=r};function o0(e,r,a,h,f){return ie(e,function(v,y){var S=r instanceof xl?r.get(y):null;return S&&S.evaluate?S.evaluate(a,h,f):S})}function s0(e){for(var r=1/0,a=1/0,h=-1/0,f=-1/0,v=0,y=e;v<y.length;v+=1){var S=y[v];r=Math.min(r,S.x),a=Math.min(a,S.y),h=Math.max(h,S.x),f=Math.max(f,S.y)}return{minX:r,minY:a,maxX:h,maxY:f}}function tC(e,r){return r-e}as.prototype.insert=function(e,r,a,h,f,v){var y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,h,f);for(var S=v?this.grid3D:this.grid,C=0;C<r.length;C++){for(var O=r[C],k=[1/0,1/0,-1/0,-1/0],L=0;L<O.length;L++){var U=O[L];k[0]=Math.min(k[0],U.x),k[1]=Math.min(k[1],U.y),k[2]=Math.max(k[2],U.x),k[3]=Math.max(k[3],U.y)}k[0]<8192&&k[1]<8192&&k[2]>=0&&k[3]>=0&&S.insert(y,k[0],k[1],k[2],k[3])}},as.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Uu.VectorTile(new yd(this.rawTileData)).layers,this.sourceLayerCoder=new Md(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},as.prototype.query=function(e,r,a,h){var f=this;this.loadVTLayers();for(var v=e.params||{},y=8192/e.tileSize/e.scale,S=Eu(v.filter),C=e.queryGeometry,O=e.queryPadding*y,k=s0(C),L=this.grid.query(k.minX-O,k.minY-O,k.maxX+O,k.maxY+O),U=s0(e.cameraQueryGeometry),$=this.grid3D.query(U.minX-O,U.minY-O,U.maxX+O,U.maxY+O,function(Re,Le,Ve,Ze){return function(Qe,vt,nt,xt,it){for(var Xt=0,Rt=Qe;Xt<Rt.length;Xt+=1){var ht=Rt[Xt];if(vt<=ht.x&&nt<=ht.y&&xt>=ht.x&&it>=ht.y)return!0}var rr=[new T(vt,nt),new T(vt,it),new T(xt,it),new T(xt,nt)];if(Qe.length>2){for(var Vt=0,cr=rr;Vt<cr.length;Vt+=1)if(Oa(Qe,cr[Vt]))return!0}for(var wt=0;wt<Qe.length-1;wt++)if(Tl(Qe[wt],Qe[wt+1],rr))return!0;return!1}(e.cameraQueryGeometry,Re-O,Le-O,Ve+O,Ze+O)}),oe=0,le=$;oe<le.length;oe+=1)L.push(le[oe]);L.sort(tC);for(var _e,fe={},Te=function(Re){var Le=L[Re];if(Le!==_e){_e=Le;var Ve=f.featureIndexArray.get(Le),Ze=null;f.loadMatchingFeature(fe,Ve.bucketIndex,Ve.sourceLayerIndex,Ve.featureIndex,S,v.layers,v.availableImages,r,a,h,function(Qe,vt,nt){return Ze||(Ze=rn(Qe)),vt.queryIntersectsFeature(C,Qe,nt,Ze,f.z,e.transform,y,e.pixelPosMatrix)})}},Me=0;Me<L.length;Me++)Te(Me);return fe},as.prototype.loadMatchingFeature=function(e,r,a,h,f,v,y,S,C,O,k){var L=this.bucketLayerIDs[r];if(!v||function(Qe,vt){for(var nt=0;nt<Qe.length;nt++)if(vt.indexOf(Qe[nt])>=0)return!0;return!1}(v,L)){var U=this.sourceLayerCoder.decode(a),$=this.vtLayers[U].feature(h);if(f.needGeometry){var oe=mn($,!0);if(!f.filter(new ir(this.tileID.overscaledZ),oe,this.tileID.canonical))return}else if(!f.filter(new ir(this.tileID.overscaledZ),$))return;for(var le=this.getId($,U),_e=0;_e<L.length;_e++){var fe=L[_e];if(!(v&&v.indexOf(fe)<0)){var Te=S[fe];if(Te){var Me={};le!==void 0&&O&&(Me=O.getState(Te.sourceLayer||"_geojsonTileLayer",le));var Re=J({},C[fe]);Re.paint=o0(Re.paint,Te.paint,$,Me,y),Re.layout=o0(Re.layout,Te.layout,$,Me,y);var Le=!k||k($,Te,Me);if(Le){var Ve=new Od($,this.z,this.x,this.y,le);Ve.layer=Re;var Ze=e[fe];Ze===void 0&&(Ze=e[fe]=[]),Ze.push({featureIndex:h,feature:Ve,intersectionZ:Le})}}}}}},as.prototype.lookupSymbolFeatures=function(e,r,a,h,f,v,y,S){var C={};this.loadVTLayers();for(var O=Eu(f),k=0,L=e;k<L.length;k+=1)this.loadMatchingFeature(C,a,h,L[k],O,v,y,S,r);return C},as.prototype.hasLayer=function(e){for(var r=0,a=this.bucketLayerIDs;r<a.length;r+=1)for(var h=0,f=a[r];h<f.length;h+=1)if(e===f[h])return!0;return!1},as.prototype.getId=function(e,r){var a=e.id;return this.promoteId&&typeof(a=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]])=="boolean"&&(a=Number(a)),a},ut("FeatureIndex",as,{omit:["rawTileData","sourceLayerCoder"]});var Wn=function(e,r){this.tileID=e,this.uid=B(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Wn.prototype.registerFadeDuration=function(e){var r=e+this.timeAdded;r<er.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)},Wn.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Wn.prototype.loadVectorData=function(e,r,a){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var h in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(O,k){var L={};if(!k)return L;for(var U=function(){var le=oe[$],_e=le.layerIds.map(function(Me){return k.getLayer(Me)}).filter(Boolean);if(_e.length!==0){le.layers=_e,le.stateDependentLayerIds&&(le.stateDependentLayers=le.stateDependentLayerIds.map(function(Me){return _e.filter(function(Re){return Re.id===Me})[0]}));for(var fe=0,Te=_e;fe<Te.length;fe+=1)L[Te[fe].id]=le}},$=0,oe=O;$<oe.length;$+=1)U();return L}(e.buckets,r.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[h];if(f instanceof kr){if(this.hasSymbolBuckets=!0,!a)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var v in this.buckets){var y=this.buckets[v];if(y instanceof kr&&y.hasRTLText){this.hasRTLText=!0,qi.isLoading()||qi.isLoaded()||ip()!=="deferred"||va();break}}for(var S in this.queryPadding=0,this.buckets){var C=this.buckets[S];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(S).queryRadius(C))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new c},Wn.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Wn.prototype.getBucket=function(e){return this.buckets[e.id]},Wn.prototype.upload=function(e){for(var r in this.buckets){var a=this.buckets[r];a.uploadPending()&&a.upload(e)}var h=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ml(e,this.imageAtlas.image,h.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ml(e,this.glyphAtlasImage,h.ALPHA),this.glyphAtlasImage=null)},Wn.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Wn.prototype.queryRenderedFeatures=function(e,r,a,h,f,v,y,S,C,O){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:f,scale:v,tileSize:this.tileSize,pixelPosMatrix:O,transform:S,params:y,queryPadding:this.queryPadding*C},e,r,a):{}},Wn.prototype.querySourceFeatures=function(e,r){var a=this.latestFeatureIndex;if(a&&a.rawTileData){var h=a.loadVTLayers(),f=r?r.sourceLayer:"",v=h._geojsonTileLayer||h[f];if(v)for(var y=Eu(r&&r.filter),S=this.tileID.canonical,C=S.z,O=S.x,k=S.y,L={z:C,x:O,y:k},U=0;U<v.length;U++){var $=v.feature(U);if(y.needGeometry){var oe=mn($,!0);if(!y.filter(new ir(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!y.filter(new ir(this.tileID.overscaledZ),$))continue;var le=a.getId($,f),_e=new Od($,C,O,k,le);_e.tile=L,e.push(_e)}}},Wn.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Wn.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Wn.prototype.setExpiryData=function(e){var r=this.expirationTime;if(e.cacheControl){var a=Tt(e.cacheControl);a["max-age"]&&(this.expirationTime=Date.now()+1e3*a["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var h=Date.now(),f=!1;if(this.expirationTime>h)f=!1;else if(r)if(this.expirationTime<r)f=!0;else{var v=this.expirationTime-r;v?this.expirationTime=h+Math.max(v,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Wn.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Wn.prototype.setFeatureState=function(e,r){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var a=this.latestFeatureIndex.loadVTLayers();for(var h in this.buckets)if(r.style.hasLayer(h)){var f=this.buckets[h],v=f.layers[0].sourceLayer||"_geojsonTileLayer",y=a[v],S=e[v];if(y&&S&&Object.keys(S).length!==0){f.update(S,y,this.imageAtlas&&this.imageAtlas.patternPositions||{});var C=r&&r.style&&r.style.getLayer(h);C&&(this.queryPadding=Math.max(this.queryPadding,C.queryRadius(f)))}}}},Wn.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Wn.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<er.now()},Wn.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Wn.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=er.now()+e},Wn.prototype.setDependencies=function(e,r){for(var a={},h=0,f=r;h<f.length;h+=1)a[f[h]]=!0;this.dependencies[e]=a},Wn.prototype.hasDependency=function(e,r){for(var a=0,h=e;a<h.length;a+=1){var f=this.dependencies[h[a]];if(f){for(var v=0,y=r;v<y.length;v+=1)if(f[y[v]])return!0}}return!1};var Ns=I.performance,l0=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},Ns.mark(this._marks.start)};l0.prototype.finish=function(){Ns.mark(this._marks.end);var e=Ns.getEntriesByName(this._marks.measure);return e.length===0&&(Ns.measure(this._marks.measure,this._marks.start,this._marks.end),e=Ns.getEntriesByName(this._marks.measure),Ns.clearMarks(this._marks.start),Ns.clearMarks(this._marks.end),Ns.clearMeasures(this._marks.measure)),e},o.Actor=Ku,o.AlphaImage=Il,o.CanonicalTileID=Rl,o.CollisionBoxArray=c,o.Color=Qt,o.DEMData=is,o.DataConstantProperty=_t,o.DictionaryCoder=Md,o.EXTENT=8192,o.ErrorEvent=xe,o.EvaluationParameters=ir,o.Event=ue,o.Evented=Se,o.FeatureIndex=as,o.FillBucket=Wa,o.FillExtrusionBucket=Ha,o.ImageAtlas=_p,o.ImagePosition=bd,o.LineBucket=xi,o.LngLat=Xr,o.LngLatBounds=Rn,o.MercatorCoordinate=Ol,o.ONE_EM=24,o.OverscaledTileID=An,o.Point=T,o.Point$1=T,o.Properties=ti,o.Protobuf=yd,o.RGBAImage=Li,o.RequestManager=hr,o.RequestPerformance=l0,o.ResourceType=ja,o.SegmentVector=X,o.SourceFeatureState=Yu,o.StructArrayLayout1ui2=cp,o.StructArrayLayout2f1f2i16=es,o.StructArrayLayout2i4=Qo,o.StructArrayLayout3ui6=go,o.StructArrayLayout4i8=op,o.SymbolBucket=kr,o.Texture=Ml,o.Tile=Wn,o.Transitionable=ei,o.Uniform1f=Ke,o.Uniform1i=qe,o.Uniform2f=Xe,o.Uniform3f=at,o.Uniform4f=bt,o.UniformColor=Pt,o.UniformMatrix4f=mr,o.UnwrappedTileID=a0,o.ValidationError=he,o.WritingMode=ua,o.ZoomHistory=ep,o.add=function(e,r,a){return e[0]=r[0]+a[0],e[1]=r[1]+a[1],e[2]=r[2]+a[2],e},o.addDynamicAttributes=Zm,o.asyncAll=function(e,r,a){if(!e.length)return a(null,[]);var h=e.length,f=new Array(e.length),v=null;e.forEach(function(y,S){r(y,function(C,O){C&&(v=C),f[S]=O,--h==0&&a(v,f)})})},o.bezier=D,o.bindAll=ve,o.browser=er,o.cacheEntryPossiblyAdded=function(e){++zo>to&&(e.getActor().send("enforceCacheSizeLimit",da),zo=0)},o.clamp=W,o.clearTileCache=function(e){var r=I.caches.delete("mapbox-tiles");e&&r.catch(e).then(function(){return e()})},o.clipLine=q_,o.clone=function(e){var r=new Sr(16);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},o.clone$1=ze,o.clone$2=function(e){var r=new Sr(3);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r},o.collisionCircleLayout=xT,o.config=mt,o.create=function(){var e=new Sr(16);return Sr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},o.create$1=function(){var e=new Sr(9);return Sr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},o.create$2=function(){var e=new Sr(4);return Sr!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},o.createCommonjsModule=_,o.createExpression=wu,o.createLayout=qn,o.createStyleLayer=function(e){return e.type==="custom"?new QT(e):new eC[e.type](e)},o.cross=function(e,r,a){var h=r[0],f=r[1],v=r[2],y=a[0],S=a[1],C=a[2];return e[0]=f*C-v*S,e[1]=v*y-h*C,e[2]=h*S-f*y,e},o.deepEqual=function e(r,a){if(Array.isArray(r)){if(!Array.isArray(a)||r.length!==a.length)return!1;for(var h=0;h<r.length;h++)if(!e(r[h],a[h]))return!1;return!0}if(typeof r=="object"&&r!==null&&a!==null){if(typeof a!="object"||Object.keys(r).length!==Object.keys(a).length)return!1;for(var f in r)if(!e(r[f],a[f]))return!1;return!0}return r===a},o.dot=function(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]},o.dot$1=function(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3]},o.ease=re,o.emitValidationErrors=yl,o.endsWith=de,o.enforceCacheSizeLimit=function(e){ro(),lt&&lt.then(function(r){r.keys().then(function(a){for(var h=0;h<a.length-e;h++)r.delete(a[h])})})},o.evaluateSizeForFeature=j_,o.evaluateSizeForZoom=N_,o.evaluateVariableOffset=H_,o.evented=np,o.extend=J,o.featureFilter=Eu,o.filterObject=we,o.fromRotation=function(e,r){var a=Math.sin(r),h=Math.cos(r);return e[0]=h,e[1]=a,e[2]=0,e[3]=-a,e[4]=h,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},o.getAnchorAlignment=qm,o.getAnchorJustification=Hm,o.getArrayBuffer=No,o.getImage=F,o.getJSON=function(e,r){return Ta(J(e,{type:"json"}),r)},o.getRTLTextPluginStatus=ip,o.getReferrer=Na,o.getVideo=function(e,r){var a,h,f=I.document.createElement("video");f.muted=!0,f.onloadstart=function(){r(null,f)};for(var v=0;v<e.length;v++){var y=I.document.createElement("source");a=e[v],h=void 0,(h=I.document.createElement("a")).href=a,(h.protocol!==I.document.location.protocol||h.host!==I.document.location.host)&&(f.crossOrigin="Anonymous"),y.src=e[v],f.appendChild(y)}return{cancel:function(){}}},o.identity=$i,o.invert=function(e,r){var a=r[0],h=r[1],f=r[2],v=r[3],y=r[4],S=r[5],C=r[6],O=r[7],k=r[8],L=r[9],U=r[10],$=r[11],oe=r[12],le=r[13],_e=r[14],fe=r[15],Te=a*S-h*y,Me=a*C-f*y,Re=a*O-v*y,Le=h*C-f*S,Ve=h*O-v*S,Ze=f*O-v*C,Qe=k*le-L*oe,vt=k*_e-U*oe,nt=k*fe-$*oe,xt=L*_e-U*le,it=L*fe-$*le,Xt=U*fe-$*_e,Rt=Te*Xt-Me*it+Re*xt+Le*nt-Ve*vt+Ze*Qe;return Rt?(e[0]=(S*Xt-C*it+O*xt)*(Rt=1/Rt),e[1]=(f*it-h*Xt-v*xt)*Rt,e[2]=(le*Ze-_e*Ve+fe*Le)*Rt,e[3]=(U*Ve-L*Ze-$*Le)*Rt,e[4]=(C*nt-y*Xt-O*vt)*Rt,e[5]=(a*Xt-f*nt+v*vt)*Rt,e[6]=(_e*Re-oe*Ze-fe*Me)*Rt,e[7]=(k*Ze-U*Re+$*Me)*Rt,e[8]=(y*it-S*nt+O*Qe)*Rt,e[9]=(h*nt-a*it-v*Qe)*Rt,e[10]=(oe*Ve-le*Re+fe*Te)*Rt,e[11]=(L*Re-k*Ve-$*Te)*Rt,e[12]=(S*vt-y*xt-C*Qe)*Rt,e[13]=(a*xt-h*vt+f*Qe)*Rt,e[14]=(le*Me-oe*Le-_e*Te)*Rt,e[15]=(k*Le-L*Me+U*Te)*Rt,e):null},o.isChar=et,o.isMapboxURL=dr,o.keysDifference=function(e,r){var a=[];for(var h in e)h in r||a.push(h);return a},o.makeRequest=Ta,o.mapObject=ie,o.mercatorXfromLng=r0,o.mercatorYfromLat=n0,o.mercatorZfromAltitude=i0,o.mul=Rm,o.multiply=bi,o.mvt=Uu,o.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},o.normalize=function(e,r){var a=r[0],h=r[1],f=r[2],v=a*a+h*h+f*f;return v>0&&(v=1/Math.sqrt(v)),e[0]=r[0]*v,e[1]=r[1]*v,e[2]=r[2]*v,e},o.number=Sn,o.offscreenCanvasSupported=jo,o.ortho=function(e,r,a,h,f,v,y){var S=1/(r-a),C=1/(h-f),O=1/(v-y);return e[0]=-2*S,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*C,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*O,e[11]=0,e[12]=(r+a)*S,e[13]=(f+h)*C,e[14]=(y+v)*O,e[15]=1,e},o.parseGlyphPBF=function(e){return new yd(e).readFields(AT,[])},o.pbf=yd,o.performSymbolLayout=function(e,r,a,h,f,v,y){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var S=e.layers[0].layout,C=e.layers[0]._unevaluatedLayout._values,O={};if(e.textSizeData.kind==="composite"){var k=e.textSizeData,L=k.maxZoom;O.compositeTextSizes=[C["text-size"].possiblyEvaluate(new ir(k.minZoom),y),C["text-size"].possiblyEvaluate(new ir(L),y)]}if(e.iconSizeData.kind==="composite"){var U=e.iconSizeData,$=U.maxZoom;O.compositeIconSizes=[C["icon-size"].possiblyEvaluate(new ir(U.minZoom),y),C["icon-size"].possiblyEvaluate(new ir($),y)]}O.layoutTextSize=C["text-size"].possiblyEvaluate(new ir(e.zoom+1),y),O.layoutIconSize=C["icon-size"].possiblyEvaluate(new ir(e.zoom+1),y),O.textMaxSize=C["text-size"].possiblyEvaluate(new ir(18));for(var oe=24*S.get("text-line-height"),le=S.get("text-rotation-alignment")==="map"&&S.get("symbol-placement")!=="point",_e=S.get("text-keep-upright"),fe=S.get("text-size"),Te=function(){var Le=Re[Me],Ve=S.get("text-font").evaluate(Le,{},y).join(","),Ze=fe.evaluate(Le,{},y),Qe=O.layoutTextSize.evaluate(Le,{},y),vt=O.layoutIconSize.evaluate(Le,{},y),nt={horizontal:{},vertical:void 0},xt=Le.text,it=[0,0];if(xt){var Xt=xt.toString(),Rt=24*S.get("text-letter-spacing").evaluate(Le,{},y),ht=function(or){for(var Lr=0,Rr=or;Lr<Rr.length;Lr+=1)if(vr=Rr[Lr].charCodeAt(0),et.Arabic(vr)||et["Arabic Supplement"](vr)||et["Arabic Extended-A"](vr)||et["Arabic Presentation Forms-A"](vr)||et["Arabic Presentation Forms-B"](vr))return!1;var vr;return!0}(Xt)?Rt:0,rr=S.get("text-anchor").evaluate(Le,{},y),Vt=S.get("text-variable-anchor");if(!Vt){var cr=S.get("text-radial-offset").evaluate(Le,{},y);it=cr?H_(rr,[24*cr,Wm]):S.get("text-offset").evaluate(Le,{},y).map(function(or){return 24*or})}var wt=le?"center":S.get("text-justify").evaluate(Le,{},y),_r=S.get("symbol-placement"),Kr=_r==="point"?24*S.get("text-max-width").evaluate(Le,{},y):0,un=function(){e.allowVerticalPlacement&&tp(Xt)&&(nt.vertical=xd(xt,r,a,f,Ve,Kr,oe,rr,"left",ht,it,ua.vertical,!0,_r,Qe,Ze))};if(!le&&Vt){for(var nn=wt==="auto"?Vt.map(function(or){return Hm(or)}):[wt],Yr=!1,cn=0;cn<nn.length;cn++){var jn=nn[cn];if(!nt.horizontal[jn])if(Yr)nt.horizontal[jn]=nt.horizontal[0];else{var Nn=xd(xt,r,a,f,Ve,Kr,oe,"center",jn,ht,it,ua.horizontal,!1,_r,Qe,Ze);Nn&&(nt.horizontal[jn]=Nn,Yr=Nn.positionedLines.length===1)}}un()}else{wt==="auto"&&(wt=Hm(rr));var vi=xd(xt,r,a,f,Ve,Kr,oe,rr,wt,ht,it,ua.horizontal,!1,_r,Qe,Ze);vi&&(nt.horizontal[wt]=vi),un(),tp(Xt)&&le&&_e&&(nt.vertical=xd(xt,r,a,f,Ve,Kr,oe,rr,wt,ht,it,ua.vertical,!1,_r,Qe,Ze))}}var Hn=void 0,gi=!1;if(Le.icon&&Le.icon.name){var vn=h[Le.icon.name];vn&&(Hn=function(or,Lr,Rr){var vr=qm(Rr),wi=Lr[0]-or.displaySize[0]*vr.horizontalAlign,ai=Lr[1]-or.displaySize[1]*vr.verticalAlign;return{image:or,top:ai,bottom:ai+or.displaySize[1],left:wi,right:wi+or.displaySize[0]}}(f[Le.icon.name],S.get("icon-offset").evaluate(Le,{},y),S.get("icon-anchor").evaluate(Le,{},y)),gi=vn.sdf,e.sdfIcons===void 0?e.sdfIcons=vn.sdf:e.sdfIcons!==vn.sdf&&ce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(vn.pixelRatio!==e.pixelRatio||S.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Zn=G_(nt.horizontal)||nt.vertical;e.iconsInText=!!Zn&&Zn.iconsInText,(Zn||Hn)&&function(or,Lr,Rr,vr,wi,ai,Wr,Pn,oi,br,So){var ca=ai.textMaxSize.evaluate(Lr,{});ca===void 0&&(ca=Wr);var Eo,gn=or.layers[0].layout,Po=gn.get("icon-offset").evaluate(Lr,{},So),Aa=G_(Rr.horizontal),Ju=Wr/24,Al=or.tilePixelRatio*Ju,Qu=or.tilePixelRatio*ca/24,os=or.tilePixelRatio*Pn,ec=or.tilePixelRatio*gn.get("symbol-spacing"),Rd=gn.get("text-padding")*or.tilePixelRatio,tc=gn.get("icon-padding")*or.tilePixelRatio,wp=gn.get("text-max-angle")/180*Math.PI,Ad=gn.get("text-rotation-alignment")==="map"&&gn.get("symbol-placement")!=="point",kd=gn.get("icon-rotation-alignment")==="map"&&gn.get("symbol-placement")!=="point",ss=gn.get("symbol-placement"),Sp=ec/2,rc=gn.get("icon-text-fit");vr&&rc!=="none"&&(or.allowVerticalPlacement&&Rr.vertical&&(Eo=z_(vr,Rr.vertical,rc,gn.get("icon-text-fit-padding"),Po,Ju)),Aa&&(vr=z_(vr,Aa,rc,gn.get("icon-text-fit-padding"),Po,Ju)));var Bs=function(rC,Rp){Rp.x<0||Rp.x>=8192||Rp.y<0||Rp.y>=8192||function(yn,Za,nC,Fs,tv,p0,Bd,To,Fd,Ap,Ud,Vd,rv,h0,kp,d0,f0,m0,v0,g0,pa,qd,y0,Co,iC){var _0,Dl,sc,lc,uc,cc=yn.addToLineVertexArray(Za,nC),b0=0,x0=0,w0=0,S0=0,nv=-1,iv=-1,ls={},E0=ae(""),av=0,ov=0;if(To._unevaluatedLayout.getValue("text-radial-offset")===void 0?(av=(_0=To.layout.get("text-offset").evaluate(pa,{},Co).map(function(Lp){return 24*Lp}))[0],ov=_0[1]):(av=24*To.layout.get("text-radial-offset").evaluate(pa,{},Co),ov=Wm),yn.allowVerticalPlacement&&Fs.vertical){var P0=To.layout.get("text-rotate").evaluate(pa,{},Co)+90;lc=new Td(Fd,Za,Ap,Ud,Vd,Fs.vertical,rv,h0,kp,P0),Bd&&(uc=new Td(Fd,Za,Ap,Ud,Vd,Bd,f0,m0,kp,P0))}if(tv){var sv=To.layout.get("icon-rotate").evaluate(pa,{}),T0=To.layout.get("icon-text-fit")!=="none",C0=$_(tv,sv,y0,T0),lv=Bd?$_(Bd,sv,y0,T0):void 0;sc=new Td(Fd,Za,Ap,Ud,Vd,tv,f0,m0,!1,sv),b0=4*C0.length;var I0=yn.iconSizeData,Dp=null;I0.kind==="source"?(Dp=[128*To.layout.get("icon-size").evaluate(pa,{})])[0]>32640&&ce(yn.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):I0.kind==="composite"&&((Dp=[128*qd.compositeIconSizes[0].evaluate(pa,{},Co),128*qd.compositeIconSizes[1].evaluate(pa,{},Co)])[0]>32640||Dp[1]>32640)&&ce(yn.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),yn.addSymbols(yn.icon,C0,Dp,g0,v0,pa,!1,Za,cc.lineStartIndex,cc.lineLength,-1,Co),nv=yn.icon.placedSymbolArray.length-1,lv&&(x0=4*lv.length,yn.addSymbols(yn.icon,lv,Dp,g0,v0,pa,ua.vertical,Za,cc.lineStartIndex,cc.lineLength,-1,Co),iv=yn.icon.placedSymbolArray.length-1)}for(var M0 in Fs.horizontal){var $d=Fs.horizontal[M0];if(!Dl){E0=ae($d.text);var aC=To.layout.get("text-rotate").evaluate(pa,{},Co);Dl=new Td(Fd,Za,Ap,Ud,Vd,$d,rv,h0,kp,aC)}var O0=$d.positionedLines.length===1;if(w0+=Z_(yn,Za,$d,p0,To,kp,pa,d0,cc,Fs.vertical?ua.horizontal:ua.horizontalOnly,O0?Object.keys(Fs.horizontal):[M0],ls,nv,qd,Co),O0)break}Fs.vertical&&(S0+=Z_(yn,Za,Fs.vertical,p0,To,kp,pa,d0,cc,ua.vertical,["vertical"],ls,iv,qd,Co));var oC=Dl?Dl.boxStartIndex:yn.collisionBoxArray.length,sC=Dl?Dl.boxEndIndex:yn.collisionBoxArray.length,lC=lc?lc.boxStartIndex:yn.collisionBoxArray.length,uC=lc?lc.boxEndIndex:yn.collisionBoxArray.length,cC=sc?sc.boxStartIndex:yn.collisionBoxArray.length,pC=sc?sc.boxEndIndex:yn.collisionBoxArray.length,hC=uc?uc.boxStartIndex:yn.collisionBoxArray.length,dC=uc?uc.boxEndIndex:yn.collisionBoxArray.length,Io=-1,Wd=function(Lp,A0){return Lp&&Lp.circleDiameter?Math.max(Lp.circleDiameter,A0):A0};Io=Wd(Dl,Io),Io=Wd(lc,Io),Io=Wd(sc,Io);var R0=(Io=Wd(uc,Io))>-1?1:0;R0&&(Io*=iC/24),yn.glyphOffsetArray.length>=kr.MAX_GLYPHS&&ce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),pa.sortKey!==void 0&&yn.addToSortKeyRanges(yn.symbolInstances.length,pa.sortKey),yn.symbolInstances.emplaceBack(Za.x,Za.y,ls.right>=0?ls.right:-1,ls.center>=0?ls.center:-1,ls.left>=0?ls.left:-1,ls.vertical||-1,nv,iv,E0,oC,sC,lC,uC,cC,pC,hC,dC,Ap,w0,S0,b0,x0,R0,0,rv,av,ov,Io)}(or,Rp,rC,Rr,vr,wi,Eo,or.layers[0],or.collisionBoxArray,Lr.index,Lr.sourceLayerIndex,or.index,Al,Rd,Ad,oi,os,tc,kd,Po,Lr,ai,br,So,Wr)};if(ss==="line")for(var nc=0,Dd=q_(Lr.geometry,0,0,8192,8192);nc<Dd.length;nc+=1)for(var Ld=Dd[nc],Ep=0,Pp=BT(Ld,ec,wp,Rr.vertical||Aa,vr,24,Qu,or.overscaling,8192);Ep<Pp.length;Ep+=1){var zd=Pp[Ep];Aa&&qT(or,Aa.text,Sp,zd)||Bs(Ld,zd)}else if(ss==="line-center")for(var Tp=0,Cp=Lr.geometry;Tp<Cp.length;Tp+=1){var Ip=Cp[Tp];if(Ip.length>1){var jd=NT(Ip,wp,Rr.vertical||Aa,vr,24,Qu);jd&&Bs(Ip,jd)}}else if(Lr.type==="Polygon")for(var ic=0,Nd=Nm(Lr.geometry,0);ic<Nd.length;ic+=1){var ac=Nd[ic],Mp=UT(ac,16);Bs(ac[0],new Wu(Mp.x,Mp.y,0))}else if(Lr.type==="LineString")for(var kl=0,Op=Lr.geometry;kl<Op.length;kl+=1){var oc=Op[kl];Bs(oc,new Wu(oc[0].x,oc[0].y,0))}else if(Lr.type==="Point")for(var Jm=0,u0=Lr.geometry;Jm<u0.length;Jm+=1)for(var Qm=0,c0=u0[Jm];Qm<c0.length;Qm+=1){var ev=c0[Qm];Bs([ev],new Wu(ev.x,ev.y,0))}}(e,Le,nt,Hn,h,O,Qe,vt,it,gi,y)},Me=0,Re=e.features;Me<Re.length;Me+=1)Te();v&&e.generateCollisionDebugBuffers()},o.perspective=function(e,r,a,h,f){var v,y=1/Math.tan(r/2);return e[0]=y/a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+h)*(v=1/(h-f)),e[14]=2*f*h*v):(e[10]=-1,e[14]=-2*h),e},o.pick=function(e,r){for(var a={},h=0;h<r.length;h++){var f=r[h];f in e&&(a[f]=e[f])}return a},o.plugin=qi,o.polygonIntersectsPolygon=bo,o.postMapLoadEvent=Ui,o.postTurnstileEvent=Cn,o.potpack=A_,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=ut,o.registerForPluginStateChange=function(e){return e({pluginStatus:Ai,pluginURL:Va}),np.on("pluginStateChange",e),e},o.renderColorRamp=d_,o.rotate=function(e,r,a){var h=r[0],f=r[1],v=r[2],y=r[3],S=Math.sin(a),C=Math.cos(a);return e[0]=h*C+v*S,e[1]=f*C+y*S,e[2]=h*-S+v*C,e[3]=f*-S+y*C,e},o.rotateX=function(e,r,a){var h=Math.sin(a),f=Math.cos(a),v=r[4],y=r[5],S=r[6],C=r[7],O=r[8],k=r[9],L=r[10],U=r[11];return r!==e&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[4]=v*f+O*h,e[5]=y*f+k*h,e[6]=S*f+L*h,e[7]=C*f+U*h,e[8]=O*f-v*h,e[9]=k*f-y*h,e[10]=L*f-S*h,e[11]=U*f-C*h,e},o.rotateZ=function(e,r,a){var h=Math.sin(a),f=Math.cos(a),v=r[0],y=r[1],S=r[2],C=r[3],O=r[4],k=r[5],L=r[6],U=r[7];return r!==e&&(e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=v*f+O*h,e[1]=y*f+k*h,e[2]=S*f+L*h,e[3]=C*f+U*h,e[4]=O*f-v*h,e[5]=k*f-y*h,e[6]=L*f-S*h,e[7]=U*f-C*h,e},o.scale=function(e,r,a){var h=a[0],f=a[1],v=a[2];return e[0]=r[0]*h,e[1]=r[1]*h,e[2]=r[2]*h,e[3]=r[3]*h,e[4]=r[4]*f,e[5]=r[5]*f,e[6]=r[6]*f,e[7]=r[7]*f,e[8]=r[8]*v,e[9]=r[9]*v,e[10]=r[10]*v,e[11]=r[11]*v,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},o.scale$1=function(e,r,a){return e[0]=r[0]*a,e[1]=r[1]*a,e[2]=r[2]*a,e[3]=r[3]*a,e},o.scale$2=function(e,r,a){return e[0]=r[0]*a,e[1]=r[1]*a,e[2]=r[2]*a,e},o.setCacheLimits=function(e,r){da=e,to=r},o.setRTLTextPlugin=function(e,r,a){if(a===void 0&&(a=!1),Ai==="deferred"||Ai==="loading"||Ai==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Va=er.resolveURL(e),Ai="deferred",Ru=r,bl(),a||va()},o.sphericalToCartesian=function(e){var r=e[0],a=e[1],h=e[2];return a+=90,a*=Math.PI/180,h*=Math.PI/180,{x:r*Math.cos(a)*Math.sin(h),y:r*Math.sin(a)*Math.sin(h),z:r*Math.cos(h)}},o.sqrLen=function(e){var r=e[0],a=e[1];return r*r+a*a},o.styleSpec=G,o.sub=function(e,r,a){return e[0]=r[0]-a[0],e[1]=r[1]-a[1],e[2]=r[2]-a[2],e},o.symbolSize=jT,o.transformMat3=function(e,r,a){var h=r[0],f=r[1],v=r[2];return e[0]=h*a[0]+f*a[3]+v*a[6],e[1]=h*a[1]+f*a[4]+v*a[7],e[2]=h*a[2]+f*a[5]+v*a[8],e},o.transformMat4=ju,o.translate=function(e,r,a){var h,f,v,y,S,C,O,k,L,U,$,oe,le=a[0],_e=a[1],fe=a[2];return r===e?(e[12]=r[0]*le+r[4]*_e+r[8]*fe+r[12],e[13]=r[1]*le+r[5]*_e+r[9]*fe+r[13],e[14]=r[2]*le+r[6]*_e+r[10]*fe+r[14],e[15]=r[3]*le+r[7]*_e+r[11]*fe+r[15]):(f=r[1],v=r[2],y=r[3],S=r[4],C=r[5],O=r[6],k=r[7],L=r[8],U=r[9],$=r[10],oe=r[11],e[0]=h=r[0],e[1]=f,e[2]=v,e[3]=y,e[4]=S,e[5]=C,e[6]=O,e[7]=k,e[8]=L,e[9]=U,e[10]=$,e[11]=oe,e[12]=h*le+S*_e+L*fe+r[12],e[13]=f*le+C*_e+U*fe+r[13],e[14]=v*le+O*_e+$*fe+r[14],e[15]=y*le+k*_e+oe*fe+r[15]),e},o.triggerPluginCompletionEvent=pd,o.uniqueId=B,o.validateCustomStyleLayer=function(e){var r=[],a=e.id;return a===void 0&&r.push({message:"layers."+a+': missing required property "id"'}),e.render===void 0&&r.push({message:"layers."+a+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&r.push({message:"layers."+a+': property "renderingMode" must be either "2d" or "3d"'}),r},o.validateLight=Mm,o.validateStyle=vl,o.values=function(e){var r=[];for(var a in e)r.push(e[a]);return r},o.vectorTile=Uu,o.version="1.13.3",o.warnOnce=ce,o.webpSupported=$t,o.window=I,o.wrap=ee}),m(["./shared"],function(o){function _(z){var F=typeof z;if(F==="number"||F==="boolean"||F==="string"||z==null)return JSON.stringify(z);if(Array.isArray(z)){for(var q="[",te=0,ue=z;te<ue.length;te+=1)q+=_(ue[te])+",";return q+"]"}for(var xe=Object.keys(z).sort(),Se="{",G=0;G<xe.length;G++)Se+=JSON.stringify(xe[G])+":"+_(z[xe[G]])+",";return Se+"}"}function b(z){for(var F="",q=0,te=o.refProperties;q<te.length;q+=1)F+="/"+_(z[te[q]]);return F}var E=function(z){this.keyCache={},z&&this.replace(z)};E.prototype.replace=function(z){this._layerConfigs={},this._layers={},this.update(z,[])},E.prototype.update=function(z,F){for(var q=this,te=0,ue=z;te<ue.length;te+=1){var xe=ue[te];this._layerConfigs[xe.id]=xe;var Se=this._layers[xe.id]=o.createStyleLayer(xe);Se._featureFilter=o.featureFilter(Se.filter),this.keyCache[xe.id]&&delete this.keyCache[xe.id]}for(var G=0,he=F;G<he.length;G+=1){var Ce=he[G];delete this.keyCache[Ce],delete this._layerConfigs[Ce],delete this._layers[Ce]}this.familiesBySource={};for(var $e=0,He=function(Ye,Je){for(var Bt={},tt=0;tt<Ye.length;tt++){var tr=Je&&Je[Ye[tt].id]||b(Ye[tt]);Je&&(Je[Ye[tt].id]=tr);var Mr=Bt[tr];Mr||(Mr=Bt[tr]=[]),Mr.push(Ye[tt])}var Jt=[];for(var lr in Bt)Jt.push(Bt[lr]);return Jt}(o.values(this._layerConfigs),this.keyCache);$e<He.length;$e+=1){var Ne=He[$e].map(function(Ye){return q._layers[Ye.id]}),We=Ne[0];if(We.visibility!=="none"){var ct=We.source||"",ot=this.familiesBySource[ct];ot||(ot=this.familiesBySource[ct]={});var Fe=We.sourceLayer||"_geojsonTileLayer",rt=ot[Fe];rt||(rt=ot[Fe]=[]),rt.push(Ne)}}};var T=function(z){var F={},q=[];for(var te in z){var ue=z[te],xe=F[te]={};for(var Se in ue){var G=ue[+Se];if(G&&G.bitmap.width!==0&&G.bitmap.height!==0){var he={x:0,y:0,w:G.bitmap.width+2,h:G.bitmap.height+2};q.push(he),xe[Se]={rect:he,metrics:G.metrics}}}}var Ce=o.potpack(q),$e=new o.AlphaImage({width:Ce.w||1,height:Ce.h||1});for(var He in z){var Ne=z[He];for(var We in Ne){var ct=Ne[+We];if(ct&&ct.bitmap.width!==0&&ct.bitmap.height!==0){var ot=F[He][We].rect;o.AlphaImage.copy(ct.bitmap,$e,{x:0,y:0},{x:ot.x+1,y:ot.y+1},ct.bitmap)}}}this.image=$e,this.positions=F};o.register("GlyphAtlas",T);var M=function(z){this.tileID=new o.OverscaledTileID(z.tileID.overscaledZ,z.tileID.wrap,z.tileID.canonical.z,z.tileID.canonical.x,z.tileID.canonical.y),this.uid=z.uid,this.zoom=z.zoom,this.pixelRatio=z.pixelRatio,this.tileSize=z.tileSize,this.source=z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=z.showCollisionBoxes,this.collectResourceTiming=!!z.collectResourceTiming,this.returnDependencies=!!z.returnDependencies,this.promoteId=z.promoteId};function I(z,F,q){for(var te=new o.EvaluationParameters(F),ue=0,xe=z;ue<xe.length;ue+=1)xe[ue].recalculate(te,q)}function N(z,F){var q=o.getArrayBuffer(z.request,function(te,ue,xe,Se){te?F(te):ue&&F(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(ue)),rawData:ue,cacheControl:xe,expires:Se})});return function(){q.cancel(),F()}}M.prototype.parse=function(z,F,q,te,ue){var xe=this;this.status="parsing",this.data=z,this.collisionBoxArray=new o.CollisionBoxArray;var Se=new o.DictionaryCoder(Object.keys(z.layers).sort()),G=new o.FeatureIndex(this.tileID,this.promoteId);G.bucketLayerIDs=[];var he,Ce,$e,He,Ne={},We={featureIndex:G,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:q},ct=F.familiesBySource[this.source];for(var ot in ct){var Fe=z.layers[ot];if(Fe){Fe.version===1&&o.warnOnce('Vector tile source "'+this.source+'" layer "'+ot+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var rt=Se.encode(ot),Ye=[],Je=0;Je<Fe.length;Je++){var Bt=Fe.feature(Je),tt=G.getId(Bt,ot);Ye.push({feature:Bt,id:tt,index:Je,sourceLayerIndex:rt})}for(var tr=0,Mr=ct[ot];tr<Mr.length;tr+=1){var Jt=Mr[tr],lr=Jt[0];lr.minzoom&&this.zoom<Math.floor(lr.minzoom)||lr.maxzoom&&this.zoom>=lr.maxzoom||lr.visibility!=="none"&&(I(Jt,this.zoom,q),(Ne[lr.id]=lr.createBucket({index:G.bucketLayerIDs.length,layers:Jt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:rt,sourceID:this.source})).populate(Ye,We,this.tileID.canonical),G.bucketLayerIDs.push(Jt.map(function(gr){return gr.id})))}}}var Ft=o.mapObject(We.glyphDependencies,function(gr){return Object.keys(gr).map(Number)});Object.keys(Ft).length?te.send("getGlyphs",{uid:this.uid,stacks:Ft},function(gr,Ut){he||(he=gr,Ce=Ut,Or.call(xe))}):Ce={};var fn=Object.keys(We.iconDependencies);fn.length?te.send("getImages",{icons:fn,source:this.source,tileID:this.tileID,type:"icons"},function(gr,Ut){he||(he=gr,$e=Ut,Or.call(xe))}):$e={};var ar=Object.keys(We.patternDependencies);function Or(){if(he)return ue(he);if(Ce&&$e&&He){var gr=new T(Ce),Ut=new o.ImageAtlas($e,He);for(var Qt in Ne){var Yn=Ne[Qt];Yn instanceof o.SymbolBucket?(I(Yn.layers,this.zoom,q),o.performSymbolLayout(Yn,Ce,gr.positions,$e,Ut.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Yn.hasPattern&&(Yn instanceof o.LineBucket||Yn instanceof o.FillBucket||Yn instanceof o.FillExtrusionBucket)&&(I(Yn.layers,this.zoom,q),Yn.addFeatures(We,this.tileID.canonical,Ut.patternPositions))}this.status="done",ue(null,{buckets:o.values(Ne).filter(function(no){return!no.isEmpty()}),featureIndex:G,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:gr.image,imageAtlas:Ut,glyphMap:this.returnDependencies?Ce:null,iconMap:this.returnDependencies?$e:null,glyphPositions:this.returnDependencies?gr.positions:null})}}ar.length?te.send("getImages",{icons:ar,source:this.source,tileID:this.tileID,type:"patterns"},function(gr,Ut){he||(he=gr,He=Ut,Or.call(xe))}):He={},Or.call(this)};var D=function(z,F,q,te){this.actor=z,this.layerIndex=F,this.availableImages=q,this.loadVectorData=te||N,this.loading={},this.loaded={}};D.prototype.loadTile=function(z,F){var q=this,te=z.uid;this.loading||(this.loading={});var ue=!!(z&&z.request&&z.request.collectResourceTiming)&&new o.RequestPerformance(z.request),xe=this.loading[te]=new M(z);xe.abort=this.loadVectorData(z,function(Se,G){if(delete q.loading[te],Se||!G)return xe.status="done",q.loaded[te]=xe,F(Se);var he=G.rawData,Ce={};G.expires&&(Ce.expires=G.expires),G.cacheControl&&(Ce.cacheControl=G.cacheControl);var $e={};if(ue){var He=ue.finish();He&&($e.resourceTiming=JSON.parse(JSON.stringify(He)))}xe.vectorTile=G.vectorTile,xe.parse(G.vectorTile,q.layerIndex,q.availableImages,q.actor,function(Ne,We){if(Ne||!We)return F(Ne);F(null,o.extend({rawTileData:he.slice(0)},We,Ce,$e))}),q.loaded=q.loaded||{},q.loaded[te]=xe})},D.prototype.reloadTile=function(z,F){var q=this,te=this.loaded,ue=z.uid,xe=this;if(te&&te[ue]){var Se=te[ue];Se.showCollisionBoxes=z.showCollisionBoxes;var G=function(he,Ce){var $e=Se.reloadCallback;$e&&(delete Se.reloadCallback,Se.parse(Se.vectorTile,xe.layerIndex,q.availableImages,xe.actor,$e)),F(he,Ce)};Se.status==="parsing"?Se.reloadCallback=G:Se.status==="done"&&(Se.vectorTile?Se.parse(Se.vectorTile,this.layerIndex,this.availableImages,this.actor,G):G())}},D.prototype.abortTile=function(z,F){var q=this.loading,te=z.uid;q&&q[te]&&q[te].abort&&(q[te].abort(),delete q[te]),F()},D.prototype.removeTile=function(z,F){var q=this.loaded,te=z.uid;q&&q[te]&&delete q[te],F()};var re=o.window.ImageBitmap,W=function(){this.loaded={}};function ee(z,F){if(z.length!==0){J(z[0],F);for(var q=1;q<z.length;q++)J(z[q],!F)}}function J(z,F){for(var q=0,te=0,ue=0,xe=z.length,Se=xe-1;ue<xe;Se=ue++){var G=(z[ue][0]-z[Se][0])*(z[Se][1]+z[ue][1]),he=q+G;te+=Math.abs(q)>=Math.abs(G)?q-he+G:G-he+q,q=he}q+te>=0!=!!F&&z.reverse()}W.prototype.loadTile=function(z,F){var q=z.uid,te=z.encoding,ue=z.rawImageData,xe=re&&ue instanceof re?this.getImageData(ue):ue,Se=new o.DEMData(q,xe,te);this.loaded=this.loaded||{},this.loaded[q]=Se,F(null,Se)},W.prototype.getImageData=function(z){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(z.width,z.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=z.width,this.offscreenCanvas.height=z.height,this.offscreenCanvasContext.drawImage(z,0,0,z.width,z.height);var F=this.offscreenCanvasContext.getImageData(-1,-1,z.width+2,z.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:F.width,height:F.height},F.data)},W.prototype.removeTile=function(z){var F=this.loaded,q=z.uid;F&&F[q]&&delete F[q]};var Y=o.vectorTile.VectorTileFeature.prototype.toGeoJSON,B=function(z){this._feature=z,this.extent=o.EXTENT,this.type=z.type,this.properties=z.tags,"id"in z&&!isNaN(z.id)&&(this.id=parseInt(z.id,10))};B.prototype.loadGeometry=function(){if(this._feature.type===1){for(var z=[],F=0,q=this._feature.geometry;F<q.length;F+=1){var te=q[F];z.push([new o.Point$1(te[0],te[1])])}return z}for(var ue=[],xe=0,Se=this._feature.geometry;xe<Se.length;xe+=1){for(var G=[],he=0,Ce=Se[xe];he<Ce.length;he+=1){var $e=Ce[he];G.push(new o.Point$1($e[0],$e[1]))}ue.push(G)}return ue},B.prototype.toGeoJSON=function(z,F,q){return Y.call(this,z,F,q)};var V=function(z){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=z.length,this._features=z};V.prototype.feature=function(z){return new B(this._features[z])};var K=o.vectorTile.VectorTileFeature,ve=de;function de(z,F){this.options=F||{},this.features=z,this.length=z.length}function ie(z,F){this.id=typeof z.id=="number"?z.id:void 0,this.type=z.type,this.rawGeometry=z.type===1?[z.geometry]:z.geometry,this.properties=z.tags,this.extent=F||4096}de.prototype.feature=function(z){return new ie(this.features[z],this.options.extent)},ie.prototype.loadGeometry=function(){var z=this.rawGeometry;this.geometry=[];for(var F=0;F<z.length;F++){for(var q=z[F],te=[],ue=0;ue<q.length;ue++)te.push(new o.Point$1(q[ue][0],q[ue][1]));this.geometry.push(te)}return this.geometry},ie.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var z=this.geometry,F=1/0,q=-1/0,te=1/0,ue=-1/0,xe=0;xe<z.length;xe++)for(var Se=z[xe],G=0;G<Se.length;G++){var he=Se[G];F=Math.min(F,he.x),q=Math.max(q,he.x),te=Math.min(te,he.y),ue=Math.max(ue,he.y)}return[F,te,q,ue]},ie.prototype.toGeoJSON=K.prototype.toGeoJSON;var we=De,ze=ve;function De(z){var F=new o.pbf;return function(q,te){for(var ue in q.layers)te.writeMessage(3,ce,q.layers[ue])}(z,F),F.finish()}function ce(z,F){var q;F.writeVarintField(15,z.version||1),F.writeStringField(1,z.name||""),F.writeVarintField(5,z.extent||4096);var te={keys:[],values:[],keycache:{},valuecache:{}};for(q=0;q<z.length;q++)te.feature=z.feature(q),F.writeMessage(2,Pe,te);var ue=te.keys;for(q=0;q<ue.length;q++)F.writeStringField(3,ue[q]);var xe=te.values;for(q=0;q<xe.length;q++)F.writeMessage(4,Ir,xe[q])}function Pe(z,F){var q=z.feature;q.id!==void 0&&F.writeVarintField(1,q.id),F.writeMessage(2,gt,z),F.writeVarintField(3,q.type),F.writeMessage(4,kt,q)}function gt(z,F){var q=z.feature,te=z.keys,ue=z.values,xe=z.keycache,Se=z.valuecache;for(var G in q.properties){var he=xe[G];he===void 0&&(te.push(G),xe[G]=he=te.length-1),F.writeVarint(he);var Ce=q.properties[G],$e=typeof Ce;$e!=="string"&&$e!=="boolean"&&$e!=="number"&&(Ce=JSON.stringify(Ce));var He=$e+":"+Ce,Ne=Se[He];Ne===void 0&&(ue.push(Ce),Se[He]=Ne=ue.length-1),F.writeVarint(Ne)}}function jt(z,F){return(F<<3)+(7&z)}function Tt(z){return z<<1^z>>31}function kt(z,F){for(var q=z.loadGeometry(),te=z.type,ue=0,xe=0,Se=q.length,G=0;G<Se;G++){var he=q[G],Ce=1;te===1&&(Ce=he.length),F.writeVarint(jt(1,Ce));for(var $e=te===3?he.length-1:he.length,He=0;He<$e;He++){He===1&&te!==1&&F.writeVarint(jt(2,$e-1));var Ne=he[He].x-ue,We=he[He].y-xe;F.writeVarint(Tt(Ne)),F.writeVarint(Tt(We)),ue+=Ne,xe+=We}te===3&&F.writeVarint(jt(7,1))}}function Ir(z,F){var q=typeof z;q==="string"?F.writeStringField(1,z):q==="boolean"?F.writeBooleanField(7,z):q==="number"&&(z%1!=0?F.writeDoubleField(3,z):z<0?F.writeSVarintField(6,z):F.writeVarintField(5,z))}function pr(z,F,q,te){Zt(z,q,te),Zt(F,2*q,2*te),Zt(F,2*q+1,2*te+1)}function Zt(z,F,q){var te=z[F];z[F]=z[q],z[q]=te}function Kt(z,F,q,te){var ue=z-q,xe=F-te;return ue*ue+xe*xe}we.fromVectorTileJs=De,we.fromGeojsonVt=function(z,F){F=F||{};var q={};for(var te in z)q[te]=new ve(z[te].features,F),q[te].name=te,q[te].version=F.version,q[te].extent=F.extent;return De({layers:q})},we.GeoJSONWrapper=ze;var Yt=function(z){return z[0]},Dt=function(z){return z[1]},Gt=function(z,F,q,te,ue){F===void 0&&(F=Yt),q===void 0&&(q=Dt),te===void 0&&(te=64),ue===void 0&&(ue=Float64Array),this.nodeSize=te,this.points=z;for(var xe=z.length<65536?Uint16Array:Uint32Array,Se=this.ids=new xe(z.length),G=this.coords=new ue(2*z.length),he=0;he<z.length;he++)Se[he]=he,G[2*he]=F(z[he]),G[2*he+1]=q(z[he]);(function Ce($e,He,Ne,We,ct,ot){if(!(ct-We<=Ne)){var Fe=We+ct>>1;(function rt(Ye,Je,Bt,tt,tr,Mr){for(;tr>tt;){if(tr-tt>600){var Jt=tr-tt+1,lr=Bt-tt+1,Ft=Math.log(Jt),fn=.5*Math.exp(2*Ft/3),ar=.5*Math.sqrt(Ft*fn*(Jt-fn)/Jt)*(lr-Jt/2<0?-1:1);rt(Ye,Je,Bt,Math.max(tt,Math.floor(Bt-lr*fn/Jt+ar)),Math.min(tr,Math.floor(Bt+(Jt-lr)*fn/Jt+ar)),Mr)}var Or=Je[2*Bt+Mr],gr=tt,Ut=tr;for(pr(Ye,Je,tt,Bt),Je[2*tr+Mr]>Or&&pr(Ye,Je,tt,tr);gr<Ut;){for(pr(Ye,Je,gr,Ut),gr++,Ut--;Je[2*gr+Mr]<Or;)gr++;for(;Je[2*Ut+Mr]>Or;)Ut--}Je[2*tt+Mr]===Or?pr(Ye,Je,tt,Ut):pr(Ye,Je,++Ut,tr),Ut<=Bt&&(tt=Ut+1),Bt<=Ut&&(tr=Ut-1)}})($e,He,Fe,We,ct,ot%2),Ce($e,He,Ne,We,Fe-1,ot+1),Ce($e,He,Ne,Fe+1,ct,ot+1)}})(Se,G,te,0,Se.length-1,0)};Gt.prototype.range=function(z,F,q,te){return function(ue,xe,Se,G,he,Ce,$e){for(var He,Ne,We=[0,ue.length-1,0],ct=[];We.length;){var ot=We.pop(),Fe=We.pop(),rt=We.pop();if(Fe-rt<=$e)for(var Ye=rt;Ye<=Fe;Ye++)Ne=xe[2*Ye+1],(He=xe[2*Ye])>=Se&&He<=he&&Ne>=G&&Ne<=Ce&&ct.push(ue[Ye]);else{var Je=Math.floor((rt+Fe)/2);Ne=xe[2*Je+1],(He=xe[2*Je])>=Se&&He<=he&&Ne>=G&&Ne<=Ce&&ct.push(ue[Je]);var Bt=(ot+1)%2;(ot===0?Se<=He:G<=Ne)&&(We.push(rt),We.push(Je-1),We.push(Bt)),(ot===0?he>=He:Ce>=Ne)&&(We.push(Je+1),We.push(Fe),We.push(Bt))}}return ct}(this.ids,this.coords,z,F,q,te,this.nodeSize)},Gt.prototype.within=function(z,F,q){return function(te,ue,xe,Se,G,he){for(var Ce=[0,te.length-1,0],$e=[],He=G*G;Ce.length;){var Ne=Ce.pop(),We=Ce.pop(),ct=Ce.pop();if(We-ct<=he)for(var ot=ct;ot<=We;ot++)Kt(ue[2*ot],ue[2*ot+1],xe,Se)<=He&&$e.push(te[ot]);else{var Fe=Math.floor((ct+We)/2),rt=ue[2*Fe],Ye=ue[2*Fe+1];Kt(rt,Ye,xe,Se)<=He&&$e.push(te[Fe]);var Je=(Ne+1)%2;(Ne===0?xe-G<=rt:Se-G<=Ye)&&(Ce.push(ct),Ce.push(Fe-1),Ce.push(Je)),(Ne===0?xe+G>=rt:Se+G>=Ye)&&(Ce.push(Fe+1),Ce.push(We),Ce.push(Je))}}return $e}(this.ids,this.coords,z,F,q,this.nodeSize)};var yr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(z){return z}},Et=function(z){this.options=$r(Object.create(yr),z),this.trees=new Array(this.options.maxZoom+1)};function er(z,F,q,te,ue){return{x:z,y:F,zoom:1/0,id:q,parentId:-1,numPoints:te,properties:ue}}function mt(z,F){var q=z.geometry.coordinates,te=q[1];return{x:Br(q[0]),y:It(te),zoom:1/0,index:F,parentId:-1}}function $t(z){return{type:"Feature",id:z.id,properties:Nr(z),geometry:{type:"Point",coordinates:[(te=z.x,360*(te-.5)),(F=z.y,q=(180-360*F)*Math.PI/180,360*Math.atan(Math.exp(q))/Math.PI-90)]}};var F,q,te}function Nr(z){var F=z.numPoints,q=F>=1e4?Math.round(F/1e3)+"k":F>=1e3?Math.round(F/100)/10+"k":F;return $r($r({},z.properties),{cluster:!0,cluster_id:z.id,point_count:F,point_count_abbreviated:q})}function Br(z){return z/360+.5}function It(z){var F=Math.sin(z*Math.PI/180),q=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return q<0?0:q>1?1:q}function $r(z,F){for(var q in F)z[q]=F[q];return z}function hr(z){return z.x}function dr(z){return z.y}function Un(z,F,q,te,ue,xe){var Se=ue-q,G=xe-te;if(Se!==0||G!==0){var he=((z-q)*Se+(F-te)*G)/(Se*Se+G*G);he>1?(q=ue,te=xe):he>0&&(q+=Se*he,te+=G*he)}return(Se=z-q)*Se+(G=F-te)*G}function Tn(z,F,q,te){var ue={id:z===void 0?null:z,type:F,geometry:q,tags:te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(xe){var Se=xe.geometry,G=xe.type;if(G==="Point"||G==="MultiPoint"||G==="LineString")Pi(xe,Se);else if(G==="Polygon"||G==="MultiLineString")for(var he=0;he<Se.length;he++)Pi(xe,Se[he]);else if(G==="MultiPolygon")for(he=0;he<Se.length;he++)for(var Ce=0;Ce<Se[he].length;Ce++)Pi(xe,Se[he][Ce])}(ue),ue}function Pi(z,F){for(var q=0;q<F.length;q+=3)z.minX=Math.min(z.minX,F[q]),z.minY=Math.min(z.minY,F[q+1]),z.maxX=Math.max(z.maxX,F[q]),z.maxY=Math.max(z.maxY,F[q+1])}function bn(z,F,q,te){if(F.geometry){var ue=F.geometry.coordinates,xe=F.geometry.type,Se=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),G=[],he=F.id;if(q.promoteId?he=F.properties[q.promoteId]:q.generateId&&(he=te||0),xe==="Point")en(ue,G);else if(xe==="MultiPoint")for(var Ce=0;Ce<ue.length;Ce++)en(ue[Ce],G);else if(xe==="LineString")ea(ue,G,Se,!1);else if(xe==="MultiLineString"){if(q.lineMetrics){for(Ce=0;Ce<ue.length;Ce++)ea(ue[Ce],G=[],Se,!1),z.push(Tn(he,"LineString",G,F.properties));return}Wt(ue,G,Se,!1)}else if(xe==="Polygon")Wt(ue,G,Se,!0);else{if(xe!=="MultiPolygon"){if(xe==="GeometryCollection"){for(Ce=0;Ce<F.geometry.geometries.length;Ce++)bn(z,{id:he,geometry:F.geometry.geometries[Ce],properties:F.properties},q,te);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ce=0;Ce<ue.length;Ce++){var $e=[];Wt(ue[Ce],$e,Se,!0),G.push($e)}}z.push(Tn(he,xe,G,F.properties))}}function en(z,F){F.push(lt(z[0])),F.push(Mt(z[1])),F.push(0)}function ea(z,F,q,te){for(var ue,xe,Se=0,G=0;G<z.length;G++){var he=lt(z[G][0]),Ce=Mt(z[G][1]);F.push(he),F.push(Ce),F.push(0),G>0&&(Se+=te?(ue*Ce-he*xe)/2:Math.sqrt(Math.pow(he-ue,2)+Math.pow(Ce-xe,2))),ue=he,xe=Ce}var $e=F.length-3;F[2]=1,function He(Ne,We,ct,ot){for(var Fe,rt=ot,Ye=ct-We>>1,Je=ct-We,Bt=Ne[We],tt=Ne[We+1],tr=Ne[ct],Mr=Ne[ct+1],Jt=We+3;Jt<ct;Jt+=3){var lr=Un(Ne[Jt],Ne[Jt+1],Bt,tt,tr,Mr);if(lr>rt)Fe=Jt,rt=lr;else if(lr===rt){var Ft=Math.abs(Jt-Ye);Ft<Je&&(Fe=Jt,Je=Ft)}}rt>ot&&(Fe-We>3&&He(Ne,We,Fe,ot),Ne[Fe+2]=rt,ct-Fe>3&&He(Ne,Fe,ct,ot))}(F,0,$e,q),F[$e+2]=1,F.size=Math.abs(Se),F.start=0,F.end=F.size}function Wt(z,F,q,te){for(var ue=0;ue<z.length;ue++){var xe=[];ea(z[ue],xe,q,te),F.push(xe)}}function lt(z){return z/360+.5}function Mt(z){var F=Math.sin(z*Math.PI/180),q=.5-.25*Math.log((1+F)/(1-F))/Math.PI;return q<0?0:q>1?1:q}function nr(z,F,q,te,ue,xe,Se,G){if(te/=F,xe>=(q/=F)&&Se<te)return z;if(Se<q||xe>=te)return null;for(var he=[],Ce=0;Ce<z.length;Ce++){var $e=z[Ce],He=$e.geometry,Ne=$e.type,We=ue===0?$e.minX:$e.minY,ct=ue===0?$e.maxX:$e.maxY;if(We>=q&&ct<te)he.push($e);else if(!(ct<q||We>=te)){var ot=[];if(Ne==="Point"||Ne==="MultiPoint")xn(He,ot,q,te,ue);else if(Ne==="LineString")Cn(He,ot,q,te,ue,!1,G.lineMetrics);else if(Ne==="MultiLineString")Ui(He,ot,q,te,ue,!1);else if(Ne==="Polygon")Ui(He,ot,q,te,ue,!0);else if(Ne==="MultiPolygon")for(var Fe=0;Fe<He.length;Fe++){var rt=[];Ui(He[Fe],rt,q,te,ue,!0),rt.length&&ot.push(rt)}if(ot.length){if(G.lineMetrics&&Ne==="LineString"){for(Fe=0;Fe<ot.length;Fe++)he.push(Tn($e.id,Ne,ot[Fe],$e.tags));continue}Ne!=="LineString"&&Ne!=="MultiLineString"||(ot.length===1?(Ne="LineString",ot=ot[0]):Ne="MultiLineString"),Ne!=="Point"&&Ne!=="MultiPoint"||(Ne=ot.length===3?"Point":"MultiPoint"),he.push(Tn($e.id,Ne,ot,$e.tags))}}}return he.length?he:null}function xn(z,F,q,te,ue){for(var xe=0;xe<z.length;xe+=3){var Se=z[xe+ue];Se>=q&&Se<=te&&(F.push(z[xe]),F.push(z[xe+1]),F.push(z[xe+2]))}}function Cn(z,F,q,te,ue,xe,Se){for(var G,he,Ce=ri(z),$e=ue===0?to:ro,He=z.start,Ne=0;Ne<z.length-3;Ne+=3){var We=z[Ne],ct=z[Ne+1],ot=z[Ne+2],Fe=z[Ne+3],rt=z[Ne+4],Ye=ue===0?We:ct,Je=ue===0?Fe:rt,Bt=!1;Se&&(G=Math.sqrt(Math.pow(We-Fe,2)+Math.pow(ct-rt,2))),Ye<q?Je>q&&(he=$e(Ce,We,ct,Fe,rt,q),Se&&(Ce.start=He+G*he)):Ye>te?Je<te&&(he=$e(Ce,We,ct,Fe,rt,te),Se&&(Ce.start=He+G*he)):da(Ce,We,ct,ot),Je<q&&Ye>=q&&(he=$e(Ce,We,ct,Fe,rt,q),Bt=!0),Je>te&&Ye<=te&&(he=$e(Ce,We,ct,Fe,rt,te),Bt=!0),!xe&&Bt&&(Se&&(Ce.end=He+G*he),F.push(Ce),Ce=ri(z)),Se&&(He+=G)}var tt=z.length-3;We=z[tt],ct=z[tt+1],ot=z[tt+2],(Ye=ue===0?We:ct)>=q&&Ye<=te&&da(Ce,We,ct,ot),tt=Ce.length-3,xe&&tt>=3&&(Ce[tt]!==Ce[0]||Ce[tt+1]!==Ce[1])&&da(Ce,Ce[0],Ce[1],Ce[2]),Ce.length&&F.push(Ce)}function ri(z){var F=[];return F.size=z.size,F.start=z.start,F.end=z.end,F}function Ui(z,F,q,te,ue,xe){for(var Se=0;Se<z.length;Se++)Cn(z[Se],F,q,te,ue,xe,!1)}function da(z,F,q,te){z.push(F),z.push(q),z.push(te)}function to(z,F,q,te,ue,xe){var Se=(xe-F)/(te-F);return z.push(xe),z.push(q+(ue-q)*Se),z.push(1),Se}function ro(z,F,q,te,ue,xe){var Se=(xe-q)/(ue-q);return z.push(F+(te-F)*Se),z.push(xe),z.push(1),Se}function Lo(z,F){for(var q=[],te=0;te<z.length;te++){var ue,xe=z[te],Se=xe.type;if(Se==="Point"||Se==="MultiPoint"||Se==="LineString")ue=za(xe.geometry,F);else if(Se==="MultiLineString"||Se==="Polygon"){ue=[];for(var G=0;G<xe.geometry.length;G++)ue.push(za(xe.geometry[G],F))}else if(Se==="MultiPolygon")for(ue=[],G=0;G<xe.geometry.length;G++){for(var he=[],Ce=0;Ce<xe.geometry[G].length;Ce++)he.push(za(xe.geometry[G][Ce],F));ue.push(he)}q.push(Tn(xe.id,Se,ue,xe.tags))}return q}function za(z,F){var q=[];q.size=z.size,z.start!==void 0&&(q.start=z.start,q.end=z.end);for(var te=0;te<z.length;te+=3)q.push(z[te]+F,z[te+1],z[te+2]);return q}function zo(z,F){if(z.transformed)return z;var q,te,ue,xe=1<<z.z,Se=z.x,G=z.y;for(q=0;q<z.features.length;q++){var he=z.features[q],Ce=he.geometry,$e=he.type;if(he.geometry=[],$e===1)for(te=0;te<Ce.length;te+=2)he.geometry.push(jo(Ce[te],Ce[te+1],F,xe,Se,G));else for(te=0;te<Ce.length;te++){var He=[];for(ue=0;ue<Ce[te].length;ue+=2)He.push(jo(Ce[te][ue],Ce[te][ue+1],F,xe,Se,G));he.geometry.push(He)}}return z.transformed=!0,z}function jo(z,F,q,te,ue,xe){return[Math.round(q*(z*te-ue)),Math.round(q*(F*te-xe))]}function ja(z,F,q,te,ue){for(var xe=F===ue.maxZoom?0:ue.tolerance/((1<<F)*ue.extent),Se={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:te,z:F,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},G=0;G<z.length;G++){Se.numFeatures++,ws(Se,z[G],xe,ue);var he=z[G].minX,Ce=z[G].minY,$e=z[G].maxX,He=z[G].maxY;he<Se.minX&&(Se.minX=he),Ce<Se.minY&&(Se.minY=Ce),$e>Se.maxX&&(Se.maxX=$e),He>Se.maxY&&(Se.maxY=He)}return Se}function ws(z,F,q,te){var ue=F.geometry,xe=F.type,Se=[];if(xe==="Point"||xe==="MultiPoint")for(var G=0;G<ue.length;G+=3)Se.push(ue[G]),Se.push(ue[G+1]),z.numPoints++,z.numSimplified++;else if(xe==="LineString")Na(Se,ue,z,q,!1,!1);else if(xe==="MultiLineString"||xe==="Polygon")for(G=0;G<ue.length;G++)Na(Se,ue[G],z,q,xe==="Polygon",G===0);else if(xe==="MultiPolygon")for(var he=0;he<ue.length;he++){var Ce=ue[he];for(G=0;G<Ce.length;G++)Na(Se,Ce[G],z,q,!0,G===0)}if(Se.length){var $e=F.tags||null;if(xe==="LineString"&&te.lineMetrics){for(var He in $e={},F.tags)$e[He]=F.tags[He];$e.mapbox_clip_start=ue.start/ue.size,$e.mapbox_clip_end=ue.end/ue.size}var Ne={geometry:Se,type:xe==="Polygon"||xe==="MultiPolygon"?3:xe==="LineString"||xe==="MultiLineString"?2:1,tags:$e};F.id!==null&&(Ne.id=F.id),z.features.push(Ne)}}function Na(z,F,q,te,ue,xe){var Se=te*te;if(te>0&&F.size<(ue?Se:te))q.numPoints+=F.length/3;else{for(var G=[],he=0;he<F.length;he+=3)(te===0||F[he+2]>Se)&&(q.numSimplified++,G.push(F[he]),G.push(F[he+1])),q.numPoints++;ue&&function(Ce,$e){for(var He=0,Ne=0,We=Ce.length,ct=We-2;Ne<We;ct=Ne,Ne+=2)He+=(Ce[Ne]-Ce[ct])*(Ce[Ne+1]+Ce[ct+1]);if(He>0===$e)for(Ne=0,We=Ce.length;Ne<We/2;Ne+=2){var ot=Ce[Ne],Fe=Ce[Ne+1];Ce[Ne]=Ce[We-2-Ne],Ce[Ne+1]=Ce[We-1-Ne],Ce[We-2-Ne]=ot,Ce[We-1-Ne]=Fe}}(G,xe),z.push(G)}}function ta(z,F){var q=(F=this.options=function(ue,xe){for(var Se in xe)ue[Se]=xe[Se];return ue}(Object.create(this.options),F)).debug;if(q&&console.time("preprocess data"),F.maxZoom<0||F.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(F.promoteId&&F.generateId)throw new Error("promoteId and generateId cannot be used together.");var te=function(ue,xe){var Se=[];if(ue.type==="FeatureCollection")for(var G=0;G<ue.features.length;G++)bn(Se,ue.features[G],xe,G);else bn(Se,ue.type==="Feature"?ue:{geometry:ue},xe);return Se}(z,F);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",F.indexMaxZoom,F.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(te=function(ue,xe){var Se=xe.buffer/xe.extent,G=ue,he=nr(ue,1,-1-Se,Se,0,-1,2,xe),Ce=nr(ue,1,1-Se,2+Se,0,-1,2,xe);return(he||Ce)&&(G=nr(ue,1,-Se,1+Se,0,-1,2,xe)||[],he&&(G=Lo(he,1).concat(G)),Ce&&(G=G.concat(Lo(Ce,-1)))),G}(te,F)).length&&this.splitTile(te,0,0,0),q&&(te.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ra(z,F,q){return 32*((1<<z)*q+F)+z}function Ta(z,F){var q=z.tileID.canonical;if(!this._geoJSONIndex)return F(null,null);var te=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!te)return F(null,null);var ue=new V(te.features),xe=we(ue);xe.byteOffset===0&&xe.byteLength===xe.buffer.byteLength||(xe=new Uint8Array(xe)),F(null,{vectorTile:ue,rawData:xe.buffer})}Et.prototype.load=function(z){var F=this.options,q=F.log,te=F.minZoom,ue=F.maxZoom,xe=F.nodeSize;q&&console.time("total time");var Se="prepare "+z.length+" points";q&&console.time(Se),this.points=z;for(var G=[],he=0;he<z.length;he++)z[he].geometry&&G.push(mt(z[he],he));this.trees[ue+1]=new Gt(G,hr,dr,xe,Float32Array),q&&console.timeEnd(Se);for(var Ce=ue;Ce>=te;Ce--){var $e=+Date.now();G=this._cluster(G,Ce),this.trees[Ce]=new Gt(G,hr,dr,xe,Float32Array),q&&console.log("z%d: %d clusters in %dms",Ce,G.length,+Date.now()-$e)}return q&&console.timeEnd("total time"),this},Et.prototype.getClusters=function(z,F){var q=((z[0]+180)%360+360)%360-180,te=Math.max(-90,Math.min(90,z[1])),ue=z[2]===180?180:((z[2]+180)%360+360)%360-180,xe=Math.max(-90,Math.min(90,z[3]));if(z[2]-z[0]>=360)q=-180,ue=180;else if(q>ue){var Se=this.getClusters([q,te,180,xe],F),G=this.getClusters([-180,te,ue,xe],F);return Se.concat(G)}for(var he=this.trees[this._limitZoom(F)],Ce=[],$e=0,He=he.range(Br(q),It(xe),Br(ue),It(te));$e<He.length;$e+=1){var Ne=he.points[He[$e]];Ce.push(Ne.numPoints?$t(Ne):this.points[Ne.index])}return Ce},Et.prototype.getChildren=function(z){var F=this._getOriginId(z),q=this._getOriginZoom(z),te="No cluster with the specified id.",ue=this.trees[q];if(!ue)throw new Error(te);var xe=ue.points[F];if(!xe)throw new Error(te);for(var Se=this.options.radius/(this.options.extent*Math.pow(2,q-1)),G=[],he=0,Ce=ue.within(xe.x,xe.y,Se);he<Ce.length;he+=1){var $e=ue.points[Ce[he]];$e.parentId===z&&G.push($e.numPoints?$t($e):this.points[$e.index])}if(G.length===0)throw new Error(te);return G},Et.prototype.getLeaves=function(z,F,q){var te=[];return this._appendLeaves(te,z,F=F||10,q=q||0,0),te},Et.prototype.getTile=function(z,F,q){var te=this.trees[this._limitZoom(z)],ue=Math.pow(2,z),xe=this.options,Se=xe.radius/xe.extent,G=(q-Se)/ue,he=(q+1+Se)/ue,Ce={features:[]};return this._addTileFeatures(te.range((F-Se)/ue,G,(F+1+Se)/ue,he),te.points,F,q,ue,Ce),F===0&&this._addTileFeatures(te.range(1-Se/ue,G,1,he),te.points,ue,q,ue,Ce),F===ue-1&&this._addTileFeatures(te.range(0,G,Se/ue,he),te.points,-1,q,ue,Ce),Ce.features.length?Ce:null},Et.prototype.getClusterExpansionZoom=function(z){for(var F=this._getOriginZoom(z)-1;F<=this.options.maxZoom;){var q=this.getChildren(z);if(F++,q.length!==1)break;z=q[0].properties.cluster_id}return F},Et.prototype._appendLeaves=function(z,F,q,te,ue){for(var xe=0,Se=this.getChildren(F);xe<Se.length;xe+=1){var G=Se[xe],he=G.properties;if(he&&he.cluster?ue+he.point_count<=te?ue+=he.point_count:ue=this._appendLeaves(z,he.cluster_id,q,te,ue):ue<te?ue++:z.push(G),z.length===q)break}return ue},Et.prototype._addTileFeatures=function(z,F,q,te,ue,xe){for(var Se=0,G=z;Se<G.length;Se+=1){var he=F[G[Se]],Ce=he.numPoints,$e={type:1,geometry:[[Math.round(this.options.extent*(he.x*ue-q)),Math.round(this.options.extent*(he.y*ue-te))]],tags:Ce?Nr(he):this.points[he.index].properties},He=void 0;Ce?He=he.id:this.options.generateId?He=he.index:this.points[he.index].id&&(He=this.points[he.index].id),He!==void 0&&($e.id=He),xe.features.push($e)}},Et.prototype._limitZoom=function(z){return Math.max(this.options.minZoom,Math.min(+z,this.options.maxZoom+1))},Et.prototype._cluster=function(z,F){for(var q=[],te=this.options,ue=te.reduce,xe=te.minPoints,Se=te.radius/(te.extent*Math.pow(2,F)),G=0;G<z.length;G++){var he=z[G];if(!(he.zoom<=F)){he.zoom=F;for(var Ce=this.trees[F+1],$e=Ce.within(he.x,he.y,Se),He=he.numPoints||1,Ne=He,We=0,ct=$e;We<ct.length;We+=1){var ot=Ce.points[ct[We]];ot.zoom>F&&(Ne+=ot.numPoints||1)}if(Ne>=xe){for(var Fe=he.x*He,rt=he.y*He,Ye=ue&&He>1?this._map(he,!0):null,Je=(G<<5)+(F+1)+this.points.length,Bt=0,tt=$e;Bt<tt.length;Bt+=1){var tr=Ce.points[tt[Bt]];if(!(tr.zoom<=F)){tr.zoom=F;var Mr=tr.numPoints||1;Fe+=tr.x*Mr,rt+=tr.y*Mr,tr.parentId=Je,ue&&(Ye||(Ye=this._map(he,!0)),ue(Ye,this._map(tr)))}}he.parentId=Je,q.push(er(Fe/Ne,rt/Ne,Je,Ne,Ye))}else if(q.push(he),Ne>1)for(var Jt=0,lr=$e;Jt<lr.length;Jt+=1){var Ft=Ce.points[lr[Jt]];Ft.zoom<=F||(Ft.zoom=F,q.push(Ft))}}}return q},Et.prototype._getOriginId=function(z){return z-this.points.length>>5},Et.prototype._getOriginZoom=function(z){return(z-this.points.length)%32},Et.prototype._map=function(z,F){if(z.numPoints)return F?$r({},z.properties):z.properties;var q=this.points[z.index].properties,te=this.options.map(q);return F&&te===q?$r({},te):te},ta.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ta.prototype.splitTile=function(z,F,q,te,ue,xe,Se){for(var G=[z,F,q,te],he=this.options,Ce=he.debug;G.length;){te=G.pop(),q=G.pop(),F=G.pop(),z=G.pop();var $e=1<<F,He=ra(F,q,te),Ne=this.tiles[He];if(!Ne&&(Ce>1&&console.time("creation"),Ne=this.tiles[He]=ja(z,F,q,te,he),this.tileCoords.push({z:F,x:q,y:te}),Ce)){Ce>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",F,q,te,Ne.numFeatures,Ne.numPoints,Ne.numSimplified),console.timeEnd("creation"));var We="z"+F;this.stats[We]=(this.stats[We]||0)+1,this.total++}if(Ne.source=z,ue){if(F===he.maxZoom||F===ue)continue;var ct=1<<ue-F;if(q!==Math.floor(xe/ct)||te!==Math.floor(Se/ct))continue}else if(F===he.indexMaxZoom||Ne.numPoints<=he.indexMaxPoints)continue;if(Ne.source=null,z.length!==0){Ce>1&&console.time("clipping");var ot,Fe,rt,Ye,Je,Bt,tt=.5*he.buffer/he.extent,tr=.5-tt,Mr=.5+tt,Jt=1+tt;ot=Fe=rt=Ye=null,Je=nr(z,$e,q-tt,q+Mr,0,Ne.minX,Ne.maxX,he),Bt=nr(z,$e,q+tr,q+Jt,0,Ne.minX,Ne.maxX,he),z=null,Je&&(ot=nr(Je,$e,te-tt,te+Mr,1,Ne.minY,Ne.maxY,he),Fe=nr(Je,$e,te+tr,te+Jt,1,Ne.minY,Ne.maxY,he),Je=null),Bt&&(rt=nr(Bt,$e,te-tt,te+Mr,1,Ne.minY,Ne.maxY,he),Ye=nr(Bt,$e,te+tr,te+Jt,1,Ne.minY,Ne.maxY,he),Bt=null),Ce>1&&console.timeEnd("clipping"),G.push(ot||[],F+1,2*q,2*te),G.push(Fe||[],F+1,2*q,2*te+1),G.push(rt||[],F+1,2*q+1,2*te),G.push(Ye||[],F+1,2*q+1,2*te+1)}}},ta.prototype.getTile=function(z,F,q){var te=this.options,ue=te.extent,xe=te.debug;if(z<0||z>24)return null;var Se=1<<z,G=ra(z,F=(F%Se+Se)%Se,q);if(this.tiles[G])return zo(this.tiles[G],ue);xe>1&&console.log("drilling down to z%d-%d-%d",z,F,q);for(var he,Ce=z,$e=F,He=q;!he&&Ce>0;)Ce--,$e=Math.floor($e/2),He=Math.floor(He/2),he=this.tiles[ra(Ce,$e,He)];return he&&he.source?(xe>1&&console.log("found parent tile z%d-%d-%d",Ce,$e,He),xe>1&&console.time("drilling down"),this.splitTile(he.source,Ce,$e,He,z,F,q),xe>1&&console.timeEnd("drilling down"),this.tiles[G]?zo(this.tiles[G],ue):null):null};var No=function(z){function F(q,te,ue,xe){z.call(this,q,te,ue,Ta),xe&&(this.loadGeoJSON=xe)}return z&&(F.__proto__=z),(F.prototype=Object.create(z&&z.prototype)).constructor=F,F.prototype.loadData=function(q,te){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=te,this._pendingLoadDataParams=q,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},F.prototype._loadData=function(){var q=this;if(this._pendingCallback&&this._pendingLoadDataParams){var te=this._pendingCallback,ue=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var xe=!!(ue&&ue.request&&ue.request.collectResourceTiming)&&new o.RequestPerformance(ue.request);this.loadGeoJSON(ue,function(Se,G){if(Se||!G)return te(Se);if(typeof G!="object")return te(new Error("Input data given to '"+ue.source+"' is not a valid GeoJSON object."));(function Ne(We,ct){var ot,Fe=We&&We.type;if(Fe==="FeatureCollection")for(ot=0;ot<We.features.length;ot++)Ne(We.features[ot],ct);else if(Fe==="GeometryCollection")for(ot=0;ot<We.geometries.length;ot++)Ne(We.geometries[ot],ct);else if(Fe==="Feature")Ne(We.geometry,ct);else if(Fe==="Polygon")ee(We.coordinates,ct);else if(Fe==="MultiPolygon")for(ot=0;ot<We.coordinates.length;ot++)ee(We.coordinates[ot],ct);return We})(G,!0);try{if(ue.filter){var he=o.createExpression(ue.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(he.result==="error")throw new Error(he.value.map(function(Ne){return Ne.key+": "+Ne.message}).join(", "));var Ce=G.features.filter(function(Ne){return he.value.evaluate({zoom:0},Ne)});G={type:"FeatureCollection",features:Ce}}q._geoJSONIndex=ue.cluster?new Et(function(Ne){var We=Ne.superclusterOptions,ct=Ne.clusterProperties;if(!ct||!We)return We;for(var ot={},Fe={},rt={accumulated:null,zoom:0},Ye={properties:null},Je=Object.keys(ct),Bt=0,tt=Je;Bt<tt.length;Bt+=1){var tr=tt[Bt],Mr=ct[tr],Jt=Mr[0],lr=o.createExpression(Mr[1]),Ft=o.createExpression(typeof Jt=="string"?[Jt,["accumulated"],["get",tr]]:Jt);ot[tr]=lr.value,Fe[tr]=Ft.value}return We.map=function(fn){Ye.properties=fn;for(var ar={},Or=0,gr=Je;Or<gr.length;Or+=1){var Ut=gr[Or];ar[Ut]=ot[Ut].evaluate(rt,Ye)}return ar},We.reduce=function(fn,ar){Ye.properties=ar;for(var Or=0,gr=Je;Or<gr.length;Or+=1){var Ut=gr[Or];rt.accumulated=fn[Ut],fn[Ut]=Fe[Ut].evaluate(rt,Ye)}},We}(ue)).load(G.features):function(Ne,We){return new ta(Ne,We)}(G,ue.geojsonVtOptions)}catch(Ne){return te(Ne)}q.loaded={};var $e={};if(xe){var He=xe.finish();He&&($e.resourceTiming={},$e.resourceTiming[ue.source]=JSON.parse(JSON.stringify(He)))}te(null,$e)})}},F.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},F.prototype.reloadTile=function(q,te){var ue=this.loaded;return ue&&ue[q.uid]?z.prototype.reloadTile.call(this,q,te):this.loadTile(q,te)},F.prototype.loadGeoJSON=function(q,te){if(q.request)o.getJSON(q.request,te);else{if(typeof q.data!="string")return te(new Error("Input data given to '"+q.source+"' is not a valid GeoJSON object."));try{return te(null,JSON.parse(q.data))}catch{return te(new Error("Input data given to '"+q.source+"' is not a valid GeoJSON object."))}}},F.prototype.removeSource=function(q,te){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),te()},F.prototype.getClusterExpansionZoom=function(q,te){try{te(null,this._geoJSONIndex.getClusterExpansionZoom(q.clusterId))}catch(ue){te(ue)}},F.prototype.getClusterChildren=function(q,te){try{te(null,this._geoJSONIndex.getChildren(q.clusterId))}catch(ue){te(ue)}},F.prototype.getClusterLeaves=function(q,te){try{te(null,this._geoJSONIndex.getLeaves(q.clusterId,q.limit,q.offset))}catch(ue){te(ue)}},F}(D),tn=function(z){var F=this;this.self=z,this.actor=new o.Actor(z,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:D,geojson:No},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(q,te){if(F.workerSourceTypes[q])throw new Error('Worker source with name "'+q+'" already registered.');F.workerSourceTypes[q]=te},this.self.registerRTLTextPlugin=function(q){if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=q.applyArabicShaping,o.plugin.processBidirectionalText=q.processBidirectionalText,o.plugin.processStyledBidirectionalText=q.processStyledBidirectionalText}};return tn.prototype.setReferrer=function(z,F){this.referrer=F},tn.prototype.setImages=function(z,F,q){for(var te in this.availableImages[z]=F,this.workerSources[z]){var ue=this.workerSources[z][te];for(var xe in ue)ue[xe].availableImages=F}q()},tn.prototype.setLayers=function(z,F,q){this.getLayerIndex(z).replace(F),q()},tn.prototype.updateLayers=function(z,F,q){this.getLayerIndex(z).update(F.layers,F.removedIds),q()},tn.prototype.loadTile=function(z,F,q){this.getWorkerSource(z,F.type,F.source).loadTile(F,q)},tn.prototype.loadDEMTile=function(z,F,q){this.getDEMWorkerSource(z,F.source).loadTile(F,q)},tn.prototype.reloadTile=function(z,F,q){this.getWorkerSource(z,F.type,F.source).reloadTile(F,q)},tn.prototype.abortTile=function(z,F,q){this.getWorkerSource(z,F.type,F.source).abortTile(F,q)},tn.prototype.removeTile=function(z,F,q){this.getWorkerSource(z,F.type,F.source).removeTile(F,q)},tn.prototype.removeDEMTile=function(z,F){this.getDEMWorkerSource(z,F.source).removeTile(F)},tn.prototype.removeSource=function(z,F,q){if(this.workerSources[z]&&this.workerSources[z][F.type]&&this.workerSources[z][F.type][F.source]){var te=this.workerSources[z][F.type][F.source];delete this.workerSources[z][F.type][F.source],te.removeSource!==void 0?te.removeSource(F,q):q()}},tn.prototype.loadWorkerSource=function(z,F,q){try{this.self.importScripts(F.url),q()}catch(te){q(te.toString())}},tn.prototype.syncRTLPluginState=function(z,F,q){try{o.plugin.setState(F);var te=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&te!=null){this.self.importScripts(te);var ue=o.plugin.isParsed();q(ue?void 0:new Error("RTL Text Plugin failed to import scripts from "+te),ue)}}catch(xe){q(xe.toString())}},tn.prototype.getAvailableImages=function(z){var F=this.availableImages[z];return F||(F=[]),F},tn.prototype.getLayerIndex=function(z){var F=this.layerIndexes[z];return F||(F=this.layerIndexes[z]=new E),F},tn.prototype.getWorkerSource=function(z,F,q){var te=this;return this.workerSources[z]||(this.workerSources[z]={}),this.workerSources[z][F]||(this.workerSources[z][F]={}),this.workerSources[z][F][q]||(this.workerSources[z][F][q]=new this.workerSourceTypes[F]({send:function(ue,xe,Se){te.actor.send(ue,xe,Se,z)}},this.getLayerIndex(z),this.getAvailableImages(z))),this.workerSources[z][F][q]},tn.prototype.getDEMWorkerSource=function(z,F){return this.demWorkerSources[z]||(this.demWorkerSources[z]={}),this.demWorkerSources[z][F]||(this.demWorkerSources[z][F]=new W),this.demWorkerSources[z][F]},tn.prototype.enforceCacheSizeLimit=function(z,F){o.enforceCacheSizeLimit(F)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new tn(self)),tn}),m(["./shared"],function(o){var _=o.createCommonjsModule(function(s){function c(g){return!l(g)}function l(g){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,P,A=new Blob([""],{type:"text/javascript"}),j=URL.createObjectURL(A);try{P=new Worker(j),w=!0}catch{w=!1}return P&&P.terminate(),URL.revokeObjectURL(j),w}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var w=document.createElement("canvas");w.width=w.height=1;var P=w.getContext("2d");if(!P)return!1;var A=P.getImageData(0,0,1,1);return A&&A.width===w.width}()?(d[x=g&&g.failIfMajorPerformanceCaveat]===void 0&&(d[x]=function(w){var P=function(j){var Z=document.createElement("canvas"),X=Object.create(c.webGLContextAttributes);return X.failIfMajorPerformanceCaveat=j,Z.probablySupportsContext?Z.probablySupportsContext("webgl",X)||Z.probablySupportsContext("experimental-webgl",X):Z.supportsContext?Z.supportsContext("webgl",X)||Z.supportsContext("experimental-webgl",X):Z.getContext("webgl",X)||Z.getContext("experimental-webgl",X)}(w);if(!P)return!1;var A=P.createShader(P.VERTEX_SHADER);return!(!A||P.isContextLost())&&(P.shaderSource(A,"void main() {}"),P.compileShader(A),P.getShaderParameter(A,P.COMPILE_STATUS)===!0)}(x)),d[x]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var x}s.exports?s.exports=c:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=c,window.mapboxgl.notSupportedReason=l);var d={};c.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),b={create:function(s,c,l){var d=o.window.document.createElement(s);return c!==void 0&&(d.className=c),l&&l.appendChild(d),d},createNS:function(s,c){return o.window.document.createElementNS(s,c)}},E=o.window.document&&o.window.document.documentElement.style;function T(s){if(!E)return s[0];for(var c=0;c<s.length;c++)if(s[c]in E)return s[c];return s[0]}var M,I=T(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);b.disableDrag=function(){E&&I&&(M=E[I],E[I]="none")},b.enableDrag=function(){E&&I&&(E[I]=M)};var N=T(["transform","WebkitTransform"]);b.setTransform=function(s,c){s.style[N]=c};var D=!1;try{var re=Object.defineProperty({},"passive",{get:function(){D=!0}});o.window.addEventListener("test",re,re),o.window.removeEventListener("test",re,re)}catch{D=!1}b.addEventListener=function(s,c,l,d){d===void 0&&(d={}),s.addEventListener(c,l,"passive"in d&&D?d:d.capture)},b.removeEventListener=function(s,c,l,d){d===void 0&&(d={}),s.removeEventListener(c,l,"passive"in d&&D?d:d.capture)};var W=function(s){s.preventDefault(),s.stopPropagation(),o.window.removeEventListener("click",W,!0)};function ee(s){var c=s.userImage;return!!(c&&c.render&&c.render())&&(s.data.replace(new Uint8Array(c.data.buffer)),!0)}b.suppressClick=function(){o.window.addEventListener("click",W,!0),o.window.setTimeout(function(){o.window.removeEventListener("click",W,!0)},0)},b.mousePos=function(s,c){var l=s.getBoundingClientRect();return new o.Point(c.clientX-l.left-s.clientLeft,c.clientY-l.top-s.clientTop)},b.touchPos=function(s,c){for(var l=s.getBoundingClientRect(),d=[],g=0;g<c.length;g++)d.push(new o.Point(c[g].clientX-l.left-s.clientLeft,c[g].clientY-l.top-s.clientTop));return d},b.mouseButton=function(s){return o.window.InstallTrigger!==void 0&&s.button===2&&s.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:s.button},b.remove=function(s){s.parentNode&&s.parentNode.removeChild(s)};var J=function(s){function c(){s.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.isLoaded=function(){return this.loaded},c.prototype.setLoaded=function(l){if(this.loaded!==l&&(this.loaded=l,l)){for(var d=0,g=this.requestors;d<g.length;d+=1){var x=g[d];this._notify(x.ids,x.callback)}this.requestors=[]}},c.prototype.getImage=function(l){return this.images[l]},c.prototype.addImage=function(l,d){this._validate(l,d)&&(this.images[l]=d)},c.prototype._validate=function(l,d){var g=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new o.ErrorEvent(new Error('Image "'+l+'" has invalid "stretchX" value'))),g=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new o.ErrorEvent(new Error('Image "'+l+'" has invalid "stretchY" value'))),g=!1),this._validateContent(d.content,d)||(this.fire(new o.ErrorEvent(new Error('Image "'+l+'" has invalid "content" value'))),g=!1),g},c.prototype._validateStretch=function(l,d){if(!l)return!0;for(var g=0,x=0,w=l;x<w.length;x+=1){var P=w[x];if(P[0]<g||P[1]<P[0]||d<P[1])return!1;g=P[1]}return!0},c.prototype._validateContent=function(l,d){return!(l&&(l.length!==4||l[0]<0||d.data.width<l[0]||l[1]<0||d.data.height<l[1]||l[2]<0||d.data.width<l[2]||l[3]<0||d.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))},c.prototype.updateImage=function(l,d){d.version=this.images[l].version+1,this.images[l]=d,this.updatedImages[l]=!0},c.prototype.removeImage=function(l){var d=this.images[l];delete this.images[l],delete this.patterns[l],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()},c.prototype.listImages=function(){return Object.keys(this.images)},c.prototype.getImages=function(l,d){var g=!0;if(!this.isLoaded())for(var x=0,w=l;x<w.length;x+=1)this.images[w[x]]||(g=!1);this.isLoaded()||g?this._notify(l,d):this.requestors.push({ids:l,callback:d})},c.prototype._notify=function(l,d){for(var g={},x=0,w=l;x<w.length;x+=1){var P=w[x];this.images[P]||this.fire(new o.Event("styleimagemissing",{id:P}));var A=this.images[P];A?g[P]={data:A.data.clone(),pixelRatio:A.pixelRatio,sdf:A.sdf,version:A.version,stretchX:A.stretchX,stretchY:A.stretchY,content:A.content,hasRenderCallback:!!(A.userImage&&A.userImage.render)}:o.warnOnce('Image "'+P+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}d(null,g)},c.prototype.getPixelSize=function(){var l=this.atlasImage;return{width:l.width,height:l.height}},c.prototype.getPattern=function(l){var d=this.patterns[l],g=this.getImage(l);if(!g)return null;if(d&&d.position.version===g.version)return d.position;if(d)d.position.version=g.version;else{var x={w:g.data.width+2,h:g.data.height+2,x:0,y:0},w=new o.ImagePosition(x,g);this.patterns[l]={bin:x,position:w}}return this._updatePatternAtlas(),this.patterns[l].position},c.prototype.bind=function(l){var d=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(l,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)},c.prototype._updatePatternAtlas=function(){var l=[];for(var d in this.patterns)l.push(this.patterns[d].bin);var g=o.potpack(l),x=g.w,w=g.h,P=this.atlasImage;for(var A in P.resize({width:x||1,height:w||1}),this.patterns){var j=this.patterns[A].bin,Z=j.x+1,X=j.y+1,Q=this.images[A].data,pe=Q.width,se=Q.height;o.RGBAImage.copy(Q,P,{x:0,y:0},{x:Z,y:X},{width:pe,height:se}),o.RGBAImage.copy(Q,P,{x:0,y:se-1},{x:Z,y:X-1},{width:pe,height:1}),o.RGBAImage.copy(Q,P,{x:0,y:0},{x:Z,y:X+se},{width:pe,height:1}),o.RGBAImage.copy(Q,P,{x:pe-1,y:0},{x:Z-1,y:X},{width:1,height:se}),o.RGBAImage.copy(Q,P,{x:0,y:0},{x:Z+pe,y:X},{width:1,height:se})}this.dirty=!0},c.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},c.prototype.dispatchRenderCallbacks=function(l){for(var d=0,g=l;d<g.length;d+=1){var x=g[d];if(!this.callbackDispatchedThisFrame[x]){this.callbackDispatchedThisFrame[x]=!0;var w=this.images[x];ee(w)&&this.updateImage(x,w)}}},c}(o.Evented),Y=K,B=K,V=1e20;function K(s,c,l,d,g,x){this.fontSize=s||24,this.buffer=c===void 0?3:c,this.cutoff=d||.25,this.fontFamily=g||"sans-serif",this.fontWeight=x||"normal",this.radius=l||8;var w=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=w,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.d=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Int16Array(w),this.middle=Math.round(w/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function ve(s,c,l,d,g,x,w){for(var P=0;P<c;P++){for(var A=0;A<l;A++)d[A]=s[A*c+P];for(de(d,g,x,w,l),A=0;A<l;A++)s[A*c+P]=g[A]}for(A=0;A<l;A++){for(P=0;P<c;P++)d[P]=s[A*c+P];for(de(d,g,x,w,c),P=0;P<c;P++)s[A*c+P]=Math.sqrt(g[P])}}function de(s,c,l,d,g){l[0]=0,d[0]=-V,d[1]=+V;for(var x=1,w=0;x<g;x++){for(var P=(s[x]+x*x-(s[l[w]]+l[w]*l[w]))/(2*x-2*l[w]);P<=d[w];)w--,P=(s[x]+x*x-(s[l[w]]+l[w]*l[w]))/(2*x-2*l[w]);l[++w]=x,d[w]=P,d[w+1]=+V}for(x=0,w=0;x<g;x++){for(;d[w+1]<x;)w++;c[x]=(x-l[w])*(x-l[w])+s[l[w]]}}K.prototype.draw=function(s){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(s,this.buffer,this.middle);for(var c=this.ctx.getImageData(0,0,this.size,this.size),l=new Uint8ClampedArray(this.size*this.size),d=0;d<this.size*this.size;d++){var g=c.data[4*d+3]/255;this.gridOuter[d]=g===1?0:g===0?V:Math.pow(Math.max(0,.5-g),2),this.gridInner[d]=g===1?V:g===0?0:Math.pow(Math.max(0,g-.5),2)}for(ve(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),ve(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),d=0;d<this.size*this.size;d++)l[d]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[d]-this.gridInner[d])/this.radius+this.cutoff))));return l},Y.default=B;var ie=function(s,c){this.requestManager=s,this.localIdeographFontFamily=c,this.entries={}};ie.prototype.setURL=function(s){this.url=s},ie.prototype.getGlyphs=function(s,c){var l=this,d=[];for(var g in s)for(var x=0,w=s[g];x<w.length;x+=1)d.push({stack:g,id:w[x]});o.asyncAll(d,function(P,A){var j=P.stack,Z=P.id,X=l.entries[j];X||(X=l.entries[j]={glyphs:{},requests:{},ranges:{}});var Q=X.glyphs[Z];if(Q===void 0){if(Q=l._tinySDF(X,j,Z))return X.glyphs[Z]=Q,void A(null,{stack:j,id:Z,glyph:Q});var pe=Math.floor(Z/256);if(256*pe>65535)A(new Error("glyphs > 65535 not supported"));else if(X.ranges[pe])A(null,{stack:j,id:Z,glyph:Q});else{var se=X.requests[pe];se||(se=X.requests[pe]=[],ie.loadGlyphRange(j,pe,l.url,l.requestManager,function(ye,ae){if(ae){for(var ge in ae)l._doesCharSupportLocalGlyph(+ge)||(X.glyphs[+ge]=ae[+ge]);X.ranges[pe]=!0}for(var Ee=0,Ie=se;Ee<Ie.length;Ee+=1)(0,Ie[Ee])(ye,ae);delete X.requests[pe]})),se.push(function(ye,ae){ye?A(ye):ae&&A(null,{stack:j,id:Z,glyph:ae[Z]||null})})}}else A(null,{stack:j,id:Z,glyph:Q})},function(P,A){if(P)c(P);else if(A){for(var j={},Z=0,X=A;Z<X.length;Z+=1){var Q=X[Z],pe=Q.stack,se=Q.id,ye=Q.glyph;(j[pe]||(j[pe]={}))[se]=ye&&{id:ye.id,bitmap:ye.bitmap.clone(),metrics:ye.metrics}}c(null,j)}})},ie.prototype._doesCharSupportLocalGlyph=function(s){return!!this.localIdeographFontFamily&&(o.isChar["CJK Unified Ideographs"](s)||o.isChar["Hangul Syllables"](s)||o.isChar.Hiragana(s)||o.isChar.Katakana(s))},ie.prototype._tinySDF=function(s,c,l){var d=this.localIdeographFontFamily;if(d&&this._doesCharSupportLocalGlyph(l)){var g=s.tinySDF;if(!g){var x="400";/bold/i.test(c)?x="900":/medium/i.test(c)?x="500":/light/i.test(c)&&(x="200"),g=s.tinySDF=new ie.TinySDF(24,3,8,.25,d,x)}return{id:l,bitmap:new o.AlphaImage({width:30,height:30},g.draw(String.fromCharCode(l))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},ie.loadGlyphRange=function(s,c,l,d,g){var x=256*c,w=x+255,P=d.transformRequest(d.normalizeGlyphsURL(l).replace("{fontstack}",s).replace("{range}",x+"-"+w),o.ResourceType.Glyphs);o.getArrayBuffer(P,function(A,j){if(A)g(A);else if(j){for(var Z={},X=0,Q=o.parseGlyphPBF(j);X<Q.length;X+=1){var pe=Q[X];Z[pe.id]=pe}g(null,Z)}})},ie.TinySDF=Y;var we=function(){this.specification=o.styleSpec.light.position};we.prototype.possiblyEvaluate=function(s,c){return o.sphericalToCartesian(s.expression.evaluate(c))},we.prototype.interpolate=function(s,c,l){return{x:o.number(s.x,c.x,l),y:o.number(s.y,c.y,l),z:o.number(s.z,c.z,l)}};var ze=new o.Properties({anchor:new o.DataConstantProperty(o.styleSpec.light.anchor),position:new we,color:new o.DataConstantProperty(o.styleSpec.light.color),intensity:new o.DataConstantProperty(o.styleSpec.light.intensity)}),De=function(s){function c(l){s.call(this),this._transitionable=new o.Transitionable(ze),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getLight=function(){return this._transitionable.serialize()},c.prototype.setLight=function(l,d){if(d===void 0&&(d={}),!this._validate(o.validateLight,l,d))for(var g in l){var x=l[g];o.endsWith(g,"-transition")?this._transitionable.setTransition(g.slice(0,-11),x):this._transitionable.setValue(g,x)}},c.prototype.updateTransitions=function(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)},c.prototype.hasTransition=function(){return this._transitioning.hasTransition()},c.prototype.recalculate=function(l){this.properties=this._transitioning.possiblyEvaluate(l)},c.prototype._validate=function(l,d,g){return(!g||g.validate!==!1)&&o.emitValidationErrors(this,l.call(o.validateStyle,o.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:o.styleSpec})))},c}(o.Evented),ce=function(s,c){this.width=s,this.height=c,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};ce.prototype.getDash=function(s,c){var l=s.join(",")+String(c);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(s,c)),this.dashEntry[l]},ce.prototype.getDashRanges=function(s,c,l){var d=[],g=s.length%2==1?-s[s.length-1]*l:0,x=s[0]*l,w=!0;d.push({left:g,right:x,isDash:w,zeroLength:s[0]===0});for(var P=s[0],A=1;A<s.length;A++){var j=s[A];d.push({left:g=P*l,right:x=(P+=j)*l,isDash:w=!w,zeroLength:j===0})}return d},ce.prototype.addRoundDash=function(s,c,l){for(var d=c/2,g=-l;g<=l;g++)for(var x=this.width*(this.nextRow+l+g),w=0,P=s[w],A=0;A<this.width;A++){A/P.right>1&&(P=s[++w]);var j=Math.abs(A-P.left),Z=Math.abs(A-P.right),X=Math.min(j,Z),Q=void 0,pe=g/l*(d+1);if(P.isDash){var se=d-Math.abs(pe);Q=Math.sqrt(X*X+se*se)}else Q=d-Math.sqrt(X*X+pe*pe);this.data[x+A]=Math.max(0,Math.min(255,Q+128))}},ce.prototype.addRegularDash=function(s){for(var c=s.length-1;c>=0;--c){var l=s[c],d=s[c+1];l.zeroLength?s.splice(c,1):d&&d.isDash===l.isDash&&(d.left=l.left,s.splice(c,1))}var g=s[0],x=s[s.length-1];g.isDash===x.isDash&&(g.left=x.left-this.width,x.right=g.right+this.width);for(var w=this.width*this.nextRow,P=0,A=s[P],j=0;j<this.width;j++){j/A.right>1&&(A=s[++P]);var Z=Math.abs(j-A.left),X=Math.abs(j-A.right),Q=Math.min(Z,X);this.data[w+j]=Math.max(0,Math.min(255,(A.isDash?Q:-Q)+128))}},ce.prototype.addDash=function(s,c){var l=c?7:0,d=2*l+1;if(this.nextRow+d>this.height)return o.warnOnce("LineAtlas out of space"),null;for(var g=0,x=0;x<s.length;x++)g+=s[x];if(g!==0){var w=this.width/g,P=this.getDashRanges(s,this.width,w);c?this.addRoundDash(P,w,l):this.addRegularDash(P)}var A={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:g};return this.nextRow+=d,this.dirty=!0,A},ce.prototype.bind=function(s){var c=s.gl;this.texture?(c.bindTexture(c.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,c.texSubImage2D(c.TEXTURE_2D,0,0,0,this.width,this.height,c.ALPHA,c.UNSIGNED_BYTE,this.data))):(this.texture=c.createTexture(),c.bindTexture(c.TEXTURE_2D,this.texture),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texImage2D(c.TEXTURE_2D,0,c.ALPHA,this.width,this.height,0,c.ALPHA,c.UNSIGNED_BYTE,this.data))};var Pe=function s(c,l){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=o.uniqueId();for(var d=this.workerPool.acquire(this.id),g=0;g<d.length;g++){var x=new s.Actor(d[g],l,this.id);x.name="Worker "+g,this.actors.push(x)}};function gt(s,c,l){var d=function(g,x){if(g)return l(g);if(x){var w=o.pick(o.extend(x,s),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);x.vector_layers&&(w.vectorLayers=x.vector_layers,w.vectorLayerIds=w.vectorLayers.map(function(P){return P.id})),w.tiles=c.canonicalizeTileset(w,s.url),l(null,w)}};return s.url?o.getJSON(c.transformRequest(c.normalizeSourceURL(s.url),o.ResourceType.Source),d):o.browser.frame(function(){return d(null,s)})}Pe.prototype.broadcast=function(s,c,l){o.asyncAll(this.actors,function(d,g){d.send(s,c,g)},l=l||function(){})},Pe.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Pe.prototype.remove=function(){this.actors.forEach(function(s){s.remove()}),this.actors=[],this.workerPool.release(this.id)},Pe.Actor=o.Actor;var jt=function(s,c,l){this.bounds=o.LngLatBounds.convert(this.validateBounds(s)),this.minzoom=c||0,this.maxzoom=l||24};jt.prototype.validateBounds=function(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]},jt.prototype.contains=function(s){var c=Math.pow(2,s.z),l=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*c),d=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*c),g=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*c),x=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*c);return s.x>=l&&s.x<g&&s.y>=d&&s.y<x};var Tt=function(s){function c(l,d,g,x){if(s.call(this),this.id=l,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(d,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.load=function(){var l=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=gt(this._options,this.map._requestManager,function(d,g){l._tileJSONRequest=null,l._loaded=!0,d?l.fire(new o.ErrorEvent(d)):g&&(o.extend(l,g),g.bounds&&(l.tileBounds=new jt(g.bounds,l.minzoom,l.maxzoom)),o.postTurnstileEvent(g.tiles,l.map._requestManager._customAccessToken),o.postMapLoadEvent(g.tiles,l.map._getMapId(),l.map._requestManager._skuToken,l.map._requestManager._customAccessToken),l.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),l.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},c.prototype.loaded=function(){return this._loaded},c.prototype.hasTile=function(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)},c.prototype.onAdd=function(l){this.map=l,this.load()},c.prototype.setSourceProperty=function(l){this._tileJSONRequest&&this._tileJSONRequest.cancel(),l(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},c.prototype.setTiles=function(l){var d=this;return this.setSourceProperty(function(){d._options.tiles=l}),this},c.prototype.setUrl=function(l){var d=this;return this.setSourceProperty(function(){d.url=l,d._options.url=l}),this},c.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},c.prototype.serialize=function(){return o.extend({},this._options)},c.prototype.loadTile=function(l,d){var g=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),x={request:this.map._requestManager.transformRequest(g,o.ResourceType.Tile),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function w(P,A){return delete l.request,l.aborted?d(null):P&&P.status!==404?d(P):(A&&A.resourceTiming&&(l.resourceTiming=A.resourceTiming),this.map._refreshExpiredTiles&&A&&l.setExpiryData(A),l.loadVectorData(A,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),d(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}x.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired"?l.state==="loading"?l.reloadCallback=d:l.request=l.actor.send("reloadTile",x,w.bind(this)):(l.actor=this.dispatcher.getActor(),l.request=l.actor.send("loadTile",x,w.bind(this)))},c.prototype.abortTile=function(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id},void 0)},c.prototype.unloadTile=function(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id},void 0)},c.prototype.hasTransition=function(){return!1},c}(o.Evented),kt=function(s){function c(l,d,g,x){s.call(this),this.id=l,this.dispatcher=g,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},d),o.extend(this,o.pick(d,["url","scheme","tileSize"]))}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.load=function(){var l=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=gt(this._options,this.map._requestManager,function(d,g){l._tileJSONRequest=null,l._loaded=!0,d?l.fire(new o.ErrorEvent(d)):g&&(o.extend(l,g),g.bounds&&(l.tileBounds=new jt(g.bounds,l.minzoom,l.maxzoom)),o.postTurnstileEvent(g.tiles),o.postMapLoadEvent(g.tiles,l.map._getMapId(),l.map._requestManager._skuToken),l.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),l.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},c.prototype.loaded=function(){return this._loaded},c.prototype.onAdd=function(l){this.map=l,this.load()},c.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},c.prototype.serialize=function(){return o.extend({},this._options)},c.prototype.hasTile=function(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)},c.prototype.loadTile=function(l,d){var g=this,x=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);l.request=o.getImage(this.map._requestManager.transformRequest(x,o.ResourceType.Tile),function(w,P){if(delete l.request,l.aborted)l.state="unloaded",d(null);else if(w)l.state="errored",d(w);else if(P){g.map._refreshExpiredTiles&&l.setExpiryData(P),delete P.cacheControl,delete P.expires;var A=g.map.painter.context,j=A.gl;l.texture=g.map.painter.getTileTexture(P.width),l.texture?l.texture.update(P,{useMipmap:!0}):(l.texture=new o.Texture(A,P,j.RGBA,{useMipmap:!0}),l.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),A.extTextureFilterAnisotropic&&j.texParameterf(j.TEXTURE_2D,A.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,A.extTextureFilterAnisotropicMax)),l.state="loaded",o.cacheEntryPossiblyAdded(g.dispatcher),d(null)}})},c.prototype.abortTile=function(l,d){l.request&&(l.request.cancel(),delete l.request),d()},c.prototype.unloadTile=function(l,d){l.texture&&this.map.painter.saveTileTexture(l.texture),d()},c.prototype.hasTransition=function(){return!1},c}(o.Evented),Ir=function(s){function c(l,d,g,x){s.call(this,l,d,g,x),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox"}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},c.prototype.loadTile=function(l,d){var g=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function x(w,P){w&&(l.state="errored",d(w)),P&&(l.dem=P,l.needsHillshadePrepare=!0,l.state="loaded",d(null))}l.request=o.getImage(this.map._requestManager.transformRequest(g,o.ResourceType.Tile),(function(w,P){if(delete l.request,l.aborted)l.state="unloaded",d(null);else if(w)l.state="errored",d(w);else if(P){this.map._refreshExpiredTiles&&l.setExpiryData(P),delete P.cacheControl,delete P.expires;var A=o.window.ImageBitmap&&P instanceof o.window.ImageBitmap&&o.offscreenCanvasSupported()?P:o.browser.getImageData(P,1),j={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:A,encoding:this.encoding};l.actor&&l.state!=="expired"||(l.actor=this.dispatcher.getActor(),l.actor.send("loadDEMTile",j,x.bind(this)))}}).bind(this)),l.neighboringTiles=this._getNeighboringTiles(l.tileID)},c.prototype._getNeighboringTiles=function(l){var d=l.canonical,g=Math.pow(2,d.z),x=(d.x-1+g)%g,w=d.x===0?l.wrap-1:l.wrap,P=(d.x+1+g)%g,A=d.x+1===g?l.wrap+1:l.wrap,j={};return j[new o.OverscaledTileID(l.overscaledZ,w,d.z,x,d.y).key]={backfilled:!1},j[new o.OverscaledTileID(l.overscaledZ,A,d.z,P,d.y).key]={backfilled:!1},d.y>0&&(j[new o.OverscaledTileID(l.overscaledZ,w,d.z,x,d.y-1).key]={backfilled:!1},j[new o.OverscaledTileID(l.overscaledZ,l.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},j[new o.OverscaledTileID(l.overscaledZ,A,d.z,P,d.y-1).key]={backfilled:!1}),d.y+1<g&&(j[new o.OverscaledTileID(l.overscaledZ,w,d.z,x,d.y+1).key]={backfilled:!1},j[new o.OverscaledTileID(l.overscaledZ,l.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},j[new o.OverscaledTileID(l.overscaledZ,A,d.z,P,d.y+1).key]={backfilled:!1}),j},c.prototype.unloadTile=function(l){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&l.actor.send("removeDEMTile",{uid:l.uid,source:this.id})},c}(kt),pr=function(s){function c(l,d,g,x){s.call(this),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=g.getActor(),this.setEventedParent(x),this._data=d.data,this._options=o.extend({},d),this._collectResourceTiming=d.collectResourceTiming,this._resourceTiming=[],d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;var w=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*w,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*w,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?Math.min(d.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:o.EXTENT,radius:(d.clusterRadius||50)*w,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.load=function(){var l=this;this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(d){if(d)l.fire(new o.ErrorEvent(d));else{var g={dataType:"source",sourceDataType:"metadata"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(g.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new o.Event("data",g))}})},c.prototype.onAdd=function(l){this.map=l,this.load()},c.prototype.setData=function(l){var d=this;return this._data=l,this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(g){if(g)d.fire(new o.ErrorEvent(g));else{var x={dataType:"source",sourceDataType:"content"};d._collectResourceTiming&&d._resourceTiming&&d._resourceTiming.length>0&&(x.resourceTiming=d._resourceTiming,d._resourceTiming=[]),d.fire(new o.Event("data",x))}}),this},c.prototype.getClusterExpansionZoom=function(l,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:l,source:this.id},d),this},c.prototype.getClusterChildren=function(l,d){return this.actor.send("geojson.getClusterChildren",{clusterId:l,source:this.id},d),this},c.prototype.getClusterLeaves=function(l,d,g,x){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:l,limit:d,offset:g},x),this},c.prototype._updateWorkerData=function(l){var d=this;this._loaded=!1;var g=o.extend({},this.workerOptions),x=this._data;typeof x=="string"?(g.request=this.map._requestManager.transformRequest(o.browser.resolveURL(x),o.ResourceType.Source),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(x),this.actor.send(this.type+".loadData",g,function(w,P){d._removed||P&&P.abandoned||(d._loaded=!0,P&&P.resourceTiming&&P.resourceTiming[d.id]&&(d._resourceTiming=P.resourceTiming[d.id].slice(0)),d.actor.send(d.type+".coalesce",{source:g.source},null),l(w))})},c.prototype.loaded=function(){return this._loaded},c.prototype.loadTile=function(l,d){var g=this,x=l.actor?"reloadTile":"loadTile";l.actor=this.actor,l.request=this.actor.send(x,{type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(w,P){return delete l.request,l.unloadVectorData(),l.aborted?d(null):w?d(w):(l.loadVectorData(P,g.map.painter,x==="reloadTile"),d(null))})},c.prototype.abortTile=function(l){l.request&&(l.request.cancel(),delete l.request),l.aborted=!0},c.prototype.unloadTile=function(l){l.unloadVectorData(),this.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})},c.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},c.prototype.serialize=function(){return o.extend({},this._options,{type:this.type,data:this._data})},c.prototype.hasTransition=function(){return!1},c}(o.Evented),Zt=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Kt=function(s){function c(l,d,g,x){s.call(this),this.id=l,this.dispatcher=g,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=d}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.load=function(l,d){var g=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),function(x,w){g._loaded=!0,x?g.fire(new o.ErrorEvent(x)):w&&(g.image=w,l&&(g.coordinates=l),d&&d(),g._finishLoading())})},c.prototype.loaded=function(){return this._loaded},c.prototype.updateImage=function(l){var d=this;return this.image&&l.url?(this.options.url=l.url,this.load(l.coordinates,function(){d.texture=null}),this):this},c.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))},c.prototype.onAdd=function(l){this.map=l,this.load()},c.prototype.setCoordinates=function(l){var d=this;this.coordinates=l;var g=l.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(w){for(var P=1/0,A=1/0,j=-1/0,Z=-1/0,X=0,Q=w;X<Q.length;X+=1){var pe=Q[X];P=Math.min(P,pe.x),A=Math.min(A,pe.y),j=Math.max(j,pe.x),Z=Math.max(Z,pe.y)}var se=Math.max(j-P,Z-A),ye=Math.max(0,Math.floor(-Math.log(se)/Math.LN2)),ae=Math.pow(2,ye);return new o.CanonicalTileID(ye,Math.floor((P+j)/2*ae),Math.floor((A+Z)/2*ae))}(g),this.minzoom=this.maxzoom=this.tileID.z;var x=g.map(function(w){return d.tileID.getTilePoint(w)._round()});return this._boundsArray=new o.StructArrayLayout4i8,this._boundsArray.emplaceBack(x[0].x,x[0].y,0,0),this._boundsArray.emplaceBack(x[1].x,x[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(x[3].x,x[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(x[2].x,x[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this},c.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var l=this.map.painter.context,d=l.gl;for(var g in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Zt.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new o.Texture(l,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this.tiles){var x=this.tiles[g];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture)}}},c.prototype.loadTile=function(l,d){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},d(null)):(l.state="errored",d(null))},c.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},c.prototype.hasTransition=function(){return!1},c}(o.Evented),Yt=function(s){function c(l,d,g,x){s.call(this,l,d,g,x),this.roundZoom=!0,this.type="video",this.options=d}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.load=function(){var l=this;this._loaded=!1;var d=this.options;this.urls=[];for(var g=0,x=d.urls;g<x.length;g+=1)this.urls.push(this.map._requestManager.transformRequest(x[g],o.ResourceType.Source).url);o.getVideo(this.urls,function(w,P){l._loaded=!0,w?l.fire(new o.ErrorEvent(w)):P&&(l.video=P,l.video.loop=!0,l.video.setAttribute("playsinline",""),l.video.addEventListener("playing",function(){l.map.triggerRepaint()}),l.map&&l.video.play(),l._finishLoading())})},c.prototype.pause=function(){this.video&&this.video.pause()},c.prototype.play=function(){this.video&&this.video.play()},c.prototype.seek=function(l){if(this.video){var d=this.video.seekable;l<d.start(0)||l>d.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+d.start(0)+" and "+d.end(0)+"-second mark."))):this.video.currentTime=l}},c.prototype.getVideo=function(){return this.video},c.prototype.onAdd=function(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},c.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var l=this.map.painter.context,d=l.gl;for(var g in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Zt.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(l,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this.tiles){var x=this.tiles[g];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture)}}},c.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},c.prototype.hasTransition=function(){return this.video&&!this.video.paused},c}(Kt),Dt=function(s){function c(l,d,g,x){s.call(this,l,d,g,x),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(function(w){return!Array.isArray(w)||w.length!==2||w.some(function(P){return typeof P!="number"})})||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+l,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+l,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError("sources."+l,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+l,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+l,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},c.prototype.getCanvas=function(){return this.canvas},c.prototype.onAdd=function(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()},c.prototype.onRemove=function(){this.pause()},c.prototype.prepare=function(){var l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var d=this.map.painter.context,g=d.gl;for(var x in this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,Zt.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(d,this.canvas,g.RGBA,{premultiply:!0}),this.tiles){var w=this.tiles[x];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}},c.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},c.prototype.hasTransition=function(){return this._playing},c.prototype._hasInvalidDimensions=function(){for(var l=0,d=[this.canvas.width,this.canvas.height];l<d.length;l+=1){var g=d[l];if(isNaN(g)||g<=0)return!0}return!1},c}(Kt),Gt={vector:Tt,raster:kt,"raster-dem":Ir,geojson:pr,video:Yt,image:Kt,canvas:Dt};function yr(s,c){var l=o.identity([]);return o.translate(l,l,[1,1,0]),o.scale(l,l,[.5*s.width,.5*s.height,1]),o.multiply(l,l,s.calculatePosMatrix(c.toUnwrapped()))}function Et(s,c,l,d,g,x){var w=function(ye,ae,ge){if(ye)for(var Ee=0,Ie=ye;Ee<Ie.length;Ee+=1){var je=ae[Ie[Ee]];if(je&&je.source===ge&&je.type==="fill-extrusion")return!0}else for(var ke in ae){var Be=ae[ke];if(Be.source===ge&&Be.type==="fill-extrusion")return!0}return!1}(g&&g.layers,c,s.id),P=x.maxPitchScaleFactor(),A=s.tilesIn(d,P,w);A.sort(er);for(var j=[],Z=0,X=A;Z<X.length;Z+=1){var Q=X[Z];j.push({wrappedTileID:Q.tileID.wrapped().key,queryResults:Q.tile.queryRenderedFeatures(c,l,s._state,Q.queryGeometry,Q.cameraQueryGeometry,Q.scale,g,x,P,yr(s.transform,Q.tileID))})}var pe=function(ye){for(var ae={},ge={},Ee=0,Ie=ye;Ee<Ie.length;Ee+=1){var je=Ie[Ee],ke=je.queryResults,Be=je.wrappedTileID,qe=ge[Be]=ge[Be]||{};for(var Ke in ke)for(var Xe=ke[Ke],at=qe[Ke]=qe[Ke]||{},bt=ae[Ke]=ae[Ke]||[],Pt=0,St=Xe;Pt<St.length;Pt+=1){var mr=St[Pt];at[mr.featureIndex]||(at[mr.featureIndex]=!0,bt.push(mr))}}return ae}(j);for(var se in pe)pe[se].forEach(function(ye){var ae=ye.feature,ge=s.getFeatureState(ae.layer["source-layer"],ae.id);ae.source=ae.layer.source,ae.layer["source-layer"]&&(ae.sourceLayer=ae.layer["source-layer"]),ae.state=ge});return pe}function er(s,c){var l=s.tileID,d=c.tileID;return l.overscaledZ-d.overscaledZ||l.canonical.y-d.canonical.y||l.wrap-d.wrap||l.canonical.x-d.canonical.x}var mt=function(s,c){this.max=s,this.onRemove=c,this.reset()};mt.prototype.reset=function(){for(var s in this.data)for(var c=0,l=this.data[s];c<l.length;c+=1){var d=l[c];d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value)}return this.data={},this.order=[],this},mt.prototype.add=function(s,c,l){var d=this,g=s.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);var x={value:c,timeout:void 0};if(l!==void 0&&(x.timeout=setTimeout(function(){d.remove(s,x)},l)),this.data[g].push(x),this.order.push(g),this.order.length>this.max){var w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this},mt.prototype.has=function(s){return s.wrapped().key in this.data},mt.prototype.getAndRemove=function(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null},mt.prototype._getAndRemoveByKey=function(s){var c=this.data[s].shift();return c.timeout&&clearTimeout(c.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),c.value},mt.prototype.getByKey=function(s){var c=this.data[s];return c?c[0].value:null},mt.prototype.get=function(s){return this.has(s)?this.data[s.wrapped().key][0].value:null},mt.prototype.remove=function(s,c){if(!this.has(s))return this;var l=s.wrapped().key,d=c===void 0?0:this.data[l].indexOf(c),g=this.data[l][d];return this.data[l].splice(d,1),g.timeout&&clearTimeout(g.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(g.value),this.order.splice(this.order.indexOf(l),1),this},mt.prototype.setMaxSize=function(s){for(this.max=s;this.order.length>this.max;){var c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this},mt.prototype.filter=function(s){var c=[];for(var l in this.data)for(var d=0,g=this.data[l];d<g.length;d+=1){var x=g[d];s(x.value)||c.push(x)}for(var w=0,P=c;w<P.length;w+=1){var A=P[w];this.remove(A.value.tileID,A)}};var $t=function(s,c,l){this.context=s;var d=s.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer};$t.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},$t.prototype.updateData=function(s){var c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)},$t.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Nr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Br=function(s,c,l,d){this.length=c.length,this.attributes=l,this.itemSize=c.bytesPerElement,this.dynamicDraw=d,this.context=s;var g=s.gl;this.buffer=g.createBuffer(),s.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer};Br.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Br.prototype.updateData=function(s){var c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,s.arrayBuffer)},Br.prototype.enableAttributes=function(s,c){for(var l=0;l<this.attributes.length;l++){var d=c.attributes[this.attributes[l].name];d!==void 0&&s.enableVertexAttribArray(d)}},Br.prototype.setVertexAttribPointers=function(s,c,l){for(var d=0;d<this.attributes.length;d++){var g=this.attributes[d],x=c.attributes[g.name];x!==void 0&&s.vertexAttribPointer(x,g.components,s[Nr[g.type]],!1,this.itemSize,g.offset+this.itemSize*(l||0))}},Br.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var It=function(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};It.prototype.get=function(){return this.current},It.prototype.set=function(s){},It.prototype.getDefault=function(){return this.default},It.prototype.setDefault=function(){this.set(this.default)};var $r=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return o.Color.transparent},c.prototype.set=function(l){var d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)},c}(It),hr=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return 1},c.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)},c}(It),dr=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return 0},c.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)},c}(It),Un=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return[!0,!0,!0,!0]},c.prototype.set=function(l){var d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)},c}(It),Tn=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return!0},c.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)},c}(It),Pi=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return 255},c.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)},c}(It),bn=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},c.prototype.set=function(l){var d=this.current;(l.func!==d.func||l.ref!==d.ref||l.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)},c}(It),en=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){var l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]},c.prototype.set=function(l){var d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)},c}(It),ea=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return!1},c.prototype.set=function(l){if(l!==this.current||this.dirty){var d=this.gl;l?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=l,this.dirty=!1}},c}(It),Wt=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return[0,1]},c.prototype.set=function(l){var d=this.current;(l[0]!==d[0]||l[1]!==d[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)},c}(It),lt=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return!1},c.prototype.set=function(l){if(l!==this.current||this.dirty){var d=this.gl;l?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=l,this.dirty=!1}},c}(It),Mt=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return this.gl.LESS},c.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)},c}(It),nr=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return!1},c.prototype.set=function(l){if(l!==this.current||this.dirty){var d=this.gl;l?d.enable(d.BLEND):d.disable(d.BLEND),this.current=l,this.dirty=!1}},c}(It),xn=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){var l=this.gl;return[l.ONE,l.ZERO]},c.prototype.set=function(l){var d=this.current;(l[0]!==d[0]||l[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)},c}(It),Cn=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return o.Color.transparent},c.prototype.set=function(l){var d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)},c}(It),ri=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return this.gl.FUNC_ADD},c.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)},c}(It),Ui=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return!1},c.prototype.set=function(l){if(l!==this.current||this.dirty){var d=this.gl;l?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=l,this.dirty=!1}},c}(It),da=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return this.gl.BACK},c.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)},c}(It),to=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return this.gl.CCW},c.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)},c}(It),ro=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return null},c.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)},c}(It),Lo=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return this.gl.TEXTURE0},c.prototype.set=function(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)},c}(It),za=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){var l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]},c.prototype.set=function(l){var d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)},c}(It),zo=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return null},c.prototype.set=function(l){if(l!==this.current||this.dirty){var d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,l),this.current=l,this.dirty=!1}},c}(It),jo=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return null},c.prototype.set=function(l){if(l!==this.current||this.dirty){var d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,l),this.current=l,this.dirty=!1}},c}(It),ja=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return null},c.prototype.set=function(l){if(l!==this.current||this.dirty){var d=this.gl;d.bindTexture(d.TEXTURE_2D,l),this.current=l,this.dirty=!1}},c}(It),ws=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return null},c.prototype.set=function(l){if(l!==this.current||this.dirty){var d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}},c}(It),Na=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return null},c.prototype.set=function(l){var d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1},c}(It),ta=function(s){function c(l){s.call(this,l),this.vao=l.extVertexArrayObject}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return null},c.prototype.set=function(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)},c}(It),ra=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return 4},c.prototype.set=function(l){if(l!==this.current||this.dirty){var d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}},c}(It),Ta=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return!1},c.prototype.set=function(l){if(l!==this.current||this.dirty){var d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}},c}(It),No=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return!1},c.prototype.set=function(l){if(l!==this.current||this.dirty){var d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}},c}(It),tn=function(s){function c(l,d){s.call(this,l),this.context=l,this.parent=d}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getDefault=function(){return null},c}(It),z=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.setDirty=function(){this.dirty=!0},c.prototype.set=function(l){if(l!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}},c}(tn),F=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.set=function(l){if(l!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,l),this.current=l,this.dirty=!1}},c}(tn),q=function(s,c,l,d){this.context=s,this.width=c,this.height=l;var g=this.framebuffer=s.gl.createFramebuffer();this.colorAttachment=new z(s,g),d&&(this.depthAttachment=new F(s,g))};q.prototype.destroy=function(){var s=this.context.gl,c=this.colorAttachment.get();if(c&&s.deleteTexture(c),this.depthAttachment){var l=this.depthAttachment.get();l&&s.deleteRenderbuffer(l)}s.deleteFramebuffer(this.framebuffer)};var te=function(s,c,l){this.func=s,this.mask=c,this.range=l};te.ReadOnly=!1,te.ReadWrite=!0,te.disabled=new te(519,te.ReadOnly,[0,1]);var ue=function(s,c,l,d,g,x){this.test=s,this.ref=c,this.mask=l,this.fail=d,this.depthFail=g,this.pass=x};ue.disabled=new ue({func:519,mask:0},0,0,7680,7680,7680);var xe=function(s,c,l){this.blendFunction=s,this.blendColor=c,this.mask=l};xe.disabled=new xe(xe.Replace=[1,0],o.Color.transparent,[!1,!1,!1,!1]),xe.unblended=new xe(xe.Replace,o.Color.transparent,[!0,!0,!0,!0]),xe.alphaBlended=new xe([1,771],o.Color.transparent,[!0,!0,!0,!0]);var Se=function(s,c,l){this.enable=s,this.mode=c,this.frontFace=l};Se.disabled=new Se(!1,1029,2305),Se.backCCW=new Se(!0,1029,2305);var G=function(s){this.gl=s,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new $r(this),this.clearDepth=new hr(this),this.clearStencil=new dr(this),this.colorMask=new Un(this),this.depthMask=new Tn(this),this.stencilMask=new Pi(this),this.stencilFunc=new bn(this),this.stencilOp=new en(this),this.stencilTest=new ea(this),this.depthRange=new Wt(this),this.depthTest=new lt(this),this.depthFunc=new Mt(this),this.blend=new nr(this),this.blendFunc=new xn(this),this.blendColor=new Cn(this),this.blendEquation=new ri(this),this.cullFace=new Ui(this),this.cullFaceSide=new da(this),this.frontFace=new to(this),this.program=new ro(this),this.activeTexture=new Lo(this),this.viewport=new za(this),this.bindFramebuffer=new zo(this),this.bindRenderbuffer=new jo(this),this.bindTexture=new ja(this),this.bindVertexBuffer=new ws(this),this.bindElementBuffer=new Na(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ta(this),this.pixelStoreUnpack=new ra(this),this.pixelStoreUnpackPremultiplyAlpha=new Ta(this),this.pixelStoreUnpackFlipY=new No(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=s.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(s.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE)};G.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},G.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},G.prototype.createIndexBuffer=function(s,c){return new $t(this,s,c)},G.prototype.createVertexBuffer=function(s,c,l){return new Br(this,s,c,l)},G.prototype.createRenderbuffer=function(s,c,l){var d=this.gl,g=d.createRenderbuffer();return this.bindRenderbuffer.set(g),d.renderbufferStorage(d.RENDERBUFFER,s,c,l),this.bindRenderbuffer.set(null),g},G.prototype.createFramebuffer=function(s,c,l){return new q(this,s,c,l)},G.prototype.clear=function(s){var c=s.color,l=s.depth,d=this.gl,g=0;c&&(g|=d.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),l!==void 0&&(g|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),d.clear(g)},G.prototype.setCullFace=function(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))},G.prototype.setDepthMode=function(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)},G.prototype.setStencilMode=function(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)},G.prototype.setColorMode=function(s){o.deepEqual(s.blendFunction,xe.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)},G.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var he=function(s){function c(l,d,g){var x=this;s.call(this),this.id=l,this.dispatcher=g,this.on("data",function(w){w.dataType==="source"&&w.sourceDataType==="metadata"&&(x._sourceLoaded=!0),x._sourceLoaded&&!x._paused&&w.dataType==="source"&&w.sourceDataType==="content"&&(x.reload(),x.transform&&x.update(x.transform))}),this.on("error",function(){x._sourceErrored=!0}),this._source=function(w,P,A,j){var Z=new Gt[P.type](w,P,A,j);if(Z.id!==w)throw new Error("Expected Source id to be "+w+" instead of "+Z.id);return o.bindAll(["load","abort","unload","serialize","prepare"],Z),Z}(l,d,g,this),this._tiles={},this._cache=new mt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new o.SourceFeatureState}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.onAdd=function(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(l)},c.prototype.onRemove=function(l){this._source&&this._source.onRemove&&this._source.onRemove(l)},c.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var l in this._tiles){var d=this._tiles[l];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0},c.prototype.getSource=function(){return this._source},c.prototype.pause=function(){this._paused=!0},c.prototype.resume=function(){if(this._paused){var l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform)}},c.prototype._loadTile=function(l,d){return this._source.loadTile(l,d)},c.prototype._unloadTile=function(l){if(this._source.unloadTile)return this._source.unloadTile(l,function(){})},c.prototype._abortTile=function(l){if(this._source.abortTile)return this._source.abortTile(l,function(){})},c.prototype.serialize=function(){return this._source.serialize()},c.prototype.prepare=function(l){for(var d in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var g=this._tiles[d];g.upload(l),g.prepare(this.map.style.imageManager)}},c.prototype.getIds=function(){return o.values(this._tiles).map(function(l){return l.tileID}).sort(Ce).map(function(l){return l.key})},c.prototype.getRenderableIds=function(l){var d=this,g=[];for(var x in this._tiles)this._isIdRenderable(x,l)&&g.push(this._tiles[x]);return l?g.sort(function(w,P){var A=w.tileID,j=P.tileID,Z=new o.Point(A.canonical.x,A.canonical.y)._rotate(d.transform.angle),X=new o.Point(j.canonical.x,j.canonical.y)._rotate(d.transform.angle);return A.overscaledZ-j.overscaledZ||X.y-Z.y||X.x-Z.x}).map(function(w){return w.tileID.key}):g.map(function(w){return w.tileID}).sort(Ce).map(function(w){return w.key})},c.prototype.hasRenderableParent=function(l){var d=this.findLoadedParent(l,0);return!!d&&this._isIdRenderable(d.tileID.key)},c.prototype._isIdRenderable=function(l,d){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(d||!this._tiles[l].holdingForFade())},c.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var l in this._cache.reset(),this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")},c.prototype._reloadTile=function(l,d){var g=this._tiles[l];g&&(g.state!=="loading"&&(g.state=d),this._loadTile(g,this._tileLoaded.bind(this,g,l,d)))},c.prototype._tileLoaded=function(l,d,g,x){if(x)return l.state="errored",void(x.status!==404?this._source.fire(new o.ErrorEvent(x,{tile:l})):this.update(this.transform));l.timeAdded=o.browser.now(),g==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(d,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),this._source.fire(new o.Event("data",{dataType:"source",tile:l,coord:l.tileID}))},c.prototype._backfillDEM=function(l){for(var d=this.getRenderableIds(),g=0;g<d.length;g++){var x=d[g];if(l.neighboringTiles&&l.neighboringTiles[x]){var w=this.getTileByID(x);P(l,w),P(w,l)}}function P(A,j){A.needsHillshadePrepare=!0;var Z=j.tileID.canonical.x-A.tileID.canonical.x,X=j.tileID.canonical.y-A.tileID.canonical.y,Q=Math.pow(2,A.tileID.canonical.z),pe=j.tileID.key;Z===0&&X===0||Math.abs(X)>1||(Math.abs(Z)>1&&(Math.abs(Z+Q)===1?Z+=Q:Math.abs(Z-Q)===1&&(Z-=Q)),j.dem&&A.dem&&(A.dem.backfillBorder(j.dem,Z,X),A.neighboringTiles&&A.neighboringTiles[pe]&&(A.neighboringTiles[pe].backfilled=!0)))}},c.prototype.getTile=function(l){return this.getTileByID(l.key)},c.prototype.getTileByID=function(l){return this._tiles[l]},c.prototype._retainLoadedChildren=function(l,d,g,x){for(var w in this._tiles){var P=this._tiles[w];if(!(x[w]||!P.hasData()||P.tileID.overscaledZ<=d||P.tileID.overscaledZ>g)){for(var A=P.tileID;P&&P.tileID.overscaledZ>d+1;){var j=P.tileID.scaledTo(P.tileID.overscaledZ-1);(P=this._tiles[j.key])&&P.hasData()&&(A=j)}for(var Z=A;Z.overscaledZ>d;)if(l[(Z=Z.scaledTo(Z.overscaledZ-1)).key]){x[A.key]=A;break}}}},c.prototype.findLoadedParent=function(l,d){if(l.key in this._loadedParentTiles){var g=this._loadedParentTiles[l.key];return g&&g.tileID.overscaledZ>=d?g:null}for(var x=l.overscaledZ-1;x>=d;x--){var w=l.scaledTo(x),P=this._getLoadedTile(w);if(P)return P}},c.prototype._getLoadedTile=function(l){var d=this._tiles[l.key];return d&&d.hasData()?d:this._cache.getByKey(l.wrapped().key)},c.prototype.updateCacheSize=function(l){var d=Math.ceil(l.width/this._source.tileSize)+1,g=Math.ceil(l.height/this._source.tileSize)+1,x=Math.floor(d*g*5),w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,x):x;this._cache.setMaxSize(w)},c.prototype.handleWrapJump=function(l){var d=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,d){var g={};for(var x in this._tiles){var w=this._tiles[x];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+d),g[w.tileID.key]=w}for(var P in this._tiles=g,this._timers)clearTimeout(this._timers[P]),delete this._timers[P];for(var A in this._tiles)this._setTileReloadTimer(A,this._tiles[A])}},c.prototype.update=function(l){var d=this;if(this.transform=l,this._sourceLoaded&&!this._paused){var g;this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?g=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(qe){return new o.OverscaledTileID(qe.canonical.z,qe.wrap,qe.canonical.z,qe.canonical.x,qe.canonical.y)}):(g=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(g=g.filter(function(qe){return d._source.hasTile(qe)}))):g=[];var x=l.coveringZoomLevel(this._source),w=Math.max(x-c.maxOverzooming,this._source.minzoom),P=Math.max(x+c.maxUnderzooming,this._source.minzoom),A=this._updateRetainedTiles(g,x);if($e(this._source.type)){for(var j={},Z={},X=0,Q=Object.keys(A);X<Q.length;X+=1){var pe=Q[X],se=A[pe],ye=this._tiles[pe];if(ye&&!(ye.fadeEndTime&&ye.fadeEndTime<=o.browser.now())){var ae=this.findLoadedParent(se,w);ae&&(this._addTile(ae.tileID),j[ae.tileID.key]=ae.tileID),Z[pe]=se}}for(var ge in this._retainLoadedChildren(Z,x,P,A),j)A[ge]||(this._coveredTiles[ge]=!0,A[ge]=j[ge])}for(var Ee in A)this._tiles[Ee].clearFadeHold();for(var Ie=0,je=o.keysDifference(this._tiles,A);Ie<je.length;Ie+=1){var ke=je[Ie],Be=this._tiles[ke];Be.hasSymbolBuckets&&!Be.holdingForFade()?Be.setHoldDuration(this.map._fadeDuration):Be.hasSymbolBuckets&&!Be.symbolFadeFinished()||this._removeTile(ke)}this._updateLoadedParentTileCache()}},c.prototype.releaseSymbolFadeTiles=function(){for(var l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)},c.prototype._updateRetainedTiles=function(l,d){for(var g={},x={},w=Math.max(d-c.maxOverzooming,this._source.minzoom),P=Math.max(d+c.maxUnderzooming,this._source.minzoom),A={},j=0,Z=l;j<Z.length;j+=1){var X=Z[j],Q=this._addTile(X);g[X.key]=X,Q.hasData()||d<this._source.maxzoom&&(A[X.key]=X)}this._retainLoadedChildren(A,d,P,g);for(var pe=0,se=l;pe<se.length;pe+=1){var ye=se[pe],ae=this._tiles[ye.key];if(!ae.hasData()){if(d+1>this._source.maxzoom){var ge=ye.children(this._source.maxzoom)[0],Ee=this.getTile(ge);if(Ee&&Ee.hasData()){g[ge.key]=ge;continue}}else{var Ie=ye.children(this._source.maxzoom);if(g[Ie[0].key]&&g[Ie[1].key]&&g[Ie[2].key]&&g[Ie[3].key])continue}for(var je=ae.wasRequested(),ke=ye.overscaledZ-1;ke>=w;--ke){var Be=ye.scaledTo(ke);if(x[Be.key]||(x[Be.key]=!0,!(ae=this.getTile(Be))&&je&&(ae=this._addTile(Be)),ae&&(g[Be.key]=Be,je=ae.wasRequested(),ae.hasData())))break}}}return g},c.prototype._updateLoadedParentTileCache=function(){for(var l in this._loadedParentTiles={},this._tiles){for(var d=[],g=void 0,x=this._tiles[l].tileID;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){g=this._loadedParentTiles[x.key];break}d.push(x.key);var w=x.scaledTo(x.overscaledZ-1);if(g=this._getLoadedTile(w))break;x=w}for(var P=0,A=d;P<A.length;P+=1)this._loadedParentTiles[A[P]]=g}},c.prototype._addTile=function(l){var d=this._tiles[l.key];if(d)return d;(d=this._cache.getAndRemove(l))&&(this._setTileReloadTimer(l.key,d),d.tileID=l,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,d)));var g=!!d;return g||(d=new o.Tile(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(d,this._tileLoaded.bind(this,d,l.key,d.state))),d?(d.uses++,this._tiles[l.key]=d,g||this._source.fire(new o.Event("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d):null},c.prototype._setTileReloadTimer=function(l,d){var g=this;l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);var x=d.getExpiryTimeout();x&&(this._timers[l]=setTimeout(function(){g._reloadTile(l,"expired"),delete g._timers[l]},x))},c.prototype._removeTile=function(l){var d=this._tiles[l];d&&(d.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))},c.prototype.clearTiles=function(){for(var l in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(l);this._cache.reset()},c.prototype.tilesIn=function(l,d,g){var x=this,w=[],P=this.transform;if(!P)return w;for(var A=g?P.getCameraQueryGeometry(l):l,j=l.map(function(ke){return P.pointCoordinate(ke)}),Z=A.map(function(ke){return P.pointCoordinate(ke)}),X=this.getIds(),Q=1/0,pe=1/0,se=-1/0,ye=-1/0,ae=0,ge=Z;ae<ge.length;ae+=1){var Ee=ge[ae];Q=Math.min(Q,Ee.x),pe=Math.min(pe,Ee.y),se=Math.max(se,Ee.x),ye=Math.max(ye,Ee.y)}for(var Ie=function(ke){var Be=x._tiles[X[ke]];if(!Be.holdingForFade()){var qe=Be.tileID,Ke=Math.pow(2,P.zoom-Be.tileID.overscaledZ),Xe=d*Be.queryPadding*o.EXTENT/Be.tileSize/Ke,at=[qe.getTilePoint(new o.MercatorCoordinate(Q,pe)),qe.getTilePoint(new o.MercatorCoordinate(se,ye))];if(at[0].x-Xe<o.EXTENT&&at[0].y-Xe<o.EXTENT&&at[1].x+Xe>=0&&at[1].y+Xe>=0){var bt=j.map(function(St){return qe.getTilePoint(St)}),Pt=Z.map(function(St){return qe.getTilePoint(St)});w.push({tile:Be,tileID:qe,queryGeometry:bt,cameraQueryGeometry:Pt,scale:Ke})}}},je=0;je<X.length;je++)Ie(je);return w},c.prototype.getVisibleCoordinates=function(l){for(var d=this,g=this.getRenderableIds(l).map(function(A){return d._tiles[A].tileID}),x=0,w=g;x<w.length;x+=1){var P=w[x];P.posMatrix=this.transform.calculatePosMatrix(P.toUnwrapped())}return g},c.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if($e(this._source.type))for(var l in this._tiles){var d=this._tiles[l];if(d.fadeEndTime!==void 0&&d.fadeEndTime>=o.browser.now())return!0}return!1},c.prototype.setFeatureState=function(l,d,g){this._state.updateState(l=l||"_geojsonTileLayer",d,g)},c.prototype.removeFeatureState=function(l,d,g){this._state.removeFeatureState(l=l||"_geojsonTileLayer",d,g)},c.prototype.getFeatureState=function(l,d){return this._state.getState(l=l||"_geojsonTileLayer",d)},c.prototype.setDependencies=function(l,d,g){var x=this._tiles[l];x&&x.setDependencies(d,g)},c.prototype.reloadTilesForDependencies=function(l,d){for(var g in this._tiles)this._tiles[g].hasDependency(l,d)&&this._reloadTile(g,"reloading");this._cache.filter(function(x){return!x.hasDependency(l,d)})},c}(o.Evented);function Ce(s,c){var l=Math.abs(2*s.wrap)-+(s.wrap<0),d=Math.abs(2*c.wrap)-+(c.wrap<0);return s.overscaledZ-c.overscaledZ||d-l||c.canonical.y-s.canonical.y||c.canonical.x-s.canonical.x}function $e(s){return s==="raster"||s==="image"||s==="video"}function He(){return new o.window.Worker(zu.workerUrl)}he.maxOverzooming=10,he.maxUnderzooming=3;var Ne="mapboxgl_preloaded_worker_pool",We=function(){this.active={}};We.prototype.acquire=function(s){if(!this.workers)for(this.workers=[];this.workers.length<We.workerCount;)this.workers.push(new He);return this.active[s]=!0,this.workers.slice()},We.prototype.release=function(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(function(c){c.terminate()}),this.workers=null)},We.prototype.isPreloaded=function(){return!!this.active[Ne]},We.prototype.numActive=function(){return Object.keys(this.active).length};var ct,ot=Math.floor(o.browser.hardwareConcurrency/2);function Fe(){return ct||(ct=new We),ct}function rt(s,c){var l={};for(var d in s)d!=="ref"&&(l[d]=s[d]);return o.refProperties.forEach(function(g){g in c&&(l[g]=c[g])}),l}function Ye(s){s=s.slice();for(var c=Object.create(null),l=0;l<s.length;l++)c[s[l].id]=s[l];for(var d=0;d<s.length;d++)"ref"in s[d]&&(s[d]=rt(s[d],c[s[d].ref]));return s}We.workerCount=Math.max(Math.min(ot,6),1);var Je={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Bt(s,c,l){l.push({command:Je.addSource,args:[s,c[s]]})}function tt(s,c,l){c.push({command:Je.removeSource,args:[s]}),l[s]=!0}function tr(s,c,l,d){tt(s,l,d),Bt(s,c,l)}function Mr(s,c,l){var d;for(d in s[l])if(s[l].hasOwnProperty(d)&&d!=="data"&&!o.deepEqual(s[l][d],c[l][d]))return!1;for(d in c[l])if(c[l].hasOwnProperty(d)&&d!=="data"&&!o.deepEqual(s[l][d],c[l][d]))return!1;return!0}function Jt(s,c,l,d,g,x){var w;for(w in c=c||{},s=s||{})s.hasOwnProperty(w)&&(o.deepEqual(s[w],c[w])||l.push({command:x,args:[d,w,c[w],g]}));for(w in c)c.hasOwnProperty(w)&&!s.hasOwnProperty(w)&&(o.deepEqual(s[w],c[w])||l.push({command:x,args:[d,w,c[w],g]}))}function lr(s){return s.id}function Ft(s,c){return s[c.id]=c,s}var fn=function(s,c){this.reset(s,c)};fn.prototype.reset=function(s,c){this.points=s||[],this._distances=[0];for(var l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding},fn.prototype.lerp=function(s){if(this.points.length===1)return this.points[0];s=o.clamp(s,0,1);for(var c=1,l=this._distances[c],d=s*this.paddedLength+this.padding;l<d&&c<this._distances.length;)l=this._distances[++c];var g=c-1,x=this._distances[g],w=l-x,P=w>0?(d-x)/w:0;return this.points[g].mult(1-P).add(this.points[c].mult(P))};var ar=function(s,c,l){var d=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(s/l),this.yCellCount=Math.ceil(c/l);for(var x=0;x<this.xCellCount*this.yCellCount;x++)d.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=c,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0};function Or(s,c,l,d,g){var x=o.create();return c?(o.scale(x,x,[1/g,1/g,1]),l||o.rotateZ(x,x,d.angle)):o.multiply(x,d.labelPlaneMatrix,s),x}function gr(s,c,l,d,g){if(c){var x=o.clone(s);return o.scale(x,x,[g,g,1]),l||o.rotateZ(x,x,-d.angle),x}return d.glCoordMatrix}function Ut(s,c){var l=[s.x,s.y,0,1];sn(l,l,c);var d=l[3];return{point:new o.Point(l[0]/d,l[1]/d),signedDistanceFromCamera:d}}function Qt(s,c){return .5+s/c*.5}function Yn(s,c){var l=s[0]/s[3],d=s[1]/s[3];return l>=-c[0]&&l<=c[0]&&d>=-c[1]&&d<=c[1]}function no(s,c,l,d,g,x,w,P){var A=d?s.textSizeData:s.iconSizeData,j=o.evaluateSizeForZoom(A,l.transform.zoom),Z=[256/l.width*2+1,256/l.height*2+1],X=d?s.text.dynamicLayoutVertexArray:s.icon.dynamicLayoutVertexArray;X.clear();for(var Q=s.lineVertexArray,pe=d?s.text.placedSymbolArray:s.icon.placedSymbolArray,se=l.transform.width/l.transform.height,ye=!1,ae=0;ae<pe.length;ae++){var ge=pe.get(ae);if(ge.hidden||ge.writingMode===o.WritingMode.vertical&&!ye)Dn(ge.numGlyphs,X);else{ye=!1;var Ee=[ge.anchorX,ge.anchorY,0,1];if(o.transformMat4(Ee,Ee,c),Yn(Ee,Z)){var Ie=Qt(l.transform.cameraToCenterDistance,Ee[3]),je=o.evaluateSizeForFeature(A,j,ge),ke=w?je/Ie:je*Ie,Be=new o.Point(ge.anchorX,ge.anchorY),qe=Ut(Be,g).point,Ke={},Xe=io(ge,ke,!1,P,c,g,x,s.glyphOffsetArray,Q,X,qe,Be,Ke,se);ye=Xe.useVertical,(Xe.notEnoughRoom||ye||Xe.needsFlipping&&io(ge,ke,!0,P,c,g,x,s.glyphOffsetArray,Q,X,qe,Be,Ke,se).notEnoughRoom)&&Dn(ge.numGlyphs,X)}else Dn(ge.numGlyphs,X)}}d?s.text.dynamicLayoutVertexBuffer.updateData(X):s.icon.dynamicLayoutVertexBuffer.updateData(X)}function on(s,c,l,d,g,x,w,P,A,j,Z){var X=P.glyphStartIndex+P.numGlyphs,Q=P.lineStartIndex,pe=P.lineStartIndex+P.lineLength,se=c.getoffsetX(P.glyphStartIndex),ye=c.getoffsetX(X-1),ae=Zr(s*se,l,d,g,x,w,P.segment,Q,pe,A,j,Z);if(!ae)return null;var ge=Zr(s*ye,l,d,g,x,w,P.segment,Q,pe,A,j,Z);return ge?{first:ae,last:ge}:null}function Hr(s,c,l,d){return s===o.WritingMode.horizontal&&Math.abs(l.y-c.y)>Math.abs(l.x-c.x)*d?{useVertical:!0}:(s===o.WritingMode.vertical?c.y<l.y:c.x>l.x)?{needsFlipping:!0}:null}function io(s,c,l,d,g,x,w,P,A,j,Z,X,Q,pe){var se,ye=c/24,ae=s.lineOffsetX*ye,ge=s.lineOffsetY*ye;if(s.numGlyphs>1){var Ee=s.glyphStartIndex+s.numGlyphs,Ie=s.lineStartIndex,je=s.lineStartIndex+s.lineLength,ke=on(ye,P,ae,ge,l,Z,X,s,A,x,Q);if(!ke)return{notEnoughRoom:!0};var Be=Ut(ke.first.point,w).point,qe=Ut(ke.last.point,w).point;if(d&&!l){var Ke=Hr(s.writingMode,Be,qe,pe);if(Ke)return Ke}se=[ke.first];for(var Xe=s.glyphStartIndex+1;Xe<Ee-1;Xe++)se.push(Zr(ye*P.getoffsetX(Xe),ae,ge,l,Z,X,s.segment,Ie,je,A,x,Q));se.push(ke.last)}else{if(d&&!l){var at=Ut(X,g).point,bt=s.lineStartIndex+s.segment+1,Pt=new o.Point(A.getx(bt),A.gety(bt)),St=Ut(Pt,g),mr=St.signedDistanceFromCamera>0?St.point:Ba(X,Pt,at,1,g),st=Hr(s.writingMode,at,mr,pe);if(st)return st}var Nt=Zr(ye*P.getoffsetX(s.glyphStartIndex),ae,ge,l,Z,X,s.segment,s.lineStartIndex,s.lineStartIndex+s.lineLength,A,x,Q);if(!Nt)return{notEnoughRoom:!0};se=[Nt]}for(var Ht=0,zt=se;Ht<zt.length;Ht+=1){var Lt=zt[Ht];o.addDynamicAttributes(j,Lt.point,Lt.angle)}return{}}function Ba(s,c,l,d,g){var x=Ut(s.add(s.sub(c)._unit()),g).point,w=l.sub(x);return l.add(w._mult(d/w.mag()))}function Zr(s,c,l,d,g,x,w,P,A,j,Z,X){var Q=d?s-c:s+c,pe=Q>0?1:-1,se=0;d&&(pe*=-1,se=Math.PI),pe<0&&(se+=Math.PI);for(var ye=pe>0?P+w:P+w+1,ae=g,ge=g,Ee=0,Ie=0,je=Math.abs(Q),ke=[];Ee+Ie<=je;){if((ye+=pe)<P||ye>=A)return null;if(ge=ae,ke.push(ae),(ae=X[ye])===void 0){var Be=new o.Point(j.getx(ye),j.gety(ye)),qe=Ut(Be,Z);if(qe.signedDistanceFromCamera>0)ae=X[ye]=qe.point;else{var Ke=ye-pe;ae=Ba(Ee===0?x:new o.Point(j.getx(Ke),j.gety(Ke)),Be,ge,je-Ee+1,Z)}}Ee+=Ie,Ie=ge.dist(ae)}var Xe=(je-Ee)/Ie,at=ae.sub(ge),bt=at.mult(Xe)._add(ge);bt._add(at._unit()._perp()._mult(l*pe));var Pt=se+Math.atan2(ae.y-ge.y,ae.x-ge.x);return ke.push(bt),{point:bt,angle:Pt,path:ke}}ar.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},ar.prototype.insert=function(s,c,l,d,g){this._forEachCell(c,l,d,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(c),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(g)},ar.prototype.insertCircle=function(s,c,l,d){this._forEachCell(c-d,l-d,c+d,l+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(c),this.circles.push(l),this.circles.push(d)},ar.prototype._insertBoxCell=function(s,c,l,d,g,x){this.boxCells[g].push(x)},ar.prototype._insertCircleCell=function(s,c,l,d,g,x){this.circleCells[g].push(x)},ar.prototype._query=function(s,c,l,d,g,x){if(l<0||s>this.width||d<0||c>this.height)return!g&&[];var w=[];if(s<=0&&c<=0&&this.width<=l&&this.height<=d){if(g)return!0;for(var P=0;P<this.boxKeys.length;P++)w.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(var A=0;A<this.circleKeys.length;A++){var j=this.circles[3*A],Z=this.circles[3*A+1],X=this.circles[3*A+2];w.push({key:this.circleKeys[A],x1:j-X,y1:Z-X,x2:j+X,y2:Z+X})}return x?w.filter(x):w}return this._forEachCell(s,c,l,d,this._queryCell,w,{hitTest:g,seenUids:{box:{},circle:{}}},x),g?w.length>0:w},ar.prototype._queryCircle=function(s,c,l,d,g){var x=s-l,w=s+l,P=c-l,A=c+l;if(w<0||x>this.width||A<0||P>this.height)return!d&&[];var j=[];return this._forEachCell(x,P,w,A,this._queryCellCircle,j,{hitTest:d,circle:{x:s,y:c,radius:l},seenUids:{box:{},circle:{}}},g),d?j.length>0:j},ar.prototype.query=function(s,c,l,d,g){return this._query(s,c,l,d,!1,g)},ar.prototype.hitTest=function(s,c,l,d,g){return this._query(s,c,l,d,!0,g)},ar.prototype.hitTestCircle=function(s,c,l,d){return this._queryCircle(s,c,l,!0,d)},ar.prototype._queryCell=function(s,c,l,d,g,x,w,P){var A=w.seenUids,j=this.boxCells[g];if(j!==null)for(var Z=this.bboxes,X=0,Q=j;X<Q.length;X+=1){var pe=Q[X];if(!A.box[pe]){A.box[pe]=!0;var se=4*pe;if(s<=Z[se+2]&&c<=Z[se+3]&&l>=Z[se+0]&&d>=Z[se+1]&&(!P||P(this.boxKeys[pe]))){if(w.hitTest)return x.push(!0),!0;x.push({key:this.boxKeys[pe],x1:Z[se],y1:Z[se+1],x2:Z[se+2],y2:Z[se+3]})}}}var ye=this.circleCells[g];if(ye!==null)for(var ae=this.circles,ge=0,Ee=ye;ge<Ee.length;ge+=1){var Ie=Ee[ge];if(!A.circle[Ie]){A.circle[Ie]=!0;var je=3*Ie;if(this._circleAndRectCollide(ae[je],ae[je+1],ae[je+2],s,c,l,d)&&(!P||P(this.circleKeys[Ie]))){if(w.hitTest)return x.push(!0),!0;var ke=ae[je],Be=ae[je+1],qe=ae[je+2];x.push({key:this.circleKeys[Ie],x1:ke-qe,y1:Be-qe,x2:ke+qe,y2:Be+qe})}}}},ar.prototype._queryCellCircle=function(s,c,l,d,g,x,w,P){var A=w.circle,j=w.seenUids,Z=this.boxCells[g];if(Z!==null)for(var X=this.bboxes,Q=0,pe=Z;Q<pe.length;Q+=1){var se=pe[Q];if(!j.box[se]){j.box[se]=!0;var ye=4*se;if(this._circleAndRectCollide(A.x,A.y,A.radius,X[ye+0],X[ye+1],X[ye+2],X[ye+3])&&(!P||P(this.boxKeys[se])))return x.push(!0),!0}}var ae=this.circleCells[g];if(ae!==null)for(var ge=this.circles,Ee=0,Ie=ae;Ee<Ie.length;Ee+=1){var je=Ie[Ee];if(!j.circle[je]){j.circle[je]=!0;var ke=3*je;if(this._circlesCollide(ge[ke],ge[ke+1],ge[ke+2],A.x,A.y,A.radius)&&(!P||P(this.circleKeys[je])))return x.push(!0),!0}}},ar.prototype._forEachCell=function(s,c,l,d,g,x,w,P){for(var A=this._convertToXCellCoord(s),j=this._convertToYCellCoord(c),Z=this._convertToXCellCoord(l),X=this._convertToYCellCoord(d),Q=A;Q<=Z;Q++)for(var pe=j;pe<=X;pe++)if(g.call(this,s,c,l,d,this.xCellCount*pe+Q,x,w,P))return},ar.prototype._convertToXCellCoord=function(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))},ar.prototype._convertToYCellCoord=function(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))},ar.prototype._circlesCollide=function(s,c,l,d,g,x){var w=d-s,P=g-c,A=l+x;return A*A>w*w+P*P},ar.prototype._circleAndRectCollide=function(s,c,l,d,g,x,w){var P=(x-d)/2,A=Math.abs(s-(d+P));if(A>P+l)return!1;var j=(w-g)/2,Z=Math.abs(c-(g+j));if(Z>j+l)return!1;if(A<=P||Z<=j)return!0;var X=A-P,Q=Z-j;return X*X+Q*Q<=l*l};var Fa=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Dn(s,c){for(var l=0;l<s;l++){var d=c.length;c.resize(d+4),c.float32.set(Fa,3*d)}}function sn(s,c,l){var d=c[0],g=c[1];return s[0]=l[0]*d+l[4]*g+l[12],s[1]=l[1]*d+l[5]*g+l[13],s[3]=l[3]*d+l[7]*g+l[15],s}var In=function(s,c,l){c===void 0&&(c=new ar(s.width+200,s.height+200,25)),l===void 0&&(l=new ar(s.width+200,s.height+200,25)),this.transform=s,this.grid=c,this.ignoredGrid=l,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+100,this.screenBottomBoundary=s.height+100,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200};function Fr(s,c,l){return c*(o.EXTENT/(s.tileSize*Math.pow(2,l-s.tileID.overscaledZ)))}In.prototype.placeCollisionBox=function(s,c,l,d,g){var x=this.projectAndGetPerspectiveRatio(d,s.anchorPointX,s.anchorPointY),w=l*x.perspectiveRatio,P=s.x1*w+x.point.x,A=s.y1*w+x.point.y,j=s.x2*w+x.point.x,Z=s.y2*w+x.point.y;return!this.isInsideGrid(P,A,j,Z)||!c&&this.grid.hitTest(P,A,j,Z,g)?{box:[],offscreen:!1}:{box:[P,A,j,Z],offscreen:this.isOffscreen(P,A,j,Z)}},In.prototype.placeCollisionCircles=function(s,c,l,d,g,x,w,P,A,j,Z,X,Q){var pe=[],se=new o.Point(c.anchorX,c.anchorY),ye=Ut(se,x),ae=Qt(this.transform.cameraToCenterDistance,ye.signedDistanceFromCamera),ge=(j?g/ae:g*ae)/o.ONE_EM,Ee=Ut(se,w).point,Ie=on(ge,d,c.lineOffsetX*ge,c.lineOffsetY*ge,!1,Ee,se,c,l,w,{}),je=!1,ke=!1,Be=!0;if(Ie){for(var qe=.5*X*ae+Q,Ke=new o.Point(-100,-100),Xe=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),at=new fn,bt=Ie.first,Pt=Ie.last,St=[],mr=bt.path.length-1;mr>=1;mr--)St.push(bt.path[mr]);for(var st=1;st<Pt.path.length;st++)St.push(Pt.path[st]);var Nt=2.5*qe;if(P){var Ht=St.map(function(la){return Ut(la,P)});St=Ht.some(function(la){return la.signedDistanceFromCamera<=0})?[]:Ht.map(function(la){return la.point})}var zt=[];if(St.length>0){for(var Lt=St[0].clone(),qt=St[0].clone(),At=1;At<St.length;At++)Lt.x=Math.min(Lt.x,St[At].x),Lt.y=Math.min(Lt.y,St[At].y),qt.x=Math.max(qt.x,St[At].x),qt.y=Math.max(qt.y,St[At].y);zt=Lt.x>=Ke.x&&qt.x<=Xe.x&&Lt.y>=Ke.y&&qt.y<=Xe.y?[St]:qt.x<Ke.x||Lt.x>Xe.x||qt.y<Ke.y||Lt.y>Xe.y?[]:o.clipLine([St],Ke.x,Ke.y,Xe.x,Xe.y)}for(var Ot=0,Ln=zt;Ot<Ln.length;Ot+=1){var ln;at.reset(Ln[Ot],.25*qe),ln=at.length<=.5*qe?1:Math.ceil(at.paddedLength/Nt)+1;for(var ii=0;ii<ln;ii++){var $n=ii/Math.max(ln-1,1),rn=at.lerp($n),mn=rn.x+100,Di=rn.y+100;pe.push(mn,Di,qe,0);var fi=mn-qe,bo=Di-qe,_i=mn+qe,_a=Di+qe;if(Be=Be&&this.isOffscreen(fi,bo,_i,_a),ke=ke||this.isInsideGrid(fi,bo,_i,_a),!s&&this.grid.hitTestCircle(mn,Di,qe,Z)&&(je=!0,!A))return{circles:[],offscreen:!1,collisionDetected:je}}}}return{circles:!A&&je||!ke?[]:pe,offscreen:Be,collisionDetected:je}},In.prototype.queryRenderedSymbols=function(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var c=[],l=1/0,d=1/0,g=-1/0,x=-1/0,w=0,P=s;w<P.length;w+=1){var A=P[w],j=new o.Point(A.x+100,A.y+100);l=Math.min(l,j.x),d=Math.min(d,j.y),g=Math.max(g,j.x),x=Math.max(x,j.y),c.push(j)}for(var Z={},X={},Q=0,pe=this.grid.query(l,d,g,x).concat(this.ignoredGrid.query(l,d,g,x));Q<pe.length;Q+=1){var se=pe[Q],ye=se.key;if(Z[ye.bucketInstanceId]===void 0&&(Z[ye.bucketInstanceId]={}),!Z[ye.bucketInstanceId][ye.featureIndex]){var ae=[new o.Point(se.x1,se.y1),new o.Point(se.x2,se.y1),new o.Point(se.x2,se.y2),new o.Point(se.x1,se.y2)];o.polygonIntersectsPolygon(c,ae)&&(Z[ye.bucketInstanceId][ye.featureIndex]=!0,X[ye.bucketInstanceId]===void 0&&(X[ye.bucketInstanceId]=[]),X[ye.bucketInstanceId].push(ye.featureIndex))}}return X},In.prototype.insertCollisionBox=function(s,c,l,d,g){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:l,featureIndex:d,collisionGroupID:g},s[0],s[1],s[2],s[3])},In.prototype.insertCollisionCircles=function(s,c,l,d,g){for(var x=c?this.ignoredGrid:this.grid,w={bucketInstanceId:l,featureIndex:d,collisionGroupID:g},P=0;P<s.length;P+=4)x.insertCircle(w,s[P],s[P+1],s[P+2])},In.prototype.projectAndGetPerspectiveRatio=function(s,c,l){var d=[c,l,0,1];return sn(d,d,s),{point:new o.Point((d[0]/d[3]+1)/2*this.transform.width+100,(-d[1]/d[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}},In.prototype.isOffscreen=function(s,c,l,d){return l<100||s>=this.screenRightBoundary||d<100||c>this.screenBottomBoundary},In.prototype.isInsideGrid=function(s,c,l,d){return l>=0&&s<this.gridRightBoundary&&d>=0&&c<this.gridBottomBoundary},In.prototype.getViewportMatrix=function(){var s=o.identity([]);return o.translate(s,s,[-100,-100,0]),s};var Ti=function(s,c,l,d){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?c:-c))):d&&l?1:0,this.placed=l};Ti.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var ni=function(s,c,l,d,g){this.text=new Ti(s?s.text:null,c,l,g),this.icon=new Ti(s?s.icon:null,c,d,g)};ni.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ol=function(s,c,l){this.text=s,this.icon=c,this.skipFade=l},Ci=function(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]},Uc=function(s,c,l,d,g){this.bucketInstanceId=s,this.featureIndex=c,this.sourceLayerIndex=l,this.bucketIndex=d,this.tileID=g},H=function(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}};function ne(s,c,l,d,g){var x=o.getAnchorAlignment(s),w=-(x.horizontalAlign-.5)*c,P=-(x.verticalAlign-.5)*l,A=o.evaluateVariableOffset(s,d);return new o.Point(w+A[0]*g,P+A[1]*g)}function be(s,c,l,d,g,x){var w=s.x1,P=s.x2,A=s.y1,j=s.y2,Z=s.anchorPointX,X=s.anchorPointY,Q=new o.Point(c,l);return d&&Q._rotate(g?x:-x),{x1:w+Q.x,y1:A+Q.y,x2:P+Q.x,y2:j+Q.y,anchorPointX:Z,anchorPointY:X}}H.prototype.get=function(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){var c=++this.maxGroupID;this.collisionGroups[s]={ID:c,predicate:function(l){return l.collisionGroupID===c}}}return this.collisionGroups[s]};var Ae=function(s,c,l,d){this.transform=s.clone(),this.collisionIndex=new In(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new H(l),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}};function Ge(s,c,l,d,g){s.emplaceBack(c?1:0,l?1:0,d||0,g||0),s.emplaceBack(c?1:0,l?1:0,d||0,g||0),s.emplaceBack(c?1:0,l?1:0,d||0,g||0),s.emplaceBack(c?1:0,l?1:0,d||0,g||0)}Ae.prototype.getBucketParts=function(s,c,l,d){var g=l.getBucket(c),x=l.latestFeatureIndex;if(g&&x&&c.id===g.layerIds[0]){var w=l.collisionBoxArray,P=g.layers[0].layout,A=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),j=l.tileSize/o.EXTENT,Z=this.transform.calculatePosMatrix(l.tileID.toUnwrapped()),X=P.get("text-pitch-alignment")==="map",Q=P.get("text-rotation-alignment")==="map",pe=Fr(l,1,this.transform.zoom),se=Or(Z,X,Q,this.transform,pe),ye=null;if(X){var ae=gr(Z,X,Q,this.transform,pe);ye=o.multiply([],this.transform.labelPlaneMatrix,ae)}this.retainedQueryData[g.bucketInstanceId]=new Uc(g.bucketInstanceId,x,g.sourceLayerIndex,g.index,l.tileID);var ge={bucket:g,layout:P,posMatrix:Z,textLabelPlaneMatrix:se,labelToScreenMatrix:ye,scale:A,textPixelRatio:j,holdingForFade:l.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(d)for(var Ee=0,Ie=g.sortKeyRanges;Ee<Ie.length;Ee+=1){var je=Ie[Ee];s.push({sortKey:je.sortKey,symbolInstanceStart:je.symbolInstanceStart,symbolInstanceEnd:je.symbolInstanceEnd,parameters:ge})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:ge})}},Ae.prototype.attemptAnchorPlacement=function(s,c,l,d,g,x,w,P,A,j,Z,X,Q,pe,se){var ye,ae=[X.textOffset0,X.textOffset1],ge=ne(s,l,d,ae,g),Ee=this.collisionIndex.placeCollisionBox(be(c,ge.x,ge.y,x,w,this.transform.angle),Z,P,A,j.predicate);if(!se||this.collisionIndex.placeCollisionBox(be(se,ge.x,ge.y,x,w,this.transform.angle),Z,P,A,j.predicate).box.length!==0)return Ee.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(ye=this.prevPlacement.variableOffsets[X.crossTileID].anchor),this.variableOffsets[X.crossTileID]={textOffset:ae,width:l,height:d,anchor:s,textBoxScale:g,prevAnchor:ye},this.markUsedJustification(Q,s,X,pe),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,pe,X),this.placedOrientations[X.crossTileID]=pe),{shift:ge,placedGlyphBoxes:Ee}):void 0},Ae.prototype.placeLayerBucketPart=function(s,c,l){var d=this,g=s.parameters,x=g.bucket,w=g.layout,P=g.posMatrix,A=g.textLabelPlaneMatrix,j=g.labelToScreenMatrix,Z=g.textPixelRatio,X=g.holdingForFade,Q=g.collisionBoxArray,pe=g.partiallyEvaluatedTextSize,se=g.collisionGroup,ye=w.get("text-optional"),ae=w.get("icon-optional"),ge=w.get("text-allow-overlap"),Ee=w.get("icon-allow-overlap"),Ie=w.get("text-rotation-alignment")==="map",je=w.get("text-pitch-alignment")==="map",ke=w.get("icon-text-fit")!=="none",Be=w.get("symbol-z-order")==="viewport-y",qe=ge&&(Ee||!x.hasIconData()||ae),Ke=Ee&&(ge||!x.hasTextData()||ye);!x.collisionArrays&&Q&&x.deserializeCollisionBoxes(Q);var Xe=function(st,Nt){if(!c[st.crossTileID])if(X)d.placements[st.crossTileID]=new ol(!1,!1,!1);else{var Ht,zt=!1,Lt=!1,qt=!0,At=null,Ot={box:null,offscreen:null},Ln={box:null,offscreen:null},ln=null,ii=null,$n=0,rn=0,mn=0;Nt.textFeatureIndex?$n=Nt.textFeatureIndex:st.useRuntimeCollisionCircles&&($n=st.featureIndex),Nt.verticalTextFeatureIndex&&(rn=Nt.verticalTextFeatureIndex);var Di=Nt.textBox;if(Di){var fi=function(Sr){var $i=o.WritingMode.horizontal;if(x.allowVerticalPlacement&&!Sr&&d.prevPlacement){var bi=d.prevPlacement.placedOrientations[st.crossTileID];bi&&(d.placedOrientations[st.crossTileID]=bi,d.markUsedOrientation(x,$i=bi,st))}return $i},bo=function(Sr,$i){if(x.allowVerticalPlacement&&st.numVerticalGlyphVertices>0&&Nt.verticalTextBox)for(var bi=0,rs=x.writingModes;bi<rs.length&&(rs[bi]===o.WritingMode.vertical?(Ot=$i(),Ln=Ot):Ot=Sr(),!(Ot&&Ot.box&&Ot.box.length));bi+=1);else Ot=Sr()};if(w.get("text-variable-anchor")){var _i=w.get("text-variable-anchor");if(d.prevPlacement&&d.prevPlacement.variableOffsets[st.crossTileID]){var _a=d.prevPlacement.variableOffsets[st.crossTileID];_i.indexOf(_a.anchor)>0&&(_i=_i.filter(function(Sr){return Sr!==_a.anchor})).unshift(_a.anchor)}var la=function(Sr,$i,bi){for(var rs=Sr.x2-Sr.x1,Rm=Sr.y2-Sr.y1,ju=st.textBoxScale,Am=ke&&!Ee?$i:null,Cl={box:[],offscreen:!1},dd=ge?2*_i.length:_i.length,zs=0;zs<dd;++zs){var Nu=d.attemptAnchorPlacement(_i[zs%_i.length],Sr,rs,Rm,ju,Ie,je,Z,P,se,zs>=_i.length,st,x,bi,Am);if(Nu&&(Cl=Nu.placedGlyphBoxes)&&Cl.box&&Cl.box.length){zt=!0,At=Nu.shift;break}}return Cl};bo(function(){return la(Di,Nt.iconBox,o.WritingMode.horizontal)},function(){var Sr=Nt.verticalTextBox;return x.allowVerticalPlacement&&!(Ot&&Ot.box&&Ot.box.length)&&st.numVerticalGlyphVertices>0&&Sr?la(Sr,Nt.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),Ot&&(zt=Ot.box,qt=Ot.offscreen);var El=fi(Ot&&Ot.box);if(!zt&&d.prevPlacement){var Ds=d.prevPlacement.variableOffsets[st.crossTileID];Ds&&(d.variableOffsets[st.crossTileID]=Ds,d.markUsedJustification(x,Ds.anchor,st,El))}}else{var xo=function(Sr,$i){var bi=d.collisionIndex.placeCollisionBox(Sr,ge,Z,P,se.predicate);return bi&&bi.box&&bi.box.length&&(d.markUsedOrientation(x,$i,st),d.placedOrientations[st.crossTileID]=$i),bi};bo(function(){return xo(Di,o.WritingMode.horizontal)},function(){var Sr=Nt.verticalTextBox;return x.allowVerticalPlacement&&st.numVerticalGlyphVertices>0&&Sr?xo(Sr,o.WritingMode.vertical):{box:null,offscreen:null}}),fi(Ot&&Ot.box&&Ot.box.length)}}if(zt=(Ht=Ot)&&Ht.box&&Ht.box.length>0,qt=Ht&&Ht.offscreen,st.useRuntimeCollisionCircles){var Ls=x.text.placedSymbolArray.get(st.centerJustifiedTextSymbolIndex),Pl=o.evaluateSizeForFeature(x.textSizeData,pe,Ls),Oa=w.get("text-padding");ln=d.collisionIndex.placeCollisionCircles(ge,Ls,x.lineVertexArray,x.glyphOffsetArray,Pl,P,A,j,l,je,se.predicate,st.collisionCircleDiameter,Oa),zt=ge||ln.circles.length>0&&!ln.collisionDetected,qt=qt&&ln.offscreen}if(Nt.iconFeatureIndex&&(mn=Nt.iconFeatureIndex),Nt.iconBox){var Tl=function(Sr){var $i=ke&&At?be(Sr,At.x,At.y,Ie,je,d.transform.angle):Sr;return d.collisionIndex.placeCollisionBox($i,Ee,Z,P,se.predicate)};Lt=Ln&&Ln.box&&Ln.box.length&&Nt.verticalIconBox?(ii=Tl(Nt.verticalIconBox)).box.length>0:(ii=Tl(Nt.iconBox)).box.length>0,qt=qt&&ii.offscreen}var Ra=ye||st.numHorizontalGlyphVertices===0&&st.numVerticalGlyphVertices===0,zn=ae||st.numIconVertices===0;if(Ra||zn?zn?Ra||(Lt=Lt&&zt):zt=Lt&&zt:Lt=zt=Lt&&zt,zt&&Ht&&Ht.box&&d.collisionIndex.insertCollisionBox(Ht.box,w.get("text-ignore-placement"),x.bucketInstanceId,Ln&&Ln.box&&rn?rn:$n,se.ID),Lt&&ii&&d.collisionIndex.insertCollisionBox(ii.box,w.get("icon-ignore-placement"),x.bucketInstanceId,mn,se.ID),ln&&(zt&&d.collisionIndex.insertCollisionCircles(ln.circles,w.get("text-ignore-placement"),x.bucketInstanceId,$n,se.ID),l)){var $a=x.bucketInstanceId,wo=d.collisionCircleArrays[$a];wo===void 0&&(wo=d.collisionCircleArrays[$a]=new Ci);for(var ts=0;ts<ln.circles.length;ts+=4)wo.circles.push(ln.circles[ts+0]),wo.circles.push(ln.circles[ts+1]),wo.circles.push(ln.circles[ts+2]),wo.circles.push(ln.collisionDetected?1:0)}d.placements[st.crossTileID]=new ol(zt||qe,Lt||Ke,qt||x.justReloaded),c[st.crossTileID]=!0}};if(Be)for(var at=x.getSortedSymbolIndexes(this.transform.angle),bt=at.length-1;bt>=0;--bt){var Pt=at[bt];Xe(x.symbolInstances.get(Pt),x.collisionArrays[Pt])}else for(var St=s.symbolInstanceStart;St<s.symbolInstanceEnd;St++)Xe(x.symbolInstances.get(St),x.collisionArrays[St]);if(l&&x.bucketInstanceId in this.collisionCircleArrays){var mr=this.collisionCircleArrays[x.bucketInstanceId];o.invert(mr.invProjMatrix,P),mr.viewportMatrix=this.collisionIndex.getViewportMatrix()}x.justReloaded=!1},Ae.prototype.markUsedJustification=function(s,c,l,d){var g;g=d===o.WritingMode.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(c)];for(var x=0,w=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];x<w.length;x+=1){var P=w[x];P>=0&&(s.text.placedSymbolArray.get(P).crossTileID=g>=0&&P!==g?0:l.crossTileID)}},Ae.prototype.markUsedOrientation=function(s,c,l){for(var d=c===o.WritingMode.horizontal||c===o.WritingMode.horizontalOnly?c:0,g=c===o.WritingMode.vertical?c:0,x=0,w=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];x<w.length;x+=1)s.text.placedSymbolArray.get(w[x]).placedOrientation=d;l.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=g)},Ae.prototype.commit=function(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;var c=this.prevPlacement,l=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;var d=c?c.symbolFadeChange(s):1,g=c?c.opacities:{},x=c?c.variableOffsets:{},w=c?c.placedOrientations:{};for(var P in this.placements){var A=this.placements[P],j=g[P];j?(this.opacities[P]=new ni(j,d,A.text,A.icon),l=l||A.text!==j.text.placed||A.icon!==j.icon.placed):(this.opacities[P]=new ni(null,d,A.text,A.icon,A.skipFade),l=l||A.text||A.icon)}for(var Z in g){var X=g[Z];if(!this.opacities[Z]){var Q=new ni(X,d,!1,!1);Q.isHidden()||(this.opacities[Z]=Q,l=l||X.text.placed||X.icon.placed)}}for(var pe in x)this.variableOffsets[pe]||!this.opacities[pe]||this.opacities[pe].isHidden()||(this.variableOffsets[pe]=x[pe]);for(var se in w)this.placedOrientations[se]||!this.opacities[se]||this.opacities[se].isHidden()||(this.placedOrientations[se]=w[se]);l?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:s)},Ae.prototype.updateLayerOpacities=function(s,c){for(var l={},d=0,g=c;d<g.length;d+=1){var x=g[d],w=x.getBucket(s);w&&x.latestFeatureIndex&&s.id===w.layerIds[0]&&this.updateBucketOpacities(w,l,x.collisionBoxArray)}},Ae.prototype.updateBucketOpacities=function(s,c,l){var d=this;s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();var g=s.layers[0].layout,x=new ni(null,0,!1,!1,!0),w=g.get("text-allow-overlap"),P=g.get("icon-allow-overlap"),A=g.get("text-variable-anchor"),j=g.get("text-rotation-alignment")==="map",Z=g.get("text-pitch-alignment")==="map",X=g.get("icon-text-fit")!=="none",Q=new ni(null,0,w&&(P||!s.hasIconData()||g.get("icon-optional")),P&&(w||!s.hasTextData()||g.get("text-optional")),!0);!s.collisionArrays&&l&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(l);for(var pe=function(ge,Ee,Ie){for(var je=0;je<Ee/4;je++)ge.opacityVertexArray.emplaceBack(Ie)},se=function(ge){var Ee=s.symbolInstances.get(ge),Ie=Ee.numHorizontalGlyphVertices,je=Ee.numVerticalGlyphVertices,ke=Ee.crossTileID,Be=d.opacities[ke];c[ke]?Be=x:Be||(d.opacities[ke]=Be=Q),c[ke]=!0;var qe=Ee.numIconVertices>0,Ke=d.placedOrientations[Ee.crossTileID],Xe=Ke===o.WritingMode.vertical,at=Ke===o.WritingMode.horizontal||Ke===o.WritingMode.horizontalOnly;if(Ie>0||je>0){var bt=Bh(Be.text);pe(s.text,Ie,Xe?Ss:bt),pe(s.text,je,at?Ss:bt);var Pt=Be.text.isHidden();[Ee.rightJustifiedTextSymbolIndex,Ee.centerJustifiedTextSymbolIndex,Ee.leftJustifiedTextSymbolIndex].forEach(function(Ot){Ot>=0&&(s.text.placedSymbolArray.get(Ot).hidden=Pt||Xe?1:0)}),Ee.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(Ee.verticalPlacedTextSymbolIndex).hidden=Pt||at?1:0);var St=d.variableOffsets[Ee.crossTileID];St&&d.markUsedJustification(s,St.anchor,Ee,Ke);var mr=d.placedOrientations[Ee.crossTileID];mr&&(d.markUsedJustification(s,"left",Ee,mr),d.markUsedOrientation(s,mr,Ee))}if(qe){var st=Bh(Be.icon),Nt=!(X&&Ee.verticalPlacedIconSymbolIndex&&Xe);Ee.placedIconSymbolIndex>=0&&(pe(s.icon,Ee.numIconVertices,Nt?st:Ss),s.icon.placedSymbolArray.get(Ee.placedIconSymbolIndex).hidden=Be.icon.isHidden()),Ee.verticalPlacedIconSymbolIndex>=0&&(pe(s.icon,Ee.numVerticalIconVertices,Nt?Ss:st),s.icon.placedSymbolArray.get(Ee.verticalPlacedIconSymbolIndex).hidden=Be.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){var Ht=s.collisionArrays[ge];if(Ht){var zt=new o.Point(0,0);if(Ht.textBox||Ht.verticalTextBox){var Lt=!0;if(A){var qt=d.variableOffsets[ke];qt?(zt=ne(qt.anchor,qt.width,qt.height,qt.textOffset,qt.textBoxScale),j&&zt._rotate(Z?d.transform.angle:-d.transform.angle)):Lt=!1}Ht.textBox&&Ge(s.textCollisionBox.collisionVertexArray,Be.text.placed,!Lt||Xe,zt.x,zt.y),Ht.verticalTextBox&&Ge(s.textCollisionBox.collisionVertexArray,Be.text.placed,!Lt||at,zt.x,zt.y)}var At=!!(!at&&Ht.verticalIconBox);Ht.iconBox&&Ge(s.iconCollisionBox.collisionVertexArray,Be.icon.placed,At,X?zt.x:0,X?zt.y:0),Ht.verticalIconBox&&Ge(s.iconCollisionBox.collisionVertexArray,Be.icon.placed,!At,X?zt.x:0,X?zt.y:0)}}},ye=0;ye<s.symbolInstances.length;ye++)se(ye);if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){var ae=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=ae.invProjMatrix,s.placementViewportMatrix=ae.viewportMatrix,s.collisionCircleArray=ae.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}},Ae.prototype.symbolFadeChange=function(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Ae.prototype.zoomAdjustment=function(s){return Math.max(0,(this.transform.zoom-s)/1.5)},Ae.prototype.hasTransitions=function(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration},Ae.prototype.stillRecent=function(s,c){var l=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*l>s},Ae.prototype.setStale=function(){this.stale=!0};var yt=Math.pow(2,25),fr=Math.pow(2,24),wn=Math.pow(2,17),Vn=Math.pow(2,16),Jn=Math.pow(2,9),na=Math.pow(2,8),Nh=Math.pow(2,1);function Bh(s){if(s.opacity===0&&!s.placed)return 0;if(s.opacity===1&&s.placed)return 4294967295;var c=s.placed?1:0,l=Math.floor(127*s.opacity);return l*yt+c*fr+l*wn+c*Vn+l*Jn+c*na+l*Nh+c}var Ss=0,Vc=function(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&s.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Vc.prototype.continuePlacement=function(s,c,l,d,g){for(var x=this._bucketParts;this._currentTileIndex<s.length;)if(c.getBucketParts(x,d,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort(function(w,P){return w.sortKey-P.sortKey}));this._currentPartIndex<x.length;)if(c.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,g())return!0;return!1};var sl=function(s,c,l,d,g,x,w){this.placement=new Ae(s,g,x,w),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=d,this._done=!1};sl.prototype.isDone=function(){return this._done},sl.prototype.continuePlacement=function(s,c,l){for(var d=this,g=o.browser.now(),x=function(){var A=o.browser.now()-g;return!d._forceFullPlacement&&A>2};this._currentPlacementIndex>=0;){var w=c[s[this._currentPlacementIndex]],P=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=P)&&(!w.maxzoom||w.maxzoom>P)){if(this._inProgressLayer||(this._inProgressLayer=new Vc(w)),this._inProgressLayer.continuePlacement(l[w.source],this.placement,this._showCollisionBoxes,w,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},sl.prototype.commit=function(s){return this.placement.commit(s),this.placement};var Fh=512/o.EXTENT/2,gu=function(s,c,l){this.tileID=s,this.indexedSymbolInstances={},this.bucketInstanceId=l;for(var d=0;d<c.length;d++){var g=c.get(d),x=g.key;this.indexedSymbolInstances[x]||(this.indexedSymbolInstances[x]=[]),this.indexedSymbolInstances[x].push({crossTileID:g.crossTileID,coord:this.getScaledCoordinates(g,s)})}};gu.prototype.getScaledCoordinates=function(s,c){var l=Fh/Math.pow(2,c.canonical.z-this.tileID.canonical.z);return{x:Math.floor((c.canonical.x*o.EXTENT+s.anchorX)*l),y:Math.floor((c.canonical.y*o.EXTENT+s.anchorY)*l)}},gu.prototype.findMatches=function(s,c,l){for(var d=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),g=0;g<s.length;g++){var x=s.get(g);if(!x.crossTileID){var w=this.indexedSymbolInstances[x.key];if(w)for(var P=this.getScaledCoordinates(x,c),A=0,j=w;A<j.length;A+=1){var Z=j[A];if(Math.abs(Z.coord.x-P.x)<=d&&Math.abs(Z.coord.y-P.y)<=d&&!l[Z.crossTileID]){l[Z.crossTileID]=!0,x.crossTileID=Z.crossTileID;break}}}}};var ia=function(){this.maxCrossTileID=0};ia.prototype.generate=function(){return++this.maxCrossTileID};var ao=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ao.prototype.handleWrapJump=function(s){var c=Math.round((s-this.lng)/360);if(c!==0)for(var l in this.indexes){var d=this.indexes[l],g={};for(var x in d){var w=d[x];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+c),g[w.tileID.key]=w}this.indexes[l]=g}this.lng=s},ao.prototype.addBucket=function(s,c,l){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(var d=0;d<c.symbolInstances.length;d++)c.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});var g=this.usedCrossTileIDs[s.overscaledZ];for(var x in this.indexes){var w=this.indexes[x];if(Number(x)>s.overscaledZ)for(var P in w){var A=w[P];A.tileID.isChildOf(s)&&A.findMatches(c.symbolInstances,s,g)}else{var j=w[s.scaledTo(Number(x)).key];j&&j.findMatches(c.symbolInstances,s,g)}}for(var Z=0;Z<c.symbolInstances.length;Z++){var X=c.symbolInstances.get(Z);X.crossTileID||(X.crossTileID=l.generate(),g[X.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new gu(s,c.symbolInstances,c.bucketInstanceId),!0},ao.prototype.removeBucketCrossTileIDs=function(s,c){for(var l in c.indexedSymbolInstances)for(var d=0,g=c.indexedSymbolInstances[l];d<g.length;d+=1)delete this.usedCrossTileIDs[s][g[d].crossTileID]},ao.prototype.removeStaleBuckets=function(s){var c=!1;for(var l in this.indexes){var d=this.indexes[l];for(var g in d)s[d[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,d[g]),delete d[g],c=!0)}return c};var oo=function(){this.layerIndexes={},this.crossTileIDs=new ia,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};oo.prototype.addLayer=function(s,c,l){var d=this.layerIndexes[s.id];d===void 0&&(d=this.layerIndexes[s.id]=new ao);var g=!1,x={};d.handleWrapJump(l);for(var w=0,P=c;w<P.length;w+=1){var A=P[w],j=A.getBucket(s);j&&s.id===j.layerIds[0]&&(j.bucketInstanceId||(j.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(A.tileID,j,this.crossTileIDs)&&(g=!0),x[j.bucketInstanceId]=!0)}return d.removeStaleBuckets(x)&&(g=!0),g},oo.prototype.pruneUnusedLayers=function(s){var c={};for(var l in s.forEach(function(d){c[d]=!0}),this.layerIndexes)c[l]||delete this.layerIndexes[l]};var Bo=function(s,c){return o.emitValidationErrors(s,c&&c.filter(function(l){return l.identifier!=="source.canvas"}))},so=o.pick(Je,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),lo=o.pick(Je,["setCenter","setZoom","setBearing","setPitch"]),yu=function(){var s={},c=o.styleSpec.$version;for(var l in o.styleSpec.$root){var d,g=o.styleSpec.$root[l];g.required&&(d=l==="version"?c:g.type==="array"?[]:{})!=null&&(s[l]=d)}return s}(),Ii=function(s){function c(l,d){var g=this;d===void 0&&(d={}),s.call(this),this.map=l,this.dispatcher=new Pe(Fe(),this),this.imageManager=new J,this.imageManager.setEventedParent(this),this.glyphManager=new ie(l._requestManager,d.localIdeographFontFamily),this.lineAtlas=new ce(256,512),this.crossTileSymbolIndex=new oo,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());var x=this;this._rtlTextPluginCallback=c.registerForPluginStateChange(function(w){x.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},function(P,A){if(o.triggerPluginCompletionEvent(P),A&&A.every(function(Z){return Z}))for(var j in x.sourceCaches)x.sourceCaches[j].reload()})}),this.on("data",function(w){if(w.dataType==="source"&&w.sourceDataType==="metadata"){var P=g.sourceCaches[w.sourceId];if(P){var A=P.getSource();if(A&&A.vectorLayerIds)for(var j in g._layers){var Z=g._layers[j];Z.source===A.id&&g._validateLayer(Z)}}}})}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.loadURL=function(l,d){var g=this;d===void 0&&(d={}),this.fire(new o.Event("dataloading",{dataType:"style"}));var x=typeof d.validate=="boolean"?d.validate:!o.isMapboxURL(l);l=this.map._requestManager.normalizeStyleURL(l,d.accessToken);var w=this.map._requestManager.transformRequest(l,o.ResourceType.Style);this._request=o.getJSON(w,function(P,A){g._request=null,P?g.fire(new o.ErrorEvent(P)):A&&g._load(A,x)})},c.prototype.loadJSON=function(l,d){var g=this;d===void 0&&(d={}),this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.browser.frame(function(){g._request=null,g._load(l,d.validate!==!1)})},c.prototype.loadEmpty=function(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(yu,!1)},c.prototype._load=function(l,d){if(!d||!Bo(this,o.validateStyle(l))){for(var g in this._loaded=!0,this.stylesheet=l,l.sources)this.addSource(g,l.sources[g],{validate:!1});l.sprite?this._loadSprite(l.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(l.glyphs);var x=Ye(this.stylesheet.layers);this._order=x.map(function(j){return j.id}),this._layers={},this._serializedLayers={};for(var w=0,P=x;w<P.length;w+=1){var A=P[w];(A=o.createStyleLayer(A)).setEventedParent(this,{layer:{id:A.id}}),this._layers[A.id]=A,this._serializedLayers[A.id]=A.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new De(this.stylesheet.light),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}},c.prototype._loadSprite=function(l){var d=this;this._spriteRequest=function(g,x,w){var P,A,j,Z=o.browser.devicePixelRatio>1?"@2x":"",X=o.getJSON(x.transformRequest(x.normalizeSpriteURL(g,Z,".json"),o.ResourceType.SpriteJSON),function(se,ye){X=null,j||(j=se,P=ye,pe())}),Q=o.getImage(x.transformRequest(x.normalizeSpriteURL(g,Z,".png"),o.ResourceType.SpriteImage),function(se,ye){Q=null,j||(j=se,A=ye,pe())});function pe(){if(j)w(j);else if(P&&A){var se=o.browser.getImageData(A),ye={};for(var ae in P){var ge=P[ae],Ee=ge.width,Ie=ge.height,je=ge.x,ke=ge.y,Be=ge.sdf,qe=ge.pixelRatio,Ke=ge.stretchX,Xe=ge.stretchY,at=ge.content,bt=new o.RGBAImage({width:Ee,height:Ie});o.RGBAImage.copy(se,bt,{x:je,y:ke},{x:0,y:0},{width:Ee,height:Ie}),ye[ae]={data:bt,pixelRatio:qe,sdf:Be,stretchX:Ke,stretchY:Xe,content:at}}w(null,ye)}}return{cancel:function(){X&&(X.cancel(),X=null),Q&&(Q.cancel(),Q=null)}}}(l,this.map._requestManager,function(g,x){if(d._spriteRequest=null,g)d.fire(new o.ErrorEvent(g));else if(x)for(var w in x)d.imageManager.addImage(w,x[w]);d.imageManager.setLoaded(!0),d._availableImages=d.imageManager.listImages(),d.dispatcher.broadcast("setImages",d._availableImages),d.fire(new o.Event("data",{dataType:"style"}))})},c.prototype._validateLayer=function(l){var d=this.sourceCaches[l.source];if(d){var g=l.sourceLayer;if(g){var x=d.getSource();(x.type==="geojson"||x.vectorLayerIds&&x.vectorLayerIds.indexOf(g)===-1)&&this.fire(new o.ErrorEvent(new Error('Source layer "'+g+'" does not exist on source "'+x.id+'" as specified by style layer "'+l.id+'"')))}}},c.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()},c.prototype._serializeLayers=function(l){for(var d=[],g=0,x=l;g<x.length;g+=1){var w=this._layers[x[g]];w.type!=="custom"&&d.push(w.serialize())}return d},c.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var l in this.sourceCaches)if(this.sourceCaches[l].hasTransition())return!0;for(var d in this._layers)if(this._layers[d].hasTransition())return!0;return!1},c.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},c.prototype.update=function(l){if(this._loaded){var d=this._changed;if(this._changed){var g=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);for(var w in(g.length||x.length)&&this._updateWorkerLayers(g,x),this._updatedSources){var P=this._updatedSources[w];P==="reload"?this._reloadSource(w):P==="clear"&&this._clearSource(w)}for(var A in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[A].updateTransitions(l);this.light.updateTransitions(l),this._resetUpdates()}var j={};for(var Z in this.sourceCaches){var X=this.sourceCaches[Z];j[Z]=X.used,X.used=!1}for(var Q=0,pe=this._order;Q<pe.length;Q+=1){var se=this._layers[pe[Q]];se.recalculate(l,this._availableImages),!se.isHidden(l.zoom)&&se.source&&(this.sourceCaches[se.source].used=!0)}for(var ye in j){var ae=this.sourceCaches[ye];j[ye]!==ae.used&&ae.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ye}))}this.light.recalculate(l),this.z=l.zoom,d&&this.fire(new o.Event("data",{dataType:"style"}))}},c.prototype._updateTilesForChangedImages=function(){var l=Object.keys(this._changedImages);if(l.length){for(var d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}},c.prototype._updateWorkerLayers=function(l,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:d})},c.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},c.prototype.setState=function(l){var d=this;if(this._checkLoaded(),Bo(this,o.validateStyle(l)))return!1;(l=o.clone$1(l)).layers=Ye(l.layers);var g=function(w,P){if(!w)return[{command:Je.setStyle,args:[P]}];var A=[];try{if(!o.deepEqual(w.version,P.version))return[{command:Je.setStyle,args:[P]}];o.deepEqual(w.center,P.center)||A.push({command:Je.setCenter,args:[P.center]}),o.deepEqual(w.zoom,P.zoom)||A.push({command:Je.setZoom,args:[P.zoom]}),o.deepEqual(w.bearing,P.bearing)||A.push({command:Je.setBearing,args:[P.bearing]}),o.deepEqual(w.pitch,P.pitch)||A.push({command:Je.setPitch,args:[P.pitch]}),o.deepEqual(w.sprite,P.sprite)||A.push({command:Je.setSprite,args:[P.sprite]}),o.deepEqual(w.glyphs,P.glyphs)||A.push({command:Je.setGlyphs,args:[P.glyphs]}),o.deepEqual(w.transition,P.transition)||A.push({command:Je.setTransition,args:[P.transition]}),o.deepEqual(w.light,P.light)||A.push({command:Je.setLight,args:[P.light]});var j={},Z=[];(function(Q,pe,se,ye){var ae;for(ae in pe=pe||{},Q=Q||{})Q.hasOwnProperty(ae)&&(pe.hasOwnProperty(ae)||tt(ae,se,ye));for(ae in pe)pe.hasOwnProperty(ae)&&(Q.hasOwnProperty(ae)?o.deepEqual(Q[ae],pe[ae])||(Q[ae].type==="geojson"&&pe[ae].type==="geojson"&&Mr(Q,pe,ae)?se.push({command:Je.setGeoJSONSourceData,args:[ae,pe[ae].data]}):tr(ae,pe,se,ye)):Bt(ae,pe,se))})(w.sources,P.sources,Z,j);var X=[];w.layers&&w.layers.forEach(function(Q){j[Q.source]?A.push({command:Je.removeLayer,args:[Q.id]}):X.push(Q)}),A=A.concat(Z),function(Q,pe,se){pe=pe||[];var ye,ae,ge,Ee,Ie,je,ke,Be=(Q=Q||[]).map(lr),qe=pe.map(lr),Ke=Q.reduce(Ft,{}),Xe=pe.reduce(Ft,{}),at=Be.slice(),bt=Object.create(null);for(ye=0,ae=0;ye<Be.length;ye++)Xe.hasOwnProperty(ge=Be[ye])?ae++:(se.push({command:Je.removeLayer,args:[ge]}),at.splice(at.indexOf(ge,ae),1));for(ye=0,ae=0;ye<qe.length;ye++)at[at.length-1-ye]!==(ge=qe[qe.length-1-ye])&&(Ke.hasOwnProperty(ge)?(se.push({command:Je.removeLayer,args:[ge]}),at.splice(at.lastIndexOf(ge,at.length-ae),1)):ae++,se.push({command:Je.addLayer,args:[Xe[ge],je=at[at.length-ye]]}),at.splice(at.length-ye,0,ge),bt[ge]=!0);for(ye=0;ye<qe.length;ye++)if(Ee=Ke[ge=qe[ye]],Ie=Xe[ge],!bt[ge]&&!o.deepEqual(Ee,Ie))if(o.deepEqual(Ee.source,Ie.source)&&o.deepEqual(Ee["source-layer"],Ie["source-layer"])&&o.deepEqual(Ee.type,Ie.type)){for(ke in Jt(Ee.layout,Ie.layout,se,ge,null,Je.setLayoutProperty),Jt(Ee.paint,Ie.paint,se,ge,null,Je.setPaintProperty),o.deepEqual(Ee.filter,Ie.filter)||se.push({command:Je.setFilter,args:[ge,Ie.filter]}),o.deepEqual(Ee.minzoom,Ie.minzoom)&&o.deepEqual(Ee.maxzoom,Ie.maxzoom)||se.push({command:Je.setLayerZoomRange,args:[ge,Ie.minzoom,Ie.maxzoom]}),Ee)Ee.hasOwnProperty(ke)&&ke!=="layout"&&ke!=="paint"&&ke!=="filter"&&ke!=="metadata"&&ke!=="minzoom"&&ke!=="maxzoom"&&(ke.indexOf("paint.")===0?Jt(Ee[ke],Ie[ke],se,ge,ke.slice(6),Je.setPaintProperty):o.deepEqual(Ee[ke],Ie[ke])||se.push({command:Je.setLayerProperty,args:[ge,ke,Ie[ke]]}));for(ke in Ie)Ie.hasOwnProperty(ke)&&!Ee.hasOwnProperty(ke)&&ke!=="layout"&&ke!=="paint"&&ke!=="filter"&&ke!=="metadata"&&ke!=="minzoom"&&ke!=="maxzoom"&&(ke.indexOf("paint.")===0?Jt(Ee[ke],Ie[ke],se,ge,ke.slice(6),Je.setPaintProperty):o.deepEqual(Ee[ke],Ie[ke])||se.push({command:Je.setLayerProperty,args:[ge,ke,Ie[ke]]}))}else se.push({command:Je.removeLayer,args:[ge]}),je=at[at.lastIndexOf(ge)+1],se.push({command:Je.addLayer,args:[Ie,je]})}(X,P.layers,A)}catch(Q){console.warn("Unable to compute style diff:",Q),A=[{command:Je.setStyle,args:[P]}]}return A}(this.serialize(),l).filter(function(w){return!(w.command in lo)});if(g.length===0)return!1;var x=g.filter(function(w){return!(w.command in so)});if(x.length>0)throw new Error("Unimplemented: "+x.map(function(w){return w.command}).join(", ")+".");return g.forEach(function(w){w.command!=="setTransition"&&d[w.command].apply(d,w.args)}),this.stylesheet=l,!0},c.prototype.addImage=function(l,d){if(this.getImage(l))return this.fire(new o.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(l,d),this._afterImageUpdated(l)},c.prototype.updateImage=function(l,d){this.imageManager.updateImage(l,d)},c.prototype.getImage=function(l){return this.imageManager.getImage(l)},c.prototype.removeImage=function(l){if(!this.getImage(l))return this.fire(new o.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(l),this._afterImageUpdated(l)},c.prototype._afterImageUpdated=function(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))},c.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},c.prototype.addSource=function(l,d,g){var x=this;if(g===void 0&&(g={}),this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error("There is already a source with this ID");if(!d.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(d).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(o.validateStyle.source,"sources."+l,d,null,g))){this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);var w=this.sourceCaches[l]=new he(l,d,this.dispatcher);w.style=this,w.setEventedParent(this,function(){return{isSourceLoaded:x.loaded(),source:w.serialize(),sourceId:l}}),w.onAdd(this.map),this._changed=!0}},c.prototype.removeSource=function(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(var d in this._layers)if(this._layers[d].source===l)return this.fire(new o.ErrorEvent(new Error('Source "'+l+'" cannot be removed while layer "'+d+'" is using it.')));var g=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],g.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),g.setEventedParent(null),g.clearTiles(),g.onRemove&&g.onRemove(this.map),this._changed=!0},c.prototype.setGeoJSONSourceData=function(l,d){this._checkLoaded(),this.sourceCaches[l].getSource().setData(d),this._changed=!0},c.prototype.getSource=function(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()},c.prototype.addLayer=function(l,d,g){g===void 0&&(g={}),this._checkLoaded();var x=l.id;if(this.getLayer(x))this.fire(new o.ErrorEvent(new Error('Layer with id "'+x+'" already exists on this map')));else{var w;if(l.type==="custom"){if(Bo(this,o.validateCustomStyleLayer(l)))return;w=o.createStyleLayer(l)}else{if(typeof l.source=="object"&&(this.addSource(x,l.source),l=o.clone$1(l),l=o.extend(l,{source:x})),this._validate(o.validateStyle.layer,"layers."+x,l,{arrayIndex:-1},g))return;w=o.createStyleLayer(l),this._validateLayer(w),w.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[w.id]=w.serialize()}var P=d?this._order.indexOf(d):this._order.length;if(d&&P===-1)this.fire(new o.ErrorEvent(new Error('Layer with id "'+d+'" does not exist on this map.')));else{if(this._order.splice(P,0,x),this._layerOrderChanged=!0,this._layers[x]=w,this._removedLayers[x]&&w.source&&w.type!=="custom"){var A=this._removedLayers[x];delete this._removedLayers[x],A.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}},c.prototype.moveLayer=function(l,d){if(this._checkLoaded(),this._changed=!0,this._layers[l]){if(l!==d){var g=this._order.indexOf(l);this._order.splice(g,1);var x=d?this._order.indexOf(d):this._order.length;d&&x===-1?this.fire(new o.ErrorEvent(new Error('Layer with id "'+d+'" does not exist on this map.'))):(this._order.splice(x,0,l),this._layerOrderChanged=!0)}}else this.fire(new o.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be moved.")))},c.prototype.removeLayer=function(l){this._checkLoaded();var d=this._layers[l];if(d){d.setEventedParent(null);var g=this._order.indexOf(l);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=d,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],d.onRemove&&d.onRemove(this.map)}else this.fire(new o.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be removed.")))},c.prototype.getLayer=function(l){return this._layers[l]},c.prototype.hasLayer=function(l){return l in this._layers},c.prototype.setLayerZoomRange=function(l,d,g){this._checkLoaded();var x=this.getLayer(l);x?x.minzoom===d&&x.maxzoom===g||(d!=null&&(x.minzoom=d),g!=null&&(x.maxzoom=g),this._updateLayer(x)):this.fire(new o.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot have zoom extent.")))},c.prototype.setFilter=function(l,d,g){g===void 0&&(g={}),this._checkLoaded();var x=this.getLayer(l);if(x){if(!o.deepEqual(x.filter,d))return d==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(o.validateStyle.filter,"layers."+x.id+".filter",d,null,g)||(x.filter=o.clone$1(d),this._updateLayer(x)))}else this.fire(new o.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be filtered.")))},c.prototype.getFilter=function(l){return o.clone$1(this.getLayer(l).filter)},c.prototype.setLayoutProperty=function(l,d,g,x){x===void 0&&(x={}),this._checkLoaded();var w=this.getLayer(l);w?o.deepEqual(w.getLayoutProperty(d),g)||(w.setLayoutProperty(d,g,x),this._updateLayer(w)):this.fire(new o.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be styled.")))},c.prototype.getLayoutProperty=function(l,d){var g=this.getLayer(l);if(g)return g.getLayoutProperty(d);this.fire(new o.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style.")))},c.prototype.setPaintProperty=function(l,d,g,x){x===void 0&&(x={}),this._checkLoaded();var w=this.getLayer(l);w?o.deepEqual(w.getPaintProperty(d),g)||(w.setPaintProperty(d,g,x)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new o.ErrorEvent(new Error("The layer '"+l+"' does not exist in the map's style and cannot be styled.")))},c.prototype.getPaintProperty=function(l,d){return this.getLayer(l).getPaintProperty(d)},c.prototype.setFeatureState=function(l,d){this._checkLoaded();var g=l.source,x=l.sourceLayer,w=this.sourceCaches[g];if(w!==void 0){var P=w.getSource().type;P==="geojson"&&x?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):P!=="vector"||x?(l.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),w.setFeatureState(x,l.id,d)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+g+"' does not exist in the map's style.")))},c.prototype.removeFeatureState=function(l,d){this._checkLoaded();var g=l.source,x=this.sourceCaches[g];if(x!==void 0){var w=x.getSource().type,P=w==="vector"?l.sourceLayer:void 0;w!=="vector"||P?d&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):x.removeFeatureState(P,l.id,d):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+g+"' does not exist in the map's style.")))},c.prototype.getFeatureState=function(l){this._checkLoaded();var d=l.source,g=l.sourceLayer,x=this.sourceCaches[d];if(x!==void 0){if(x.getSource().type!=="vector"||g)return l.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),x.getFeatureState(g,l.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},c.prototype.getTransition=function(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},c.prototype.serialize=function(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,function(l){return l.serialize()}),layers:this._serializeLayers(this._order)},function(l){return l!==void 0})},c.prototype._updateLayer=function(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._changed=!0},c.prototype._flattenAndSortRenderedFeatures=function(l){for(var d=this,g=function(Ke){return d._layers[Ke].type==="fill-extrusion"},x={},w=[],P=this._order.length-1;P>=0;P--){var A=this._order[P];if(g(A)){x[A]=P;for(var j=0,Z=l;j<Z.length;j+=1){var X=Z[j][A];if(X)for(var Q=0,pe=X;Q<pe.length;Q+=1)w.push(pe[Q])}}}w.sort(function(Ke,Xe){return Xe.intersectionZ-Ke.intersectionZ});for(var se=[],ye=this._order.length-1;ye>=0;ye--){var ae=this._order[ye];if(g(ae))for(var ge=w.length-1;ge>=0;ge--){var Ee=w[ge].feature;if(x[Ee.layer.id]<ye)break;se.push(Ee),w.pop()}else for(var Ie=0,je=l;Ie<je.length;Ie+=1){var ke=je[Ie][ae];if(ke)for(var Be=0,qe=ke;Be<qe.length;Be+=1)se.push(qe[Be].feature)}}return se},c.prototype.queryRenderedFeatures=function(l,d,g){d&&d.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",d.filter,null,d);var x={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var w=0,P=d.layers;w<P.length;w+=1){var A=P[w],j=this._layers[A];if(!j)return this.fire(new o.ErrorEvent(new Error("The layer '"+A+"' does not exist in the map's style and cannot be queried for features."))),[];x[j.source]=!0}}var Z=[];for(var X in d.availableImages=this._availableImages,this.sourceCaches)d.layers&&!x[X]||Z.push(Et(this.sourceCaches[X],this._layers,this._serializedLayers,l,d,g));return this.placement&&Z.push(function(Q,pe,se,ye,ae,ge,Ee){for(var Ie={},je=ge.queryRenderedSymbols(ye),ke=[],Be=0,qe=Object.keys(je).map(Number);Be<qe.length;Be+=1)ke.push(Ee[qe[Be]]);ke.sort(er);for(var Ke=function(){var St=at[Xe],mr=St.featureIndex.lookupSymbolFeatures(je[St.bucketInstanceId],pe,St.bucketIndex,St.sourceLayerIndex,ae.filter,ae.layers,ae.availableImages,Q);for(var st in mr){var Nt=Ie[st]=Ie[st]||[],Ht=mr[st];Ht.sort(function(qt,At){var Ot=St.featureSortOrder;if(Ot){var Ln=Ot.indexOf(qt.featureIndex);return Ot.indexOf(At.featureIndex)-Ln}return At.featureIndex-qt.featureIndex});for(var zt=0,Lt=Ht;zt<Lt.length;zt+=1)Nt.push(Lt[zt])}},Xe=0,at=ke;Xe<at.length;Xe+=1)Ke();var bt=function(St){Ie[St].forEach(function(mr){var st=mr.feature,Nt=se[Q[St].source].getFeatureState(st.layer["source-layer"],st.id);st.source=st.layer.source,st.layer["source-layer"]&&(st.sourceLayer=st.layer["source-layer"]),st.state=Nt})};for(var Pt in Ie)bt(Pt);return Ie}(this._layers,this._serializedLayers,this.sourceCaches,l,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Z)},c.prototype.querySourceFeatures=function(l,d){d&&d.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",d.filter,null,d);var g=this.sourceCaches[l];return g?function(x,w){for(var P=x.getRenderableIds().map(function(pe){return x.getTileByID(pe)}),A=[],j={},Z=0;Z<P.length;Z++){var X=P[Z],Q=X.tileID.canonical.key;j[Q]||(j[Q]=!0,X.querySourceFeatures(A,w))}return A}(g,d):[]},c.prototype.addSourceType=function(l,d,g){return c.getSourceType(l)?g(new Error('A source type called "'+l+'" already exists.')):(c.setSourceType(l,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:d.workerSourceURL},g):g(null,null))},c.prototype.getLight=function(){return this.light.getLight()},c.prototype.setLight=function(l,d){d===void 0&&(d={}),this._checkLoaded();var g=this.light.getLight(),x=!1;for(var w in l)if(!o.deepEqual(l[w],g[w])){x=!0;break}if(x){var P={now:o.browser.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,d),this.light.updateTransitions(P)}},c.prototype._validate=function(l,d,g,x,w){return w===void 0&&(w={}),(!w||w.validate!==!1)&&Bo(this,l.call(o.validateStyle,o.extend({key:d,style:this.serialize(),value:g,styleSpec:o.styleSpec},x)))},c.prototype._remove=function(){for(var l in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[l].setEventedParent(null);for(var d in this.sourceCaches)this.sourceCaches[d].clearTiles(),this.sourceCaches[d].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},c.prototype._clearSource=function(l){this.sourceCaches[l].clearTiles()},c.prototype._reloadSource=function(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()},c.prototype._updateSources=function(l){for(var d in this.sourceCaches)this.sourceCaches[d].update(l)},c.prototype._generateCollisionBoxes=function(){for(var l in this.sourceCaches)this._reloadSource(l)},c.prototype._updatePlacement=function(l,d,g,x,w){w===void 0&&(w=!1);for(var P=!1,A=!1,j={},Z=0,X=this._order;Z<X.length;Z+=1){var Q=this._layers[X[Z]];if(Q.type==="symbol"){if(!j[Q.source]){var pe=this.sourceCaches[Q.source];j[Q.source]=pe.getRenderableIds(!0).map(function(Ee){return pe.getTileByID(Ee)}).sort(function(Ee,Ie){return Ie.tileID.overscaledZ-Ee.tileID.overscaledZ||(Ee.tileID.isLessThan(Ie.tileID)?-1:1)})}var se=this.crossTileSymbolIndex.addLayer(Q,j[Q.source],l.center.lng);P=P||se}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.browser.now(),l.zoom))&&(this.pauseablePlacement=new sl(l,this._order,w,d,g,x,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,j),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.browser.now()),A=!0),P&&this.pauseablePlacement.placement.setStale()),A||P)for(var ye=0,ae=this._order;ye<ae.length;ye+=1){var ge=this._layers[ae[ye]];ge.type==="symbol"&&this.placement.updateLayerOpacities(ge,j[ge.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.browser.now())},c.prototype._releaseSymbolFadeTiles=function(){for(var l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()},c.prototype.getImages=function(l,d,g){this.imageManager.getImages(d.icons,g),this._updateTilesForChangedImages();var x=this.sourceCaches[d.source];x&&x.setDependencies(d.tileID.key,d.type,d.icons)},c.prototype.getGlyphs=function(l,d,g){this.glyphManager.getGlyphs(d.stacks,g)},c.prototype.getResource=function(l,d,g){return o.makeRequest(d,g)},c}(o.Evented);Ii.getSourceType=function(s){return Gt[s]},Ii.setSourceType=function(s,c){Gt[s]=c},Ii.registerForPluginStateChange=o.registerForPluginStateChange;var Sn=o.createLayout([{name:"a_pos",type:"Int16",components:2}]),Es=Dr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Uh=Dr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),wm=Dr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Sm=Dr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),qc=Dr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),$c=Dr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Wc=Dr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Hc=Dr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Vh=Dr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),qh=Dr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Em=Dr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),ll=Dr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ul=Dr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),$h=Dr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Qn=Dr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Zc=Dr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),uo=Dr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),co=Dr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Fo=Dr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Uo=Dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),po=Dr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Vo=Dr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),qo=Dr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),ho=Dr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Wh=Dr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Hh=Dr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Dr(s,c){var l=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=c.match(/attribute ([\w]+) ([\w]+)/g),g=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=x?x.concat(g):g,P={};return{fragmentSource:s=s.replace(l,function(A,j,Z,X,Q){return P[Q]=!0,j==="define"?`
#ifndef HAS_UNIFORM_u_`+Q+`
varying `+Z+" "+X+" "+Q+`;
#else
uniform `+Z+" "+X+" u_"+Q+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Q+`
    `+Z+" "+X+" "+Q+" = u_"+Q+`;
#endif
`}),vertexSource:c=c.replace(l,function(A,j,Z,X,Q){var pe=X==="float"?"vec2":"vec4",se=Q.match(/color/)?"color":pe;return P[Q]?j==="define"?`
#ifndef HAS_UNIFORM_u_`+Q+`
uniform lowp float u_`+Q+`_t;
attribute `+Z+" "+pe+" a_"+Q+`;
varying `+Z+" "+X+" "+Q+`;
#else
uniform `+Z+" "+X+" u_"+Q+`;
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Q+`
    `+Q+" = a_"+Q+`;
#else
    `+Z+" "+X+" "+Q+" = u_"+Q+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Q+`
    `+Q+" = unpack_mix_"+se+"(a_"+Q+", u_"+Q+`_t);
#else
    `+Z+" "+X+" "+Q+" = u_"+Q+`;
#endif
`:j==="define"?`
#ifndef HAS_UNIFORM_u_`+Q+`
uniform lowp float u_`+Q+`_t;
attribute `+Z+" "+pe+" a_"+Q+`;
#else
uniform `+Z+" "+X+" u_"+Q+`;
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Q+`
    `+Z+" "+X+" "+Q+" = a_"+Q+`;
#else
    `+Z+" "+X+" "+Q+" = u_"+Q+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Q+`
    `+Z+" "+X+" "+Q+" = unpack_mix_"+se+"(a_"+Q+", u_"+Q+`_t);
#else
    `+Z+" "+X+" "+Q+" = u_"+Q+`;
#endif
`}),staticAttributes:d,staticUniforms:w}}var Pm=Object.freeze({__proto__:null,prelude:Es,background:Uh,backgroundPattern:wm,circle:Sm,clippingMask:qc,heatmap:$c,heatmapTexture:Wc,collisionBox:Hc,collisionCircle:Vh,debug:qh,fill:Em,fillOutline:ll,fillOutlinePattern:ul,fillPattern:$h,fillExtrusion:Qn,fillExtrusionPattern:Zc,hillshadePrepare:uo,hillshade:co,line:Fo,lineGradient:Uo,linePattern:po,lineSDF:Vo,raster:qo,symbolIcon:ho,symbolSDF:Wh,symbolTextAndIcon:Hh}),_u=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Zh(s){for(var c=[],l=0;l<s.length;l++)if(s[l]!==null){var d=s[l].split(" ");c.push(d.pop())}return c}_u.prototype.bind=function(s,c,l,d,g,x,w,P){this.context=s;for(var A=this.boundPaintVertexBuffers.length!==d.length,j=0;!A&&j<d.length;j++)this.boundPaintVertexBuffers[j]!==d[j]&&(A=!0);s.extVertexArrayObject&&this.vao&&this.boundProgram===c&&this.boundLayoutVertexBuffer===l&&!A&&this.boundIndexBuffer===g&&this.boundVertexOffset===x&&this.boundDynamicVertexBuffer===w&&this.boundDynamicVertexBuffer2===P?(s.bindVertexArrayOES.set(this.vao),w&&w.bind(),g&&g.dynamicDraw&&g.bind(),P&&P.bind()):this.freshBind(c,l,d,g,x,w,P)},_u.prototype.freshBind=function(s,c,l,d,g,x,w){var P,A=s.numAttributes,j=this.context,Z=j.gl;if(j.extVertexArrayObject)this.vao&&this.destroy(),this.vao=j.extVertexArrayObject.createVertexArrayOES(),j.bindVertexArrayOES.set(this.vao),P=0,this.boundProgram=s,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=d,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=w;else{P=j.currentNumAttributes||0;for(var X=A;X<P;X++)Z.disableVertexAttribArray(X)}c.enableAttributes(Z,s);for(var Q=0,pe=l;Q<pe.length;Q+=1)pe[Q].enableAttributes(Z,s);x&&x.enableAttributes(Z,s),w&&w.enableAttributes(Z,s),c.bind(),c.setVertexAttribPointers(Z,s,g);for(var se=0,ye=l;se<ye.length;se+=1){var ae=ye[se];ae.bind(),ae.setVertexAttribPointers(Z,s,g)}x&&(x.bind(),x.setVertexAttribPointers(Z,s,g)),d&&d.bind(),w&&(w.bind(),w.setVertexAttribPointers(Z,s,g)),j.currentNumAttributes=A},_u.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Gh=function(s,c,l,d,g,x){var w=s.gl;this.program=w.createProgram();for(var P=Zh(l.staticAttributes),A=d?d.getBinderAttributes():[],j=P.concat(A),Z=l.staticUniforms?Zh(l.staticUniforms):[],X=d?d.getBinderUniforms():[],Q=[],pe=0,se=Z.concat(X);pe<se.length;pe+=1){var ye=se[pe];Q.indexOf(ye)<0&&Q.push(ye)}var ae=d?d.defines():[];x&&ae.push("#define OVERDRAW_INSPECTOR;");var ge=ae.concat(Es.fragmentSource,l.fragmentSource).join(`
`),Ee=ae.concat(Es.vertexSource,l.vertexSource).join(`
`),Ie=w.createShader(w.FRAGMENT_SHADER);if(w.isContextLost())this.failedToCreate=!0;else{w.shaderSource(Ie,ge),w.compileShader(Ie),w.attachShader(this.program,Ie);var je=w.createShader(w.VERTEX_SHADER);if(w.isContextLost())this.failedToCreate=!0;else{w.shaderSource(je,Ee),w.compileShader(je),w.attachShader(this.program,je),this.attributes={};var ke={};this.numAttributes=j.length;for(var Be=0;Be<this.numAttributes;Be++)j[Be]&&(w.bindAttribLocation(this.program,Be,j[Be]),this.attributes[j[Be]]=Be);w.linkProgram(this.program),w.deleteShader(je),w.deleteShader(Ie);for(var qe=0;qe<Q.length;qe++){var Ke=Q[qe];if(Ke&&!ke[Ke]){var Xe=w.getUniformLocation(this.program,Ke);Xe&&(ke[Ke]=Xe)}}this.fixedUniforms=g(s,ke),this.binderUniforms=d?d.getUniforms(s,ke):[]}}};function Xh(s,c,l){var d=1/Fr(l,1,c.transform.tileZoom),g=Math.pow(2,l.tileID.overscaledZ),x=l.tileSize*Math.pow(2,c.transform.tileZoom)/g,w=x*(l.tileID.canonical.x+l.tileID.wrap*g),P=x*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_scale:[d,s.fromScale,s.toScale],u_fade:s.t,u_pixel_coord_upper:[w>>16,P>>16],u_pixel_coord_lower:[65535&w,65535&P]}}Gh.prototype.draw=function(s,c,l,d,g,x,w,P,A,j,Z,X,Q,pe,se,ye){var ae,ge=s.gl;if(!this.failedToCreate){for(var Ee in s.program.set(this.program),s.setDepthMode(l),s.setStencilMode(d),s.setColorMode(g),s.setCullFace(x),this.fixedUniforms)this.fixedUniforms[Ee].set(w[Ee]);pe&&pe.setUniforms(s,this.binderUniforms,X,{zoom:Q});for(var Ie=(ae={},ae[ge.LINES]=2,ae[ge.TRIANGLES]=3,ae[ge.LINE_STRIP]=1,ae)[c],je=0,ke=Z.get();je<ke.length;je+=1){var Be=ke[je],qe=Be.vaos||(Be.vaos={});(qe[P]||(qe[P]=new _u)).bind(s,this,A,pe?pe.getPaintVertexBuffers():[],j,Be.vertexOffset,se,ye),ge.drawElements(c,Be.primitiveLength*Ie,ge.UNSIGNED_SHORT,Be.primitiveOffset*Ie*2)}}};var Kh=function(s,c,l,d){var g=c.style.light,x=g.properties.get("position"),w=[x.x,x.y,x.z],P=o.create$1();g.properties.get("anchor")==="viewport"&&o.fromRotation(P,-c.transform.angle),o.transformMat3(w,w,P);var A=g.properties.get("color");return{u_matrix:s,u_lightpos:w,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[A.r,A.g,A.b],u_vertical_gradient:+l,u_opacity:d}},$o=function(s,c,l,d,g,x,w){return o.extend(Kh(s,c,l,d),Xh(x,c,w),{u_height_factor:-Math.pow(2,g.overscaledZ)/w.tileSize/8})},fo=function(s){return{u_matrix:s}},Wo=function(s,c,l,d){return o.extend(fo(s),Xh(l,c,d))},Yh=function(s,c){return{u_matrix:s,u_world:c}},Jh=function(s,c,l,d,g){return o.extend(Wo(s,c,l,d),{u_world:g})},Gc=function(s,c,l,d){var g,x,w=s.transform;if(d.paint.get("circle-pitch-alignment")==="map"){var P=Fr(l,1,w.zoom);g=!0,x=[P,P]}else g=!1,x=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_matrix:s.translatePosMatrix(c.posMatrix,l,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+g,u_device_pixel_ratio:o.browser.devicePixelRatio,u_extrude_scale:x}},Ho=function(s,c,l){var d=Fr(l,1,c.zoom),g=Math.pow(2,c.zoom-l.tileID.overscaledZ),x=l.tileID.overscaleFactor();return{u_matrix:s,u_camera_to_center_distance:c.cameraToCenterDistance,u_pixels_to_tile_units:d,u_extrude_scale:[c.pixelsToGLUnits[0]/(d*g),c.pixelsToGLUnits[1]/(d*g)],u_overscale_factor:x}},Qh=function(s,c,l){return{u_matrix:s,u_inv_matrix:c,u_camera_to_center_distance:l.cameraToCenterDistance,u_viewport_size:[l.width,l.height]}},Zo=function(s,c,l){return l===void 0&&(l=1),{u_matrix:s,u_color:c,u_overlay:0,u_overlay_scale:l}},Go=function(s){return{u_matrix:s}},ed=function(s,c,l,d){return{u_matrix:s,u_extrude_scale:Fr(c,1,l),u_intensity:d}},cl=function(s,c,l){var d=s.transform;return{u_matrix:td(s,c,l),u_ratio:1/Fr(c,1,d.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Ur=function(s,c,l,d){return o.extend(cl(s,c,l),{u_image:0,u_image_height:d})},bu=function(s,c,l,d){var g=s.transform,x=Ps(c,g);return{u_matrix:td(s,c,l),u_texsize:c.imageAtlasTexture.size,u_ratio:1/Fr(c,1,g.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_image:0,u_scale:[x,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Tm=function(s,c,l,d,g){var x=s.lineAtlas,w=Ps(c,s.transform),P=l.layout.get("line-cap")==="round",A=x.getDash(d.from,P),j=x.getDash(d.to,P),Z=A.width*g.fromScale,X=j.width*g.toScale;return o.extend(cl(s,c,l),{u_patternscale_a:[w/Z,-A.height/2],u_patternscale_b:[w/X,-j.height/2],u_sdfgamma:x.width/(256*Math.min(Z,X)*o.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:A.y,u_tex_y_b:j.y,u_mix:g.t})};function Ps(s,c){return 1/Fr(s,1,c.tileZoom)}function td(s,c,l){return s.translatePosMatrix(c.tileID.posMatrix,c,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}var Cm=function(s,c,l,d,g){return{u_matrix:s,u_tl_parent:c,u_scale_parent:l,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(w=g.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(x=g.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:rd(g.paint.get("raster-hue-rotate"))};var x,w};function rd(s){s*=Math.PI/180;var c=Math.sin(s),l=Math.cos(s);return[(2*l+1)/3,(-Math.sqrt(3)*c-l+1)/3,(Math.sqrt(3)*c-l+1)/3]}var xu,Ts=function(s,c,l,d,g,x,w,P,A,j){var Z=g.transform;return{u_is_size_zoom_constant:+(s==="constant"||s==="source"),u_is_size_feature_constant:+(s==="constant"||s==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:Z.cameraToCenterDistance,u_pitch:Z.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:Z.width/Z.height,u_fade_change:g.options.fadeDuration?g.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:w,u_coord_matrix:P,u_is_text:+A,u_pitch_with_map:+d,u_texsize:j,u_texture:0}},pl=function(s,c,l,d,g,x,w,P,A,j,Z){var X=g.transform;return o.extend(Ts(s,c,l,d,g,x,w,P,A,j),{u_gamma_scale:d?Math.cos(X._pitch)*X.cameraToCenterDistance:1,u_device_pixel_ratio:o.browser.devicePixelRatio,u_is_halo:+Z})},wu=function(s,c,l,d,g,x,w,P,A,j){return o.extend(pl(s,c,l,d,g,x,w,P,!0,A,!0),{u_texsize_icon:j,u_texture_icon:1})},hl=function(s,c,l){return{u_matrix:s,u_opacity:c,u_color:l}},Cs=function(s,c,l,d,g,x){return o.extend(function(w,P,A,j){var Z=A.imageManager.getPattern(w.from.toString()),X=A.imageManager.getPattern(w.to.toString()),Q=A.imageManager.getPixelSize(),pe=Q.width,se=Q.height,ye=Math.pow(2,j.tileID.overscaledZ),ae=j.tileSize*Math.pow(2,A.transform.tileZoom)/ye,ge=ae*(j.tileID.canonical.x+j.tileID.wrap*ye),Ee=ae*j.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Z.tl,u_pattern_br_a:Z.br,u_pattern_tl_b:X.tl,u_pattern_br_b:X.br,u_texsize:[pe,se],u_mix:P.t,u_pattern_size_a:Z.displaySize,u_pattern_size_b:X.displaySize,u_scale_a:P.fromScale,u_scale_b:P.toScale,u_tile_units_to_pixels:1/Fr(j,1,A.transform.tileZoom),u_pixel_coord_upper:[ge>>16,Ee>>16],u_pixel_coord_lower:[65535&ge,65535&Ee]}}(d,x,l,g),{u_matrix:s,u_opacity:c})},nd={fillExtrusion:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_lightpos:new o.Uniform3f(s,c.u_lightpos),u_lightintensity:new o.Uniform1f(s,c.u_lightintensity),u_lightcolor:new o.Uniform3f(s,c.u_lightcolor),u_vertical_gradient:new o.Uniform1f(s,c.u_vertical_gradient),u_opacity:new o.Uniform1f(s,c.u_opacity)}},fillExtrusionPattern:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_lightpos:new o.Uniform3f(s,c.u_lightpos),u_lightintensity:new o.Uniform1f(s,c.u_lightintensity),u_lightcolor:new o.Uniform3f(s,c.u_lightcolor),u_vertical_gradient:new o.Uniform1f(s,c.u_vertical_gradient),u_height_factor:new o.Uniform1f(s,c.u_height_factor),u_image:new o.Uniform1i(s,c.u_image),u_texsize:new o.Uniform2f(s,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(s,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(s,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(s,c.u_scale),u_fade:new o.Uniform1f(s,c.u_fade),u_opacity:new o.Uniform1f(s,c.u_opacity)}},fill:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix)}},fillPattern:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_image:new o.Uniform1i(s,c.u_image),u_texsize:new o.Uniform2f(s,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(s,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(s,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(s,c.u_scale),u_fade:new o.Uniform1f(s,c.u_fade)}},fillOutline:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_world:new o.Uniform2f(s,c.u_world)}},fillOutlinePattern:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_world:new o.Uniform2f(s,c.u_world),u_image:new o.Uniform1i(s,c.u_image),u_texsize:new o.Uniform2f(s,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(s,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(s,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(s,c.u_scale),u_fade:new o.Uniform1f(s,c.u_fade)}},circle:function(s,c){return{u_camera_to_center_distance:new o.Uniform1f(s,c.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(s,c.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(s,c.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(s,c.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(s,c.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(s,c.u_matrix)}},collisionBox:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_camera_to_center_distance:new o.Uniform1f(s,c.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(s,c.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(s,c.u_extrude_scale),u_overscale_factor:new o.Uniform1f(s,c.u_overscale_factor)}},collisionCircle:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_inv_matrix:new o.UniformMatrix4f(s,c.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(s,c.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(s,c.u_viewport_size)}},debug:function(s,c){return{u_color:new o.UniformColor(s,c.u_color),u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_overlay:new o.Uniform1i(s,c.u_overlay),u_overlay_scale:new o.Uniform1f(s,c.u_overlay_scale)}},clippingMask:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix)}},heatmap:function(s,c){return{u_extrude_scale:new o.Uniform1f(s,c.u_extrude_scale),u_intensity:new o.Uniform1f(s,c.u_intensity),u_matrix:new o.UniformMatrix4f(s,c.u_matrix)}},heatmapTexture:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_world:new o.Uniform2f(s,c.u_world),u_image:new o.Uniform1i(s,c.u_image),u_color_ramp:new o.Uniform1i(s,c.u_color_ramp),u_opacity:new o.Uniform1f(s,c.u_opacity)}},hillshade:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_image:new o.Uniform1i(s,c.u_image),u_latrange:new o.Uniform2f(s,c.u_latrange),u_light:new o.Uniform2f(s,c.u_light),u_shadow:new o.UniformColor(s,c.u_shadow),u_highlight:new o.UniformColor(s,c.u_highlight),u_accent:new o.UniformColor(s,c.u_accent)}},hillshadePrepare:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_image:new o.Uniform1i(s,c.u_image),u_dimension:new o.Uniform2f(s,c.u_dimension),u_zoom:new o.Uniform1f(s,c.u_zoom),u_unpack:new o.Uniform4f(s,c.u_unpack)}},line:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_ratio:new o.Uniform1f(s,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(s,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(s,c.u_units_to_pixels)}},lineGradient:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_ratio:new o.Uniform1f(s,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(s,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(s,c.u_units_to_pixels),u_image:new o.Uniform1i(s,c.u_image),u_image_height:new o.Uniform1f(s,c.u_image_height)}},linePattern:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_texsize:new o.Uniform2f(s,c.u_texsize),u_ratio:new o.Uniform1f(s,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(s,c.u_device_pixel_ratio),u_image:new o.Uniform1i(s,c.u_image),u_units_to_pixels:new o.Uniform2f(s,c.u_units_to_pixels),u_scale:new o.Uniform3f(s,c.u_scale),u_fade:new o.Uniform1f(s,c.u_fade)}},lineSDF:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_ratio:new o.Uniform1f(s,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(s,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(s,c.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(s,c.u_patternscale_a),u_patternscale_b:new o.Uniform2f(s,c.u_patternscale_b),u_sdfgamma:new o.Uniform1f(s,c.u_sdfgamma),u_image:new o.Uniform1i(s,c.u_image),u_tex_y_a:new o.Uniform1f(s,c.u_tex_y_a),u_tex_y_b:new o.Uniform1f(s,c.u_tex_y_b),u_mix:new o.Uniform1f(s,c.u_mix)}},raster:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_tl_parent:new o.Uniform2f(s,c.u_tl_parent),u_scale_parent:new o.Uniform1f(s,c.u_scale_parent),u_buffer_scale:new o.Uniform1f(s,c.u_buffer_scale),u_fade_t:new o.Uniform1f(s,c.u_fade_t),u_opacity:new o.Uniform1f(s,c.u_opacity),u_image0:new o.Uniform1i(s,c.u_image0),u_image1:new o.Uniform1i(s,c.u_image1),u_brightness_low:new o.Uniform1f(s,c.u_brightness_low),u_brightness_high:new o.Uniform1f(s,c.u_brightness_high),u_saturation_factor:new o.Uniform1f(s,c.u_saturation_factor),u_contrast_factor:new o.Uniform1f(s,c.u_contrast_factor),u_spin_weights:new o.Uniform3f(s,c.u_spin_weights)}},symbolIcon:function(s,c){return{u_is_size_zoom_constant:new o.Uniform1i(s,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(s,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(s,c.u_size_t),u_size:new o.Uniform1f(s,c.u_size),u_camera_to_center_distance:new o.Uniform1f(s,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(s,c.u_pitch),u_rotate_symbol:new o.Uniform1i(s,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(s,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(s,c.u_fade_change),u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(s,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(s,c.u_coord_matrix),u_is_text:new o.Uniform1i(s,c.u_is_text),u_pitch_with_map:new o.Uniform1i(s,c.u_pitch_with_map),u_texsize:new o.Uniform2f(s,c.u_texsize),u_texture:new o.Uniform1i(s,c.u_texture)}},symbolSDF:function(s,c){return{u_is_size_zoom_constant:new o.Uniform1i(s,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(s,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(s,c.u_size_t),u_size:new o.Uniform1f(s,c.u_size),u_camera_to_center_distance:new o.Uniform1f(s,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(s,c.u_pitch),u_rotate_symbol:new o.Uniform1i(s,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(s,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(s,c.u_fade_change),u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(s,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(s,c.u_coord_matrix),u_is_text:new o.Uniform1i(s,c.u_is_text),u_pitch_with_map:new o.Uniform1i(s,c.u_pitch_with_map),u_texsize:new o.Uniform2f(s,c.u_texsize),u_texture:new o.Uniform1i(s,c.u_texture),u_gamma_scale:new o.Uniform1f(s,c.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(s,c.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(s,c.u_is_halo)}},symbolTextAndIcon:function(s,c){return{u_is_size_zoom_constant:new o.Uniform1i(s,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(s,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(s,c.u_size_t),u_size:new o.Uniform1f(s,c.u_size),u_camera_to_center_distance:new o.Uniform1f(s,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(s,c.u_pitch),u_rotate_symbol:new o.Uniform1i(s,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(s,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(s,c.u_fade_change),u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(s,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(s,c.u_coord_matrix),u_is_text:new o.Uniform1i(s,c.u_is_text),u_pitch_with_map:new o.Uniform1i(s,c.u_pitch_with_map),u_texsize:new o.Uniform2f(s,c.u_texsize),u_texsize_icon:new o.Uniform2f(s,c.u_texsize_icon),u_texture:new o.Uniform1i(s,c.u_texture),u_texture_icon:new o.Uniform1i(s,c.u_texture_icon),u_gamma_scale:new o.Uniform1f(s,c.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(s,c.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(s,c.u_is_halo)}},background:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_opacity:new o.Uniform1f(s,c.u_opacity),u_color:new o.UniformColor(s,c.u_color)}},backgroundPattern:function(s,c){return{u_matrix:new o.UniformMatrix4f(s,c.u_matrix),u_opacity:new o.Uniform1f(s,c.u_opacity),u_image:new o.Uniform1i(s,c.u_image),u_pattern_tl_a:new o.Uniform2f(s,c.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(s,c.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(s,c.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(s,c.u_pattern_br_b),u_texsize:new o.Uniform2f(s,c.u_texsize),u_mix:new o.Uniform1f(s,c.u_mix),u_pattern_size_a:new o.Uniform2f(s,c.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(s,c.u_pattern_size_b),u_scale_a:new o.Uniform1f(s,c.u_scale_a),u_scale_b:new o.Uniform1f(s,c.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(s,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(s,c.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(s,c.u_tile_units_to_pixels)}}};function Is(s,c,l,d,g,x,w){for(var P=s.context,A=P.gl,j=s.useProgram("collisionBox"),Z=[],X=0,Q=0,pe=0;pe<d.length;pe++){var se=d[pe],ye=c.getTile(se),ae=ye.getBucket(l);if(ae){var ge=se.posMatrix;g[0]===0&&g[1]===0||(ge=s.translatePosMatrix(se.posMatrix,ye,g,x));var Ee=w?ae.textCollisionBox:ae.iconCollisionBox,Ie=ae.collisionCircleArray;if(Ie.length>0){var je=o.create(),ke=ge;o.mul(je,ae.placementInvProjMatrix,s.transform.glCoordMatrix),o.mul(je,je,ae.placementViewportMatrix),Z.push({circleArray:Ie,circleOffset:Q,transform:ke,invTransform:je}),Q=X+=Ie.length/4}Ee&&j.draw(P,A.LINES,te.disabled,ue.disabled,s.colorModeForRenderPass(),Se.disabled,Ho(ge,s.transform,ye),l.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,null,s.transform.zoom,null,null,Ee.collisionVertexBuffer)}}if(w&&Z.length){var Be=s.useProgram("collisionCircle"),qe=new o.StructArrayLayout2f1f2i16;qe.resize(4*X),qe._trim();for(var Ke=0,Xe=0,at=Z;Xe<at.length;Xe+=1)for(var bt=at[Xe],Pt=0;Pt<bt.circleArray.length/4;Pt++){var St=4*Pt,mr=bt.circleArray[St+0],st=bt.circleArray[St+1],Nt=bt.circleArray[St+2],Ht=bt.circleArray[St+3];qe.emplace(Ke++,mr,st,Nt,Ht,0),qe.emplace(Ke++,mr,st,Nt,Ht,1),qe.emplace(Ke++,mr,st,Nt,Ht,2),qe.emplace(Ke++,mr,st,Nt,Ht,3)}(!xu||xu.length<2*X)&&(xu=function(ln){var ii=2*ln,$n=new o.StructArrayLayout3ui6;$n.resize(ii),$n._trim();for(var rn=0;rn<ii;rn++){var mn=6*rn;$n.uint16[mn+0]=4*rn+0,$n.uint16[mn+1]=4*rn+1,$n.uint16[mn+2]=4*rn+2,$n.uint16[mn+3]=4*rn+2,$n.uint16[mn+4]=4*rn+3,$n.uint16[mn+5]=4*rn+0}return $n}(X));for(var zt=P.createIndexBuffer(xu,!0),Lt=P.createVertexBuffer(qe,o.collisionCircleLayout.members,!0),qt=0,At=Z;qt<At.length;qt+=1){var Ot=At[qt],Ln=Qh(Ot.transform,Ot.invTransform,s.transform);Be.draw(P,A.TRIANGLES,te.disabled,ue.disabled,s.colorModeForRenderPass(),Se.disabled,Ln,l.id,Lt,zt,o.SegmentVector.simpleSegment(0,2*Ot.circleOffset,Ot.circleArray.length,Ot.circleArray.length/2),null,s.transform.zoom,null,null,null)}Lt.destroy(),zt.destroy()}}var fa=o.identity(new Float32Array(16));function id(s,c,l,d,g,x){var w=o.getAnchorAlignment(s),P=-(w.horizontalAlign-.5)*c,A=-(w.verticalAlign-.5)*l,j=o.evaluateVariableOffset(s,d);return new o.Point((P/g+j[0])*x,(A/g+j[1])*x)}function ad(s,c,l,d,g,x,w,P,A,j,Z){var X=s.text.placedSymbolArray,Q=s.text.dynamicLayoutVertexArray,pe=s.icon.dynamicLayoutVertexArray,se={};Q.clear();for(var ye=0;ye<X.length;ye++){var ae=X.get(ye),ge=ae.hidden||!ae.crossTileID||s.allowVerticalPlacement&&!ae.placedOrientation?null:d[ae.crossTileID];if(ge){var Ee=new o.Point(ae.anchorX,ae.anchorY),Ie=Ut(Ee,l?P:w),je=Qt(x.cameraToCenterDistance,Ie.signedDistanceFromCamera),ke=g.evaluateSizeForFeature(s.textSizeData,j,ae)*je/o.ONE_EM;l&&(ke*=s.tilePixelRatio/A);for(var Be=id(ge.anchor,ge.width,ge.height,ge.textOffset,ge.textBoxScale,ke),qe=l?Ut(Ee.add(Be),w).point:Ie.point.add(c?Be.rotate(-x.angle):Be),Ke=s.allowVerticalPlacement&&ae.placedOrientation===o.WritingMode.vertical?Math.PI/2:0,Xe=0;Xe<ae.numGlyphs;Xe++)o.addDynamicAttributes(Q,qe,Ke);Z&&ae.associatedIconIndex>=0&&(se[ae.associatedIconIndex]={shiftedAnchor:qe,angle:Ke})}else Dn(ae.numGlyphs,Q)}if(Z){pe.clear();for(var at=s.icon.placedSymbolArray,bt=0;bt<at.length;bt++){var Pt=at.get(bt);if(Pt.hidden)Dn(Pt.numGlyphs,pe);else{var St=se[bt];if(St)for(var mr=0;mr<Pt.numGlyphs;mr++)o.addDynamicAttributes(pe,St.shiftedAnchor,St.angle);else Dn(Pt.numGlyphs,pe)}}s.icon.dynamicLayoutVertexBuffer.updateData(pe)}s.text.dynamicLayoutVertexBuffer.updateData(Q)}function od(s,c,l){return l.iconsInText&&c?"symbolTextAndIcon":s?"symbolSDF":"symbolIcon"}function Xo(s,c,l,d,g,x,w,P,A,j,Z,X){for(var Q=s.context,pe=Q.gl,se=s.transform,ye=P==="map",ae=A==="map",ge=ye&&l.layout.get("symbol-placement")!=="point",Ee=ye&&!ae&&!ge,Ie=l.layout.get("symbol-sort-key").constantOr(1)!==void 0,je=!1,ke=s.depthModeForSublayer(0,te.ReadOnly),Be=l.layout.get("text-variable-anchor"),qe=[],Ke=0,Xe=d;Ke<Xe.length;Ke+=1){var at=Xe[Ke],bt=c.getTile(at),Pt=bt.getBucket(l);if(Pt){var St=g?Pt.text:Pt.icon;if(St&&St.segments.get().length){var mr=St.programConfigurations.get(l.id),st=g||Pt.sdfIcons,Nt=g?Pt.textSizeData:Pt.iconSizeData,Ht=ae||se.pitch!==0,zt=s.useProgram(od(st,g,Pt),mr),Lt=o.evaluateSizeForZoom(Nt,se.zoom),qt=void 0,At=[0,0],Ot=void 0,Ln=void 0,ln=null,ii=void 0;if(g)Ot=bt.glyphAtlasTexture,Ln=pe.LINEAR,qt=bt.glyphAtlasTexture.size,Pt.iconsInText&&(At=bt.imageAtlasTexture.size,ln=bt.imageAtlasTexture,ii=Ht||s.options.rotating||s.options.zooming||Nt.kind==="composite"||Nt.kind==="camera"?pe.LINEAR:pe.NEAREST);else{var $n=l.layout.get("icon-size").constantOr(0)!==1||Pt.iconsNeedLinear;Ot=bt.imageAtlasTexture,Ln=st||s.options.rotating||s.options.zooming||$n||Ht?pe.LINEAR:pe.NEAREST,qt=bt.imageAtlasTexture.size}var rn=Fr(bt,1,s.transform.zoom),mn=Or(at.posMatrix,ae,ye,s.transform,rn),Di=gr(at.posMatrix,ae,ye,s.transform,rn),fi=Be&&Pt.hasTextData(),bo=l.layout.get("icon-text-fit")!=="none"&&fi&&Pt.hasIconData();ge&&no(Pt,at.posMatrix,s,g,mn,Di,ae,j);var _i=s.translatePosMatrix(at.posMatrix,bt,x,w),_a=ge||g&&Be||bo?fa:mn,la=s.translatePosMatrix(Di,bt,x,w,!0),El=st&&l.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Ds={program:zt,buffers:St,uniformValues:st?Pt.iconsInText?wu(Nt.kind,Lt,Ee,ae,s,_i,_a,la,qt,At):pl(Nt.kind,Lt,Ee,ae,s,_i,_a,la,g,qt,!0):Ts(Nt.kind,Lt,Ee,ae,s,_i,_a,la,g,qt),atlasTexture:Ot,atlasTextureIcon:ln,atlasInterpolation:Ln,atlasInterpolationIcon:ii,isSDF:st,hasHalo:El};if(Ie&&Pt.canOverlap){je=!0;for(var xo=0,Ls=St.segments.get();xo<Ls.length;xo+=1){var Pl=Ls[xo];qe.push({segments:new o.SegmentVector([Pl]),sortKey:Pl.sortKey,state:Ds})}}else qe.push({segments:St.segments,sortKey:0,state:Ds})}}}je&&qe.sort(function(wo,ts){return wo.sortKey-ts.sortKey});for(var Oa=0,Tl=qe;Oa<Tl.length;Oa+=1){var Ra=Tl[Oa],zn=Ra.state;if(Q.activeTexture.set(pe.TEXTURE0),zn.atlasTexture.bind(zn.atlasInterpolation,pe.CLAMP_TO_EDGE),zn.atlasTextureIcon&&(Q.activeTexture.set(pe.TEXTURE1),zn.atlasTextureIcon&&zn.atlasTextureIcon.bind(zn.atlasInterpolationIcon,pe.CLAMP_TO_EDGE)),zn.isSDF){var $a=zn.uniformValues;zn.hasHalo&&($a.u_is_halo=1,dl(zn.buffers,Ra.segments,l,s,zn.program,ke,Z,X,$a)),$a.u_is_halo=0}dl(zn.buffers,Ra.segments,l,s,zn.program,ke,Z,X,zn.uniformValues)}}function dl(s,c,l,d,g,x,w,P,A){var j=d.context;g.draw(j,j.gl.TRIANGLES,x,w,P,Se.disabled,A,l.id,s.layoutVertexBuffer,s.indexBuffer,c,l.paint,d.transform.zoom,s.programConfigurations.get(l.id),s.dynamicLayoutVertexBuffer,s.opacityVertexBuffer)}function Su(s,c,l,d,g,x,w){var P,A,j,Z,X,Q=s.context.gl,pe=l.paint.get("fill-pattern"),se=pe&&pe.constantOr(1),ye=l.getCrossfadeParameters();w?(A=se&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",P=Q.LINES):(A=se?"fillPattern":"fill",P=Q.TRIANGLES);for(var ae=0,ge=d;ae<ge.length;ae+=1){var Ee=ge[ae],Ie=c.getTile(Ee);if(!se||Ie.patternsLoaded()){var je=Ie.getBucket(l);if(je){var ke=je.programConfigurations.get(l.id),Be=s.useProgram(A,ke);se&&(s.context.activeTexture.set(Q.TEXTURE0),Ie.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),ke.updatePaintBuffers(ye));var qe=pe.constantOr(null);if(qe&&Ie.imageAtlas){var Ke=Ie.imageAtlas,Xe=Ke.patternPositions[qe.to.toString()],at=Ke.patternPositions[qe.from.toString()];Xe&&at&&ke.setConstantPatternPositions(Xe,at)}var bt=s.translatePosMatrix(Ee.posMatrix,Ie,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor"));if(w){Z=je.indexBuffer2,X=je.segments2;var Pt=[Q.drawingBufferWidth,Q.drawingBufferHeight];j=A==="fillOutlinePattern"&&se?Jh(bt,s,ye,Ie,Pt):Yh(bt,Pt)}else Z=je.indexBuffer,X=je.segments,j=se?Wo(bt,s,ye,Ie):fo(bt);Be.draw(s.context,P,g,s.stencilModeForClipping(Ee),x,Se.disabled,j,l.id,je.layoutVertexBuffer,Z,X,l.paint,s.transform.zoom,ke)}}}}function Xc(s,c,l,d,g,x,w){for(var P=s.context,A=P.gl,j=l.paint.get("fill-extrusion-pattern"),Z=j.constantOr(1),X=l.getCrossfadeParameters(),Q=l.paint.get("fill-extrusion-opacity"),pe=0,se=d;pe<se.length;pe+=1){var ye=se[pe],ae=c.getTile(ye),ge=ae.getBucket(l);if(ge){var Ee=ge.programConfigurations.get(l.id),Ie=s.useProgram(Z?"fillExtrusionPattern":"fillExtrusion",Ee);Z&&(s.context.activeTexture.set(A.TEXTURE0),ae.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),Ee.updatePaintBuffers(X));var je=j.constantOr(null);if(je&&ae.imageAtlas){var ke=ae.imageAtlas,Be=ke.patternPositions[je.to.toString()],qe=ke.patternPositions[je.from.toString()];Be&&qe&&Ee.setConstantPatternPositions(Be,qe)}var Ke=s.translatePosMatrix(ye.posMatrix,ae,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Xe=l.paint.get("fill-extrusion-vertical-gradient"),at=Z?$o(Ke,s,Xe,Q,ye,X,ae):Kh(Ke,s,Xe,Q);Ie.draw(P,P.gl.TRIANGLES,g,x,w,Se.backCCW,at,l.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,l.paint,s.transform.zoom,Ee)}}}function Eu(s,c,l,d,g,x){var w=s.context,P=w.gl,A=c.fbo;if(A){var j=s.useProgram("hillshade");w.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,A.colorAttachment.get());var Z=function(X,Q,pe){var se=pe.paint.get("hillshade-shadow-color"),ye=pe.paint.get("hillshade-highlight-color"),ae=pe.paint.get("hillshade-accent-color"),ge=pe.paint.get("hillshade-illumination-direction")*(Math.PI/180);pe.paint.get("hillshade-illumination-anchor")==="viewport"&&(ge-=X.transform.angle);var Ee,Ie,je,ke=!X.options.moving;return{u_matrix:X.transform.calculatePosMatrix(Q.tileID.toUnwrapped(),ke),u_image:0,u_latrange:(Ee=Q.tileID,Ie=Math.pow(2,Ee.canonical.z),je=Ee.canonical.y,[new o.MercatorCoordinate(0,je/Ie).toLngLat().lat,new o.MercatorCoordinate(0,(je+1)/Ie).toLngLat().lat]),u_light:[pe.paint.get("hillshade-exaggeration"),ge],u_shadow:se,u_highlight:ye,u_accent:ae}}(s,c,l);j.draw(w,P.TRIANGLES,d,g,x,Se.disabled,Z,l.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments)}}function Im(s,c,l,d,g,x){var w=s.context,P=w.gl,A=c.dem;if(A&&A.data){var j=A.dim,Z=A.stride,X=A.getPixels();if(w.activeTexture.set(P.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||s.getTileTexture(Z),c.demTexture){var Q=c.demTexture;Q.update(X,{premultiply:!1}),Q.bind(P.NEAREST,P.CLAMP_TO_EDGE)}else c.demTexture=new o.Texture(w,X,P.RGBA,{premultiply:!1}),c.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE);w.activeTexture.set(P.TEXTURE0);var pe=c.fbo;if(!pe){var se=new o.Texture(w,{width:j,height:j,data:null},P.RGBA);se.bind(P.LINEAR,P.CLAMP_TO_EDGE),(pe=c.fbo=w.createFramebuffer(j,j,!0)).colorAttachment.set(se.texture)}w.bindFramebuffer.set(pe.framebuffer),w.viewport.set([0,0,j,j]),s.useProgram("hillshadePrepare").draw(w,P.TRIANGLES,d,g,x,Se.disabled,function(ye,ae){var ge=ae.stride,Ee=o.create();return o.ortho(Ee,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(Ee,Ee,[0,-o.EXTENT,0]),{u_matrix:Ee,u_image:1,u_dimension:[ge,ge],u_zoom:ye.overscaledZ,u_unpack:ae.getUnpackVector()}}(c.tileID,A),l.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments),c.needsHillshadePrepare=!1}}function Pu(s,c,l,d,g){var x=d.paint.get("raster-fade-duration");if(x>0){var w=o.browser.now(),P=(w-s.timeAdded)/x,A=c?(w-c.timeAdded)/x:-1,j=l.getSource(),Z=g.coveringZoomLevel({tileSize:j.tileSize,roundZoom:j.roundZoom}),X=!c||Math.abs(c.tileID.overscaledZ-Z)>Math.abs(s.tileID.overscaledZ-Z),Q=X&&s.refreshedUponExpiration?1:o.clamp(X?P:1-A,0,1);return s.refreshedUponExpiration&&P>=1&&(s.refreshedUponExpiration=!1),c?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}var Kc=new o.Color(1,0,0,1),sd=new o.Color(0,1,0,1),ld=new o.Color(0,0,1,1),Tu=new o.Color(1,0,1,1),Yc=new o.Color(0,1,1,1);function Jc(s,c,l,d){fl(s,0,c+l/2,s.transform.width,l,d)}function Qc(s,c,l,d){fl(s,c-l/2,0,l,s.transform.height,d)}function fl(s,c,l,d,g,x){var w=s.context,P=w.gl;P.enable(P.SCISSOR_TEST),P.scissor(c*o.browser.devicePixelRatio,l*o.browser.devicePixelRatio,d*o.browser.devicePixelRatio,g*o.browser.devicePixelRatio),w.clear({color:x}),P.disable(P.SCISSOR_TEST)}function ud(s,c,l){var d=s.context,g=d.gl,x=l.posMatrix,w=s.useProgram("debug"),P=te.disabled,A=ue.disabled,j=s.colorModeForRenderPass();d.activeTexture.set(g.TEXTURE0),s.emptyTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),w.draw(d,g.LINE_STRIP,P,A,j,Se.disabled,Zo(x,o.Color.red),"$debug",s.debugBuffer,s.tileBorderIndexBuffer,s.debugSegments);var Z=c.getTileByID(l.key).latestRawTileData,X=Math.floor((Z&&Z.byteLength||0)/1024),Q=c.getTile(l).tileSize,pe=512/Math.min(Q,512)*(l.overscaledZ/s.transform.zoom)*.5,se=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(se+=" => "+l.overscaledZ),function(ye,ae){ye.initDebugOverlayCanvas();var ge=ye.debugOverlayCanvas,Ee=ye.context.gl,Ie=ye.debugOverlayCanvas.getContext("2d");Ie.clearRect(0,0,ge.width,ge.height),Ie.shadowColor="white",Ie.shadowBlur=2,Ie.lineWidth=1.5,Ie.strokeStyle="white",Ie.textBaseline="top",Ie.font="bold 36px Open Sans, sans-serif",Ie.fillText(ae,5,5),Ie.strokeText(ae,5,5),ye.debugOverlayTexture.update(ge),ye.debugOverlayTexture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE)}(s,se+" "+X+"kb"),w.draw(d,g.TRIANGLES,P,A,xe.alphaBlended,Se.disabled,Zo(x,o.Color.transparent,pe),"$debug",s.debugBuffer,s.quadTriangleIndexBuffer,s.debugSegments)}var Ko={symbol:function(s,c,l,d,g){if(s.renderPass==="translucent"){var x=ue.disabled,w=s.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(P,A,j,Z,X,Q,pe){for(var se=A.transform,ye=X==="map",ae=Q==="map",ge=0,Ee=P;ge<Ee.length;ge+=1){var Ie=Ee[ge],je=Z.getTile(Ie),ke=je.getBucket(j);if(ke&&ke.text&&ke.text.segments.get().length){var Be=o.evaluateSizeForZoom(ke.textSizeData,se.zoom),qe=Fr(je,1,A.transform.zoom),Ke=Or(Ie.posMatrix,ae,ye,A.transform,qe),Xe=j.layout.get("icon-text-fit")!=="none"&&ke.hasIconData();if(Be){var at=Math.pow(2,se.zoom-je.tileID.overscaledZ);ad(ke,ye,ae,pe,o.symbolSize,se,Ke,Ie.posMatrix,at,Be,Xe)}}}}(d,s,l,c,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),g),l.paint.get("icon-opacity").constantOr(1)!==0&&Xo(s,c,l,d,!1,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),l.layout.get("icon-rotation-alignment"),l.layout.get("icon-pitch-alignment"),l.layout.get("icon-keep-upright"),x,w),l.paint.get("text-opacity").constantOr(1)!==0&&Xo(s,c,l,d,!0,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),l.layout.get("text-keep-upright"),x,w),c.map.showCollisionBoxes&&(Is(s,c,l,d,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),Is(s,c,l,d,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))}},circle:function(s,c,l,d){if(s.renderPass==="translucent"){var g=l.paint.get("circle-opacity"),x=l.paint.get("circle-stroke-width"),w=l.paint.get("circle-stroke-opacity"),P=l.layout.get("circle-sort-key").constantOr(1)!==void 0;if(g.constantOr(1)!==0||x.constantOr(1)!==0&&w.constantOr(1)!==0){for(var A=s.context,j=A.gl,Z=s.depthModeForSublayer(0,te.ReadOnly),X=ue.disabled,Q=s.colorModeForRenderPass(),pe=[],se=0;se<d.length;se++){var ye=d[se],ae=c.getTile(ye),ge=ae.getBucket(l);if(ge){var Ee=ge.programConfigurations.get(l.id),Ie={programConfiguration:Ee,program:s.useProgram("circle",Ee),layoutVertexBuffer:ge.layoutVertexBuffer,indexBuffer:ge.indexBuffer,uniformValues:Gc(s,ye,ae,l)};if(P)for(var je=0,ke=ge.segments.get();je<ke.length;je+=1){var Be=ke[je];pe.push({segments:new o.SegmentVector([Be]),sortKey:Be.sortKey,state:Ie})}else pe.push({segments:ge.segments,sortKey:0,state:Ie})}}P&&pe.sort(function(bt,Pt){return bt.sortKey-Pt.sortKey});for(var qe=0,Ke=pe;qe<Ke.length;qe+=1){var Xe=Ke[qe],at=Xe.state;at.program.draw(A,j.TRIANGLES,Z,X,Q,Se.disabled,at.uniformValues,l.id,at.layoutVertexBuffer,at.indexBuffer,Xe.segments,l.paint,s.transform.zoom,at.programConfiguration)}}}},heatmap:function(s,c,l,d){if(l.paint.get("heatmap-opacity")!==0)if(s.renderPass==="offscreen"){var g=s.context,x=g.gl,w=ue.disabled,P=new xe([x.ONE,x.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(pe,se,ye){var ae=pe.gl;pe.activeTexture.set(ae.TEXTURE1),pe.viewport.set([0,0,se.width/4,se.height/4]);var ge=ye.heatmapFbo;if(ge)ae.bindTexture(ae.TEXTURE_2D,ge.colorAttachment.get()),pe.bindFramebuffer.set(ge.framebuffer);else{var Ee=ae.createTexture();ae.bindTexture(ae.TEXTURE_2D,Ee),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_S,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_T,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MIN_FILTER,ae.LINEAR),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MAG_FILTER,ae.LINEAR),ge=ye.heatmapFbo=pe.createFramebuffer(se.width/4,se.height/4,!1),function(Ie,je,ke,Be){var qe=Ie.gl;qe.texImage2D(qe.TEXTURE_2D,0,qe.RGBA,je.width/4,je.height/4,0,qe.RGBA,Ie.extRenderToTextureHalfFloat?Ie.extTextureHalfFloat.HALF_FLOAT_OES:qe.UNSIGNED_BYTE,null),Be.colorAttachment.set(ke)}(pe,se,Ee,ge)}})(g,s,l),g.clear({color:o.Color.transparent});for(var A=0;A<d.length;A++){var j=d[A];if(!c.hasRenderableParent(j)){var Z=c.getTile(j),X=Z.getBucket(l);if(X){var Q=X.programConfigurations.get(l.id);s.useProgram("heatmap",Q).draw(g,x.TRIANGLES,te.disabled,w,P,Se.disabled,ed(j.posMatrix,Z,s.transform.zoom,l.paint.get("heatmap-intensity")),l.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,l.paint,s.transform.zoom,Q)}}}g.viewport.set([0,0,s.width,s.height])}else s.renderPass==="translucent"&&(s.context.setColorMode(s.colorModeForRenderPass()),function(pe,se){var ye=pe.context,ae=ye.gl,ge=se.heatmapFbo;if(ge){ye.activeTexture.set(ae.TEXTURE0),ae.bindTexture(ae.TEXTURE_2D,ge.colorAttachment.get()),ye.activeTexture.set(ae.TEXTURE1);var Ee=se.colorRampTexture;Ee||(Ee=se.colorRampTexture=new o.Texture(ye,se.colorRamp,ae.RGBA)),Ee.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),pe.useProgram("heatmapTexture").draw(ye,ae.TRIANGLES,te.disabled,ue.disabled,pe.colorModeForRenderPass(),Se.disabled,function(Ie,je,ke,Be){var qe=o.create();o.ortho(qe,0,Ie.width,Ie.height,0,0,1);var Ke=Ie.context.gl;return{u_matrix:qe,u_world:[Ke.drawingBufferWidth,Ke.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:je.paint.get("heatmap-opacity")}}(pe,se),se.id,pe.viewportBuffer,pe.quadTriangleIndexBuffer,pe.viewportSegments,se.paint,pe.transform.zoom)}}(s,l))},line:function(s,c,l,d){if(s.renderPass==="translucent"){var g=l.paint.get("line-opacity"),x=l.paint.get("line-width");if(g.constantOr(1)!==0&&x.constantOr(1)!==0)for(var w=s.depthModeForSublayer(0,te.ReadOnly),P=s.colorModeForRenderPass(),A=l.paint.get("line-dasharray"),j=l.paint.get("line-pattern"),Z=j.constantOr(1),X=l.paint.get("line-gradient"),Q=l.getCrossfadeParameters(),pe=Z?"linePattern":A?"lineSDF":X?"lineGradient":"line",se=s.context,ye=se.gl,ae=!0,ge=0,Ee=d;ge<Ee.length;ge+=1){var Ie=Ee[ge],je=c.getTile(Ie);if(!Z||je.patternsLoaded()){var ke=je.getBucket(l);if(ke){var Be=ke.programConfigurations.get(l.id),qe=s.context.program.get(),Ke=s.useProgram(pe,Be),Xe=ae||Ke.program!==qe,at=j.constantOr(null);if(at&&je.imageAtlas){var bt=je.imageAtlas,Pt=bt.patternPositions[at.to.toString()],St=bt.patternPositions[at.from.toString()];Pt&&St&&Be.setConstantPatternPositions(Pt,St)}var mr=Z?bu(s,je,l,Q):A?Tm(s,je,l,A,Q):X?Ur(s,je,l,ke.lineClipsArray.length):cl(s,je,l);if(Z)se.activeTexture.set(ye.TEXTURE0),je.imageAtlasTexture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),Be.updatePaintBuffers(Q);else if(A&&(Xe||s.lineAtlas.dirty))se.activeTexture.set(ye.TEXTURE0),s.lineAtlas.bind(se);else if(X){var st=ke.gradients[l.id],Nt=st.texture;if(l.gradientVersion!==st.version){var Ht=256;if(l.stepInterpolant){var zt=c.getSource().maxzoom,Lt=Ie.canonical.z===zt?Math.ceil(1<<s.transform.maxZoom-Ie.canonical.z):1;Ht=o.clamp(o.nextPowerOfTwo(ke.maxLineLength/o.EXTENT*1024*Lt),256,se.maxTextureSize)}st.gradient=o.renderColorRamp({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:Ht,image:st.gradient||void 0,clips:ke.lineClipsArray}),st.texture?st.texture.update(st.gradient):st.texture=new o.Texture(se,st.gradient,ye.RGBA),st.version=l.gradientVersion,Nt=st.texture}se.activeTexture.set(ye.TEXTURE0),Nt.bind(l.stepInterpolant?ye.NEAREST:ye.LINEAR,ye.CLAMP_TO_EDGE)}Ke.draw(se,ye.TRIANGLES,w,s.stencilModeForClipping(Ie),P,Se.disabled,mr,l.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,l.paint,s.transform.zoom,Be,ke.layoutVertexBuffer2),ae=!1}}}}},fill:function(s,c,l,d){var g=l.paint.get("fill-color"),x=l.paint.get("fill-opacity");if(x.constantOr(1)!==0){var w=s.colorModeForRenderPass(),P=l.paint.get("fill-pattern"),A=s.opaquePassEnabledForLayer()&&!P.constantOr(1)&&g.constantOr(o.Color.transparent).a===1&&x.constantOr(0)===1?"opaque":"translucent";if(s.renderPass===A){var j=s.depthModeForSublayer(1,s.renderPass==="opaque"?te.ReadWrite:te.ReadOnly);Su(s,c,l,d,j,w,!1)}if(s.renderPass==="translucent"&&l.paint.get("fill-antialias")){var Z=s.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,te.ReadOnly);Su(s,c,l,d,Z,w,!0)}}},"fill-extrusion":function(s,c,l,d){var g=l.paint.get("fill-extrusion-opacity");if(g!==0&&s.renderPass==="translucent"){var x=new te(s.context.gl.LEQUAL,te.ReadWrite,s.depthRangeFor3D);if(g!==1||l.paint.get("fill-extrusion-pattern").constantOr(1))Xc(s,c,l,d,x,ue.disabled,xe.disabled),Xc(s,c,l,d,x,s.stencilModeFor3D(),s.colorModeForRenderPass());else{var w=s.colorModeForRenderPass();Xc(s,c,l,d,x,ue.disabled,w)}}},hillshade:function(s,c,l,d){if(s.renderPass==="offscreen"||s.renderPass==="translucent"){for(var g=s.context,x=s.depthModeForSublayer(0,te.ReadOnly),w=s.colorModeForRenderPass(),P=s.renderPass==="translucent"?s.stencilConfigForOverlap(d):[{},d],A=P[0],j=0,Z=P[1];j<Z.length;j+=1){var X=Z[j],Q=c.getTile(X);Q.needsHillshadePrepare&&s.renderPass==="offscreen"?Im(s,Q,l,x,ue.disabled,w):s.renderPass==="translucent"&&Eu(s,Q,l,x,A[X.overscaledZ],w)}g.viewport.set([0,0,s.width,s.height])}},raster:function(s,c,l,d){if(s.renderPass==="translucent"&&l.paint.get("raster-opacity")!==0&&d.length)for(var g=s.context,x=g.gl,w=c.getSource(),P=s.useProgram("raster"),A=s.colorModeForRenderPass(),j=w instanceof Kt?[{},d]:s.stencilConfigForOverlap(d),Z=j[0],X=j[1],Q=X[X.length-1].overscaledZ,pe=!s.options.moving,se=0,ye=X;se<ye.length;se+=1){var ae=ye[se],ge=s.depthModeForSublayer(ae.overscaledZ-Q,l.paint.get("raster-opacity")===1?te.ReadWrite:te.ReadOnly,x.LESS),Ee=c.getTile(ae),Ie=s.transform.calculatePosMatrix(ae.toUnwrapped(),pe);Ee.registerFadeDuration(l.paint.get("raster-fade-duration"));var je=c.findLoadedParent(ae,0),ke=Pu(Ee,je,c,l,s.transform),Be=void 0,qe=void 0,Ke=l.paint.get("raster-resampling")==="nearest"?x.NEAREST:x.LINEAR;g.activeTexture.set(x.TEXTURE0),Ee.texture.bind(Ke,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST),g.activeTexture.set(x.TEXTURE1),je?(je.texture.bind(Ke,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST),Be=Math.pow(2,je.tileID.overscaledZ-Ee.tileID.overscaledZ),qe=[Ee.tileID.canonical.x*Be%1,Ee.tileID.canonical.y*Be%1]):Ee.texture.bind(Ke,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST);var Xe=Cm(Ie,qe||[0,0],Be||1,ke,l);w instanceof Kt?P.draw(g,x.TRIANGLES,ge,ue.disabled,A,Se.disabled,Xe,l.id,w.boundsBuffer,s.quadTriangleIndexBuffer,w.boundsSegments):P.draw(g,x.TRIANGLES,ge,Z[ae.overscaledZ],A,Se.disabled,Xe,l.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments)}},background:function(s,c,l){var d=l.paint.get("background-color"),g=l.paint.get("background-opacity");if(g!==0){var x=s.context,w=x.gl,P=s.transform,A=P.tileSize,j=l.paint.get("background-pattern");if(!s.isPatternMissing(j)){var Z=!j&&d.a===1&&g===1&&s.opaquePassEnabledForLayer()?"opaque":"translucent";if(s.renderPass===Z){var X=ue.disabled,Q=s.depthModeForSublayer(0,Z==="opaque"?te.ReadWrite:te.ReadOnly),pe=s.colorModeForRenderPass(),se=s.useProgram(j?"backgroundPattern":"background"),ye=P.coveringTiles({tileSize:A});j&&(x.activeTexture.set(w.TEXTURE0),s.imageManager.bind(s.context));for(var ae=l.getCrossfadeParameters(),ge=0,Ee=ye;ge<Ee.length;ge+=1){var Ie=Ee[ge],je=s.transform.calculatePosMatrix(Ie.toUnwrapped()),ke=j?Cs(je,g,s,j,{tileID:Ie,tileSize:A},ae):hl(je,g,d);se.draw(x,w.TRIANGLES,Q,X,pe,Se.disabled,ke,l.id,s.tileExtentBuffer,s.quadTriangleIndexBuffer,s.tileExtentSegments)}}}}},debug:function(s,c,l){for(var d=0;d<l.length;d++)ud(s,c,l[d])},custom:function(s,c,l){var d=s.context,g=l.implementation;if(s.renderPass==="offscreen"){var x=g.prerender;x&&(s.setCustomLayerDefaults(),d.setColorMode(s.colorModeForRenderPass()),x.call(g,d.gl,s.transform.customLayerMatrix()),d.setDirty(),s.setBaseState())}else if(s.renderPass==="translucent"){s.setCustomLayerDefaults(),d.setColorMode(s.colorModeForRenderPass()),d.setStencilMode(ue.disabled);var w=g.renderingMode==="3d"?new te(s.context.gl.LEQUAL,te.ReadWrite,s.depthRangeFor3D):s.depthModeForSublayer(0,te.ReadOnly);d.setDepthMode(w),g.render(d.gl,s.transform.customLayerMatrix()),d.setDirty(),s.setBaseState(),d.bindFramebuffer.set(null)}}},Gr=function(s,c){this.context=new G(s),this.transform=c,this._tileTextures={},this.setup(),this.numSublayers=he.maxUnderzooming+he.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new oo,this.gpuTimers={}};Gr.prototype.resize=function(s,c){if(this.width=s*o.browser.devicePixelRatio,this.height=c*o.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var l=0,d=this.style._order;l<d.length;l+=1)this.style._layers[d[l]].resize()},Gr.prototype.setup=function(){var s=this.context,c=new o.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(o.EXTENT,0),c.emplaceBack(0,o.EXTENT),c.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(c,Sn.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);var l=new o.StructArrayLayout2i4;l.emplaceBack(0,0),l.emplaceBack(o.EXTENT,0),l.emplaceBack(0,o.EXTENT),l.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=s.createVertexBuffer(l,Sn.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);var d=new o.StructArrayLayout4i8;d.emplaceBack(0,0,0,0),d.emplaceBack(o.EXTENT,0,o.EXTENT,0),d.emplaceBack(0,o.EXTENT,0,o.EXTENT),d.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=s.createVertexBuffer(d,Zt.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);var g=new o.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(g,Sn.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);var x=new o.StructArrayLayout1ui2;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(x);var w=new o.StructArrayLayout3ui6;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(w),this.emptyTexture=new o.Texture(s,{width:1,height:1,data:new Uint8Array([0,0,0,0])},s.gl.RGBA);var P=this.context.gl;this.stencilClearMode=new ue({func:P.ALWAYS,mask:0},0,255,P.ZERO,P.ZERO,P.ZERO)},Gr.prototype.clearStencil=function(){var s=this.context,c=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var l=o.create();o.ortho(l,0,this.width,this.height,0,0,1),o.scale(l,l,[c.drawingBufferWidth,c.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,c.TRIANGLES,te.disabled,this.stencilClearMode,xe.disabled,Se.disabled,Go(l),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Gr.prototype._renderTileClippingMasks=function(s,c){if(this.currentStencilSource!==s.source&&s.isTileClipped()&&c&&c.length){this.currentStencilSource=s.source;var l=this.context,d=l.gl;this.nextStencilID+c.length>256&&this.clearStencil(),l.setColorMode(xe.disabled),l.setDepthMode(te.disabled);var g=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var x=0,w=c;x<w.length;x+=1){var P=w[x],A=this._tileClippingMaskIDs[P.key]=this.nextStencilID++;g.draw(l,d.TRIANGLES,te.disabled,new ue({func:d.ALWAYS,mask:0},A,255,d.KEEP,d.KEEP,d.REPLACE),xe.disabled,Se.disabled,Go(P.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Gr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var s=this.nextStencilID++,c=this.context.gl;return new ue({func:c.NOTEQUAL,mask:255},s,255,c.KEEP,c.KEEP,c.REPLACE)},Gr.prototype.stencilModeForClipping=function(s){var c=this.context.gl;return new ue({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,c.KEEP,c.KEEP,c.REPLACE)},Gr.prototype.stencilConfigForOverlap=function(s){var c,l=this.context.gl,d=s.sort(function(A,j){return j.overscaledZ-A.overscaledZ}),g=d[d.length-1].overscaledZ,x=d[0].overscaledZ-g+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();for(var w={},P=0;P<x;P++)w[P+g]=new ue({func:l.GEQUAL,mask:255},P+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=x,[w,d]}return[(c={},c[g]=ue.disabled,c),d]},Gr.prototype.colorModeForRenderPass=function(){var s=this.context.gl;return this._showOverdrawInspector?new xe([s.CONSTANT_COLOR,s.ONE],new o.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?xe.unblended:xe.alphaBlended},Gr.prototype.depthModeForSublayer=function(s,c,l){if(!this.opaquePassEnabledForLayer())return te.disabled;var d=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new te(l||this.context.gl.LEQUAL,c,[d,d])},Gr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Gr.prototype.render=function(s,c){var l=this;this.style=s,this.options=c,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(o.browser.now()),this.imageManager.beginFrame();var d=this.style._order,g=this.style.sourceCaches;for(var x in g){var w=g[x];w.used&&w.prepare(this.context)}var P,A,j={},Z={},X={};for(var Q in g){var pe=g[Q];j[Q]=pe.getVisibleCoordinates(),Z[Q]=j[Q].slice().reverse(),X[Q]=pe.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var se=0;se<d.length;se++)if(this.style._layers[d[se]].is3D()){this.opaquePassCutoff=se;break}this.renderPass="offscreen";for(var ye=0,ae=d;ye<ae.length;ye+=1){var ge=this.style._layers[ae[ye]];if(ge.hasOffscreenPass()&&!ge.isHidden(this.transform.zoom)){var Ee=Z[ge.source];(ge.type==="custom"||Ee.length)&&this.renderLayer(this,g[ge.source],ge,Ee)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:c.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){var Ie=this.style._layers[d[this.currentLayer]],je=g[Ie.source],ke=j[Ie.source];this._renderTileClippingMasks(Ie,ke),this.renderLayer(this,je,Ie,ke)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){var Be=this.style._layers[d[this.currentLayer]],qe=g[Be.source],Ke=(Be.type==="symbol"?X:Z)[Be.source];this._renderTileClippingMasks(Be,j[Be.source]),this.renderLayer(this,qe,Be,Ke)}this.options.showTileBoundaries&&(o.values(this.style._layers).forEach(function(Xe){Xe.source&&!Xe.isHidden(l.transform.zoom)&&(Xe.source!==(A&&A.id)&&(A=l.style.sourceCaches[Xe.source]),(!P||P.getSource().maxzoom<A.getSource().maxzoom)&&(P=A))}),P&&Ko.debug(this,P,P.getVisibleCoordinates())),this.options.showPadding&&function(Xe){var at=Xe.transform.padding;Jc(Xe,Xe.transform.height-(at.top||0),3,Kc),Jc(Xe,at.bottom||0,3,sd),Qc(Xe,at.left||0,3,ld),Qc(Xe,Xe.transform.width-(at.right||0),3,Tu);var bt=Xe.transform.centerPoint;(function(Pt,St,mr,st){fl(Pt,St-1,mr-10,2,20,st),fl(Pt,St-10,mr-1,20,2,st)})(Xe,bt.x,Xe.transform.height-bt.y,Yc)}(this),this.context.setDefault()},Gr.prototype.renderLayer=function(s,c,l,d){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||d.length)&&(this.id=l.id,this.gpuTimingStart(l),Ko[l.type](s,c,l,d,this.style.placement.variableOffsets),this.gpuTimingEnd())},Gr.prototype.gpuTimingStart=function(s){if(this.options.gpuTiming){var c=this.context.extTimerQuery,l=this.gpuTimers[s.id];l||(l=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),l.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,l.query)}},Gr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}},Gr.prototype.collectGpuTimers=function(){var s=this.gpuTimers;return this.gpuTimers={},s},Gr.prototype.queryGpuTimers=function(s){var c={};for(var l in s){var d=s[l],g=this.context.extTimerQuery,x=g.getQueryObjectEXT(d.query,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(d.query),c[l]=x}return c},Gr.prototype.translatePosMatrix=function(s,c,l,d,g){if(!l[0]&&!l[1])return s;var x=g?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(x){var w=Math.sin(x),P=Math.cos(x);l=[l[0]*P-l[1]*w,l[0]*w+l[1]*P]}var A=[g?l[0]:Fr(c,l[0],this.transform.zoom),g?l[1]:Fr(c,l[1],this.transform.zoom),0],j=new Float32Array(16);return o.translate(j,s,A),j},Gr.prototype.saveTileTexture=function(s){var c=this._tileTextures[s.size[0]];c?c.push(s):this._tileTextures[s.size[0]]=[s]},Gr.prototype.getTileTexture=function(s){var c=this._tileTextures[s];return c&&c.length>0?c.pop():null},Gr.prototype.isPatternMissing=function(s){if(!s)return!1;if(!s.from||!s.to)return!0;var c=this.imageManager.getPattern(s.from.toString()),l=this.imageManager.getPattern(s.to.toString());return!c||!l},Gr.prototype.useProgram=function(s,c){this.cache=this.cache||{};var l=""+s+(c?c.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[l]||(this.cache[l]=new Gh(this.context,s,Pm[s],c,nd[s],this._showOverdrawInspector)),this.cache[l]},Gr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Gr.prototype.setBaseState=function(){var s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)},Gr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Gr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Cu=function(s,c){this.points=s,this.planes=c};Cu.fromInvProjectionMatrix=function(s,c,l){var d=Math.pow(2,l),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(w){return o.transformMat4([],w,s)}).map(function(w){return o.scale$1([],w,1/w[3]/c*d)}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(w){var P=o.sub([],g[w[0]],g[w[1]]),A=o.sub([],g[w[2]],g[w[1]]),j=o.normalize([],o.cross([],P,A)),Z=-o.dot(j,g[w[1]]);return j.concat(Z)});return new Cu(g,x)};var Yo=function(s,c){this.min=s,this.max=c,this.center=o.scale$2([],o.add([],this.min,this.max),.5)};Yo.prototype.quadrant=function(s){for(var c=[s%2==0,s<2],l=o.clone$2(this.min),d=o.clone$2(this.max),g=0;g<c.length;g++)l[g]=c[g]?this.min[g]:this.center[g],d[g]=c[g]?this.center[g]:this.max[g];return d[2]=this.max[2],new Yo(l,d)},Yo.prototype.distanceX=function(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]},Yo.prototype.distanceY=function(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]},Yo.prototype.intersects=function(s){for(var c=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],l=!0,d=0;d<s.planes.length;d++){for(var g=s.planes[d],x=0,w=0;w<c.length;w++)x+=o.dot$1(g,c[w])>=0;if(x===0)return 0;x!==c.length&&(l=!1)}if(l)return 2;for(var P=0;P<3;P++){for(var A=Number.MAX_VALUE,j=-Number.MAX_VALUE,Z=0;Z<s.points.length;Z++){var X=s.points[Z][P]-this.min[P];A=Math.min(A,X),j=Math.max(j,X)}if(j<0||A>this.max[P]-this.min[P])return 0}return 1};var mo=function(s,c,l,d){if(s===void 0&&(s=0),c===void 0&&(c=0),l===void 0&&(l=0),d===void 0&&(d=0),isNaN(s)||s<0||isNaN(c)||c<0||isNaN(l)||l<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=c,this.left=l,this.right=d};mo.prototype.interpolate=function(s,c,l){return c.top!=null&&s.top!=null&&(this.top=o.number(s.top,c.top,l)),c.bottom!=null&&s.bottom!=null&&(this.bottom=o.number(s.bottom,c.bottom,l)),c.left!=null&&s.left!=null&&(this.left=o.number(s.left,c.left,l)),c.right!=null&&s.right!=null&&(this.right=o.number(s.right,c.right,l)),this},mo.prototype.getCenter=function(s,c){var l=o.clamp((this.left+s-this.right)/2,0,s),d=o.clamp((this.top+c-this.bottom)/2,0,c);return new o.Point(l,d)},mo.prototype.equals=function(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right},mo.prototype.clone=function(){return new mo(this.top,this.bottom,this.left,this.right)},mo.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var ur=function(s,c,l,d,g){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=g===void 0||g,this._minZoom=s||0,this._maxZoom=c||22,this._minPitch=l??0,this._maxPitch=d??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new mo,this._posMatrixCache={},this._alignedPosMatrixCache={}},Vr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};ur.prototype.clone=function(){var s=new ur(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.tileSize=this.tileSize,s.latRange=this.latRange,s.width=this.width,s.height=this.height,s._center=this._center,s.zoom=this.zoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._calcMatrices(),s},Vr.minZoom.get=function(){return this._minZoom},Vr.minZoom.set=function(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))},Vr.maxZoom.get=function(){return this._maxZoom},Vr.maxZoom.set=function(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))},Vr.minPitch.get=function(){return this._minPitch},Vr.minPitch.set=function(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))},Vr.maxPitch.get=function(){return this._maxPitch},Vr.maxPitch.set=function(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))},Vr.renderWorldCopies.get=function(){return this._renderWorldCopies},Vr.renderWorldCopies.set=function(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s},Vr.worldSize.get=function(){return this.tileSize*this.scale},Vr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Vr.size.get=function(){return new o.Point(this.width,this.height)},Vr.bearing.get=function(){return-this.angle/Math.PI*180},Vr.bearing.set=function(s){var c=-o.wrap(s,-180,180)*Math.PI/180;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=o.create$2(),o.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Vr.pitch.get=function(){return this._pitch/Math.PI*180},Vr.pitch.set=function(s){var c=o.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())},Vr.fov.get=function(){return this._fov/Math.PI*180},Vr.fov.set=function(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())},Vr.zoom.get=function(){return this._zoom},Vr.zoom.set=function(s){var c=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._zoom=c,this.scale=this.zoomScale(c),this.tileZoom=Math.floor(c),this.zoomFraction=c-this.tileZoom,this._constrain(),this._calcMatrices())},Vr.center.get=function(){return this._center},Vr.center.set=function(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())},Vr.padding.get=function(){return this._edgeInsets.toJSON()},Vr.padding.set=function(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())},Vr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},ur.prototype.isPaddingEqual=function(s){return this._edgeInsets.equals(s)},ur.prototype.interpolatePadding=function(s,c,l){this._unmodified=!1,this._edgeInsets.interpolate(s,c,l),this._constrain(),this._calcMatrices()},ur.prototype.coveringZoomLevel=function(s){var c=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,c)},ur.prototype.getVisibleUnwrappedCoordinates=function(s){var c=[new o.UnwrappedTileID(0,s)];if(this._renderWorldCopies)for(var l=this.pointCoordinate(new o.Point(0,0)),d=this.pointCoordinate(new o.Point(this.width,0)),g=this.pointCoordinate(new o.Point(this.width,this.height)),x=this.pointCoordinate(new o.Point(0,this.height)),w=Math.floor(Math.min(l.x,d.x,g.x,x.x)),P=Math.floor(Math.max(l.x,d.x,g.x,x.x)),A=w-1;A<=P+1;A++)A!==0&&c.push(new o.UnwrappedTileID(A,s));return c},ur.prototype.coveringTiles=function(s){var c=this.coveringZoomLevel(s),l=c;if(s.minzoom!==void 0&&c<s.minzoom)return[];s.maxzoom!==void 0&&c>s.maxzoom&&(c=s.maxzoom);var d=o.MercatorCoordinate.fromLngLat(this.center),g=Math.pow(2,c),x=[g*d.x,g*d.y,0],w=Cu.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c),P=s.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(P=c);var A=function(Xe){return{aabb:new Yo([Xe*g,0,0],[(Xe+1)*g,g,0]),zoom:0,x:0,y:0,wrap:Xe,fullyVisible:!1}},j=[],Z=[],X=c,Q=s.reparseOverscaled?l:c;if(this._renderWorldCopies)for(var pe=1;pe<=3;pe++)j.push(A(-pe)),j.push(A(pe));for(j.push(A(0));j.length>0;){var se=j.pop(),ye=se.x,ae=se.y,ge=se.fullyVisible;if(!ge){var Ee=se.aabb.intersects(w);if(Ee===0)continue;ge=Ee===2}var Ie=se.aabb.distanceX(x),je=se.aabb.distanceY(x),ke=Math.max(Math.abs(Ie),Math.abs(je));if(se.zoom===X||ke>3+(1<<X-se.zoom)-2&&se.zoom>=P)Z.push({tileID:new o.OverscaledTileID(se.zoom===X?Q:se.zoom,se.wrap,se.zoom,ye,ae),distanceSq:o.sqrLen([x[0]-.5-ye,x[1]-.5-ae])});else for(var Be=0;Be<4;Be++){var qe=(ye<<1)+Be%2,Ke=(ae<<1)+(Be>>1);j.push({aabb:se.aabb.quadrant(Be),zoom:se.zoom+1,x:qe,y:Ke,wrap:se.wrap,fullyVisible:ge})}}return Z.sort(function(Xe,at){return Xe.distanceSq-at.distanceSq}).map(function(Xe){return Xe.tileID})},ur.prototype.resize=function(s,c){this.width=s,this.height=c,this.pixelsToGLUnits=[2/s,-2/c],this._constrain(),this._calcMatrices()},Vr.unmodified.get=function(){return this._unmodified},ur.prototype.zoomScale=function(s){return Math.pow(2,s)},ur.prototype.scaleZoom=function(s){return Math.log(s)/Math.LN2},ur.prototype.project=function(s){var c=o.clamp(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.Point(o.mercatorXfromLng(s.lng)*this.worldSize,o.mercatorYfromLat(c)*this.worldSize)},ur.prototype.unproject=function(s){return new o.MercatorCoordinate(s.x/this.worldSize,s.y/this.worldSize).toLngLat()},Vr.point.get=function(){return this.project(this.center)},ur.prototype.setLocationAtPoint=function(s,c){var l=this.pointCoordinate(c),d=this.pointCoordinate(this.centerPoint),g=this.locationCoordinate(s),x=new o.MercatorCoordinate(g.x-(l.x-d.x),g.y-(l.y-d.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())},ur.prototype.locationPoint=function(s){return this.coordinatePoint(this.locationCoordinate(s))},ur.prototype.pointLocation=function(s){return this.coordinateLocation(this.pointCoordinate(s))},ur.prototype.locationCoordinate=function(s){return o.MercatorCoordinate.fromLngLat(s)},ur.prototype.coordinateLocation=function(s){return s.toLngLat()},ur.prototype.pointCoordinate=function(s){var c=[s.x,s.y,0,1],l=[s.x,s.y,1,1];o.transformMat4(c,c,this.pixelMatrixInverse),o.transformMat4(l,l,this.pixelMatrixInverse);var d=c[3],g=l[3],x=c[1]/d,w=l[1]/g,P=c[2]/d,A=l[2]/g,j=P===A?0:(0-P)/(A-P);return new o.MercatorCoordinate(o.number(c[0]/d,l[0]/g,j)/this.worldSize,o.number(x,w,j)/this.worldSize)},ur.prototype.coordinatePoint=function(s){var c=[s.x*this.worldSize,s.y*this.worldSize,0,1];return o.transformMat4(c,c,this.pixelMatrix),new o.Point(c[0]/c[3],c[1]/c[3])},ur.prototype.getBounds=function(){return new o.LngLatBounds().extend(this.pointLocation(new o.Point(0,0))).extend(this.pointLocation(new o.Point(this.width,0))).extend(this.pointLocation(new o.Point(this.width,this.height))).extend(this.pointLocation(new o.Point(0,this.height)))},ur.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},ur.prototype.setMaxBounds=function(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},ur.prototype.calculatePosMatrix=function(s,c){c===void 0&&(c=!1);var l=s.key,d=c?this._alignedPosMatrixCache:this._posMatrixCache;if(d[l])return d[l];var g=s.canonical,x=this.worldSize/this.zoomScale(g.z),w=g.x+Math.pow(2,g.z)*s.wrap,P=o.identity(new Float64Array(16));return o.translate(P,P,[w*x,g.y*x,0]),o.scale(P,P,[x/o.EXTENT,x/o.EXTENT,1]),o.multiply(P,c?this.alignedProjMatrix:this.projMatrix,P),d[l]=new Float32Array(P),d[l]},ur.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},ur.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var s,c,l,d,g=-90,x=90,w=-180,P=180,A=this.size,j=this._unmodified;if(this.latRange){var Z=this.latRange;g=o.mercatorYfromLat(Z[1])*this.worldSize,s=(x=o.mercatorYfromLat(Z[0])*this.worldSize)-g<A.y?A.y/(x-g):0}if(this.lngRange){var X=this.lngRange;w=o.mercatorXfromLng(X[0])*this.worldSize,c=(P=o.mercatorXfromLng(X[1])*this.worldSize)-w<A.x?A.x/(P-w):0}var Q=this.point,pe=Math.max(c||0,s||0);if(pe)return this.center=this.unproject(new o.Point(c?(P+w)/2:Q.x,s?(x+g)/2:Q.y)),this.zoom+=this.scaleZoom(pe),this._unmodified=j,void(this._constraining=!1);if(this.latRange){var se=Q.y,ye=A.y/2;se-ye<g&&(d=g+ye),se+ye>x&&(d=x-ye)}if(this.lngRange){var ae=Q.x,ge=A.x/2;ae-ge<w&&(l=w+ge),ae+ge>P&&(l=P-ge)}l===void 0&&d===void 0||(this.center=this.unproject(new o.Point(l!==void 0?l:Q.x,d!==void 0?d:Q.y))),this._unmodified=j,this._constraining=!1}},ur.prototype._calcMatrices=function(){if(this.height){var s=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var c=Math.PI/2+this._pitch,l=this._fov*(.5+s.y/this.height),d=Math.sin(l)*this.cameraToCenterDistance/Math.sin(o.clamp(Math.PI-c-l,.01,Math.PI-.01)),g=this.point,x=g.x,w=g.y,P=1.01*(Math.cos(Math.PI/2-this._pitch)*d+this.cameraToCenterDistance),A=this.height/50,j=new Float64Array(16);o.perspective(j,this._fov,this.width/this.height,A,P),j[8]=2*-s.x/this.width,j[9]=2*s.y/this.height,o.scale(j,j,[1,-1,1]),o.translate(j,j,[0,0,-this.cameraToCenterDistance]),o.rotateX(j,j,this._pitch),o.rotateZ(j,j,this.angle),o.translate(j,j,[-x,-w,0]),this.mercatorMatrix=o.scale([],j,[this.worldSize,this.worldSize,this.worldSize]),o.scale(j,j,[1,1,o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=j,this.invProjMatrix=o.invert([],this.projMatrix);var Z=this.width%2/2,X=this.height%2/2,Q=Math.cos(this.angle),pe=Math.sin(this.angle),se=x-Math.round(x)+Q*Z+pe*X,ye=w-Math.round(w)+Q*X+pe*Z,ae=new Float64Array(j);if(o.translate(ae,ae,[se>.5?se-1:se,ye>.5?ye-1:ye,0]),this.alignedProjMatrix=ae,j=o.create(),o.scale(j,j,[this.width/2,-this.height/2,1]),o.translate(j,j,[1,-1,0]),this.labelPlaneMatrix=j,j=o.create(),o.scale(j,j,[1,-1,1]),o.translate(j,j,[-1,-1,0]),o.scale(j,j,[2/this.width,2/this.height,1]),this.glCoordMatrix=j,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(j=o.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=j,this._posMatrixCache={},this._alignedPosMatrixCache={}}},ur.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var s=this.pointCoordinate(new o.Point(0,0)),c=[s.x*this.worldSize,s.y*this.worldSize,0,1];return o.transformMat4(c,c,this.pixelMatrix)[3]/this.cameraToCenterDistance},ur.prototype.getCameraPoint=function(){var s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,s))},ur.prototype.getCameraQueryGeometry=function(s){var c=this.getCameraPoint();if(s.length===1)return[s[0],c];for(var l=c.x,d=c.y,g=c.x,x=c.y,w=0,P=s;w<P.length;w+=1){var A=P[w];l=Math.min(l,A.x),d=Math.min(d,A.y),g=Math.max(g,A.x),x=Math.max(x,A.y)}return[new o.Point(l,d),new o.Point(g,d),new o.Point(g,x),new o.Point(l,x),new o.Point(l,d)]},Object.defineProperties(ur.prototype,Vr);var Vi=function(s){var c,l,d,g;this._hashName=s&&encodeURIComponent(s),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(c=this._updateHashUnthrottled.bind(this),l=!1,d=null,g=function(){d=null,l&&(c(),d=setTimeout(g,300),l=!1)},function(){return l=!0,d||g(),d})};Vi.prototype.addTo=function(s){return this._map=s,o.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Vi.prototype.remove=function(){return o.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Vi.prototype.getHashString=function(s){var c=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,d=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,d),x=Math.round(c.lng*g)/g,w=Math.round(c.lat*g)/g,P=this._map.getBearing(),A=this._map.getPitch(),j="";if(j+=s?"/"+x+"/"+w+"/"+l:l+"/"+w+"/"+x,(P||A)&&(j+="/"+Math.round(10*P)/10),A&&(j+="/"+Math.round(A)),this._hashName){var Z=this._hashName,X=!1,Q=o.window.location.hash.slice(1).split("&").map(function(pe){var se=pe.split("=")[0];return se===Z?(X=!0,se+"="+j):pe}).filter(function(pe){return pe});return X||Q.push(Z+"="+j),"#"+Q.join("&")}return"#"+j},Vi.prototype._getCurrentHash=function(){var s,c=this,l=o.window.location.hash.replace("#","");return this._hashName?(l.split("&").map(function(d){return d.split("=")}).forEach(function(d){d[0]===c._hashName&&(s=d)}),(s&&s[1]||"").split("/")):l.split("/")},Vi.prototype._onHashChange=function(){var s=this._getCurrentHash();if(s.length>=3&&!s.some(function(l){return isNaN(l)})){var c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:c,pitch:+(s[4]||0)}),!0}return!1},Vi.prototype._updateHashUnthrottled=function(){var s=o.window.location.href.replace(/(#.+)?$/,this.getHashString());try{o.window.history.replaceState(o.window.history.state,null,s)}catch{}};var ml={linearity:.3,easing:o.bezier(0,0,.3,1)},Ms=o.extend({deceleration:2500,maxSpeed:1400},ml),vl=o.extend({deceleration:20,maxSpeed:1400},ml),Mm=o.extend({deceleration:1e3,maxSpeed:360},ml),Om=o.extend({deceleration:1e3,maxSpeed:90},ml),gl=function(s){this._map=s,this.clear()};function yl(s,c){(!s.duration||s.duration<c.duration)&&(s.duration=c.duration,s.easing=c.easing)}function Ua(s,c,l){var d=l.maxSpeed,g=l.linearity,x=l.deceleration,w=o.clamp(s*g/(c/1e3),-d,d),P=Math.abs(w)/(x*g);return{easing:l.easing,duration:1e3*P,amount:w*(P/2)}}gl.prototype.clear=function(){this._inertiaBuffer=[]},gl.prototype.record=function(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.browser.now(),settings:s})},gl.prototype._drainInertiaBuffer=function(){for(var s=this._inertiaBuffer,c=o.browser.now();s.length>0&&c-s[0].time>160;)s.shift()},gl.prototype._onMoveEnd=function(s){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var c={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0},l=0,d=this._inertiaBuffer;l<d.length;l+=1){var g=d[l].settings;c.zoom+=g.zoomDelta||0,c.bearing+=g.bearingDelta||0,c.pitch+=g.pitchDelta||0,g.panDelta&&c.pan._add(g.panDelta),g.around&&(c.around=g.around),g.pinchAround&&(c.pinchAround=g.pinchAround)}var x=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(c.pan.mag()){var P=Ua(c.pan.mag(),x,o.extend({},Ms,s||{}));w.offset=c.pan.mult(P.amount/c.pan.mag()),w.center=this._map.transform.center,yl(w,P)}if(c.zoom){var A=Ua(c.zoom,x,vl);w.zoom=this._map.transform.zoom+A.amount,yl(w,A)}if(c.bearing){var j=Ua(c.bearing,x,Mm);w.bearing=this._map.transform.bearing+o.clamp(j.amount,-179,179),yl(w,j)}if(c.pitch){var Z=Ua(c.pitch,x,Om);w.pitch=this._map.transform.pitch+Z.amount,yl(w,Z)}if(w.zoom||w.bearing){var X=c.pinchAround===void 0?c.around:c.pinchAround;w.around=X?this._map.unproject(X):this._map.getCenter()}return this.clear(),o.extend(w,{noMoveStart:!0})}};var Mn=function(s){function c(d,g,x,w){w===void 0&&(w={});var P=b.mousePos(g.getCanvasContainer(),x),A=g.unproject(P);s.call(this,d,o.extend({point:P,lngLat:A,originalEvent:x},w)),this._defaultPrevented=!1,this.target=g}s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c;var l={defaultPrevented:{configurable:!0}};return c.prototype.preventDefault=function(){this._defaultPrevented=!0},l.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(c.prototype,l),c}(o.Event),_l=function(s){function c(d,g,x){var w=d==="touchend"?x.changedTouches:x.touches,P=b.touchPos(g.getCanvasContainer(),w),A=P.map(function(X){return g.unproject(X)}),j=P.reduce(function(X,Q,pe,se){return X.add(Q.div(se.length))},new o.Point(0,0)),Z=g.unproject(j);s.call(this,d,{points:P,point:j,lngLats:A,lngLat:Z,originalEvent:x}),this._defaultPrevented=!1}s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c;var l={defaultPrevented:{configurable:!0}};return c.prototype.preventDefault=function(){this._defaultPrevented=!0},l.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(c.prototype,l),c}(o.Event),cd=function(s){function c(d,g,x){s.call(this,d,{originalEvent:x}),this._defaultPrevented=!1}s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c;var l={defaultPrevented:{configurable:!0}};return c.prototype.preventDefault=function(){this._defaultPrevented=!0},l.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(c.prototype,l),c}(o.Event),En=function(s,c){this._map=s,this._clickTolerance=c.clickTolerance};En.prototype.reset=function(){delete this._mousedownPos},En.prototype.wheel=function(s){return this._firePreventable(new cd(s.type,this._map,s))},En.prototype.mousedown=function(s,c){return this._mousedownPos=c,this._firePreventable(new Mn(s.type,this._map,s))},En.prototype.mouseup=function(s){this._map.fire(new Mn(s.type,this._map,s))},En.prototype.click=function(s,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||this._map.fire(new Mn(s.type,this._map,s))},En.prototype.dblclick=function(s){return this._firePreventable(new Mn(s.type,this._map,s))},En.prototype.mouseover=function(s){this._map.fire(new Mn(s.type,this._map,s))},En.prototype.mouseout=function(s){this._map.fire(new Mn(s.type,this._map,s))},En.prototype.touchstart=function(s){return this._firePreventable(new _l(s.type,this._map,s))},En.prototype.touchmove=function(s){this._map.fire(new _l(s.type,this._map,s))},En.prototype.touchend=function(s){this._map.fire(new _l(s.type,this._map,s))},En.prototype.touchcancel=function(s){this._map.fire(new _l(s.type,this._map,s))},En.prototype._firePreventable=function(s){if(this._map.fire(s),s.defaultPrevented)return{}},En.prototype.isEnabled=function(){return!0},En.prototype.isActive=function(){return!1},En.prototype.enable=function(){},En.prototype.disable=function(){};var ut=function(s){this._map=s};ut.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ut.prototype.mousemove=function(s){this._map.fire(new Mn(s.type,this._map,s))},ut.prototype.mousedown=function(){this._delayContextMenu=!0},ut.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Mn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ut.prototype.contextmenu=function(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new Mn(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()},ut.prototype.isEnabled=function(){return!0},ut.prototype.isActive=function(){return!1},ut.prototype.enable=function(){},ut.prototype.disable=function(){};var Mi=function(s,c){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=c.clickTolerance||1};function Iu(s,c){for(var l={},d=0;d<s.length;d++)l[s[d].identifier]=c[d];return l}Mi.prototype.isEnabled=function(){return!!this._enabled},Mi.prototype.isActive=function(){return!!this._active},Mi.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Mi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Mi.prototype.mousedown=function(s,c){this.isEnabled()&&s.shiftKey&&s.button===0&&(b.disableDrag(),this._startPos=this._lastPos=c,this._active=!0)},Mi.prototype.mousemoveWindow=function(s,c){if(this._active){var l=c;if(!(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)){var d=this._startPos;this._lastPos=l,this._box||(this._box=b.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));var g=Math.min(d.x,l.x),x=Math.max(d.x,l.x),w=Math.min(d.y,l.y),P=Math.max(d.y,l.y);b.setTransform(this._box,"translate("+g+"px,"+w+"px)"),this._box.style.width=x-g+"px",this._box.style.height=P-w+"px"}}},Mi.prototype.mouseupWindow=function(s,c){var l=this;if(this._active&&s.button===0){var d=this._startPos,g=c;if(this.reset(),b.suppressClick(),d.x!==g.x||d.y!==g.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:function(x){return x.fitScreenCoordinates(d,g,l._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",s)}},Mi.prototype.keydown=function(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))},Mi.prototype.blur=function(){this.reset()},Mi.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(b.remove(this._box),this._box=null),b.enableDrag(),delete this._startPos,delete this._lastPos},Mi.prototype._fireEvent=function(s,c){return this._map.fire(new o.Event(s,{originalEvent:c}))};var Os=function(s){this.reset(),this.numTouches=s.numTouches};Os.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Os.prototype.touchstart=function(s,c,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),l.length===this.numTouches&&(this.centroid=function(d){for(var g=new o.Point(0,0),x=0,w=d;x<w.length;x+=1)g._add(w[x]);return g.div(d.length)}(c),this.touches=Iu(l,c)))},Os.prototype.touchmove=function(s,c,l){if(!this.aborted&&this.centroid){var d=Iu(l,c);for(var g in this.touches){var x=d[g];(!x||x.dist(this.touches[g])>30)&&(this.aborted=!0)}}},Os.prototype.touchend=function(s,c,l){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){var d=!this.aborted&&this.centroid;if(this.reset(),d)return d}};var ma=function(s){this.singleTap=new Os(s),this.numTaps=s.numTaps,this.reset()};ma.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},ma.prototype.touchstart=function(s,c,l){this.singleTap.touchstart(s,c,l)},ma.prototype.touchmove=function(s,c,l){this.singleTap.touchmove(s,c,l)},ma.prototype.touchend=function(s,c,l){var d=this.singleTap.touchend(s,c,l);if(d){var g=s.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(d)<30;if(g&&x||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}};var Oi=function(){this._zoomIn=new ma({numTouches:1,numTaps:2}),this._zoomOut=new ma({numTouches:2,numTaps:1}),this.reset()};Oi.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Oi.prototype.touchstart=function(s,c,l){this._zoomIn.touchstart(s,c,l),this._zoomOut.touchstart(s,c,l)},Oi.prototype.touchmove=function(s,c,l){this._zoomIn.touchmove(s,c,l),this._zoomOut.touchmove(s,c,l)},Oi.prototype.touchend=function(s,c,l){var d=this,g=this._zoomIn.touchend(s,c,l),x=this._zoomOut.touchend(s,c,l);return g?(this._active=!0,s.preventDefault(),setTimeout(function(){return d.reset()},0),{cameraAnimation:function(w){return w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(g)},{originalEvent:s})}}):x?(this._active=!0,s.preventDefault(),setTimeout(function(){return d.reset()},0),{cameraAnimation:function(w){return w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(x)},{originalEvent:s})}}):void 0},Oi.prototype.touchcancel=function(){this.reset()},Oi.prototype.enable=function(){this._enabled=!0},Oi.prototype.disable=function(){this._enabled=!1,this.reset()},Oi.prototype.isEnabled=function(){return this._enabled},Oi.prototype.isActive=function(){return this._active};var ep={0:1,2:2},et=function(s){this.reset(),this._clickTolerance=s.clickTolerance||1};et.prototype.blur=function(){this.reset()},et.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},et.prototype._correctButton=function(s,c){return!1},et.prototype._move=function(s,c){return{}},et.prototype.mousedown=function(s,c){if(!this._lastPoint){var l=b.mouseButton(s);this._correctButton(s,l)&&(this._lastPoint=c,this._eventButton=l)}},et.prototype.mousemoveWindow=function(s,c){var l=this._lastPoint;if(l){if(s.preventDefault(),function(d,g){var x=ep[g];return d.buttons===void 0||(d.buttons&x)!==x}(s,this._eventButton))this.reset();else if(this._moved||!(c.dist(l)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(l,c)}},et.prototype.mouseupWindow=function(s){this._lastPoint&&b.mouseButton(s)===this._eventButton&&(this._moved&&b.suppressClick(),this.reset())},et.prototype.enable=function(){this._enabled=!0},et.prototype.disable=function(){this._enabled=!1,this.reset()},et.prototype.isEnabled=function(){return this._enabled},et.prototype.isActive=function(){return this._active};var tp=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.mousedown=function(l,d){s.prototype.mousedown.call(this,l,d),this._lastPoint&&(this._active=!0)},c.prototype._correctButton=function(l,d){return d===0&&!l.ctrlKey},c.prototype._move=function(l,d){return{around:d,panDelta:d.sub(l)}},c}(et),Mu=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype._correctButton=function(l,d){return d===0&&l.ctrlKey||d===2},c.prototype._move=function(l,d){var g=.8*(d.x-l.x);if(g)return this._active=!0,{bearingDelta:g}},c.prototype.contextmenu=function(l){l.preventDefault()},c}(et),rp=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype._correctButton=function(l,d){return d===0&&l.ctrlKey||d===2},c.prototype._move=function(l,d){var g=-.5*(d.y-l.y);if(g)return this._active=!0,{pitchDelta:g}},c.prototype.contextmenu=function(l){l.preventDefault()},c}(et),aa=function(s){this._minTouches=1,this._clickTolerance=s.clickTolerance||1,this.reset()};aa.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)},aa.prototype.touchstart=function(s,c,l){return this._calculateTransform(s,c,l)},aa.prototype.touchmove=function(s,c,l){if(this._active&&!(l.length<this._minTouches))return s.preventDefault(),this._calculateTransform(s,c,l)},aa.prototype.touchend=function(s,c,l){this._calculateTransform(s,c,l),this._active&&l.length<this._minTouches&&this.reset()},aa.prototype.touchcancel=function(){this.reset()},aa.prototype._calculateTransform=function(s,c,l){l.length>0&&(this._active=!0);var d=Iu(l,c),g=new o.Point(0,0),x=new o.Point(0,0),w=0;for(var P in d){var A=d[P],j=this._touches[P];j&&(g._add(A),x._add(A.sub(j)),w++,d[P]=A)}if(this._touches=d,!(w<this._minTouches)&&x.mag()){var Z=x.div(w);if(this._sum._add(Z),!(this._sum.mag()<this._clickTolerance))return{around:g.div(w),panDelta:Z}}},aa.prototype.enable=function(){this._enabled=!0},aa.prototype.disable=function(){this._enabled=!1,this.reset()},aa.prototype.isEnabled=function(){return this._enabled},aa.prototype.isActive=function(){return this._active};var Ri=function(){this.reset()};function Ou(s,c,l){for(var d=0;d<s.length;d++)if(s[d].identifier===l)return c[d]}function Ru(s,c){return Math.log(s/c)/Math.LN2}Ri.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ri.prototype._start=function(s){},Ri.prototype._move=function(s,c,l){return{}},Ri.prototype.touchstart=function(s,c,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([c[0],c[1]]))},Ri.prototype.touchmove=function(s,c,l){if(this._firstTwoTouches){s.preventDefault();var d=this._firstTwoTouches,g=d[1],x=Ou(l,c,d[0]),w=Ou(l,c,g);if(x&&w){var P=this._aroundCenter?null:x.add(w).div(2);return this._move([x,w],P,s)}}},Ri.prototype.touchend=function(s,c,l){if(this._firstTwoTouches){var d=this._firstTwoTouches,g=d[1],x=Ou(l,c,d[0]),w=Ou(l,c,g);x&&w||(this._active&&b.suppressClick(),this.reset())}},Ri.prototype.touchcancel=function(){this.reset()},Ri.prototype.enable=function(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"},Ri.prototype.disable=function(){this._enabled=!1,this.reset()},Ri.prototype.isEnabled=function(){return this._enabled},Ri.prototype.isActive=function(){return this._active};var Ai=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.reset=function(){s.prototype.reset.call(this),delete this._distance,delete this._startDistance},c.prototype._start=function(l){this._startDistance=this._distance=l[0].dist(l[1])},c.prototype._move=function(l,d){var g=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(Ru(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ru(this._distance,g),pinchAround:d}},c}(Ri);function Va(s,c){return 180*s.angleWith(c)/Math.PI}var pd=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.reset=function(){s.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},c.prototype._start=function(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])},c.prototype._move=function(l,d){var g=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Va(this._vector,g),pinchAround:d}},c.prototype._isBelowThreshold=function(l){this._minDiameter=Math.min(this._minDiameter,l.mag());var d=25/(Math.PI*this._minDiameter)*360,g=Va(l,this._startVector);return Math.abs(g)<d},c}(Ri);function bl(s){return Math.abs(s.y)>Math.abs(s.x)}var np=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.reset=function(){s.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},c.prototype._start=function(l){this._lastPoints=l,bl(l[0].sub(l[1]))&&(this._valid=!1)},c.prototype._move=function(l,d,g){var x=l[0].sub(this._lastPoints[0]),w=l[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(x,w,g.timeStamp),this._valid)return this._lastPoints=l,this._active=!0,{pitchDelta:(x.y+w.y)/2*-.5}},c.prototype.gestureBeginsVertically=function(l,d,g){if(this._valid!==void 0)return this._valid;var x=l.mag()>=2,w=d.mag()>=2;if(x||w){if(!x||!w)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;var P=l.y>0==d.y>0;return bl(l)&&bl(d)&&P}},c}(Ri),ip={panStep:100,bearingStep:15,pitchStep:10},va=function(){var s=ip;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1};function qi(s){return s*(2-s)}va.prototype.blur=function(){this.reset()},va.prototype.reset=function(){this._active=!1},va.prototype.keydown=function(s){var c=this;if(!(s.altKey||s.ctrlKey||s.metaKey)){var l=0,d=0,g=0,x=0,w=0;switch(s.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:s.shiftKey?d=-1:(s.preventDefault(),x=-1);break;case 39:s.shiftKey?d=1:(s.preventDefault(),x=1);break;case 38:s.shiftKey?g=1:(s.preventDefault(),w=-1);break;case 40:s.shiftKey?g=-1:(s.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(d=0,g=0),{cameraAnimation:function(P){var A=P.getZoom();P.easeTo({duration:300,easeId:"keyboardHandler",easing:qi,zoom:l?Math.round(A)+l*(s.shiftKey?2:1):A,bearing:P.getBearing()+d*c._bearingStep,pitch:P.getPitch()+g*c._pitchStep,offset:[-x*c._panStep,-w*c._panStep],center:P.getCenter()},{originalEvent:s})}}}},va.prototype.enable=function(){this._enabled=!0},va.prototype.disable=function(){this._enabled=!1,this.reset()},va.prototype.isEnabled=function(){return this._enabled},va.prototype.isActive=function(){return this._active},va.prototype.disableRotation=function(){this._rotationDisabled=!0},va.prototype.enableRotation=function(){this._rotationDisabled=!1};var ir=function(s,c){this._map=s,this._el=s.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,o.bindAll(["_onTimeout"],this)};ir.prototype.setZoomRate=function(s){this._defaultZoomRate=s},ir.prototype.setWheelZoomRate=function(s){this._wheelZoomRate=s},ir.prototype.isEnabled=function(){return!!this._enabled},ir.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},ir.prototype.isZooming=function(){return!!this._zooming},ir.prototype.enable=function(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=s&&s.around==="center")},ir.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ir.prototype.wheel=function(s){if(this.isEnabled()){var c=s.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY,l=o.browser.now(),d=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,c!==0&&c%4.000244140625==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(d*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),s.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=s,this._delta-=c,this._active||this._start(s)),s.preventDefault()}},ir.prototype._onTimeout=function(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)},ir.prototype._start=function(s){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var c=b.mousePos(this._el,s);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(c)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ir.prototype.renderFrame=function(){var s=this;if(this._frameId&&(this._frameId=null,this.isActive())){var c=this._map.transform;if(this._delta!==0){var l=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,d=2/(1+Math.exp(-Math.abs(this._delta*l)));this._delta<0&&d!==0&&(d=1/d);var g=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):c.scale;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(g*d))),this._type==="wheel"&&(this._startZoom=c.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var x,w=typeof this._targetZoom=="number"?this._targetZoom:c.zoom,P=this._startZoom,A=this._easing,j=!1;if(this._type==="wheel"&&P&&A){var Z=Math.min((o.browser.now()-this._lastWheelEventTime)/200,1),X=A(Z);x=o.number(P,w,X),Z<1?this._frameId||(this._frameId=!0):j=!0}else x=w,j=!0;return this._active=!0,j&&(this._active=!1,this._finishTimeout=setTimeout(function(){s._zooming=!1,s._handler._triggerRenderFrame(),delete s._targetZoom,delete s._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!j,zoomDelta:x-c.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ir.prototype._smoothOutEasing=function(s){var c=o.ease;if(this._prevEase){var l=this._prevEase,d=(o.browser.now()-l.start)/l.duration,g=l.easing(d+.01)-l.easing(d),x=.27/Math.sqrt(g*g+1e-4)*.01,w=Math.sqrt(.0729-x*x);c=o.bezier(x,w,.25,1)}return this._prevEase={start:o.browser.now(),duration:s,easing:c},c},ir.prototype.blur=function(){this.reset()},ir.prototype.reset=function(){this._active=!1};var Ca=function(s,c){this._clickZoom=s,this._tapZoom=c};Ca.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ca.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ca.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ca.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var oa=function(){this.reset()};oa.prototype.reset=function(){this._active=!1},oa.prototype.blur=function(){this.reset()},oa.prototype.dblclick=function(s,c){return s.preventDefault(),{cameraAnimation:function(l){l.easeTo({duration:300,zoom:l.getZoom()+(s.shiftKey?-1:1),around:l.unproject(c)},{originalEvent:s})}}},oa.prototype.enable=function(){this._enabled=!0},oa.prototype.disable=function(){this._enabled=!1,this.reset()},oa.prototype.isEnabled=function(){return this._enabled},oa.prototype.isActive=function(){return this._active};var ei=function(){this._tap=new ma({numTouches:1,numTaps:1}),this.reset()};ei.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ei.prototype.touchstart=function(s,c,l){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?l.length>0&&(this._swipePoint=c[0],this._swipeTouch=l[0].identifier):this._tap.touchstart(s,c,l))},ei.prototype.touchmove=function(s,c,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;var d=c[0],g=d.y-this._swipePoint.y;return this._swipePoint=d,s.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(s,c,l)},ei.prototype.touchend=function(s,c,l){this._tapTime?this._swipePoint&&l.length===0&&this.reset():this._tap.touchend(s,c,l)&&(this._tapTime=s.timeStamp)},ei.prototype.touchcancel=function(){this.reset()},ei.prototype.enable=function(){this._enabled=!0},ei.prototype.disable=function(){this._enabled=!1,this.reset()},ei.prototype.isEnabled=function(){return this._enabled},ei.prototype.isActive=function(){return this._active};var Jo=function(s,c,l){this._el=s,this._mousePan=c,this._touchPan=l};Jo.prototype.enable=function(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Jo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Jo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Jo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var vo=function(s,c,l){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=c,this._mousePitch=l};vo.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},vo.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},vo.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},vo.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ga=function(s,c,l,d){this._el=s,this._touchZoom=c,this._touchRotate=l,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0};ga.prototype.enable=function(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ga.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ga.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ga.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ga.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ga.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var hi=function(s){return s.zoom||s.drag||s.pitch||s.rotate},xl=function(s){function c(){s.apply(this,arguments)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c}(o.Event);function _t(s){return s.panDelta&&s.panDelta.mag()||s.zoomDelta||s.bearingDelta||s.pitchDelta}var pt=function(s,c){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new gl(s),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(c),o.bindAll(["handleEvent","handleWindowEvent"],this);var l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[o.window,"blur",void 0]];for(var d=0,g=this._listeners;d<g.length;d+=1){var x=g[d],w=x[0];b.addEventListener(w,x[1],w===o.window.document?this.handleWindowEvent:this.handleEvent,x[2])}};pt.prototype.destroy=function(){for(var s=0,c=this._listeners;s<c.length;s+=1){var l=c[s],d=l[0];b.removeEventListener(d,l[1],d===o.window.document?this.handleWindowEvent:this.handleEvent,l[2])}},pt.prototype._addDefaultHandlers=function(s){var c=this._map,l=c.getCanvasContainer();this._add("mapEvent",new En(c,s));var d=c.boxZoom=new Mi(c,s);this._add("boxZoom",d);var g=new Oi,x=new oa;c.doubleClickZoom=new Ca(x,g),this._add("tapZoom",g),this._add("clickZoom",x);var w=new ei;this._add("tapDragZoom",w);var P=c.touchPitch=new np;this._add("touchPitch",P);var A=new Mu(s),j=new rp(s);c.dragRotate=new vo(s,A,j),this._add("mouseRotate",A,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]);var Z=new tp(s),X=new aa(s);c.dragPan=new Jo(l,Z,X),this._add("mousePan",Z),this._add("touchPan",X,["touchZoom","touchRotate"]);var Q=new pd,pe=new Ai;c.touchZoomRotate=new ga(l,pe,Q,w),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",pe,["touchPan","touchRotate"]);var se=c.scrollZoom=new ir(c,this);this._add("scrollZoom",se,["mousePan"]);var ye=c.keyboard=new va;this._add("keyboard",ye),this._add("blockableMapEvent",new ut(c));for(var ae=0,ge=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];ae<ge.length;ae+=1){var Ee=ge[ae];s.interactive&&s[Ee]&&c[Ee].enable(s[Ee])}},pt.prototype._add=function(s,c,l){this._handlers.push({handlerName:s,handler:c,allowed:l}),this._handlersById[s]=c},pt.prototype.stop=function(s){if(!this._updatingCamera){for(var c=0,l=this._handlers;c<l.length;c+=1)l[c].handler.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}},pt.prototype.isActive=function(){for(var s=0,c=this._handlers;s<c.length;s+=1)if(c[s].handler.isActive())return!0;return!1},pt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},pt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},pt.prototype.isMoving=function(){return!!hi(this._eventsInProgress)||this.isZooming()},pt.prototype._blockedByActive=function(s,c,l){for(var d in s)if(d!==l&&(!c||c.indexOf(d)<0))return!0;return!1},pt.prototype.handleWindowEvent=function(s){this.handleEvent(s,s.type+"Window")},pt.prototype._getMapTouches=function(s){for(var c=[],l=0,d=s;l<d.length;l+=1){var g=d[l];this._el.contains(g.target)&&c.push(g)}return c},pt.prototype.handleEvent=function(s,c){this._updatingCamera=!0;for(var l=s.type==="renderFrame"?void 0:s,d={needsRenderFrame:!1},g={},x={},w=s.touches?this._getMapTouches(s.touches):void 0,P=w?b.touchPos(this._el,w):b.mousePos(this._el,s),A=0,j=this._handlers;A<j.length;A+=1){var Z=j[A],X=Z.handlerName,Q=Z.handler,pe=Z.allowed;if(Q.isEnabled()){var se=void 0;this._blockedByActive(x,pe,X)?Q.reset():Q[c||s.type]&&(se=Q[c||s.type](s,P,w),this.mergeHandlerResult(d,g,se,X,l),se&&se.needsRenderFrame&&this._triggerRenderFrame()),(se||Q.isActive())&&(x[X]=Q)}}var ye={};for(var ae in this._previousActiveHandlers)x[ae]||(ye[ae]=l);this._previousActiveHandlers=x,(Object.keys(ye).length||_t(d))&&(this._changes.push([d,g,ye]),this._triggerRenderFrame()),(Object.keys(x).length||_t(d))&&this._map._stop(!0),this._updatingCamera=!1;var ge=d.cameraAnimation;ge&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ge(this._map))},pt.prototype.mergeHandlerResult=function(s,c,l,d,g){if(l){o.extend(s,l);var x={handlerName:d,originalEvent:l.originalEvent||g};l.zoomDelta!==void 0&&(c.zoom=x),l.panDelta!==void 0&&(c.drag=x),l.pitchDelta!==void 0&&(c.pitch=x),l.bearingDelta!==void 0&&(c.rotate=x)}},pt.prototype._applyChanges=function(){for(var s={},c={},l={},d=0,g=this._changes;d<g.length;d+=1){var x=g[d],w=x[0],P=x[1],A=x[2];w.panDelta&&(s.panDelta=(s.panDelta||new o.Point(0,0))._add(w.panDelta)),w.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(s.around=w.around),w.pinchAround!==void 0&&(s.pinchAround=w.pinchAround),w.noInertia&&(s.noInertia=w.noInertia),o.extend(c,P),o.extend(l,A)}this._updateMapTransform(s,c,l),this._changes=[]},pt.prototype._updateMapTransform=function(s,c,l){var d=this._map,g=d.transform;if(!_t(s))return this._fireEvents(c,l,!0);var x=s.panDelta,w=s.zoomDelta,P=s.bearingDelta,A=s.pitchDelta,j=s.around,Z=s.pinchAround;Z!==void 0&&(j=Z),d._stop(!0),j=j||d.transform.centerPoint;var X=g.pointLocation(x?j.sub(x):j);P&&(g.bearing+=P),A&&(g.pitch+=A),w&&(g.zoom+=w),g.setLocationAtPoint(X,j),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(c,l,!0)},pt.prototype._fireEvents=function(s,c,l){var d=this,g=hi(this._eventsInProgress),x=hi(s),w={};for(var P in s)this._eventsInProgress[P]||(w[P+"start"]=s[P].originalEvent),this._eventsInProgress[P]=s[P];for(var A in!g&&x&&this._fireEvent("movestart",x.originalEvent),w)this._fireEvent(A,w[A]);for(var j in x&&this._fireEvent("move",x.originalEvent),s)this._fireEvent(j,s[j].originalEvent);var Z,X={};for(var Q in this._eventsInProgress){var pe=this._eventsInProgress[Q],se=pe.handlerName,ye=pe.originalEvent;this._handlersById[se].isActive()||(delete this._eventsInProgress[Q],X[Q+"end"]=Z=c[se]||ye)}for(var ae in X)this._fireEvent(ae,X[ae]);var ge=hi(this._eventsInProgress);if(l&&(g||x)&&!ge){this._updatingCamera=!0;var Ee=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Ie=function(je){return je!==0&&-d._bearingSnap<je&&je<d._bearingSnap};Ee?(Ie(Ee.bearing||this._map.getBearing())&&(Ee.bearing=0),this._map.easeTo(Ee,{originalEvent:Z})):(this._map.fire(new o.Event("moveend",{originalEvent:Z})),Ie(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},pt.prototype._fireEvent=function(s,c){this._map.fire(new o.Event(s,c?{originalEvent:c}:{}))},pt.prototype._requestFrame=function(){var s=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(c){delete s._frameId,s.handleEvent(new xl("renderFrame",{timeStamp:c})),s._applyChanges()})},pt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Au=function(s){function c(l,d){s.call(this),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=d.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.getCenter=function(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)},c.prototype.setCenter=function(l,d){return this.jumpTo({center:l},d)},c.prototype.panBy=function(l,d,g){return l=o.Point.convert(l).mult(-1),this.panTo(this.transform.center,o.extend({offset:l},d),g)},c.prototype.panTo=function(l,d,g){return this.easeTo(o.extend({center:l},d),g)},c.prototype.getZoom=function(){return this.transform.zoom},c.prototype.setZoom=function(l,d){return this.jumpTo({zoom:l},d),this},c.prototype.zoomTo=function(l,d,g){return this.easeTo(o.extend({zoom:l},d),g)},c.prototype.zoomIn=function(l,d){return this.zoomTo(this.getZoom()+1,l,d),this},c.prototype.zoomOut=function(l,d){return this.zoomTo(this.getZoom()-1,l,d),this},c.prototype.getBearing=function(){return this.transform.bearing},c.prototype.setBearing=function(l,d){return this.jumpTo({bearing:l},d),this},c.prototype.getPadding=function(){return this.transform.padding},c.prototype.setPadding=function(l,d){return this.jumpTo({padding:l},d),this},c.prototype.rotateTo=function(l,d,g){return this.easeTo(o.extend({bearing:l},d),g)},c.prototype.resetNorth=function(l,d){return this.rotateTo(0,o.extend({duration:1e3},l),d),this},c.prototype.resetNorthPitch=function(l,d){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},l),d),this},c.prototype.snapToNorth=function(l,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,d):this},c.prototype.getPitch=function(){return this.transform.pitch},c.prototype.setPitch=function(l,d){return this.jumpTo({pitch:l},d),this},c.prototype.cameraForBounds=function(l,d){l=o.LngLatBounds.convert(l);var g=d&&d.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),g,d)},c.prototype._cameraForBoxAndBearing=function(l,d,g,x){var w={top:0,bottom:0,right:0,left:0};if(typeof(x=o.extend({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},x)).padding=="number"){var P=x.padding;x.padding={top:P,bottom:P,right:P,left:P}}x.padding=o.extend(w,x.padding);var A=this.transform,j=A.padding,Z=A.project(o.LngLat.convert(l)),X=A.project(o.LngLat.convert(d)),Q=Z.rotate(-g*Math.PI/180),pe=X.rotate(-g*Math.PI/180),se=new o.Point(Math.max(Q.x,pe.x),Math.max(Q.y,pe.y)),ye=new o.Point(Math.min(Q.x,pe.x),Math.min(Q.y,pe.y)),ae=se.sub(ye),ge=(A.width-(j.left+j.right+x.padding.left+x.padding.right))/ae.x,Ee=(A.height-(j.top+j.bottom+x.padding.top+x.padding.bottom))/ae.y;if(!(Ee<0||ge<0)){var Ie=Math.min(A.scaleZoom(A.scale*Math.min(ge,Ee)),x.maxZoom),je=typeof x.offset.x=="number"?new o.Point(x.offset.x,x.offset.y):o.Point.convert(x.offset),ke=new o.Point((x.padding.left-x.padding.right)/2,(x.padding.top-x.padding.bottom)/2).rotate(g*Math.PI/180),Be=je.add(ke).mult(A.scale/A.zoomScale(Ie));return{center:A.unproject(Z.add(X).div(2).sub(Be)),zoom:Ie,bearing:g}}o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},c.prototype.fitBounds=function(l,d,g){return this._fitInternal(this.cameraForBounds(l,d),d,g)},c.prototype.fitScreenCoordinates=function(l,d,g,x,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.Point.convert(l)),this.transform.pointLocation(o.Point.convert(d)),g,x),x,w)},c.prototype._fitInternal=function(l,d,g){return l?(delete(d=o.extend(l,d)).padding,d.linear?this.easeTo(d,g):this.flyTo(d,g)):this},c.prototype.jumpTo=function(l,d){this.stop();var g=this.transform,x=!1,w=!1,P=!1;return"zoom"in l&&g.zoom!==+l.zoom&&(x=!0,g.zoom=+l.zoom),l.center!==void 0&&(g.center=o.LngLat.convert(l.center)),"bearing"in l&&g.bearing!==+l.bearing&&(w=!0,g.bearing=+l.bearing),"pitch"in l&&g.pitch!==+l.pitch&&(P=!0,g.pitch=+l.pitch),l.padding==null||g.isPaddingEqual(l.padding)||(g.padding=l.padding),this.fire(new o.Event("movestart",d)).fire(new o.Event("move",d)),x&&this.fire(new o.Event("zoomstart",d)).fire(new o.Event("zoom",d)).fire(new o.Event("zoomend",d)),w&&this.fire(new o.Event("rotatestart",d)).fire(new o.Event("rotate",d)).fire(new o.Event("rotateend",d)),P&&this.fire(new o.Event("pitchstart",d)).fire(new o.Event("pitch",d)).fire(new o.Event("pitchend",d)),this.fire(new o.Event("moveend",d))},c.prototype.easeTo=function(l,d){var g=this;this._stop(!1,l.easeId),((l=o.extend({offset:[0,0],duration:500,easing:o.ease},l)).animate===!1||!l.essential&&o.browser.prefersReducedMotion)&&(l.duration=0);var x=this.transform,w=this.getZoom(),P=this.getBearing(),A=this.getPitch(),j=this.getPadding(),Z="zoom"in l?+l.zoom:w,X="bearing"in l?this._normalizeBearing(l.bearing,P):P,Q="pitch"in l?+l.pitch:A,pe="padding"in l?l.padding:x.padding,se=o.Point.convert(l.offset),ye=x.centerPoint.add(se),ae=x.pointLocation(ye),ge=o.LngLat.convert(l.center||ae);this._normalizeCenter(ge);var Ee,Ie,je=x.project(ae),ke=x.project(ge).sub(je),Be=x.zoomScale(Z-w);l.around&&(Ee=o.LngLat.convert(l.around),Ie=x.locationPoint(Ee));var qe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Z!==w,this._rotating=this._rotating||P!==X,this._pitching=this._pitching||Q!==A,this._padding=!x.isPaddingEqual(pe),this._easeId=l.easeId,this._prepareEase(d,l.noMoveStart,qe),this._ease(function(Ke){if(g._zooming&&(x.zoom=o.number(w,Z,Ke)),g._rotating&&(x.bearing=o.number(P,X,Ke)),g._pitching&&(x.pitch=o.number(A,Q,Ke)),g._padding&&(x.interpolatePadding(j,pe,Ke),ye=x.centerPoint.add(se)),Ee)x.setLocationAtPoint(Ee,Ie);else{var Xe=x.zoomScale(x.zoom-w),at=Z>w?Math.min(2,Be):Math.max(.5,Be),bt=Math.pow(at,1-Ke),Pt=x.unproject(je.add(ke.mult(Ke*bt)).mult(Xe));x.setLocationAtPoint(x.renderWorldCopies?Pt.wrap():Pt,ye)}g._fireMoveEvents(d)},function(Ke){g._afterEase(d,Ke)},l),this},c.prototype._prepareEase=function(l,d,g){g===void 0&&(g={}),this._moving=!0,d||g.moving||this.fire(new o.Event("movestart",l)),this._zooming&&!g.zooming&&this.fire(new o.Event("zoomstart",l)),this._rotating&&!g.rotating&&this.fire(new o.Event("rotatestart",l)),this._pitching&&!g.pitching&&this.fire(new o.Event("pitchstart",l))},c.prototype._fireMoveEvents=function(l){this.fire(new o.Event("move",l)),this._zooming&&this.fire(new o.Event("zoom",l)),this._rotating&&this.fire(new o.Event("rotate",l)),this._pitching&&this.fire(new o.Event("pitch",l))},c.prototype._afterEase=function(l,d){if(!this._easeId||!d||this._easeId!==d){delete this._easeId;var g=this._zooming,x=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new o.Event("zoomend",l)),x&&this.fire(new o.Event("rotateend",l)),w&&this.fire(new o.Event("pitchend",l)),this.fire(new o.Event("moveend",l))}},c.prototype.flyTo=function(l,d){var g=this;if(!l.essential&&o.browser.prefersReducedMotion){var x=o.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(x,d)}this.stop(),l=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},l);var w=this.transform,P=this.getZoom(),A=this.getBearing(),j=this.getPitch(),Z=this.getPadding(),X="zoom"in l?o.clamp(+l.zoom,w.minZoom,w.maxZoom):P,Q="bearing"in l?this._normalizeBearing(l.bearing,A):A,pe="pitch"in l?+l.pitch:j,se="padding"in l?l.padding:w.padding,ye=w.zoomScale(X-P),ae=o.Point.convert(l.offset),ge=w.centerPoint.add(ae),Ee=w.pointLocation(ge),Ie=o.LngLat.convert(l.center||Ee);this._normalizeCenter(Ie);var je=w.project(Ee),ke=w.project(Ie).sub(je),Be=l.curve,qe=Math.max(w.width,w.height),Ke=qe/ye,Xe=ke.mag();if("minZoom"in l){var at=o.clamp(Math.min(l.minZoom,P,X),w.minZoom,w.maxZoom),bt=qe/w.zoomScale(at-P);Be=Math.sqrt(bt/Xe*2)}var Pt=Be*Be;function St(At){var Ot=(Ke*Ke-qe*qe+(At?-1:1)*Pt*Pt*Xe*Xe)/(2*(At?Ke:qe)*Pt*Xe);return Math.log(Math.sqrt(Ot*Ot+1)-Ot)}function mr(At){return(Math.exp(At)-Math.exp(-At))/2}function st(At){return(Math.exp(At)+Math.exp(-At))/2}var Nt=St(0),Ht=function(At){return st(Nt)/st(Nt+Be*At)},zt=function(At){return qe*((st(Nt)*(mr(Ot=Nt+Be*At)/st(Ot))-mr(Nt))/Pt)/Xe;var Ot},Lt=(St(1)-Nt)/Be;if(Math.abs(Xe)<1e-6||!isFinite(Lt)){if(Math.abs(qe-Ke)<1e-6)return this.easeTo(l,d);var qt=Ke<qe?-1:1;Lt=Math.abs(Math.log(Ke/qe))/Be,zt=function(){return 0},Ht=function(At){return Math.exp(qt*Be*At)}}return l.duration="duration"in l?+l.duration:1e3*Lt/("screenSpeed"in l?+l.screenSpeed/Be:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=A!==Q,this._pitching=pe!==j,this._padding=!w.isPaddingEqual(se),this._prepareEase(d,!1),this._ease(function(At){var Ot=At*Lt,Ln=1/Ht(Ot);w.zoom=At===1?X:P+w.scaleZoom(Ln),g._rotating&&(w.bearing=o.number(A,Q,At)),g._pitching&&(w.pitch=o.number(j,pe,At)),g._padding&&(w.interpolatePadding(Z,se,At),ge=w.centerPoint.add(ae));var ln=At===1?Ie:w.unproject(je.add(ke.mult(zt(Ot))).mult(Ln));w.setLocationAtPoint(w.renderWorldCopies?ln.wrap():ln,ge),g._fireMoveEvents(d)},function(){return g._afterEase(d)},l),this},c.prototype.isEasing=function(){return!!this._easeFrameId},c.prototype.stop=function(){return this._stop()},c.prototype._stop=function(l,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,d)}if(!l){var x=this.handlers;x&&x.stop(!1)}return this},c.prototype._ease=function(l,d,g){g.animate===!1||g.duration===0?(l(1),d()):(this._easeStart=o.browser.now(),this._easeOptions=g,this._onEaseFrame=l,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},c.prototype._renderFrameCallback=function(){var l=Math.min((o.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},c.prototype._normalizeBearing=function(l,d){l=o.wrap(l,-180,180);var g=Math.abs(l-d);return Math.abs(l-360-d)<g&&(l-=360),Math.abs(l+360-d)<g&&(l+=360),l},c.prototype._normalizeCenter=function(l){var d=this.transform;if(d.renderWorldCopies&&!d.lngRange){var g=l.lng-d.center.lng;l.lng+=g>180?-360:g<-180?360:0}},c}(o.Evented),di=function(s){s===void 0&&(s={}),this.options=s,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};di.prototype.getDefaultPosition=function(){return"bottom-right"},di.prototype.onAdd=function(s){var c=this.options&&this.options.compact;return this._map=s,this._container=b.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=b.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=b.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},di.prototype.onRemove=function(){b.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},di.prototype._setElementTitle=function(s,c){var l=this._map._getUIString("AttributionControl."+c);s.title=l,s.setAttribute("aria-label",l)},di.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},di.prototype._updateEditLink=function(){var s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));var c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(s){var l=c.reduce(function(d,g,x){return g.value&&(d+=g.key+"="+g.value+(x<c.length-1?"&":"")),d},"?");s.href=o.config.FEEDBACK_URL+"/"+l+(this._map._hash?this._map._hash.getHashString(!0):""),s.rel="noopener nofollow",this._setElementTitle(s,"MapFeedback")}},di.prototype._updateData=function(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},di.prototype._updateAttributions=function(){if(this._map.style){var s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(function(P){return typeof P!="string"?"":P})):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){var c=this._map.style.stylesheet;this.styleOwner=c.owner,this.styleId=c.id}var l=this._map.style.sourceCaches;for(var d in l){var g=l[d];if(g.used){var x=g.getSource();x.attribution&&s.indexOf(x.attribution)<0&&s.push(x.attribution)}}s.sort(function(P,A){return P.length-A.length});var w=(s=s.filter(function(P,A){for(var j=A+1;j<s.length;j++)if(s[j].indexOf(P)>=0)return!1;return!0})).join(" | ");w!==this._attribHTML&&(this._attribHTML=w,s.length?(this._innerContainer.innerHTML=w,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},di.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var ya=function(){o.bindAll(["_updateLogo"],this),o.bindAll(["_updateCompact"],this)};ya.prototype.onAdd=function(s){this._map=s,this._container=b.create("div","mapboxgl-ctrl");var c=b.create("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ya.prototype.onRemove=function(){b.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ya.prototype.getDefaultPosition=function(){return"bottom-left"},ya.prototype._updateLogo=function(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ya.prototype._logoRequired=function(){if(this._map.style){var s=this._map.style.sourceCaches;for(var c in s)if(s[c].getSource().mapbox_logo)return!0;return!1}},ya.prototype._updateCompact=function(){var s=this._container.children;if(s.length){var c=s[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}};var ti=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};ti.prototype.add=function(s){var c=++this._id;return this._queue.push({callback:s,id:c,cancelled:!1}),c},ti.prototype.remove=function(s){for(var c=this._currentlyRunning,l=0,d=c?this._queue.concat(c):this._queue;l<d.length;l+=1){var g=d[l];if(g.id===s)return void(g.cancelled=!0)}},ti.prototype.run=function(s){s===void 0&&(s=0);var c=this._currentlyRunning=this._queue;this._queue=[];for(var l=0,d=c;l<d.length;l+=1){var g=d[l];if(!g.cancelled&&(g.callback(s),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},ti.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ia={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},ap=o.window.HTMLImageElement,ku=o.window.HTMLElement,Tr=o.window.ImageBitmap,qn={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},hd=function(s){function c(d){var g=this;if((d=o.extend({},qn,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var x=new ur(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies);if(s.call(this,x,d),this._interactive=d.interactive,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._crossSourceCollisions=d.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=d.collectResourceTiming,this._renderTaskQueue=new ti,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},Ia,d.locale),this._clickTolerance=d.clickTolerance,this._requestManager=new o.RequestManager(d.transformRequest,d.accessToken),typeof d.container=="string"){if(this._container=o.window.document.getElementById(d.container),!this._container)throw new Error("Container '"+d.container+"' not found.")}else{if(!(d.container instanceof ku))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(d.maxBounds&&this.setMaxBounds(d.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return g._update(!1)}),this.on("moveend",function(){return g._update(!1)}),this.on("zoom",function(){return g._update(!0)}),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new pt(this,d),this._hash=d.hash&&new Vi(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,o.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=d.localIdeographFontFamily,d.style&&this.setStyle(d.style,{localIdeographFontFamily:d.localIdeographFontFamily}),d.attributionControl&&this.addControl(new di({customAttribution:d.customAttribution})),this.addControl(new ya,d.logoPosition),this.on("style.load",function(){g.transform.unmodified&&g.jumpTo(g.style.stylesheet)}),this.on("data",function(w){g._update(w.dataType==="style"),g.fire(new o.Event(w.dataType+"data",w))}),this.on("dataloading",function(w){g.fire(new o.Event(w.dataType+"dataloading",w))})}s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c;var l={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return c.prototype._getMapId=function(){return this._mapId},c.prototype.addControl=function(d,g){if(g===void 0&&(g=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var x=d.onAdd(this);this._controls.push(d);var w=this._controlPositions[g];return g.indexOf("bottom")!==-1?w.insertBefore(x,w.firstChild):w.appendChild(x),this},c.prototype.removeControl=function(d){if(!d||!d.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var g=this._controls.indexOf(d);return g>-1&&this._controls.splice(g,1),d.onRemove(this),this},c.prototype.hasControl=function(d){return this._controls.indexOf(d)>-1},c.prototype.resize=function(d){var g=this._containerDimensions(),x=g[0],w=g[1];if(x===this.transform.width&&w===this.transform.height)return this;this._resizeCanvas(x,w),this.transform.resize(x,w),this.painter.resize(x,w);var P=!this._moving;return P&&this.fire(new o.Event("movestart",d)).fire(new o.Event("move",d)),this.fire(new o.Event("resize",d)),P&&this.fire(new o.Event("moveend",d)),this},c.prototype.getBounds=function(){return this.transform.getBounds()},c.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},c.prototype.setMaxBounds=function(d){return this.transform.setMaxBounds(o.LngLatBounds.convert(d)),this._update()},c.prototype.setMinZoom=function(d){if((d=d??-2)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d&&this.setZoom(d),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},c.prototype.getMinZoom=function(){return this.transform.minZoom},c.prototype.setMaxZoom=function(d){if((d=d??22)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d&&this.setZoom(d),this;throw new Error("maxZoom must be greater than the current minZoom")},c.prototype.getMaxZoom=function(){return this.transform.maxZoom},c.prototype.setMinPitch=function(d){if((d=d??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d&&this.setPitch(d),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},c.prototype.getMinPitch=function(){return this.transform.minPitch},c.prototype.setMaxPitch=function(d){if((d=d??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d&&this.setPitch(d),this;throw new Error("maxPitch must be greater than the current minPitch")},c.prototype.getMaxPitch=function(){return this.transform.maxPitch},c.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},c.prototype.setRenderWorldCopies=function(d){return this.transform.renderWorldCopies=d,this._update()},c.prototype.project=function(d){return this.transform.locationPoint(o.LngLat.convert(d))},c.prototype.unproject=function(d){return this.transform.pointLocation(o.Point.convert(d))},c.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},c.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},c.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},c.prototype._createDelegatedListener=function(d,g,x){var w,P=this;if(d==="mouseenter"||d==="mouseover"){var A=!1;return{layer:g,listener:x,delegates:{mousemove:function(Z){var X=P.getLayer(g)?P.queryRenderedFeatures(Z.point,{layers:[g]}):[];X.length?A||(A=!0,x.call(P,new Mn(d,P,Z.originalEvent,{features:X}))):A=!1},mouseout:function(){A=!1}}}}if(d==="mouseleave"||d==="mouseout"){var j=!1;return{layer:g,listener:x,delegates:{mousemove:function(Z){(P.getLayer(g)?P.queryRenderedFeatures(Z.point,{layers:[g]}):[]).length?j=!0:j&&(j=!1,x.call(P,new Mn(d,P,Z.originalEvent)))},mouseout:function(Z){j&&(j=!1,x.call(P,new Mn(d,P,Z.originalEvent)))}}}}return{layer:g,listener:x,delegates:(w={},w[d]=function(Z){var X=P.getLayer(g)?P.queryRenderedFeatures(Z.point,{layers:[g]}):[];X.length&&(Z.features=X,x.call(P,Z),delete Z.features)},w)}},c.prototype.on=function(d,g,x){if(x===void 0)return s.prototype.on.call(this,d,g);var w=this._createDelegatedListener(d,g,x);for(var P in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(w),w.delegates)this.on(P,w.delegates[P]);return this},c.prototype.once=function(d,g,x){if(x===void 0)return s.prototype.once.call(this,d,g);var w=this._createDelegatedListener(d,g,x);for(var P in w.delegates)this.once(P,w.delegates[P]);return this},c.prototype.off=function(d,g,x){var w=this;return x===void 0?s.prototype.off.call(this,d,g):(this._delegatedListeners&&this._delegatedListeners[d]&&function(P){for(var A=P[d],j=0;j<A.length;j++){var Z=A[j];if(Z.layer===g&&Z.listener===x){for(var X in Z.delegates)w.off(X,Z.delegates[X]);return A.splice(j,1),w}}}(this._delegatedListeners),this)},c.prototype.queryRenderedFeatures=function(d,g){if(!this.style)return[];var x;if(g!==void 0||d===void 0||d instanceof o.Point||Array.isArray(d)||(g=d,d=void 0),g=g||{},(d=d||[[0,0],[this.transform.width,this.transform.height]])instanceof o.Point||typeof d[0]=="number")x=[o.Point.convert(d)];else{var w=o.Point.convert(d[0]),P=o.Point.convert(d[1]);x=[w,new o.Point(P.x,w.y),P,new o.Point(w.x,P.y),w]}return this.style.queryRenderedFeatures(x,g,this.transform)},c.prototype.querySourceFeatures=function(d,g){return this.style.querySourceFeatures(d,g)},c.prototype.setStyle=function(d,g){return(g=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},g)).diff!==!1&&g.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&d?(this._diffStyle(d,g),this):(this._localIdeographFontFamily=g.localIdeographFontFamily,this._updateStyle(d,g))},c.prototype._getUIString=function(d){var g=this._locale[d];if(g==null)throw new Error("Missing UI string '"+d+"'");return g},c.prototype._updateStyle=function(d,g){return this.style&&(this.style.setEventedParent(null),this.style._remove()),d?(this.style=new Ii(this,g||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d):this.style.loadJSON(d),this):(delete this.style,this)},c.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Ii(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},c.prototype._diffStyle=function(d,g){var x=this;if(typeof d=="string"){var w=this._requestManager.normalizeStyleURL(d),P=this._requestManager.transformRequest(w,o.ResourceType.Style);o.getJSON(P,function(A,j){A?x.fire(new o.ErrorEvent(A)):j&&x._updateDiff(j,g)})}else typeof d=="object"&&this._updateDiff(d,g)},c.prototype._updateDiff=function(d,g){try{this.style.setState(d)&&this._update(!0)}catch(x){o.warnOnce("Unable to perform style diff: "+(x.message||x.error||x)+".  Rebuilding the style from scratch."),this._updateStyle(d,g)}},c.prototype.getStyle=function(){if(this.style)return this.style.serialize()},c.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")},c.prototype.addSource=function(d,g){return this._lazyInitEmptyStyle(),this.style.addSource(d,g),this._update(!0)},c.prototype.isSourceLoaded=function(d){var g=this.style&&this.style.sourceCaches[d];if(g!==void 0)return g.loaded();this.fire(new o.ErrorEvent(new Error("There is no source with ID '"+d+"'")))},c.prototype.areTilesLoaded=function(){var d=this.style&&this.style.sourceCaches;for(var g in d){var x=d[g]._tiles;for(var w in x){var P=x[w];if(P.state!=="loaded"&&P.state!=="errored")return!1}}return!0},c.prototype.addSourceType=function(d,g,x){return this._lazyInitEmptyStyle(),this.style.addSourceType(d,g,x)},c.prototype.removeSource=function(d){return this.style.removeSource(d),this._update(!0)},c.prototype.getSource=function(d){return this.style.getSource(d)},c.prototype.addImage=function(d,g,x){x===void 0&&(x={});var w=x.pixelRatio;w===void 0&&(w=1);var P=x.sdf;P===void 0&&(P=!1);var A=x.stretchX,j=x.stretchY,Z=x.content;if(this._lazyInitEmptyStyle(),g instanceof ap||Tr&&g instanceof Tr){var X=o.browser.getImageData(g);this.style.addImage(d,{data:new o.RGBAImage({width:X.width,height:X.height},X.data),pixelRatio:w,stretchX:A,stretchY:j,content:Z,sdf:P,version:0})}else{if(g.width===void 0||g.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Q=g;this.style.addImage(d,{data:new o.RGBAImage({width:g.width,height:g.height},new Uint8Array(g.data)),pixelRatio:w,stretchX:A,stretchY:j,content:Z,sdf:P,version:0,userImage:Q}),Q.onAdd&&Q.onAdd(this,d)}},c.prototype.updateImage=function(d,g){var x=this.style.getImage(d);if(!x)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var w=g instanceof ap||Tr&&g instanceof Tr?o.browser.getImageData(g):g,P=w.width,A=w.height,j=w.data;return P===void 0||A===void 0?this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):P!==x.data.width||A!==x.data.height?this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(x.data.replace(j,!(g instanceof ap||Tr&&g instanceof Tr)),void this.style.updateImage(d,x))},c.prototype.hasImage=function(d){return d?!!this.style.getImage(d):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)},c.prototype.removeImage=function(d){this.style.removeImage(d)},c.prototype.loadImage=function(d,g){o.getImage(this._requestManager.transformRequest(d,o.ResourceType.Image),g)},c.prototype.listImages=function(){return this.style.listImages()},c.prototype.addLayer=function(d,g){return this._lazyInitEmptyStyle(),this.style.addLayer(d,g),this._update(!0)},c.prototype.moveLayer=function(d,g){return this.style.moveLayer(d,g),this._update(!0)},c.prototype.removeLayer=function(d){return this.style.removeLayer(d),this._update(!0)},c.prototype.getLayer=function(d){return this.style.getLayer(d)},c.prototype.setLayerZoomRange=function(d,g,x){return this.style.setLayerZoomRange(d,g,x),this._update(!0)},c.prototype.setFilter=function(d,g,x){return x===void 0&&(x={}),this.style.setFilter(d,g,x),this._update(!0)},c.prototype.getFilter=function(d){return this.style.getFilter(d)},c.prototype.setPaintProperty=function(d,g,x,w){return w===void 0&&(w={}),this.style.setPaintProperty(d,g,x,w),this._update(!0)},c.prototype.getPaintProperty=function(d,g){return this.style.getPaintProperty(d,g)},c.prototype.setLayoutProperty=function(d,g,x,w){return w===void 0&&(w={}),this.style.setLayoutProperty(d,g,x,w),this._update(!0)},c.prototype.getLayoutProperty=function(d,g){return this.style.getLayoutProperty(d,g)},c.prototype.setLight=function(d,g){return g===void 0&&(g={}),this._lazyInitEmptyStyle(),this.style.setLight(d,g),this._update(!0)},c.prototype.getLight=function(){return this.style.getLight()},c.prototype.setFeatureState=function(d,g){return this.style.setFeatureState(d,g),this._update()},c.prototype.removeFeatureState=function(d,g){return this.style.removeFeatureState(d,g),this._update()},c.prototype.getFeatureState=function(d){return this.style.getFeatureState(d)},c.prototype.getContainer=function(){return this._container},c.prototype.getCanvasContainer=function(){return this._canvasContainer},c.prototype.getCanvas=function(){return this._canvas},c.prototype._containerDimensions=function(){var d=0,g=0;return this._container&&(d=this._container.clientWidth||400,g=this._container.clientHeight||300),[d,g]},c.prototype._detectMissingCSS=function(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},c.prototype._setupContainer=function(){var d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=b.create("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();var g=this._canvasContainer=b.create("div","mapboxgl-canvas-container",d);this._interactive&&g.classList.add("mapboxgl-interactive"),this._canvas=b.create("canvas","mapboxgl-canvas",g),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var x=this._containerDimensions();this._resizeCanvas(x[0],x[1]);var w=this._controlContainer=b.create("div","mapboxgl-control-container",d),P=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(A){P[A]=b.create("div","mapboxgl-ctrl-"+A,w)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},c.prototype._resizeCanvas=function(d,g){var x=o.browser.devicePixelRatio||1;this._canvas.width=x*d,this._canvas.height=x*g,this._canvas.style.width=d+"px",this._canvas.style.height=g+"px"},c.prototype._setupPainter=function(){var d=o.extend({},_.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),g=this._canvas.getContext("webgl",d)||this._canvas.getContext("experimental-webgl",d);g?(this.painter=new Gr(g,this.transform),o.webpSupported.testSupport(g)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))},c.prototype._contextLost=function(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:d}))},c.prototype._contextRestored=function(d){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:d}))},c.prototype._onMapScroll=function(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},c.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},c.prototype._update=function(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this},c.prototype._requestRenderFrame=function(d){return this._update(),this._renderTaskQueue.add(d)},c.prototype._cancelRenderFrame=function(d){this._renderTaskQueue.remove(d)},c.prototype._render=function(d){var g,x=this,w=0,P=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(g=P.createQueryEXT(),P.beginQueryEXT(P.TIME_ELAPSED_EXT,g),w=o.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),!this._removed){var A=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var j=this.transform.zoom,Z=o.browser.now();this.style.zoomHistory.update(j,Z);var X=new o.EvaluationParameters(j,{now:Z,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Q=X.crossFadingFactor();Q===1&&Q===this._crossFadingFactor||(A=!0,this._crossFadingFactor=Q),this.style.update(X)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||A)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var pe=o.browser.now()-w;P.endQueryEXT(P.TIME_ELAPSED_EXT,g),setTimeout(function(){var ae=P.getQueryObjectEXT(g,P.QUERY_RESULT_EXT)/1e6;P.deleteQueryEXT(g),x.fire(new o.Event("gpu-timing-frame",{cpuTime:pe,gpuTime:ae}))},50)}if(this.listens("gpu-timing-layer")){var se=this.painter.collectGpuTimers();setTimeout(function(){var ae=x.painter.queryGpuTimers(se);x.fire(new o.Event("gpu-timing-layer",{layerTimes:ae}))},50)}var ye=this._sourcesDirty||this._styleDirty||this._placementDirty;return ye||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||ye||(this._fullyLoaded=!0),this}},c.prototype.remove=function(){this._hash&&this._hash.remove();for(var d=0,g=this._controls;d<g.length;d+=1)g[d].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1));var x=this.painter.context.gl.getExtension("WEBGL_lose_context");x&&x.loseContext(),Qo(this._canvasContainer),Qo(this._controlContainer),Qo(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new o.Event("remove"))},c.prototype.triggerRepaint=function(){var d=this;this.style&&!this._frame&&(this._frame=o.browser.frame(function(g){d._frame=null,d._render(g)}))},c.prototype._onWindowOnline=function(){this._update()},c.prototype._onWindowResize=function(d){this._trackResize&&this.resize({originalEvent:d})._update()},l.showTileBoundaries.get=function(){return!!this._showTileBoundaries},l.showTileBoundaries.set=function(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())},l.showPadding.get=function(){return!!this._showPadding},l.showPadding.set=function(d){this._showPadding!==d&&(this._showPadding=d,this._update())},l.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},l.showCollisionBoxes.set=function(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())},l.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},l.showOverdrawInspector.set=function(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())},l.repaint.get=function(){return!!this._repaint},l.repaint.set=function(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())},l.vertices.get=function(){return!!this._vertices},l.vertices.set=function(d){this._vertices=d,this._update()},c.prototype._setCacheLimits=function(d,g){o.setCacheLimits(d,g)},l.version.get=function(){return o.version},Object.defineProperties(c.prototype,l),c}(Au);function Qo(s){s.parentNode&&s.parentNode.removeChild(s)}var op={showCompass:!0,showZoom:!0,visualizePitch:!1},qa=function(s){var c=this;this.options=o.extend({},op,s),this._container=b.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(l){return l.preventDefault()}),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(l){return c._map.zoomIn({},{originalEvent:l})}),b.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(l){return c._map.zoomOut({},{originalEvent:l})}),b.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(l){c.options.visualizePitch?c._map.resetNorthPitch({},{originalEvent:l}):c._map.resetNorth({},{originalEvent:l})}),this._compassIcon=b.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};qa.prototype._updateZoomButtons=function(){var s=this._map.getZoom(),c=s===this._map.getMaxZoom(),l=s===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},qa.prototype._rotateCompassArrow=function(){var s=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=s},qa.prototype.onAdd=function(s){return this._map=s,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ki(this._map,this._compass,this.options.visualizePitch)),this._container},qa.prototype.onRemove=function(){b.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},qa.prototype._createButton=function(s,c){var l=b.create("button",s,this._container);return l.type="button",l.addEventListener("click",c),l},qa.prototype._setButtonTitle=function(s,c){var l=this._map._getUIString("NavigationControl."+c);s.title=l,s.setAttribute("aria-label",l)};var ki=function(s,c,l){l===void 0&&(l=!1),this._clickTolerance=10,this.element=c,this.mouseRotate=new Mu({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,l&&(this.mousePitch=new rp({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),b.addEventListener(c,"mousedown",this.mousedown),b.addEventListener(c,"touchstart",this.touchstart,{passive:!1}),b.addEventListener(c,"touchmove",this.touchmove),b.addEventListener(c,"touchend",this.touchend),b.addEventListener(c,"touchcancel",this.reset)};function Rs(s,c,l){if(s=new o.LngLat(s.lng,s.lat),c){var d=new o.LngLat(s.lng-360,s.lat),g=new o.LngLat(s.lng+360,s.lat),x=l.locationPoint(s).distSqr(c);l.locationPoint(d).distSqr(c)<x?s=d:l.locationPoint(g).distSqr(c)<x&&(s=g)}for(;Math.abs(s.lng-l.center.lng)>180;){var w=l.locationPoint(s);if(w.x>=0&&w.y>=0&&w.x<=l.width&&w.y<=l.height)break;s.lng>l.center.lng?s.lng-=360:s.lng+=360}return s}ki.prototype.down=function(s,c){this.mouseRotate.mousedown(s,c),this.mousePitch&&this.mousePitch.mousedown(s,c),b.disableDrag()},ki.prototype.move=function(s,c){var l=this.map,d=this.mouseRotate.mousemoveWindow(s,c);if(d&&d.bearingDelta&&l.setBearing(l.getBearing()+d.bearingDelta),this.mousePitch){var g=this.mousePitch.mousemoveWindow(s,c);g&&g.pitchDelta&&l.setPitch(l.getPitch()+g.pitchDelta)}},ki.prototype.off=function(){var s=this.element;b.removeEventListener(s,"mousedown",this.mousedown),b.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),b.removeEventListener(s,"touchmove",this.touchmove),b.removeEventListener(s,"touchend",this.touchend),b.removeEventListener(s,"touchcancel",this.reset),this.offTemp()},ki.prototype.offTemp=function(){b.enableDrag(),b.removeEventListener(o.window,"mousemove",this.mousemove),b.removeEventListener(o.window,"mouseup",this.mouseup)},ki.prototype.mousedown=function(s){this.down(o.extend({},s,{ctrlKey:!0,preventDefault:function(){return s.preventDefault()}}),b.mousePos(this.element,s)),b.addEventListener(o.window,"mousemove",this.mousemove),b.addEventListener(o.window,"mouseup",this.mouseup)},ki.prototype.mousemove=function(s){this.move(s,b.mousePos(this.element,s))},ki.prototype.mouseup=function(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()},ki.prototype.touchstart=function(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=b.touchPos(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return s.preventDefault()}},this._startPos))},ki.prototype.touchmove=function(s){s.targetTouches.length!==1?this.reset():(this._lastPos=b.touchPos(this.element,s.targetTouches)[0],this.move({preventDefault:function(){return s.preventDefault()}},this._lastPos))},ki.prototype.touchend=function(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},ki.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Ma={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Du(s,c,l){var d=s.classList;for(var g in Ma)d.remove("mapboxgl-"+l+"-anchor-"+g);d.add("mapboxgl-"+l+"-anchor-"+c)}var As,wl=function(s){function c(l,d){if(s.call(this),(l instanceof o.window.HTMLElement||d)&&(l=o.extend({element:l},d)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,l&&l.element)this._element=l.element,this._offset=o.Point.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=b.create("div"),this._element.setAttribute("aria-label","Map marker");var g=b.createNS("http://www.w3.org/2000/svg","svg");g.setAttributeNS(null,"display","block"),g.setAttributeNS(null,"height","41px"),g.setAttributeNS(null,"width","27px"),g.setAttributeNS(null,"viewBox","0 0 27 41");var x=b.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");var w=b.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");var P=b.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"transform","translate(3.0, 29.0)"),P.setAttributeNS(null,"fill","#000000");for(var A=0,j=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];A<j.length;A+=1){var Z=j[A],X=b.createNS("http://www.w3.org/2000/svg","ellipse");X.setAttributeNS(null,"opacity","0.04"),X.setAttributeNS(null,"cx","10.5"),X.setAttributeNS(null,"cy","5.80029008"),X.setAttributeNS(null,"rx",Z.rx),X.setAttributeNS(null,"ry",Z.ry),P.appendChild(X)}var Q=b.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"fill",this._color);var pe=b.createNS("http://www.w3.org/2000/svg","path");pe.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Q.appendChild(pe);var se=b.createNS("http://www.w3.org/2000/svg","g");se.setAttributeNS(null,"opacity","0.25"),se.setAttributeNS(null,"fill","#000000");var ye=b.createNS("http://www.w3.org/2000/svg","path");ye.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),se.appendChild(ye);var ae=b.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ae.setAttributeNS(null,"fill","#FFFFFF");var ge=b.createNS("http://www.w3.org/2000/svg","g");ge.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Ee=b.createNS("http://www.w3.org/2000/svg","circle");Ee.setAttributeNS(null,"fill","#000000"),Ee.setAttributeNS(null,"opacity","0.25"),Ee.setAttributeNS(null,"cx","5.5"),Ee.setAttributeNS(null,"cy","5.5"),Ee.setAttributeNS(null,"r","5.4999962");var Ie=b.createNS("http://www.w3.org/2000/svg","circle");Ie.setAttributeNS(null,"fill","#FFFFFF"),Ie.setAttributeNS(null,"cx","5.5"),Ie.setAttributeNS(null,"cy","5.5"),Ie.setAttributeNS(null,"r","5.4999962"),ge.appendChild(Ee),ge.appendChild(Ie),w.appendChild(P),w.appendChild(Q),w.appendChild(se),w.appendChild(ae),w.appendChild(ge),g.appendChild(w),g.setAttributeNS(null,"height",41*this._scale+"px"),g.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(g),this._offset=o.Point.convert(l&&l.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(je){je.preventDefault()}),this._element.addEventListener("mousedown",function(je){je.preventDefault()}),Du(this._element,this._anchor,"marker"),this._popup=null}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.addTo=function(l){return this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},c.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),b.remove(this._element),this._popup&&this._popup.remove(),this},c.prototype.getLngLat=function(){return this._lngLat},c.prototype.setLngLat=function(l){return this._lngLat=o.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},c.prototype.getElement=function(){return this._element},c.prototype.setPopup=function(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){var d=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(24.6+d)],"bottom-right":[-d,-1*(24.6+d)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=l,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},c.prototype._onKeyPress=function(l){var d=l.code,g=l.charCode||l.keyCode;d!=="Space"&&d!=="Enter"&&g!==32&&g!==13||this.togglePopup()},c.prototype._onMapClick=function(l){var d=l.originalEvent.target,g=this._element;this._popup&&(d===g||g.contains(d))&&this.togglePopup()},c.prototype.getPopup=function(){return this._popup},c.prototype.togglePopup=function(){var l=this._popup;return l?(l.isOpen()?l.remove():l.addTo(this._map),this):this},c.prototype._update=function(l){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Rs(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(d="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var g="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?g="rotateX(0deg)":this._pitchAlignment==="map"&&(g="rotateX("+this._map.getPitch()+"deg)"),l&&l.type!=="moveend"||(this._pos=this._pos.round()),b.setTransform(this._element,Ma[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+g+" "+d)}},c.prototype.getOffset=function(){return this._offset},c.prototype.setOffset=function(l){return this._offset=o.Point.convert(l),this._update(),this},c.prototype._onMove=function(l){if(!this._isDragging){var d=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))},c.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"},c.prototype._addDragHandler=function(l){this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},c.prototype.setDraggable=function(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},c.prototype.isDraggable=function(){return this._draggable},c.prototype.setRotation=function(l){return this._rotation=l||0,this._update(),this},c.prototype.getRotation=function(){return this._rotation},c.prototype.setRotationAlignment=function(l){return this._rotationAlignment=l||"auto",this._update(),this},c.prototype.getRotationAlignment=function(){return this._rotationAlignment},c.prototype.setPitchAlignment=function(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this},c.prototype.getPitchAlignment=function(){return this._pitchAlignment},c}(o.Evented),sp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ks=0,es=!1,lp=function(s){function c(l){s.call(this),this.options=o.extend({},sp,l),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.onAdd=function(l){var d;return this._map=l,this._container=b.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),d=this._setupUI,As!==void 0?d(As):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(function(g){d(As=g.state!=="denied")}):d(As=!!o.window.navigator.geolocation),this._container},c.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),b.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ks=0,es=!1},c.prototype._isOutOfMapMaxBounds=function(l){var d=this._map.getMaxBounds(),g=l.coords;return d&&(g.longitude<d.getWest()||g.longitude>d.getEast()||g.latitude<d.getSouth()||g.latitude>d.getNorth())},c.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},c.prototype._onSuccess=function(l){if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",l)),this._finish()}},c.prototype._updateCamera=function(l){var d=new o.LngLat(l.coords.longitude,l.coords.latitude),g=l.coords.accuracy,x=this._map.getBearing(),w=o.extend({bearing:x},this.options.fitBoundsOptions);this._map.fitBounds(d.toBounds(g),w,{geolocateSource:!0})},c.prototype._updateMarker=function(l){if(l){var d=new o.LngLat(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},c.prototype._updateCircleRadius=function(){var l=this._map._container.clientHeight/2,d=this._map.unproject([0,l]),g=this._map.unproject([1,l]),x=d.distanceTo(g),w=Math.ceil(2*this._accuracy/x);this._circleElement.style.width=w+"px",this._circleElement.style.height=w+"px"},c.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},c.prototype._onError=function(l){if(this._map){if(this.options.trackUserLocation)if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&es)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",l)),this._finish()}},c.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},c.prototype._setupUI=function(l){var d=this;if(this._container.addEventListener("contextmenu",function(w){return w.preventDefault()}),this._geolocateButton=b.create("button","mapboxgl-ctrl-geolocate",this._container),b.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",l===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var g=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=g,this._geolocateButton.setAttribute("aria-label",g)}else{var x=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=x,this._geolocateButton.setAttribute("aria-label",x)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=b.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new wl(this._dotElement),this._circleElement=b.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new wl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(w){w.geolocateSource||d._watchState!=="ACTIVE_LOCK"||w.originalEvent&&w.originalEvent.type==="resize"||(d._watchState="BACKGROUND",d._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),d._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),d.fire(new o.Event("trackuserlocationend")))})},c.prototype.trigger=function(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ks--,es=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var l;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++ks>1?(l={maximumAge:6e5,timeout:0},es=!0):(l=this.options.positionOptions,es=!1),this._geolocationWatchID=o.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,l)}}else o.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},c.prototype._clearWatch=function(){o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},c}(o.Evented),go={maxWidth:100,unit:"metric"},yo=function(s){this.options=o.extend({},go,s),o.bindAll(["_onMove","setUnit"],this)};function Lu(s,c,l){var d=l&&l.maxWidth||100,g=s._container.clientHeight/2,x=s.unproject([0,g]),w=s.unproject([d,g]),P=x.distanceTo(w);if(l&&l.unit==="imperial"){var A=3.2808*P;A>5280?_o(c,d,A/5280,s._getUIString("ScaleControl.Miles")):_o(c,d,A,s._getUIString("ScaleControl.Feet"))}else l&&l.unit==="nautical"?_o(c,d,P/1852,s._getUIString("ScaleControl.NauticalMiles")):P>=1e3?_o(c,d,P/1e3,s._getUIString("ScaleControl.Kilometers")):_o(c,d,P,s._getUIString("ScaleControl.Meters"))}function _o(s,c,l,d){var g,x,w,P=(g=l,(x=Math.pow(10,(""+Math.floor(g)).length-1))*(w=(w=g/x)>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:function(A){var j=Math.pow(10,Math.ceil(-Math.log(A)/Math.LN10));return Math.round(A*j)/j}(w)));s.style.width=c*(P/l)+"px",s.innerHTML=P+"&nbsp;"+d}yo.prototype.getDefaultPosition=function(){return"bottom-left"},yo.prototype._onMove=function(){Lu(this._map,this._container,this.options)},yo.prototype.onAdd=function(s){return this._map=s,this._container=b.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",s.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},yo.prototype.onRemove=function(){b.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},yo.prototype.setUnit=function(s){this.options.unit=s,Lu(this._map,this._container,this.options)};var sa=function(s){this._fullscreen=!1,s&&s.container&&(s.container instanceof o.window.HTMLElement?this._container=s.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in o.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in o.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in o.window.document&&(this._fullscreenchange="MSFullscreenChange")};sa.prototype.onAdd=function(s){return this._map=s,this._container||(this._container=this._map.getContainer()),this._controlContainer=b.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},sa.prototype.onRemove=function(){b.remove(this._controlContainer),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},sa.prototype._checkFullscreenSupport=function(){return!!(o.window.document.fullscreenEnabled||o.window.document.mozFullScreenEnabled||o.window.document.msFullscreenEnabled||o.window.document.webkitFullscreenEnabled)},sa.prototype._setupUI=function(){var s=this._fullscreenButton=b.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);b.create("span","mapboxgl-ctrl-icon",s).setAttribute("aria-hidden",!0),s.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},sa.prototype._updateTitle=function(){var s=this._getTitle();this._fullscreenButton.setAttribute("aria-label",s),this._fullscreenButton.title=s},sa.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},sa.prototype._isFullscreen=function(){return this._fullscreen},sa.prototype._changeIcon=function(){(o.window.document.fullscreenElement||o.window.document.mozFullScreenElement||o.window.document.webkitFullscreenElement||o.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},sa.prototype._onClickFullscreen=function(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.mozCancelFullScreen?o.window.document.mozCancelFullScreen():o.window.document.msExitFullscreen?o.window.document.msExitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var up={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Sl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),cp=function(s){function c(l){s.call(this),this.options=o.extend(Object.create(up),l),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return s&&(c.__proto__=s),(c.prototype=Object.create(s&&s.prototype)).constructor=c,c.prototype.addTo=function(l){return this._map&&this.remove(),this._map=l,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this},c.prototype.isOpen=function(){return!!this._map},c.prototype.remove=function(){return this._content&&b.remove(this._content),this._container&&(b.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this},c.prototype.getLngLat=function(){return this._lngLat},c.prototype.setLngLat=function(l){return this._lngLat=o.LngLat.convert(l),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},c.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},c.prototype.getElement=function(){return this._container},c.prototype.setText=function(l){return this.setDOMContent(o.window.document.createTextNode(l))},c.prototype.setHTML=function(l){var d,g=o.window.document.createDocumentFragment(),x=o.window.document.createElement("body");for(x.innerHTML=l;d=x.firstChild;)g.appendChild(d);return this.setDOMContent(g)},c.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},c.prototype.setMaxWidth=function(l){return this.options.maxWidth=l,this._update(),this},c.prototype.setDOMContent=function(l){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=b.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(l),this._createCloseButton(),this._update(),this._focusFirstElement(),this},c.prototype.addClassName=function(l){this._container&&this._container.classList.add(l)},c.prototype.removeClassName=function(l){this._container&&this._container.classList.remove(l)},c.prototype.setOffset=function(l){return this.options.offset=l,this._update(),this},c.prototype.toggleClassName=function(l){if(this._container)return this._container.classList.toggle(l)},c.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=b.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},c.prototype._onMouseUp=function(l){this._update(l.point)},c.prototype._onMouseMove=function(l){this._update(l.point)},c.prototype._onDrag=function(l){this._update(l.point)},c.prototype._update=function(l){var d=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=b.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=b.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(X){return d._container.classList.add(X)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Rs(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||l)){var g=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat),x=this.options.anchor,w=function X(Q){if(Q){if(typeof Q=="number"){var pe=Math.round(Math.sqrt(.5*Math.pow(Q,2)));return{center:new o.Point(0,0),top:new o.Point(0,Q),"top-left":new o.Point(pe,pe),"top-right":new o.Point(-pe,pe),bottom:new o.Point(0,-Q),"bottom-left":new o.Point(pe,-pe),"bottom-right":new o.Point(-pe,-pe),left:new o.Point(Q,0),right:new o.Point(-Q,0)}}if(Q instanceof o.Point||Array.isArray(Q)){var se=o.Point.convert(Q);return{center:se,top:se,"top-left":se,"top-right":se,bottom:se,"bottom-left":se,"bottom-right":se,left:se,right:se}}return{center:o.Point.convert(Q.center||[0,0]),top:o.Point.convert(Q.top||[0,0]),"top-left":o.Point.convert(Q["top-left"]||[0,0]),"top-right":o.Point.convert(Q["top-right"]||[0,0]),bottom:o.Point.convert(Q.bottom||[0,0]),"bottom-left":o.Point.convert(Q["bottom-left"]||[0,0]),"bottom-right":o.Point.convert(Q["bottom-right"]||[0,0]),left:o.Point.convert(Q.left||[0,0]),right:o.Point.convert(Q.right||[0,0])}}return X(new o.Point(0,0))}(this.options.offset);if(!x){var P,A=this._container.offsetWidth,j=this._container.offsetHeight;P=g.y+w.bottom.y<j?["top"]:g.y>this._map.transform.height-j?["bottom"]:[],g.x<A/2?P.push("left"):g.x>this._map.transform.width-A/2&&P.push("right"),x=P.length===0?"bottom":P.join("-")}var Z=g.add(w[x]).round();b.setTransform(this._container,Ma[x]+" translate("+Z.x+"px,"+Z.y+"px)"),Du(this._container,x,"popup")}},c.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var l=this._container.querySelector(Sl);l&&l.focus()}},c.prototype._onClose=function(){this.remove()},c}(o.Evented),zu={version:o.version,supported:_,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:hd,NavigationControl:qa,GeolocateControl:lp,AttributionControl:di,ScaleControl:yo,FullscreenControl:sa,Popup:cp,Marker:wl,Style:Ii,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,config:o.config,prewarm:function(){Fe().acquire(Ne)},clearPrewarmedResources:function(){var s=ct;s&&(s.isPreloaded()&&s.numActive()===1?(s.release(Ne),ct=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(s){o.config.ACCESS_TOKEN=s},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(s){o.config.API_URL=s},get workerCount(){return We.workerCount},set workerCount(s){We.workerCount=s},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(s){o.config.MAX_PARALLEL_IMAGE_REQUESTS=s},clearStorage:function(s){o.clearTileCache(s)},workerUrl:""};return zu}),p})})(R2);var VR=R2.exports;const Do=_n(VR);var qR=1e-7;function Og(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function A2(n,t){if(n===t)return!0;if(Og(n)&&Og(t)){if(n.length!==t.length)return!1;for(var i=0;i<n.length;++i)if(!A2(n[i],t[i]))return!1;return!0}return Math.abs(n-t)<=qR}function of(n,t,i){return Math.max(t,Math.min(i,n))}function qf(n,t,i){return Og(n)?n.map(function(u,p){return qf(u,t[p],i)}):i*t+(1-i)*n}function Ki(n,t){if(!n)throw new Error(t||"react-map-gl: assertion failed.")}function Ex(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function Px(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Ex(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Ex(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var hu={minZoom:0,maxZoom:24,minPitch:0,maxPitch:60},Rv={pitch:0,bearing:0,altitude:1.5},Tx=5,$R=1.2,Sc=function(){function n(t){var i=t.width,u=t.height,p=t.latitude,m=t.longitude,o=t.zoom,_=t.bearing,b=_===void 0?Rv.bearing:_,E=t.pitch,T=E===void 0?Rv.pitch:E,M=t.altitude,I=M===void 0?Rv.altitude:M,N=t.maxZoom,D=N===void 0?hu.maxZoom:N,re=t.minZoom,W=re===void 0?hu.minZoom:re,ee=t.maxPitch,J=ee===void 0?hu.maxPitch:ee,Y=t.minPitch,B=Y===void 0?hu.minPitch:Y,V=t.transitionDuration,K=t.transitionEasing,ve=t.transitionInterpolator,de=t.transitionInterruption,ie=t.startPanLngLat,we=t.startZoomLngLat,ze=t.startRotatePos,De=t.startBearing,ce=t.startPitch,Pe=t.startZoom;rl(this,n),Ki(Number.isFinite(i),"`width` must be supplied"),Ki(Number.isFinite(u),"`height` must be supplied"),Ki(Number.isFinite(m),"`longitude` must be supplied"),Ki(Number.isFinite(p),"`latitude` must be supplied"),Ki(Number.isFinite(o),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:i,height:u,latitude:p,longitude:m,zoom:o,bearing:b,pitch:T,altitude:I,maxZoom:D,minZoom:W,maxPitch:J,minPitch:B,transitionDuration:V,transitionEasing:K,transitionInterpolator:ve,transitionInterruption:de}),this._state={startPanLngLat:ie,startZoomLngLat:we,startRotatePos:ze,startBearing:De,startPitch:ce,startZoom:Pe}}return tl(n,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getState",value:function(){return this._state}},{key:"panStart",value:function(i){var u=i.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(u)})}},{key:"pan",value:function(i){var u=i.pos,p=i.startPos,m=this._state.startPanLngLat||this._unproject(p);if(!m)return this;var o=this._calculateNewLngLat({startPanLngLat:m,pos:u}),_=Bn(o,2),b=_[0],E=_[1];return this._getUpdatedMapState({longitude:b,latitude:E})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(i){var u=i.pos;return this._getUpdatedMapState({startRotatePos:u,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(i){var u=i.pos,p=i.deltaAngleX,m=p===void 0?0:p,o=i.deltaAngleY,_=o===void 0?0:o,b=this._state,E=b.startRotatePos,T=b.startBearing,M=b.startPitch;if(!Number.isFinite(T)||!Number.isFinite(M))return this;var I;return u?I=this._calculateNewPitchAndBearing(Px(Px({},this._getRotationParams(u,E)),{},{startBearing:T,startPitch:M})):I={bearing:T+m,pitch:M+_},this._getUpdatedMapState(I)}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(i){var u=i.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(u),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(i){var u=i.pos,p=i.startPos,m=i.scale;Ki(m>0,"`scale` must be a positive number");var o=this._state,_=o.startZoom,b=o.startZoomLngLat;Number.isFinite(_)||(_=this._viewportProps.zoom,b=this._unproject(p)||this._unproject(u)),Ki(b,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var E=this._calculateNewZoom({scale:m,startZoom:_||0}),T=new Ea(Object.assign({},this._viewportProps,{zoom:E})),M=T.getMapCenterByLngLatPosition({lngLat:b,pos:u}),I=Bn(M,2),N=I[0],D=I[1];return this._getUpdatedMapState({zoom:E,longitude:N,latitude:D})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(i){return new n(Object.assign({},this._viewportProps,this._state,i))}},{key:"_applyConstraints",value:function(i){var u=i.maxZoom,p=i.minZoom,m=i.zoom;i.zoom=of(m,p,u);var o=i.maxPitch,_=i.minPitch,b=i.pitch;return i.pitch=of(b,_,o),Object.assign(i,vR(i)),i}},{key:"_unproject",value:function(i){var u=new Ea(this._viewportProps);return i&&u.unproject(i)}},{key:"_calculateNewLngLat",value:function(i){var u=i.startPanLngLat,p=i.pos,m=new Ea(this._viewportProps);return m.getMapCenterByLngLatPosition({lngLat:u,pos:p})}},{key:"_calculateNewZoom",value:function(i){var u=i.scale,p=i.startZoom,m=this._viewportProps,o=m.maxZoom,_=m.minZoom,b=p+Math.log2(u);return of(b,_,o)}},{key:"_calculateNewPitchAndBearing",value:function(i){var u=i.deltaScaleX,p=i.deltaScaleY,m=i.startBearing,o=i.startPitch;p=of(p,-1,1);var _=this._viewportProps,b=_.minPitch,E=_.maxPitch,T=m+180*u,M=o;return p>0?M=o+p*(E-o):p<0&&(M=o-p*(b-o)),{pitch:M,bearing:T}}},{key:"_getRotationParams",value:function(i,u){var p=i[0]-u[0],m=i[1]-u[1],o=i[1],_=u[1],b=this._viewportProps,E=b.width,T=b.height,M=p/E,I=0;return m>0?Math.abs(T-_)>Tx&&(I=m/(_-T)*$R):m<0&&_>Tx&&(I=1-o/_),I=Math.min(1,Math.max(-1,I)),{deltaScaleX:M,deltaScaleY:I}}}]),n}();function WR(n){return n[0].toLowerCase()+n.slice(1)}function HR(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hu;for(var i in t){var u=i.slice(0,3),p=WR(i.slice(3));if(u==="min"&&n[p]<t[i]||u==="max"&&n[p]>t[i])return!1}return!0}function Cx(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function Ix(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Cx(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Cx(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var nl=me.createContext({viewport:null,map:null,container:null,onViewportChange:null,onViewStateChange:null,eventManager:null}),by=nl.Provider;function ZR(n){var t=n.value,i=n.children,u=me.useState(null),p=Bn(u,2),m=p[0],o=p[1],_=me.useContext(nl);return t=Ix(Ix({setMap:o},_),{},{map:_&&_.map||m},t),me.createElement(by,{value:t},i)}nl.Provider=ZR;var Rg=typeof window<"u"?me.useLayoutEffect:me.useEffect;function Mx(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function Ya(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Mx(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Mx(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var GR="https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens",k2="A valid API access token is required to use Mapbox data";function XR(){}function D2(n){var t=n.props,i=n.width,u=n.height;return new Ea(Ya(Ya(Ya({},t),t.viewState),{},{width:i,height:u}))}var KR=401,Ox={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},YR=Object.assign({},vu.propTypes,{width:Oe.oneOfType([Oe.number,Oe.string]),height:Oe.oneOfType([Oe.number,Oe.string]),onResize:Oe.func,disableTokenWarning:Oe.bool,visible:Oe.bool,className:Oe.string,style:Oe.object,visibilityConstraints:Oe.object}),JR=Object.assign({},vu.defaultProps,{disableTokenWarning:!1,visible:!0,onResize:XR,className:"",style:null,visibilityConstraints:hu});function QR(){var n={position:"absolute",left:0,top:0};return me.createElement("div",{key:"warning",id:"no-token-warning",style:n},me.createElement("h3",{key:"header"},k2),me.createElement("div",{key:"text"},"For information on setting up your basemap, read"),me.createElement("a",{key:"link",href:GR},"Note on Map Tokens"))}function eA(n){return{getMap:function(){return n.current&&n.current.getMap()},queryRenderedFeatures:function(i){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=n.current&&n.current.getMap();return p&&p.queryRenderedFeatures(i,u)}}}var il=me.forwardRef(function(n,t){var i=me.useState(!0),u=Bn(i,2),p=u[0],m=u[1],o=me.useState({width:0,height:0}),_=Bn(o,2),b=_[0],E=_[1],T=me.useRef(null),M=me.useRef(null),I=me.useRef(null),N=me.useRef(null),D=me.useContext(nl);Rg(function(){if(il.supported()){var we=new vu(Ya(Ya(Ya({},n),b),{},{mapboxgl:Do,container:M.current,onError:function(ce){var Pe=ce.error&&ce.error.status||ce.status;Pe===KR&&p&&(console.error(k2),m(!1)),n.onError(ce)}}));T.current=we,D&&D.setMap&&D.setMap(we.getMap());var ze=new M2(function(De){if(De[0].contentRect){var ce=De[0].contentRect,Pe=ce.width,gt=ce.height;E({width:Pe,height:gt}),n.onResize({width:Pe,height:gt})}});return ze.observe(I.current),function(){we.finalize(),T.current=null,ze.disconnect()}}},[]),Rg(function(){T.current&&T.current.setProps(Ya(Ya({},n),b))});var re=T.current&&T.current.getMap();me.useImperativeHandle(t,function(){return eA(T)},[]);var W=me.useCallback(function(we){var ze=we.target;ze===N.current&&ze.scrollTo(0,0)},[]),ee=re&&me.createElement(by,{value:Ya(Ya({},D),{},{viewport:D.viewport||D2(Ya({map:re,props:n},b)),map:re,container:D.container||I.current})},me.createElement("div",{key:"map-overlays",className:"overlays",ref:N,style:Ox,onScroll:W},n.children)),J=n.className,Y=n.width,B=n.height,V=n.style,K=n.visibilityConstraints,ve=Object.assign({position:"relative"},V,{width:Y,height:B}),de=n.visible&&HR(n.viewState||n,K),ie=Object.assign({},Ox,{visibility:de?"inherit":"hidden"});return me.createElement("div",{key:"map-container",ref:I,style:ve},me.createElement("div",{key:"map-mapbox",ref:M,style:ie,className:J}),ee,!p&&!n.disableTokenWarning&&me.createElement(QR,null))});il.supported=function(){return Do&&Do.supported()};il.propTypes=YR;il.defaultProps=JR;function tA(n,t){var i;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(i=rA(n))||t){i&&(n=i);var u=0,p=function(){};return{s:p,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(E){throw E},f:p}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,o=!1,_;return{s:function(){i=n[Symbol.iterator]()},n:function(){var E=i.next();return m=E.done,E},e:function(E){o=!0,_=E},f:function(){try{!m&&i.return!=null&&i.return()}finally{if(o)throw _}}}}function rA(n,t){if(n){if(typeof n=="string")return Rx(n,t);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(n);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Rx(n,t)}}function Rx(n,t){t=n.length;for(var i=0,u=new Array(t);i<t;i++)u[i]=n[i];return u}var L2=function(){function n(){rl(this,n),ft(this,"propNames",[])}return tl(n,[{key:"arePropsEqual",value:function(i,u){var p=tA(this.propNames||[]),m;try{for(p.s();!(m=p.n()).done;){var o=m.value;if(!A2(i[o],u[o]))return!1}}catch(_){p.e(_)}finally{p.f()}return!0}},{key:"initializeProps",value:function(i,u){return{start:i,end:u}}},{key:"interpolateProps",value:function(i,u,p){Ki(!1,"interpolateProps is not implemented")}},{key:"getDuration",value:function(i,u){return u.transitionDuration}}]),n}(),nA={longitude:1,bearing:1};function $f(n){return Number.isFinite(n)||Array.isArray(n)}function iA(n){return n in nA}function Ag(n,t,i){return iA(n)&&Math.abs(i-t)>180&&(i=i<0?i+360:i-360),i}function Av(n,t){var i;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(i=aA(n))||t){i&&(n=i);var u=0,p=function(){};return{s:p,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(E){throw E},f:p}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,o=!1,_;return{s:function(){i=n[Symbol.iterator]()},n:function(){var E=i.next();return m=E.done,E},e:function(E){o=!0,_=E},f:function(){try{!m&&i.return!=null&&i.return()}finally{if(o)throw _}}}}function aA(n,t){if(n){if(typeof n=="string")return Ax(n,t);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(n);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ax(n,t)}}function Ax(n,t){t=n.length;for(var i=0,u=new Array(t);i<t;i++)u[i]=n[i];return u}function oA(n){var t=sA();return function(){var u=Cc(n),p;if(t){var m=Cc(this).constructor;p=Reflect.construct(u,arguments,m)}else p=u.apply(this,arguments);return Jg(this,p)}}function sA(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var lA=["longitude","latitude","zoom","bearing","pitch"],uA=["latitude","longitude","zoom","width","height"],kx=["bearing","pitch"],cA={speed:1.2,curve:1.414};(function(n){Yg(i,n);var t=oA(i);function i(){var u,p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return rl(this,i),u=t.call(this),ft(Vs(u),"propNames",lA),u.props=Object.assign({},cA,p),u}return tl(i,[{key:"initializeProps",value:function(p,m){var o={},_={},b=Av(uA),E;try{for(b.s();!(E=b.n()).done;){var T=E.value,M=p[T],I=m[T];Ki($f(M)&&$f(I),"".concat(T," must be supplied for transition")),o[T]=M,_[T]=Ag(T,M,I)}}catch(J){b.e(J)}finally{b.f()}var N=Av(kx),D;try{for(N.s();!(D=N.n()).done;){var re=D.value,W=p[re]||0,ee=m[re]||0;o[re]=W,_[re]=Ag(re,W,ee)}}catch(J){N.e(J)}finally{N.f()}return{start:o,end:_}}},{key:"interpolateProps",value:function(p,m,o){var _=yR(p,m,o,this.props),b=Av(kx),E;try{for(b.s();!(E=b.n()).done;){var T=E.value;_[T]=qf(p[T],m[T],o)}}catch(M){b.e(M)}finally{b.f()}return _}},{key:"getDuration",value:function(p,m){var o=m.transitionDuration;return o==="auto"&&(o=_R(p,m,this.props)),o}}]),i})(L2);function Dx(n,t){var i;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(i=pA(n))||t){i&&(n=i);var u=0,p=function(){};return{s:p,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(E){throw E},f:p}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m=!0,o=!1,_;return{s:function(){i=n[Symbol.iterator]()},n:function(){var E=i.next();return m=E.done,E},e:function(E){o=!0,_=E},f:function(){try{!m&&i.return!=null&&i.return()}finally{if(o)throw _}}}}function pA(n,t){if(n){if(typeof n=="string")return Lx(n,t);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(n);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Lx(n,t)}}function Lx(n,t){t=n.length;for(var i=0,u=new Array(t);i<t;i++)u[i]=n[i];return u}function hA(n){var t=dA();return function(){var u=Cc(n),p;if(t){var m=Cc(this).constructor;p=Reflect.construct(u,arguments,m)}else p=u.apply(this,arguments);return Jg(this,p)}}function dA(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var fA=["longitude","latitude","zoom","bearing","pitch"],Ec=function(n){Yg(i,n);var t=hA(i);function i(){var u,p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return rl(this,i),u=t.call(this),Array.isArray(p)&&(p={transitionProps:p}),u.propNames=p.transitionProps||fA,p.around&&(u.around=p.around),u}return tl(i,[{key:"initializeProps",value:function(p,m){var o={},_={};if(this.around){o.around=this.around;var b=new Ea(p).unproject(this.around);Object.assign(_,m,{around:new Ea(m).project(b),aroundLngLat:b})}var E=Dx(this.propNames),T;try{for(E.s();!(T=E.n()).done;){var M=T.value,I=p[M],N=m[M];Ki($f(I)&&$f(N),"".concat(M," must be supplied for transition")),o[M]=I,_[M]=Ag(M,I,N)}}catch(D){E.e(D)}finally{E.f()}return{start:o,end:_}}},{key:"interpolateProps",value:function(p,m,o){var _={},b=Dx(this.propNames),E;try{for(b.s();!(E=b.n()).done;){var T=E.value;_[T]=qf(p[T],m[T],o)}}catch(re){b.e(re)}finally{b.f()}if(m.around){var M=new Ea(Object.assign({},m,_)).getMapCenterByLngLatPosition({lngLat:m.aroundLngLat,pos:qf(p.around,m.around,o)}),I=Bn(M,2),N=I[0],D=I[1];_.longitude=N,_.latitude=D}return _}}]),i}(L2),ch=function(){};function mA(n,t){var i=n(t);return function(u){return 1/(1-i)*(n(u*(1-t)+t)-i)}}var ph={BREAK:1,SNAP_TO_END:2,IGNORE:3,UPDATE:4},vA={transitionDuration:0,transitionEasing:function(t){return t},transitionInterpolator:new Ec,transitionInterruption:ph.BREAK,onTransitionStart:ch,onTransitionInterrupt:ch,onTransitionEnd:ch},xy=function(){function n(){var t=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};rl(this,n),ft(this,"_animationFrame",null),ft(this,"_onTransitionFrame",function(){t._animationFrame=requestAnimationFrame(t._onTransitionFrame),t._updateViewport()}),this.props=null,this.onViewportChange=i.onViewportChange||ch,this.onStateChange=i.onStateChange||ch,this.time=i.getTime||Date.now}return tl(n,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(i){var u=this.props;if(this.props=i,!u||this._shouldIgnoreViewportChange(u,i))return!1;if(this._isTransitionEnabled(i)){var p=Object.assign({},u),m=Object.assign({},i);if(this._isTransitionInProgress()&&(u.onTransitionInterrupt(),this.state.interruption===ph.SNAP_TO_END?Object.assign(p,this.state.endProps):Object.assign(p,this.state.propsInTransition),this.state.interruption===ph.UPDATE)){var o=this.time(),_=(o-this.state.startTime)/this.state.duration;m.transitionDuration=this.state.duration-(o-this.state.startTime),m.transitionEasing=mA(this.state.easing,_),m.transitionInterpolator=p.transitionInterpolator}return m.onTransitionStart(),this._triggerTransition(p,m),!0}return this._isTransitionInProgress()&&(u.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return!!this._animationFrame}},{key:"_isTransitionEnabled",value:function(i){var u=i.transitionDuration,p=i.transitionInterpolator;return(u>0||u==="auto")&&!!p}},{key:"_isUpdateDueToCurrentTransition",value:function(i){return this.state.propsInTransition?this.state.interpolator.arePropsEqual(i,this.state.propsInTransition):!1}},{key:"_shouldIgnoreViewportChange",value:function(i,u){return i?this._isTransitionInProgress()?this.state.interruption===ph.IGNORE||this._isUpdateDueToCurrentTransition(u):this._isTransitionEnabled(u)?u.transitionInterpolator.arePropsEqual(i,u):!0:!0}},{key:"_triggerTransition",value:function(i,u){Ki(this._isTransitionEnabled(u)),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var p=u.transitionInterpolator,m=p.getDuration?p.getDuration(i,u):u.transitionDuration;if(m!==0){var o=u.transitionInterpolator.initializeProps(i,u),_={inTransition:!0,isZooming:i.zoom!==u.zoom,isPanning:i.longitude!==u.longitude||i.latitude!==u.latitude,isRotating:i.bearing!==u.bearing||i.pitch!==u.pitch};this.state={duration:m,easing:u.transitionEasing,interpolator:u.transitionInterpolator,interruption:u.transitionInterruption,startTime:this.time(),startProps:o.start,endProps:o.end,animation:null,propsInTransition:{}},this._onTransitionFrame(),this.onStateChange(_)}}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var i=this.time(),u=this.state,p=u.startTime,m=u.duration,o=u.easing,_=u.interpolator,b=u.startProps,E=u.endProps,T=!1,M=(i-p)/m;M>=1&&(M=1,T=!0),M=o(M);var I=_.interpolateProps(b,E,M),N=new Sc(Object.assign({},this.props,I));this.state.propsInTransition=N.getViewportProps(),this.onViewportChange(this.state.propsInTransition,this.props),T&&(this._endTransition(),this.props.onTransitionEnd())}}]),n}();ft(xy,"defaultProps",vA);var z2={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(n){(function(t,i,u,p){var m=["","webkit","Moz","MS","ms","o"],o=i.createElement("div"),_="function",b=Math.round,E=Math.abs,T=Date.now;function M(H,ne,be){return setTimeout(Y(H,be),ne)}function I(H,ne,be){return Array.isArray(H)?(N(H,be[ne],be),!0):!1}function N(H,ne,be){var Ae;if(H)if(H.forEach)H.forEach(ne,be);else if(H.length!==p)for(Ae=0;Ae<H.length;)ne.call(be,H[Ae],Ae,H),Ae++;else for(Ae in H)H.hasOwnProperty(Ae)&&ne.call(be,H[Ae],Ae,H)}function D(H,ne,be){var Ae="DEPRECATED METHOD: "+ne+`
`+be+` AT 
`;return function(){var Ge=new Error("get-stack-trace"),yt=Ge&&Ge.stack?Ge.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",fr=t.console&&(t.console.warn||t.console.log);return fr&&fr.call(t.console,Ae,yt),H.apply(this,arguments)}}var re;typeof Object.assign!="function"?re=function(ne){if(ne===p||ne===null)throw new TypeError("Cannot convert undefined or null to object");for(var be=Object(ne),Ae=1;Ae<arguments.length;Ae++){var Ge=arguments[Ae];if(Ge!==p&&Ge!==null)for(var yt in Ge)Ge.hasOwnProperty(yt)&&(be[yt]=Ge[yt])}return be}:re=Object.assign;var W=D(function(ne,be,Ae){for(var Ge=Object.keys(be),yt=0;yt<Ge.length;)(!Ae||Ae&&ne[Ge[yt]]===p)&&(ne[Ge[yt]]=be[Ge[yt]]),yt++;return ne},"extend","Use `assign`."),ee=D(function(ne,be){return W(ne,be,!0)},"merge","Use `assign`.");function J(H,ne,be){var Ae=ne.prototype,Ge;Ge=H.prototype=Object.create(Ae),Ge.constructor=H,Ge._super=Ae,be&&re(Ge,be)}function Y(H,ne){return function(){return H.apply(ne,arguments)}}function B(H,ne){return typeof H==_?H.apply(ne&&ne[0]||p,ne):H}function V(H,ne){return H===p?ne:H}function K(H,ne,be){N(we(ne),function(Ae){H.addEventListener(Ae,be,!1)})}function ve(H,ne,be){N(we(ne),function(Ae){H.removeEventListener(Ae,be,!1)})}function de(H,ne){for(;H;){if(H==ne)return!0;H=H.parentNode}return!1}function ie(H,ne){return H.indexOf(ne)>-1}function we(H){return H.trim().split(/\s+/g)}function ze(H,ne,be){if(H.indexOf&&!be)return H.indexOf(ne);for(var Ae=0;Ae<H.length;){if(be&&H[Ae][be]==ne||!be&&H[Ae]===ne)return Ae;Ae++}return-1}function De(H){return Array.prototype.slice.call(H,0)}function ce(H,ne,be){for(var Ae=[],Ge=[],yt=0;yt<H.length;){var fr=H[yt][ne];ze(Ge,fr)<0&&Ae.push(H[yt]),Ge[yt]=fr,yt++}return Ae=Ae.sort(function(Vn,Jn){return Vn[ne]>Jn[ne]}),Ae}function Pe(H,ne){for(var be,Ae,Ge=ne[0].toUpperCase()+ne.slice(1),yt=0;yt<m.length;){if(be=m[yt],Ae=be?be+Ge:ne,Ae in H)return Ae;yt++}return p}var gt=1;function jt(){return gt++}function Tt(H){var ne=H.ownerDocument||H;return ne.defaultView||ne.parentWindow||t}var kt=/mobile|tablet|ip(ad|hone|od)|android/i,Ir="ontouchstart"in t,pr=Pe(t,"PointerEvent")!==p,Zt=Ir&&kt.test(navigator.userAgent),Kt="touch",Yt="pen",Dt="mouse",Gt="kinect",yr=25,Et=1,er=2,mt=4,$t=8,Nr=1,Br=2,It=4,$r=8,hr=16,dr=Br|It,Un=$r|hr,Tn=dr|Un,Pi=["x","y"],bn=["clientX","clientY"];function en(H,ne){var be=this;this.manager=H,this.callback=ne,this.element=H.element,this.target=H.options.inputTarget,this.domHandler=function(Ae){B(H.options.enable,[H])&&be.handler(Ae)},this.init()}en.prototype={handler:function(){},init:function(){this.evEl&&K(this.element,this.evEl,this.domHandler),this.evTarget&&K(this.target,this.evTarget,this.domHandler),this.evWin&&K(Tt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ve(this.element,this.evEl,this.domHandler),this.evTarget&&ve(this.target,this.evTarget,this.domHandler),this.evWin&&ve(Tt(this.element),this.evWin,this.domHandler)}};function ea(H){var ne,be=H.options.inputClass;return be?ne=be:pr?ne=Ta:Zt?ne=xe:Ir?ne=Ce:ne=ja,new ne(H,Wt)}function Wt(H,ne,be){var Ae=be.pointers.length,Ge=be.changedPointers.length,yt=ne&Et&&Ae-Ge===0,fr=ne&(mt|$t)&&Ae-Ge===0;be.isFirst=!!yt,be.isFinal=!!fr,yt&&(H.session={}),be.eventType=ne,lt(H,be),H.emit("hammer.input",be),H.recognize(be),H.session.prevInput=be}function lt(H,ne){var be=H.session,Ae=ne.pointers,Ge=Ae.length;be.firstInput||(be.firstInput=xn(ne)),Ge>1&&!be.firstMultiple?be.firstMultiple=xn(ne):Ge===1&&(be.firstMultiple=!1);var yt=be.firstInput,fr=be.firstMultiple,wn=fr?fr.center:yt.center,Vn=ne.center=Cn(Ae);ne.timeStamp=T(),ne.deltaTime=ne.timeStamp-yt.timeStamp,ne.angle=to(wn,Vn),ne.distance=da(wn,Vn),Mt(be,ne),ne.offsetDirection=Ui(ne.deltaX,ne.deltaY);var Jn=ri(ne.deltaTime,ne.deltaX,ne.deltaY);ne.overallVelocityX=Jn.x,ne.overallVelocityY=Jn.y,ne.overallVelocity=E(Jn.x)>E(Jn.y)?Jn.x:Jn.y,ne.scale=fr?Lo(fr.pointers,Ae):1,ne.rotation=fr?ro(fr.pointers,Ae):0,ne.maxPointers=be.prevInput?ne.pointers.length>be.prevInput.maxPointers?ne.pointers.length:be.prevInput.maxPointers:ne.pointers.length,nr(be,ne);var na=H.element;de(ne.srcEvent.target,na)&&(na=ne.srcEvent.target),ne.target=na}function Mt(H,ne){var be=ne.center,Ae=H.offsetDelta||{},Ge=H.prevDelta||{},yt=H.prevInput||{};(ne.eventType===Et||yt.eventType===mt)&&(Ge=H.prevDelta={x:yt.deltaX||0,y:yt.deltaY||0},Ae=H.offsetDelta={x:be.x,y:be.y}),ne.deltaX=Ge.x+(be.x-Ae.x),ne.deltaY=Ge.y+(be.y-Ae.y)}function nr(H,ne){var be=H.lastInterval||ne,Ae=ne.timeStamp-be.timeStamp,Ge,yt,fr,wn;if(ne.eventType!=$t&&(Ae>yr||be.velocity===p)){var Vn=ne.deltaX-be.deltaX,Jn=ne.deltaY-be.deltaY,na=ri(Ae,Vn,Jn);yt=na.x,fr=na.y,Ge=E(na.x)>E(na.y)?na.x:na.y,wn=Ui(Vn,Jn),H.lastInterval=ne}else Ge=be.velocity,yt=be.velocityX,fr=be.velocityY,wn=be.direction;ne.velocity=Ge,ne.velocityX=yt,ne.velocityY=fr,ne.direction=wn}function xn(H){for(var ne=[],be=0;be<H.pointers.length;)ne[be]={clientX:b(H.pointers[be].clientX),clientY:b(H.pointers[be].clientY)},be++;return{timeStamp:T(),pointers:ne,center:Cn(ne),deltaX:H.deltaX,deltaY:H.deltaY}}function Cn(H){var ne=H.length;if(ne===1)return{x:b(H[0].clientX),y:b(H[0].clientY)};for(var be=0,Ae=0,Ge=0;Ge<ne;)be+=H[Ge].clientX,Ae+=H[Ge].clientY,Ge++;return{x:b(be/ne),y:b(Ae/ne)}}function ri(H,ne,be){return{x:ne/H||0,y:be/H||0}}function Ui(H,ne){return H===ne?Nr:E(H)>=E(ne)?H<0?Br:It:ne<0?$r:hr}function da(H,ne,be){be||(be=Pi);var Ae=ne[be[0]]-H[be[0]],Ge=ne[be[1]]-H[be[1]];return Math.sqrt(Ae*Ae+Ge*Ge)}function to(H,ne,be){be||(be=Pi);var Ae=ne[be[0]]-H[be[0]],Ge=ne[be[1]]-H[be[1]];return Math.atan2(Ge,Ae)*180/Math.PI}function ro(H,ne){return to(ne[1],ne[0],bn)+to(H[1],H[0],bn)}function Lo(H,ne){return da(ne[0],ne[1],bn)/da(H[0],H[1],bn)}var za={mousedown:Et,mousemove:er,mouseup:mt},zo="mousedown",jo="mousemove mouseup";function ja(){this.evEl=zo,this.evWin=jo,this.pressed=!1,en.apply(this,arguments)}J(ja,en,{handler:function(ne){var be=za[ne.type];be&Et&&ne.button===0&&(this.pressed=!0),be&er&&ne.which!==1&&(be=mt),this.pressed&&(be&mt&&(this.pressed=!1),this.callback(this.manager,be,{pointers:[ne],changedPointers:[ne],pointerType:Dt,srcEvent:ne}))}});var ws={pointerdown:Et,pointermove:er,pointerup:mt,pointercancel:$t,pointerout:$t},Na={2:Kt,3:Yt,4:Dt,5:Gt},ta="pointerdown",ra="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(ta="MSPointerDown",ra="MSPointerMove MSPointerUp MSPointerCancel");function Ta(){this.evEl=ta,this.evWin=ra,en.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}J(Ta,en,{handler:function(ne){var be=this.store,Ae=!1,Ge=ne.type.toLowerCase().replace("ms",""),yt=ws[Ge],fr=Na[ne.pointerType]||ne.pointerType,wn=fr==Kt,Vn=ze(be,ne.pointerId,"pointerId");yt&Et&&(ne.button===0||wn)?Vn<0&&(be.push(ne),Vn=be.length-1):yt&(mt|$t)&&(Ae=!0),!(Vn<0)&&(be[Vn]=ne,this.callback(this.manager,yt,{pointers:be,changedPointers:[ne],pointerType:fr,srcEvent:ne}),Ae&&be.splice(Vn,1))}});var No={touchstart:Et,touchmove:er,touchend:mt,touchcancel:$t},tn="touchstart",z="touchstart touchmove touchend touchcancel";function F(){this.evTarget=tn,this.evWin=z,this.started=!1,en.apply(this,arguments)}J(F,en,{handler:function(ne){var be=No[ne.type];if(be===Et&&(this.started=!0),!!this.started){var Ae=q.call(this,ne,be);be&(mt|$t)&&Ae[0].length-Ae[1].length===0&&(this.started=!1),this.callback(this.manager,be,{pointers:Ae[0],changedPointers:Ae[1],pointerType:Kt,srcEvent:ne})}}});function q(H,ne){var be=De(H.touches),Ae=De(H.changedTouches);return ne&(mt|$t)&&(be=ce(be.concat(Ae),"identifier")),[be,Ae]}var te={touchstart:Et,touchmove:er,touchend:mt,touchcancel:$t},ue="touchstart touchmove touchend touchcancel";function xe(){this.evTarget=ue,this.targetIds={},en.apply(this,arguments)}J(xe,en,{handler:function(ne){var be=te[ne.type],Ae=Se.call(this,ne,be);Ae&&this.callback(this.manager,be,{pointers:Ae[0],changedPointers:Ae[1],pointerType:Kt,srcEvent:ne})}});function Se(H,ne){var be=De(H.touches),Ae=this.targetIds;if(ne&(Et|er)&&be.length===1)return Ae[be[0].identifier]=!0,[be,be];var Ge,yt,fr=De(H.changedTouches),wn=[],Vn=this.target;if(yt=be.filter(function(Jn){return de(Jn.target,Vn)}),ne===Et)for(Ge=0;Ge<yt.length;)Ae[yt[Ge].identifier]=!0,Ge++;for(Ge=0;Ge<fr.length;)Ae[fr[Ge].identifier]&&wn.push(fr[Ge]),ne&(mt|$t)&&delete Ae[fr[Ge].identifier],Ge++;if(wn.length)return[ce(yt.concat(wn),"identifier"),wn]}var G=2500,he=25;function Ce(){en.apply(this,arguments);var H=Y(this.handler,this);this.touch=new xe(this.manager,H),this.mouse=new ja(this.manager,H),this.primaryTouch=null,this.lastTouches=[]}J(Ce,en,{handler:function(ne,be,Ae){var Ge=Ae.pointerType==Kt,yt=Ae.pointerType==Dt;if(!(yt&&Ae.sourceCapabilities&&Ae.sourceCapabilities.firesTouchEvents)){if(Ge)$e.call(this,be,Ae);else if(yt&&Ne.call(this,Ae))return;this.callback(ne,be,Ae)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function $e(H,ne){H&Et?(this.primaryTouch=ne.changedPointers[0].identifier,He.call(this,ne)):H&(mt|$t)&&He.call(this,ne)}function He(H){var ne=H.changedPointers[0];if(ne.identifier===this.primaryTouch){var be={x:ne.clientX,y:ne.clientY};this.lastTouches.push(be);var Ae=this.lastTouches,Ge=function(){var yt=Ae.indexOf(be);yt>-1&&Ae.splice(yt,1)};setTimeout(Ge,G)}}function Ne(H){for(var ne=H.srcEvent.clientX,be=H.srcEvent.clientY,Ae=0;Ae<this.lastTouches.length;Ae++){var Ge=this.lastTouches[Ae],yt=Math.abs(ne-Ge.x),fr=Math.abs(be-Ge.y);if(yt<=he&&fr<=he)return!0}return!1}var We=Pe(o.style,"touchAction"),ct=We!==p,ot="compute",Fe="auto",rt="manipulation",Ye="none",Je="pan-x",Bt="pan-y",tt=Jt();function tr(H,ne){this.manager=H,this.set(ne)}tr.prototype={set:function(H){H==ot&&(H=this.compute()),ct&&this.manager.element.style&&tt[H]&&(this.manager.element.style[We]=H),this.actions=H.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var H=[];return N(this.manager.recognizers,function(ne){B(ne.options.enable,[ne])&&(H=H.concat(ne.getTouchAction()))}),Mr(H.join(" "))},preventDefaults:function(H){var ne=H.srcEvent,be=H.offsetDirection;if(this.manager.session.prevented){ne.preventDefault();return}var Ae=this.actions,Ge=ie(Ae,Ye)&&!tt[Ye],yt=ie(Ae,Bt)&&!tt[Bt],fr=ie(Ae,Je)&&!tt[Je];if(Ge){var wn=H.pointers.length===1,Vn=H.distance<2,Jn=H.deltaTime<250;if(wn&&Vn&&Jn)return}if(!(fr&&yt)&&(Ge||yt&&be&dr||fr&&be&Un))return this.preventSrc(ne)},preventSrc:function(H){this.manager.session.prevented=!0,H.preventDefault()}};function Mr(H){if(ie(H,Ye))return Ye;var ne=ie(H,Je),be=ie(H,Bt);return ne&&be?Ye:ne||be?ne?Je:Bt:ie(H,rt)?rt:Fe}function Jt(){if(!ct)return!1;var H={},ne=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(be){H[be]=ne?t.CSS.supports("touch-action",be):!0}),H}var lr=1,Ft=2,fn=4,ar=8,Or=ar,gr=16,Ut=32;function Qt(H){this.options=re({},this.defaults,H||{}),this.id=jt(),this.manager=null,this.options.enable=V(this.options.enable,!0),this.state=lr,this.simultaneous={},this.requireFail=[]}Qt.prototype={defaults:{},set:function(H){return re(this.options,H),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(H){if(I(H,"recognizeWith",this))return this;var ne=this.simultaneous;return H=on(H,this),ne[H.id]||(ne[H.id]=H,H.recognizeWith(this)),this},dropRecognizeWith:function(H){return I(H,"dropRecognizeWith",this)?this:(H=on(H,this),delete this.simultaneous[H.id],this)},requireFailure:function(H){if(I(H,"requireFailure",this))return this;var ne=this.requireFail;return H=on(H,this),ze(ne,H)===-1&&(ne.push(H),H.requireFailure(this)),this},dropRequireFailure:function(H){if(I(H,"dropRequireFailure",this))return this;H=on(H,this);var ne=ze(this.requireFail,H);return ne>-1&&this.requireFail.splice(ne,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(H){return!!this.simultaneous[H.id]},emit:function(H){var ne=this,be=this.state;function Ae(Ge){ne.manager.emit(Ge,H)}be<ar&&Ae(ne.options.event+Yn(be)),Ae(ne.options.event),H.additionalEvent&&Ae(H.additionalEvent),be>=ar&&Ae(ne.options.event+Yn(be))},tryEmit:function(H){if(this.canEmit())return this.emit(H);this.state=Ut},canEmit:function(){for(var H=0;H<this.requireFail.length;){if(!(this.requireFail[H].state&(Ut|lr)))return!1;H++}return!0},recognize:function(H){var ne=re({},H);if(!B(this.options.enable,[this,ne])){this.reset(),this.state=Ut;return}this.state&(Or|gr|Ut)&&(this.state=lr),this.state=this.process(ne),this.state&(Ft|fn|ar|gr)&&this.tryEmit(ne)},process:function(H){},getTouchAction:function(){},reset:function(){}};function Yn(H){return H&gr?"cancel":H&ar?"end":H&fn?"move":H&Ft?"start":""}function no(H){return H==hr?"down":H==$r?"up":H==Br?"left":H==It?"right":""}function on(H,ne){var be=ne.manager;return be?be.get(H):H}function Hr(){Qt.apply(this,arguments)}J(Hr,Qt,{defaults:{pointers:1},attrTest:function(H){var ne=this.options.pointers;return ne===0||H.pointers.length===ne},process:function(H){var ne=this.state,be=H.eventType,Ae=ne&(Ft|fn),Ge=this.attrTest(H);return Ae&&(be&$t||!Ge)?ne|gr:Ae||Ge?be&mt?ne|ar:ne&Ft?ne|fn:Ft:Ut}});function io(){Hr.apply(this,arguments),this.pX=null,this.pY=null}J(io,Hr,{defaults:{event:"pan",threshold:10,pointers:1,direction:Tn},getTouchAction:function(){var H=this.options.direction,ne=[];return H&dr&&ne.push(Bt),H&Un&&ne.push(Je),ne},directionTest:function(H){var ne=this.options,be=!0,Ae=H.distance,Ge=H.direction,yt=H.deltaX,fr=H.deltaY;return Ge&ne.direction||(ne.direction&dr?(Ge=yt===0?Nr:yt<0?Br:It,be=yt!=this.pX,Ae=Math.abs(H.deltaX)):(Ge=fr===0?Nr:fr<0?$r:hr,be=fr!=this.pY,Ae=Math.abs(H.deltaY))),H.direction=Ge,be&&Ae>ne.threshold&&Ge&ne.direction},attrTest:function(H){return Hr.prototype.attrTest.call(this,H)&&(this.state&Ft||!(this.state&Ft)&&this.directionTest(H))},emit:function(H){this.pX=H.deltaX,this.pY=H.deltaY;var ne=no(H.direction);ne&&(H.additionalEvent=this.options.event+ne),this._super.emit.call(this,H)}});function Ba(){Hr.apply(this,arguments)}J(Ba,Hr,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ye]},attrTest:function(H){return this._super.attrTest.call(this,H)&&(Math.abs(H.scale-1)>this.options.threshold||this.state&Ft)},emit:function(H){if(H.scale!==1){var ne=H.scale<1?"in":"out";H.additionalEvent=this.options.event+ne}this._super.emit.call(this,H)}});function Zr(){Qt.apply(this,arguments),this._timer=null,this._input=null}J(Zr,Qt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Fe]},process:function(H){var ne=this.options,be=H.pointers.length===ne.pointers,Ae=H.distance<ne.threshold,Ge=H.deltaTime>ne.time;if(this._input=H,!Ae||!be||H.eventType&(mt|$t)&&!Ge)this.reset();else if(H.eventType&Et)this.reset(),this._timer=M(function(){this.state=Or,this.tryEmit()},ne.time,this);else if(H.eventType&mt)return Or;return Ut},reset:function(){clearTimeout(this._timer)},emit:function(H){this.state===Or&&(H&&H.eventType&mt?this.manager.emit(this.options.event+"up",H):(this._input.timeStamp=T(),this.manager.emit(this.options.event,this._input)))}});function Fa(){Hr.apply(this,arguments)}J(Fa,Hr,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ye]},attrTest:function(H){return this._super.attrTest.call(this,H)&&(Math.abs(H.rotation)>this.options.threshold||this.state&Ft)}});function Dn(){Hr.apply(this,arguments)}J(Dn,Hr,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:dr|Un,pointers:1},getTouchAction:function(){return io.prototype.getTouchAction.call(this)},attrTest:function(H){var ne=this.options.direction,be;return ne&(dr|Un)?be=H.overallVelocity:ne&dr?be=H.overallVelocityX:ne&Un&&(be=H.overallVelocityY),this._super.attrTest.call(this,H)&&ne&H.offsetDirection&&H.distance>this.options.threshold&&H.maxPointers==this.options.pointers&&E(be)>this.options.velocity&&H.eventType&mt},emit:function(H){var ne=no(H.offsetDirection);ne&&this.manager.emit(this.options.event+ne,H),this.manager.emit(this.options.event,H)}});function sn(){Qt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}J(sn,Qt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[rt]},process:function(H){var ne=this.options,be=H.pointers.length===ne.pointers,Ae=H.distance<ne.threshold,Ge=H.deltaTime<ne.time;if(this.reset(),H.eventType&Et&&this.count===0)return this.failTimeout();if(Ae&&Ge&&be){if(H.eventType!=mt)return this.failTimeout();var yt=this.pTime?H.timeStamp-this.pTime<ne.interval:!0,fr=!this.pCenter||da(this.pCenter,H.center)<ne.posThreshold;this.pTime=H.timeStamp,this.pCenter=H.center,!fr||!yt?this.count=1:this.count+=1,this._input=H;var wn=this.count%ne.taps;if(wn===0)return this.hasRequireFailures()?(this._timer=M(function(){this.state=Or,this.tryEmit()},ne.interval,this),Ft):Or}return Ut},failTimeout:function(){return this._timer=M(function(){this.state=Ut},this.options.interval,this),Ut},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Or&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function In(H,ne){return ne=ne||{},ne.recognizers=V(ne.recognizers,In.defaults.preset),new ni(H,ne)}In.VERSION="2.0.7",In.defaults={domEvents:!1,touchAction:ot,enable:!0,inputTarget:null,inputClass:null,preset:[[Fa,{enable:!1}],[Ba,{enable:!1},["rotate"]],[Dn,{direction:dr}],[io,{direction:dr},["swipe"]],[sn],[sn,{event:"doubletap",taps:2},["tap"]],[Zr]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Fr=1,Ti=2;function ni(H,ne){this.options=re({},In.defaults,ne||{}),this.options.inputTarget=this.options.inputTarget||H,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=H,this.input=ea(this),this.touchAction=new tr(this,this.options.touchAction),ol(this,!0),N(this.options.recognizers,function(be){var Ae=this.add(new be[0](be[1]));be[2]&&Ae.recognizeWith(be[2]),be[3]&&Ae.requireFailure(be[3])},this)}ni.prototype={set:function(H){return re(this.options,H),H.touchAction&&this.touchAction.update(),H.inputTarget&&(this.input.destroy(),this.input.target=H.inputTarget,this.input.init()),this},stop:function(H){this.session.stopped=H?Ti:Fr},recognize:function(H){var ne=this.session;if(!ne.stopped){this.touchAction.preventDefaults(H);var be,Ae=this.recognizers,Ge=ne.curRecognizer;(!Ge||Ge&&Ge.state&Or)&&(Ge=ne.curRecognizer=null);for(var yt=0;yt<Ae.length;)be=Ae[yt],ne.stopped!==Ti&&(!Ge||be==Ge||be.canRecognizeWith(Ge))?be.recognize(H):be.reset(),!Ge&&be.state&(Ft|fn|ar)&&(Ge=ne.curRecognizer=be),yt++}},get:function(H){if(H instanceof Qt)return H;for(var ne=this.recognizers,be=0;be<ne.length;be++)if(ne[be].options.event==H)return ne[be];return null},add:function(H){if(I(H,"add",this))return this;var ne=this.get(H.options.event);return ne&&this.remove(ne),this.recognizers.push(H),H.manager=this,this.touchAction.update(),H},remove:function(H){if(I(H,"remove",this))return this;if(H=this.get(H),H){var ne=this.recognizers,be=ze(ne,H);be!==-1&&(ne.splice(be,1),this.touchAction.update())}return this},on:function(H,ne){if(H!==p&&ne!==p){var be=this.handlers;return N(we(H),function(Ae){be[Ae]=be[Ae]||[],be[Ae].push(ne)}),this}},off:function(H,ne){if(H!==p){var be=this.handlers;return N(we(H),function(Ae){ne?be[Ae]&&be[Ae].splice(ze(be[Ae],ne),1):delete be[Ae]}),this}},emit:function(H,ne){this.options.domEvents&&Ci(H,ne);var be=this.handlers[H]&&this.handlers[H].slice();if(!(!be||!be.length)){ne.type=H,ne.preventDefault=function(){ne.srcEvent.preventDefault()};for(var Ae=0;Ae<be.length;)be[Ae](ne),Ae++}},destroy:function(){this.element&&ol(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ol(H,ne){var be=H.element;if(be.style){var Ae;N(H.options.cssProps,function(Ge,yt){Ae=Pe(be.style,yt),ne?(H.oldCssProps[Ae]=be.style[Ae],be.style[Ae]=Ge):be.style[Ae]=H.oldCssProps[Ae]||""}),ne||(H.oldCssProps={})}}function Ci(H,ne){var be=i.createEvent("Event");be.initEvent(H,!0,!0),be.gesture=ne,ne.target.dispatchEvent(be)}re(In,{INPUT_START:Et,INPUT_MOVE:er,INPUT_END:mt,INPUT_CANCEL:$t,STATE_POSSIBLE:lr,STATE_BEGAN:Ft,STATE_CHANGED:fn,STATE_ENDED:ar,STATE_RECOGNIZED:Or,STATE_CANCELLED:gr,STATE_FAILED:Ut,DIRECTION_NONE:Nr,DIRECTION_LEFT:Br,DIRECTION_RIGHT:It,DIRECTION_UP:$r,DIRECTION_DOWN:hr,DIRECTION_HORIZONTAL:dr,DIRECTION_VERTICAL:Un,DIRECTION_ALL:Tn,Manager:ni,Input:en,TouchAction:tr,TouchInput:xe,MouseInput:ja,PointerEventInput:Ta,TouchMouseInput:Ce,SingleTouchInput:F,Recognizer:Qt,AttrRecognizer:Hr,Tap:sn,Pan:io,Swipe:Dn,Pinch:Ba,Rotate:Fa,Press:Zr,on:K,off:ve,each:N,merge:ee,extend:W,assign:re,inherit:J,bindFn:Y,prefixed:Pe});var Uc=typeof t<"u"?t:typeof self<"u"?self:{};Uc.Hammer=In,n.exports?n.exports=In:t[u]=In})(window,document,"Hammer")})(z2);var Ch=z2.exports;const gA=_n(Ch),Oo=EI({__proto__:null,default:gA},[Ch]),j2=1,N2=2,kg=4,yA={mousedown:j2,mousemove:N2,mouseup:kg};function _A(n,t){for(let i=0;i<n.length;i++)if(t(n[i]))return!0;return!1}function bA(n){const t=n.prototype.handler;n.prototype.handler=function(u){const p=this.store;u.button>0&&u.type==="pointerdown"&&(_A(p,m=>m.pointerId===u.pointerId)||p.push(u)),t.call(this,u)}}function xA(n){n.prototype.handler=function(i){let u=yA[i.type];u&j2&&i.button>=0&&(this.pressed=!0),u&N2&&i.which===0&&(u=kg),this.pressed&&(u&kg&&(this.pressed=!1),this.callback(this.manager,u,{pointers:[i],changedPointers:[i],pointerType:"mouse",srcEvent:i}))}}bA(Ch.PointerEventInput);xA(Ch.MouseInput);const wA=Ch.Manager;class cm{constructor(t,i,u){this.element=t,this.callback=i,this.options={enable:!0,...u}}}const SA=Oo?[[Oo.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Oo.Rotate,{enable:!1}],[Oo.Pinch,{enable:!1}],[Oo.Swipe,{enable:!1}],[Oo.Pan,{threshold:0,enable:!1}],[Oo.Press,{enable:!1}],[Oo.Tap,{event:"doubletap",taps:2,enable:!1}],[Oo.Tap,{event:"anytap",enable:!1}],[Oo.Tap,{enable:!1}]]:null,zx={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},EA={doubletap:["tap"]},PA={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},wy={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},TA={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},jx={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},CA=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",bc=typeof window<"u"?window:global;let Dg=!1;try{const n={get passive(){return Dg=!0,!0}};bc.addEventListener("test",null,n),bc.removeEventListener("test",null)}catch{Dg=!1}const IA=CA.indexOf("firefox")!==-1,{WHEEL_EVENTS:MA}=wy,Nx="wheel",Bx=4.000244140625,OA=40,RA=.25;class AA extends cm{constructor(t,i,u){super(t,i,u),this.handleEvent=p=>{if(!this.options.enable)return;let m=p.deltaY;bc.WheelEvent&&(IA&&p.deltaMode===bc.WheelEvent.DOM_DELTA_PIXEL&&(m/=bc.devicePixelRatio),p.deltaMode===bc.WheelEvent.DOM_DELTA_LINE&&(m*=OA)),m!==0&&m%Bx===0&&(m=Math.floor(m/Bx)),p.shiftKey&&m&&(m=m*RA),this.callback({type:Nx,center:{x:p.clientX,y:p.clientY},delta:-m,srcEvent:p,pointerType:"mouse",target:p.target})},this.events=(this.options.events||[]).concat(MA),this.events.forEach(p=>t.addEventListener(p,this.handleEvent,Dg?{passive:!1}:!1))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,i){t===Nx&&(this.options.enable=i)}}const{MOUSE_EVENTS:kA}=wy,Fx="pointermove",Ux="pointerover",Vx="pointerout",qx="pointerenter",$x="pointerleave";class DA extends cm{constructor(t,i,u){super(t,i,u),this.handleEvent=m=>{this.handleOverEvent(m),this.handleOutEvent(m),this.handleEnterEvent(m),this.handleLeaveEvent(m),this.handleMoveEvent(m)},this.pressed=!1;const{enable:p}=this.options;this.enableMoveEvent=p,this.enableLeaveEvent=p,this.enableEnterEvent=p,this.enableOutEvent=p,this.enableOverEvent=p,this.events=(this.options.events||[]).concat(kA),this.events.forEach(m=>t.addEventListener(m,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,i){t===Fx&&(this.enableMoveEvent=i),t===Ux&&(this.enableOverEvent=i),t===Vx&&(this.enableOutEvent=i),t===qx&&(this.enableEnterEvent=i),t===$x&&(this.enableLeaveEvent=i)}handleOverEvent(t){this.enableOverEvent&&t.type==="mouseover"&&this._emit(Ux,t)}handleOutEvent(t){this.enableOutEvent&&t.type==="mouseout"&&this._emit(Vx,t)}handleEnterEvent(t){this.enableEnterEvent&&t.type==="mouseenter"&&this._emit(qx,t)}handleLeaveEvent(t){this.enableLeaveEvent&&t.type==="mouseleave"&&this._emit($x,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":t.which===0&&(this.pressed=!1),this.pressed||this._emit(Fx,t);break;case"mouseup":this.pressed=!1;break}}_emit(t,i){this.callback({type:t,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})}}const{KEY_EVENTS:LA}=wy,Wx="keydown",Hx="keyup";class zA extends cm{constructor(t,i,u){super(t,i,u),this.handleEvent=p=>{const m=p.target||p.srcElement;m.tagName==="INPUT"&&m.type==="text"||m.tagName==="TEXTAREA"||(this.enableDownEvent&&p.type==="keydown"&&this.callback({type:Wx,srcEvent:p,key:p.key,target:p.target}),this.enableUpEvent&&p.type==="keyup"&&this.callback({type:Hx,srcEvent:p,key:p.key,target:p.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(LA),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach(p=>t.addEventListener(p,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,i){t===Wx&&(this.enableDownEvent=i),t===Hx&&(this.enableUpEvent=i)}}const Zx="contextmenu";class jA extends cm{constructor(t,i,u){super(t,i,u),this.handleEvent=p=>{this.options.enable&&this.callback({type:Zx,center:{x:p.clientX,y:p.clientY},srcEvent:p,pointerType:"mouse",target:p.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,i){t===Zx&&(this.options.enable=i)}}const Lg=1,Wf=2,zg=4,NA={pointerdown:Lg,pointermove:Wf,pointerup:zg,mousedown:Lg,mousemove:Wf,mouseup:zg},BA=1,FA=2,UA=3,VA=0,qA=1,$A=2,WA=1,HA=2,ZA=4;function GA(n){const t=NA[n.srcEvent.type];if(!t)return null;const{buttons:i,button:u,which:p}=n.srcEvent;let m=!1,o=!1,_=!1;return t===zg||t===Wf&&!Number.isFinite(i)?(m=p===BA,o=p===FA,_=p===UA):t===Wf?(m=!!(i&WA),o=!!(i&ZA),_=!!(i&HA)):t===Lg&&(m=u===VA,o=u===qA,_=u===$A),{leftButton:m,middleButton:o,rightButton:_}}function XA(n,t){const i=n.center;if(!i)return null;const u=t.getBoundingClientRect(),p=u.width/t.offsetWidth||1,m=u.height/t.offsetHeight||1,o={x:(i.x-u.left-t.clientLeft)/p,y:(i.y-u.top-t.clientTop)/m};return{center:i,offsetCenter:o}}const kv={srcElement:"root",priority:0};class KA{constructor(t){this.handleEvent=i=>{if(this.isEmpty())return;const u=this._normalizeEvent(i);let p=i.srcEvent.target;for(;p&&p!==u.rootElement;){if(this._emit(u,p),u.handled)return;p=p.parentNode}this._emit(u,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,i,u,p=!1,m=!1){const{handlers:o,handlersByElement:_}=this;let b=kv;typeof u=="string"||u&&u.addEventListener?b={...kv,srcElement:u}:u&&(b={...kv,...u});let E=_.get(b.srcElement);E||(E=[],_.set(b.srcElement,E));const T={type:t,handler:i,srcElement:b.srcElement,priority:b.priority};p&&(T.once=!0),m&&(T.passive=!0),o.push(T),this._active=this._active||!T.passive;let M=E.length-1;for(;M>=0&&!(E[M].priority>=T.priority);)M--;E.splice(M+1,0,T)}remove(t,i){const{handlers:u,handlersByElement:p}=this;for(let m=u.length-1;m>=0;m--){const o=u[m];if(o.type===t&&o.handler===i){u.splice(m,1);const _=p.get(o.srcElement);_.splice(_.indexOf(o),1),_.length===0&&p.delete(o.srcElement)}}this._active=u.some(m=>!m.passive)}_emit(t,i){const u=this.handlersByElement.get(i);if(u){let p=!1;const m=()=>{t.handled=!0},o=()=>{t.handled=!0,p=!0},_=[];for(let b=0;b<u.length;b++){const{type:E,handler:T,once:M}=u[b];if(T({...t,type:E,stopPropagation:m,stopImmediatePropagation:o}),M&&_.push(u[b]),p)break}for(let b=0;b<_.length;b++){const{type:E,handler:T}=_[b];this.remove(E,T)}}}_normalizeEvent(t){const i=this.eventManager.getElement();return{...t,...GA(t),...XA(t,i),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:i}}}const YA={events:null,recognizers:null,recognizerOptions:{},Manager:wA,touchAction:"none",tabIndex:0};class JA{constructor(t=null,i){this._onBasicInput=p=>{const{srcEvent:m}=p,o=PA[m.type];o&&this.manager.emit(o,p)},this._onOtherEvent=p=>{this.manager.emit(p.type,p)},this.options={...YA,...i},this.events=new Map,this.setElement(t);const{events:u}=this.options;u&&this.on(u)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:i}=this,u=i.Manager;this.manager=new u(t,{touchAction:i.touchAction,recognizers:i.recognizers||SA}).on("hammer.input",this._onBasicInput),i.recognizers||Object.keys(zx).forEach(p=>{const m=this.manager.get(p);m&&zx[p].forEach(o=>{m.recognizeWith(o)})});for(const p in i.recognizerOptions){const m=this.manager.get(p);if(m){const o=i.recognizerOptions[p];delete o.enable,m.set(o)}}this.wheelInput=new AA(t,this._onOtherEvent,{enable:!1}),this.moveInput=new DA(t,this._onOtherEvent,{enable:!1}),this.keyInput=new zA(t,this._onOtherEvent,{enable:!1,tabIndex:i.tabIndex}),this.contextmenuInput=new jA(t,this._onOtherEvent,{enable:!1});for(const[p,m]of this.events)m.isEmpty()||(this._toggleRecognizer(m.recognizerName,!0),this.manager.on(p,m.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,i,u){this._addEventHandler(t,i,u,!1)}once(t,i,u){this._addEventHandler(t,i,u,!0)}watch(t,i,u){this._addEventHandler(t,i,u,!1,!0)}off(t,i){this._removeEventHandler(t,i)}_toggleRecognizer(t,i){const{manager:u}=this;if(!u)return;const p=u.get(t);if(p&&p.options.enable!==i){p.set({enable:i});const m=EA[t];m&&!this.options.recognizers&&m.forEach(o=>{const _=u.get(o);i?(_.requireFailure(t),p.dropRequireFailure(o)):_.dropRequireFailure(t)})}this.wheelInput.enableEventType(t,i),this.moveInput.enableEventType(t,i),this.keyInput.enableEventType(t,i),this.contextmenuInput.enableEventType(t,i)}_addEventHandler(t,i,u,p,m){if(typeof t!="string"){u=i;for(const T in t)this._addEventHandler(T,t[T],u,p,m);return}const{manager:o,events:_}=this,b=jx[t]||t;let E=_.get(b);E||(E=new KA(this),_.set(b,E),E.recognizerName=TA[b]||b,o&&o.on(b,E.handleEvent)),E.add(t,i,u,p,m),E.isEmpty()||this._toggleRecognizer(E.recognizerName,!0)}_removeEventHandler(t,i){if(typeof t!="string"){for(const o in t)this._removeEventHandler(o,t[o]);return}const{events:u}=this,p=jx[t]||t,m=u.get(p);if(m&&(m.remove(t,i),m.isEmpty())){const{recognizerName:o}=m;let _=!1;for(const b of u.values())if(b.recognizerName===o&&!b.isEmpty()){_=!0;break}_||this._toggleRecognizer(o,!1)}}}function Gx(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function Hi(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Gx(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Gx(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var ou={transitionDuration:0},hs={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new Ec,transitionInterruption:ph.BREAK},sf=300,lf=function(t){return 1-(1-t)*(1-t)},fc={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},B2=function(){function n(){var t=this;rl(this,n),ft(this,"events",[]),ft(this,"scrollZoom",!0),ft(this,"dragPan",!0),ft(this,"dragRotate",!0),ft(this,"doubleClickZoom",!0),ft(this,"touchZoom",!0),ft(this,"touchRotate",!1),ft(this,"keyboard",!0),ft(this,"_interactionState",{isDragging:!1}),ft(this,"_events",{}),ft(this,"_setInteractionState",function(i){Object.assign(t._interactionState,i),t.onStateChange&&t.onStateChange(t._interactionState)}),ft(this,"_onTransition",function(i,u){t.onViewportChange(i,t._interactionState,u)}),this.handleEvent=this.handleEvent.bind(this),this._transitionManager=new xy({onViewportChange:this._onTransition,onStateChange:this._setInteractionState})}return tl(n,[{key:"handleEvent",value:function(i){this.mapState=this.getMapState();var u=this._eventStartBlocked;switch(i.type){case"panstart":return u?!1:this._onPanStart(i);case"panmove":return this._onPan(i);case"panend":return this._onPanEnd(i);case"pinchstart":return u?!1:this._onPinchStart(i);case"pinchmove":return this._onPinch(i);case"pinchend":return this._onPinchEnd(i);case"tripanstart":return u?!1:this._onTriplePanStart(i);case"tripanmove":return this._onTriplePan(i);case"tripanend":return this._onTriplePanEnd(i);case"doubletap":return this._onDoubleTap(i);case"wheel":return this._onWheel(i);case"keydown":return this._onKeyDown(i);default:return!1}}},{key:"getCenter",value:function(i){var u=i.offsetCenter,p=u.x,m=u.y;return[p,m]}},{key:"isFunctionKeyPressed",value:function(i){var u=i.srcEvent;return!!(u.metaKey||u.altKey||u.ctrlKey||u.shiftKey)}},{key:"blockEvents",value:function(i){var u=this,p=setTimeout(function(){u._eventStartBlocked===p&&(u._eventStartBlocked=null)},i);this._eventStartBlocked=p}},{key:"updateViewport",value:function(i,u,p){var m=this.mapState instanceof Sc?this.mapState.getViewportProps():this.mapState,o=Hi(Hi({},i.getViewportProps()),u),_=Object.keys(o).some(function(b){return m[b]!==o[b]});this._state=i.getState(),this._setInteractionState(p),_&&this.onViewportChange(o,this._interactionState,m)}},{key:"getMapState",value:function(i){return new Sc(Hi(Hi(Hi({},this.mapStateProps),this._state),i))}},{key:"isDragging",value:function(){return this._interactionState.isDragging}},{key:"setOptions",value:function(i){var u=i.onViewportChange,p=i.onStateChange,m=i.eventManager,o=m===void 0?this.eventManager:m,_=i.isInteractive,b=_===void 0?!0:_,E=i.scrollZoom,T=E===void 0?this.scrollZoom:E,M=i.dragPan,I=M===void 0?this.dragPan:M,N=i.dragRotate,D=N===void 0?this.dragRotate:N,re=i.doubleClickZoom,W=re===void 0?this.doubleClickZoom:re,ee=i.touchZoom,J=ee===void 0?this.touchZoom:ee,Y=i.touchRotate,B=Y===void 0?this.touchRotate:Y,V=i.keyboard,K=V===void 0?this.keyboard:V;this.onViewportChange=u,this.onStateChange=p;var ve=this.mapStateProps||{},de=ve.height!==i.height||ve.width!==i.width;this.mapStateProps=i,de&&(this.mapState=ve,this.updateViewport(new Sc(i))),this._transitionManager.processViewportChange(i),this.eventManager!==o&&(this.eventManager=o,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(fc.WHEEL,b&&!!T),this.toggleEvents(fc.PAN,b&&!!(I||D)),this.toggleEvents(fc.PINCH,b&&!!(J||B)),this.toggleEvents(fc.TRIPLE_PAN,b&&!!B),this.toggleEvents(fc.DOUBLE_TAP,b&&!!W),this.toggleEvents(fc.KEYBOARD,b&&!!K),this.scrollZoom=T,this.dragPan=I,this.dragRotate=D,this.doubleClickZoom=W,this.touchZoom=J,this.touchRotate=B,this.keyboard=K}},{key:"toggleEvents",value:function(i,u){var p=this;this.eventManager&&i.forEach(function(m){p._events[m]!==u&&(p._events[m]=u,u?p.eventManager.on(m,p.handleEvent):p.eventManager.off(m,p.handleEvent))})}},{key:"_onPanStart",value:function(i){var u=this.getCenter(i);this._panRotate=this.isFunctionKeyPressed(i)||i.rightButton;var p=this._panRotate?this.mapState.rotateStart({pos:u}):this.mapState.panStart({pos:u});return this.updateViewport(p,ou,{isDragging:!0}),!0}},{key:"_onPan",value:function(i){return this.isDragging()?this._panRotate?this._onPanRotate(i):this._onPanMove(i):!1}},{key:"_onPanEnd",value:function(i){return this.isDragging()?this._panRotate?this._onPanRotateEnd(i):this._onPanMoveEnd(i):!1}},{key:"_onPanMove",value:function(i){if(!this.dragPan)return!1;var u=this.getCenter(i),p=this.mapState.pan({pos:u});return this.updateViewport(p,ou,{isPanning:!0}),!0}},{key:"_onPanMoveEnd",value:function(i){if(this.dragPan){var u=this.dragPan.inertia,p=u===void 0?sf:u;if(p&&i.velocity){var m=this.getCenter(i),o=[m[0]+i.velocityX*p/2,m[1]+i.velocityY*p/2],_=this.mapState.pan({pos:o}).panEnd();return this.updateViewport(_,Hi(Hi({},hs),{},{transitionDuration:p,transitionEasing:lf}),{isDragging:!1,isPanning:!0}),!0}}var b=this.mapState.panEnd();return this.updateViewport(b,null,{isDragging:!1,isPanning:!1}),!0}},{key:"_onPanRotate",value:function(i){if(!this.dragRotate)return!1;var u=this.getCenter(i),p=this.mapState.rotate({pos:u});return this.updateViewport(p,ou,{isRotating:!0}),!0}},{key:"_onPanRotateEnd",value:function(i){if(this.dragRotate){var u=this.dragRotate.inertia,p=u===void 0?sf:u;if(p&&i.velocity){var m=this.getCenter(i),o=[m[0]+i.velocityX*p/2,m[1]+i.velocityY*p/2],_=this.mapState.rotate({pos:o}).rotateEnd();return this.updateViewport(_,Hi(Hi({},hs),{},{transitionDuration:p,transitionEasing:lf}),{isDragging:!1,isRotating:!0}),!0}}var b=this.mapState.panEnd();return this.updateViewport(b,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onWheel",value:function(i){if(!this.scrollZoom)return!1;var u=this.scrollZoom,p=u.speed,m=p===void 0?.01:p,o=u.smooth,_=o===void 0?!1:o;i.preventDefault();var b=this.getCenter(i),E=i.delta,T=2/(1+Math.exp(-Math.abs(E*m)));E<0&&T!==0&&(T=1/T);var M=this.mapState.zoom({pos:b,scale:T});return M.getViewportProps().zoom===this.mapStateProps.zoom?!1:(this.updateViewport(M,Hi(Hi({},hs),{},{transitionInterpolator:new Ec({around:b}),transitionDuration:_?250:1}),{isPanning:!0,isZooming:!0}),!0)}},{key:"_onPinchStart",value:function(i){var u=this.getCenter(i),p=this.mapState.zoomStart({pos:u}).rotateStart({pos:u});return this._startPinchRotation=i.rotation,this._lastPinchEvent=i,this.updateViewport(p,ou,{isDragging:!0}),!0}},{key:"_onPinch",value:function(i){if(!this.isDragging()||!this.touchZoom&&!this.touchRotate)return!1;var u=this.mapState;if(this.touchZoom){var p=i.scale,m=this.getCenter(i);u=u.zoom({pos:m,scale:p})}if(this.touchRotate){var o=i.rotation;u=u.rotate({deltaAngleX:this._startPinchRotation-o})}return this.updateViewport(u,ou,{isDragging:!0,isPanning:!!this.touchZoom,isZooming:!!this.touchZoom,isRotating:!!this.touchRotate}),this._lastPinchEvent=i,!0}},{key:"_onPinchEnd",value:function(i){if(!this.isDragging())return!1;if(this.touchZoom){var u=this.touchZoom.inertia,p=u===void 0?sf:u,m=this._lastPinchEvent;if(p&&m&&i.scale!==m.scale){var o=this.getCenter(i),_=this.mapState.rotateEnd(),b=Math.log2(i.scale),E=(b-Math.log2(m.scale))/(i.deltaTime-m.deltaTime),T=Math.pow(2,b+E*p/2);return _=_.zoom({pos:o,scale:T}).zoomEnd(),this.updateViewport(_,Hi(Hi({},hs),{},{transitionInterpolator:new Ec({around:o}),transitionDuration:p,transitionEasing:lf}),{isDragging:!1,isPanning:!!this.touchZoom,isZooming:!!this.touchZoom,isRotating:!1}),this.blockEvents(p),!0}}var M=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(M,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),this._startPinchRotation=null,this._lastPinchEvent=null,!0}},{key:"_onTriplePanStart",value:function(i){var u=this.getCenter(i),p=this.mapState.rotateStart({pos:u});return this.updateViewport(p,ou,{isDragging:!0}),!0}},{key:"_onTriplePan",value:function(i){if(!this.isDragging()||!this.touchRotate)return!1;var u=this.getCenter(i);u[0]-=i.deltaX;var p=this.mapState.rotate({pos:u});return this.updateViewport(p,ou,{isRotating:!0}),!0}},{key:"_onTriplePanEnd",value:function(i){if(!this.isDragging())return!1;if(this.touchRotate){var u=this.touchRotate.inertia,p=u===void 0?sf:u;if(p&&i.velocityY){var m=this.getCenter(i),o=[m[0],m[1]+=i.velocityY*p/2],_=this.mapState.rotate({pos:o});return this.updateViewport(_,Hi(Hi({},hs),{},{transitionDuration:p,transitionEasing:lf}),{isDragging:!1,isRotating:!0}),this.blockEvents(p),!1}}var b=this.mapState.rotateEnd();return this.updateViewport(b,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(i){if(!this.doubleClickZoom)return!1;var u=this.getCenter(i),p=this.isFunctionKeyPressed(i),m=this.mapState.zoom({pos:u,scale:p?.5:2});return this.updateViewport(m,Object.assign({},hs,{transitionInterpolator:new Ec({around:u})}),{isZooming:!0}),!0}},{key:"_onKeyDown",value:function(i){if(!this.keyboard)return!1;var u=this.isFunctionKeyPressed(i),p=this.keyboard,m=p.zoomSpeed,o=m===void 0?2:m,_=p.moveSpeed,b=_===void 0?100:_,E=p.rotateSpeedX,T=E===void 0?15:E,M=p.rotateSpeedY,I=M===void 0?10:M,N=this.mapStateProps,D;switch(i.srcEvent.keyCode){case 189:u?D=this.getMapState({zoom:N.zoom-Math.log2(o)-1}):D=this.getMapState({zoom:N.zoom-Math.log2(o)});break;case 187:u?D=this.getMapState({zoom:N.zoom+Math.log2(o)+1}):D=this.getMapState({zoom:N.zoom+Math.log2(o)});break;case 37:u?D=this.getMapState({bearing:N.bearing-T}):D=this.mapState.pan({pos:[b,0],startPos:[0,0]});break;case 39:u?D=this.getMapState({bearing:N.bearing+T}):D=this.mapState.pan({pos:[-b,0],startPos:[0,0]});break;case 38:u?D=this.getMapState({pitch:N.pitch+I}):D=this.mapState.pan({pos:[0,b],startPos:[0,0]});break;case 40:u?D=this.getMapState({pitch:N.pitch-I}):D=this.mapState.pan({pos:[0,-b],startPos:[0,0]});break;default:return!1}return this.updateViewport(D,hs)}}]),n}();function Xx(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function cs(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Xx(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Xx(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var QA=Object.assign({},il.propTypes,{maxZoom:Oe.number,minZoom:Oe.number,maxPitch:Oe.number,minPitch:Oe.number,onViewStateChange:Oe.func,onViewportChange:Oe.func,onInteractionStateChange:Oe.func,transitionDuration:Oe.oneOfType([Oe.number,Oe.string]),transitionInterpolator:Oe.object,transitionInterruption:Oe.number,transitionEasing:Oe.func,onTransitionStart:Oe.func,onTransitionInterrupt:Oe.func,onTransitionEnd:Oe.func,scrollZoom:Oe.oneOfType([Oe.bool,Oe.object]),dragPan:Oe.oneOfType([Oe.bool,Oe.object]),dragRotate:Oe.oneOfType([Oe.bool,Oe.object]),doubleClickZoom:Oe.bool,touchZoom:Oe.oneOfType([Oe.bool,Oe.object]),touchRotate:Oe.oneOfType([Oe.bool,Oe.object]),keyboard:Oe.oneOfType([Oe.bool,Oe.object]),onHover:Oe.func,onClick:Oe.func,onDblClick:Oe.func,onContextMenu:Oe.func,onMouseDown:Oe.func,onMouseMove:Oe.func,onMouseUp:Oe.func,onTouchStart:Oe.func,onTouchMove:Oe.func,onTouchEnd:Oe.func,onMouseEnter:Oe.func,onMouseLeave:Oe.func,onMouseOut:Oe.func,onWheel:Oe.func,touchAction:Oe.string,eventRecognizerOptions:Oe.object,clickRadius:Oe.number,interactiveLayerIds:Oe.array,getCursor:Oe.func,controller:Oe.instanceOf(B2)}),ek=function(t){var i=t.isDragging,u=t.isHovering;return i?"grabbing":u?"pointer":"grab"},tk=Object.assign({},il.defaultProps,hu,xy.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:function(t){return t.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",eventRecognizerOptions:{},clickRadius:0,getCursor:ek});function Sy(n){if(n.lngLat||!n.offsetCenter)return n;var t=n.offsetCenter,i=t.x,u=t.y;if(!Number.isFinite(i)||!Number.isFinite(u))return n;var p=[i,u];return n.point=p,n.lngLat=this.viewport.unproject(p),n}function F2(n){var t=this.map;if(!t||!n)return null;var i={},u=this.props.clickRadius;this.props.interactiveLayerIds&&(i.layers=this.props.interactiveLayerIds);try{return t.queryRenderedFeatures(u?[[n[0]-u,n[1]+u],[n[0]+u,n[1]-u]]:n,i)}catch{return null}}function gs(n,t){var i=this.props[n];i&&i(Sy.call(this,t))}function rk(n){gs.call(this,n.pointerType==="touch"?"onTouchStart":"onMouseDown",n)}function nk(n){gs.call(this,n.pointerType==="touch"?"onTouchEnd":"onMouseUp",n)}function ik(n){if(gs.call(this,n.pointerType==="touch"?"onTouchMove":"onMouseMove",n),!this.state.isDragging){var t=this.props,i=t.onHover,u=t.interactiveLayerIds,p;n=Sy.call(this,n),(u||i)&&(p=F2.call(this,n.point));var m=!!(u&&p&&p.length>0),o=m&&!this.state.isHovering,_=!m&&this.state.isHovering;(i||o)&&(n.features=p,i&&i(n)),o&&gs.call(this,"onMouseEnter",n),_&&gs.call(this,"onMouseLeave",n),(o||_)&&this.setState({isHovering:m})}}function Kx(n){var t=this.props,i=t.onClick,u=t.onNativeClick,p=t.onDblClick,m=t.doubleClickZoom,o=[],_=p||m;switch(n.type){case"anyclick":o.push(u),_||o.push(i);break;case"click":_&&o.push(i);break}o=o.filter(Boolean),o.length&&(n=Sy.call(this,n),n.features=F2.call(this,n.point),o.forEach(function(b){return b(n)}))}function ak(n){return{getMap:n.current&&n.current.getMap,queryRenderedFeatures:n.current&&n.current.queryRenderedFeatures}}var Ih=me.forwardRef(function(n,t){var i=me.useContext(nl),u=me.useMemo(function(){return n.controller||new B2},[]),p=me.useMemo(function(){return new JA(null,{touchAction:n.touchAction,recognizerOptions:n.eventRecognizerOptions})},[]),m=me.useRef(null),o=me.useRef(null),_=me.useRef({width:0,height:0,state:{isHovering:!1,isDragging:!1}}),b=_.current;b.props=n,b.map=o.current&&o.current.getMap(),b.setState=function(K){b.state=cs(cs({},b.state),K),m.current.style.cursor=n.getCursor(b.state)};var E=!0,T,M,I=function(ve,de,ie){if(E){T=[ve,de,ie];return}var we=b.props,ze=we.onViewStateChange,De=we.onViewportChange;ze&&ze({viewState:ve,interactionState:de,oldViewState:ie}),De&&De(ve,de,ie)};me.useImperativeHandle(t,function(){return ak(o)},[]);var N=me.useMemo(function(){return cs(cs({},i),{},{eventManager:p,container:i.container||m.current})},[i,m.current]);N.onViewportChange=I,N.viewport=i.viewport||D2(b),b.viewport=N.viewport;var D=function(ve){var de=ve.isDragging,ie=de===void 0?!1:de;if(ie!==b.state.isDragging&&b.setState({isDragging:ie}),E){M=ve;return}var we=b.props.onInteractionStateChange;we&&we(ve)},re=function(){b.width&&b.height&&u.setOptions(cs(cs(cs({},b.props),b.props.viewState),{},{isInteractive:!!(b.props.onViewStateChange||b.props.onViewportChange),onViewportChange:I,onStateChange:D,eventManager:p,width:b.width,height:b.height}))},W=function(ve){var de=ve.width,ie=ve.height;b.width=de,b.height=ie,re(),b.props.onResize({width:de,height:ie})};me.useEffect(function(){return p.setElement(m.current),p.on({pointerdown:rk.bind(b),pointermove:ik.bind(b),pointerup:nk.bind(b),pointerleave:gs.bind(b,"onMouseOut"),click:Kx.bind(b),anyclick:Kx.bind(b),dblclick:gs.bind(b,"onDblClick"),wheel:gs.bind(b,"onWheel"),contextmenu:gs.bind(b,"onContextMenu")}),function(){p.destroy()}},[]),Rg(function(){T&&I.apply(void 0,pO(T)),M&&D(M)}),re();var ee=n.width,J=n.height,Y=n.style,B=n.getCursor,V=me.useMemo(function(){return cs(cs({position:"relative"},Y),{},{width:ee,height:J,cursor:B(b.state)})},[Y,ee,J,B,b.state]);return(!T||!b._child)&&(b._child=me.createElement(by,{value:N},me.createElement("div",{key:"event-canvas",ref:m,style:V},me.createElement(il,Qg({},n,{width:"100%",height:"100%",style:null,onResize:W,ref:o}))))),E=!1,b._child});Ih.supported=il.supported;Ih.propTypes=QA;Ih.defaultProps=tk;function du(n,t){if(n===t)return!0;if(!n||!t)return!1;if(Array.isArray(n)){if(!Array.isArray(t)||n.length!==t.length)return!1;for(var i=0;i<n.length;i++)if(!du(n[i],t[i]))return!1;return!0}else if(Array.isArray(t))return!1;if(k0(n)==="object"&&k0(t)==="object"){var u=Object.keys(n),p=Object.keys(t);if(u.length!==p.length)return!1;for(var m=0,o=u;m<o.length;m++){var _=o[m];if(!t.hasOwnProperty(_)||!du(n[_],t[_]))return!1}return!0}return!1}function Yx(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function ok(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Yx(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Yx(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var sk={type:Oe.string.isRequired,id:Oe.string},lk=0;function uk(n,t,i){if(n&&n.style&&n.style._loaded){var u=ok({},i);return delete u.id,delete u.children,n.addSource(t,u),n.getSource(t)}return null}function ck(n,t,i){Ki(t.id===i.id,"source id changed"),Ki(t.type===i.type,"source type changed");var u="",p=0;for(var m in t)m!=="children"&&m!=="id"&&!du(i[m],t[m])&&(u=m,p++);if(p){var o=t.type;if(o==="geojson")n.setData(t.data);else if(o==="image")n.updateImage({url:t.url,coordinates:t.coordinates});else if((o==="canvas"||o==="video")&&p===1&&u==="coordinates")n.setCoordinates(t.coordinates);else if(o==="vector"&&n.setUrl)switch(u){case"url":n.setUrl(t.url);break;case"tiles":n.setTiles(t.tiles);break}else console.warn("Unable to update <Source> prop: ".concat(u))}}function jg(n){var t=me.useContext(nl),i=me.useRef({id:n.id,type:n.type}),u=me.useState(0),p=Bn(u,2),m=p[1],o=me.useMemo(function(){return n.id||"jsx-source-".concat(lk++)},[]),_=t.map;me.useEffect(function(){if(_){var E=function(){return m(function(M){return M+1})};return _.on("styledata",E),function(){_.off("styledata",E),requestAnimationFrame(function(){_.style&&_.style._loaded&&_.getSource(o)&&_.removeSource(o)})}}},[_,o]);var b=_&&_.style&&_.getSource(o);return b?ck(b,n,i.current):b=uk(_,o,n),i.current=n,b&&me.Children.map(n.children,function(E){return E&&me.cloneElement(E,{source:o})})||null}jg.propTypes=sk;function pk(n,t){if(n==null)return{};var i=Qw(n,t),u,p;if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(n);for(p=0;p<m.length;p++)u=m[p],!(t.indexOf(u)>=0)&&Object.prototype.propertyIsEnumerable.call(n,u)&&(i[u]=n[u])}return i}function Jx(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function Qx(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Jx(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Jx(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var hk=["fill","line","symbol","circle","fill-extrusion","raster","background","heatmap","hillshade"],dk={type:Oe.oneOf(hk).isRequired,id:Oe.string,source:Oe.string,beforeId:Oe.string};function fk(n,t,i,u){var p=i.layout,m=p===void 0?{}:p,o=i.paint,_=o===void 0?{}:o,b=i.filter,E=i.minzoom,T=i.maxzoom,M=i.beforeId,I=pk(i,["layout","paint","filter","minzoom","maxzoom","beforeId"]);if(M!==u.beforeId&&n.moveLayer(t,M),m!==u.layout){var N=u.layout||{};for(var D in m)du(m[D],N[D])||n.setLayoutProperty(t,D,m[D]);for(var re in N)m.hasOwnProperty(re)||n.setLayoutProperty(t,re,void 0)}if(_!==u.paint){var W=u.paint||{};for(var ee in _)du(_[ee],W[ee])||n.setPaintProperty(t,ee,_[ee]);for(var J in W)_.hasOwnProperty(J)||n.setPaintProperty(t,J,void 0)}du(b,u.filter)||n.setFilter(t,b),(E!==u.minzoom||T!==u.maxzoom)&&n.setLayerZoomRange(t,E,T);for(var Y in I)du(I[Y],u[Y])||n.setLayerProperty(t,Y,I[Y])}function mk(n,t,i){if(n.style&&n.style._loaded){var u=Qx(Qx({},i),{},{id:t});delete u.beforeId,n.addLayer(u,i.beforeId)}}function vk(n,t,i,u){Ki(i.id===u.id,"layer id changed"),Ki(i.type===u.type,"layer type changed");try{fk(n,t,i,u)}catch(p){console.warn(p)}}var gk=0;function Ng(n){var t=me.useContext(nl),i=me.useRef({id:n.id,type:n.type}),u=me.useState(0),p=Bn(u,2),m=p[1],o=me.useMemo(function(){return n.id||"jsx-layer-".concat(gk++)},[]),_=t.map;me.useEffect(function(){if(_){var E=function(){return m(function(M){return M+1})};return _.on("styledata",E),function(){_.off("styledata",E),_.style&&_.style._loaded&&_.removeLayer(o)}}},[_]);var b=_&&_.style&&_.getLayer(o);return b?vk(_,o,n,i.current):mk(_,o,n),i.current=n,null}Ng.propTypes=dk;var al={captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!1},eo={captureScroll:Oe.bool,captureDrag:Oe.bool,captureClick:Oe.bool,captureDoubleClick:Oe.bool,capturePointerMove:Oe.bool};function yk(n){var t=n.containerRef.current,i=n.context.eventManager;if(!(!t||!i)){var u={wheel:function(m){var o=n.props;o.captureScroll&&m.stopPropagation(),o.onScroll&&o.onScroll(m,n)},panstart:function(m){var o=n.props;o.captureDrag&&m.stopPropagation(),o.onDragStart&&o.onDragStart(m,n)},anyclick:function(m){var o=n.props;o.captureClick&&m.stopPropagation(),o.onNativeClick&&o.onNativeClick(m,n)},click:function(m){var o=n.props;o.captureClick&&m.stopPropagation(),o.onClick&&o.onClick(m,n)},dblclick:function(m){var o=n.props;o.captureDoubleClick&&m.stopPropagation(),o.onDoubleClick&&o.onDoubleClick(m,n)},pointermove:function(m){var o=n.props;o.capturePointerMove&&m.stopPropagation(),o.onPointerMove&&o.onPointerMove(m,n)}};return i.watch(u,t),function(){i.off(u)}}}function xs(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=me.useContext(nl),i=me.useRef(null),u=me.useRef({props:n,state:{},context:t,containerRef:i}),p=u.current;return p.props=n,p.context=t,me.useEffect(function(){return yk(p)},[t.eventManager]),p}function _k(n){var t=bk();return function(){var u=Cc(n),p;if(t){var m=Cc(this).constructor;p=Reflect.construct(u,arguments,m)}else p=u.apply(this,arguments);return Jg(this,p)}}function bk(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function xk(n){var t=n.instance,i=xs(n),u=i.context,p=i.containerRef;return t._context=u,t._containerRef=p,t._render()}var U2=function(n){Yg(i,n);var t=_k(i);function i(){var u;rl(this,i);for(var p=arguments.length,m=new Array(p),o=0;o<p;o++)m[o]=arguments[o];return u=t.call.apply(t,[this].concat(m)),ft(Vs(u),"_context",{}),ft(Vs(u),"_containerRef",me.createRef()),ft(Vs(u),"_onScroll",function(_){}),ft(Vs(u),"_onDragStart",function(_){}),ft(Vs(u),"_onDblClick",function(_){}),ft(Vs(u),"_onClick",function(_){}),ft(Vs(u),"_onPointerMove",function(_){}),u}return tl(i,[{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){return me.createElement(xk,Qg({instance:this},this.props,{onScroll:this._onScroll,onDragStart:this._onDragStart,onDblClick:this._onDblClick,onClick:this._onClick,onPointerMove:this._onPointerMove}))}}]),i}(me.PureComponent);ft(U2,"propTypes",eo);ft(U2,"defaultProps",al);function e1(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function t1(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?e1(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):e1(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var wk=Object.assign({},eo,{draggable:Oe.bool,onDrag:Oe.func,onDragEnd:Oe.func,onDragStart:Oe.func,offsetLeft:Oe.number,offsetTop:Oe.number}),Sk=Object.assign({},al,{draggable:!1,offsetLeft:0,offsetTop:0});function V2(n){var t=n.offsetCenter,i=t.x,u=t.y;return[i,u]}function Ek(n,t){var i=n.center,u=i.x,p=i.y;if(t){var m=t.getBoundingClientRect();return[m.left-u,m.top-p]}return null}function Ey(n,t,i,u){var p=n[0]+t[0]-i.offsetLeft,m=n[1]+t[1]-i.offsetTop;return u.viewport.unproject([p,m])}function Pk(n,t){var i=t.props,u=t.callbacks,p=t.state,m=t.context,o=t.containerRef,_=i.draggable;if(_){n.stopPropagation();var b=V2(n),E=Ek(n,o.current);if(p.setDragPos(b),p.setDragOffset(E),u.onDragStart&&E){var T=Object.assign({},n);T.lngLat=Ey(b,E,i,m),u.onDragStart(T)}}}function Tk(n,t){var i=t.props,u=t.callbacks,p=t.state,m=t.context;n.stopPropagation();var o=V2(n);p.setDragPos(o);var _=p.dragOffset;if(u.onDrag&&_){var b=Object.assign({},n);b.lngLat=Ey(o,_,i,m),u.onDrag(b)}}function Ck(n,t){var i=t.props,u=t.callbacks,p=t.state,m=t.context;n.stopPropagation();var o=p.dragPos,_=p.dragOffset;if(p.setDragPos(null),p.setDragOffset(null),u.onDragEnd&&o&&_){var b=Object.assign({},n);b.lngLat=Ey(o,_,i,m),u.onDragEnd(b)}}function Ik(n,t){var i=t.state;n.stopPropagation(),i.setDragPos(null),i.setDragOffset(null)}function Mk(n){var t=n.context.eventManager;if(!(!t||!n.state.dragPos)){var i={panmove:function(p){return Tk(p,n)},panend:function(p){return Ck(p,n)},pancancel:function(p){return Ik(p,n)}};return t.watch(i),function(){t.off(i)}}}function Ok(n){var t=me.useState(null),i=Bn(t,2),u=i[0],p=i[1],m=me.useState(null),o=Bn(m,2),_=o[0],b=o[1],E=xs(t1(t1({},n),{},{onDragStart:Pk}));return E.callbacks=n,E.state.dragPos=u,E.state.setDragPos=p,E.state.dragOffset=_,E.state.setDragOffset=b,me.useEffect(function(){return Mk(E)},[E.context.eventManager,!!u]),E}var r1=typeof window<"u"&&window.devicePixelRatio||1,yh=function(t){return Math.round(t*r1)/r1},n1=function(t,i){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"x";if(t===null)return i;var p=u==="x"?t.offsetWidth:t.offsetHeight;return yh(i/100*p)/p*100};function i1(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function Rk(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?i1(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):i1(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var Ak=Object.assign({},wk,{className:Oe.string,longitude:Oe.number.isRequired,latitude:Oe.number.isRequired,style:Oe.object}),kk=Object.assign({},Sk,{className:""});function Dk(n){var t=n.props,i=n.state,u=n.context,p=t.longitude,m=t.latitude,o=t.offsetLeft,_=t.offsetTop,b=i.dragPos,E=i.dragOffset;if(b&&E)return[b[0]+E[0],b[1]+E[1]];var T=u.viewport.project([p,m]),M=Bn(T,2),I=M[0],N=M[1];return I+=o,N+=_,[I,N]}function Py(n){var t=Ok(n),i=t.state,u=t.containerRef,p=n.children,m=n.className,o=n.draggable,_=n.style,b=i.dragPos,E=Dk(t),T=Bn(E,2),M=T[0],I=T[1],N="translate(".concat(yh(M),"px, ").concat(yh(I),"px)"),D=o?b?"grabbing":"grab":"auto",re=me.useMemo(function(){var ee=Rk({position:"absolute",left:0,top:0,transform:N,cursor:D},_);return me.createElement("div",{className:"mapboxgl-marker ".concat(m),ref:t.containerRef,style:ee},p)},[p,m]),W=u.current;return W&&(W.style.transform=N,W.style.cursor=D),re}Py.defaultProps=kk;Py.propTypes=Ak;const uf=me.memo(Py);var _h={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},Lk=Object.keys(_h);function zk(n){var t=n.x,i=n.y,u=n.width,p=n.height,m=n.selfWidth,o=n.selfHeight,_=n.anchor,b=n.padding,E=b===void 0?0:b,T=_h[_],M=T.x,I=T.y,N=i-I*o,D=N+o,re=Math.max(0,E-N)+Math.max(0,D-p+E);if(re>0){var W=I,ee=re;for(I=0;I<=1;I+=.5)N=i-I*o,D=N+o,re=Math.max(0,E-N)+Math.max(0,D-p+E),re<ee&&(ee=re,W=I);I=W}var J=.5;I===.5&&(M=Math.floor(M),J=1);var Y=t-M*m,B=Y+m,V=Math.max(0,E-Y)+Math.max(0,B-u+E);if(V>0){var K=M,ve=V;for(M=0;M<=1;M+=J)Y=t-M*m,B=Y+m,V=Math.max(0,E-Y)+Math.max(0,B-u+E),V<ve&&(ve=V,K=M);M=K}return Lk.find(function(de){var ie=_h[de];return ie.x===M&&ie.y===I})||_}var jk=Object.assign({},eo,{className:Oe.string,longitude:Oe.number.isRequired,latitude:Oe.number.isRequired,altitude:Oe.number,offsetLeft:Oe.number,offsetTop:Oe.number,tipSize:Oe.number,closeButton:Oe.bool,closeOnClick:Oe.bool,anchor:Oe.oneOf(Object.keys(_h)),dynamicPosition:Oe.bool,sortByDepth:Oe.bool,onClose:Oe.func}),Nk=Object.assign({},al,{className:"",altitude:0,offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}});function Bk(n,t,i,u){var p=Bn(u,2),m=p[0],o=p[1],_=n.anchor,b=n.dynamicPosition,E=n.tipSize;return i&&b?zk({x:m,y:o,anchor:_,padding:E,width:t.width,height:t.height,selfWidth:i.clientWidth,selfHeight:i.clientHeight}):_}function Fk(n,t,i,u,p){var m=Bn(u,3),o=m[0],_=m[1],b=m[2],E=n.offsetLeft,T=n.offsetTop,M=n.sortByDepth,I=_h[p],N=o+E,D=_+T,re=n1(i,-I.x*100),W=n1(i,-I.y*100,"y"),ee={position:"absolute",transform:`
      translate(`.concat(re,"%, ").concat(W,`%)
      translate(`).concat(yh(N),"px, ").concat(yh(D),`px)
    `),display:void 0,zIndex:void 0};return M&&(b>1||b<-1||o<0||o>t.width||_<0||_>t.height?ee.display="none":ee.zIndex=Math.floor((1-b)/2*1e5)),ee}function Ty(n){var t=me.useRef(null),i=xs(n),u=i.context,p=i.containerRef,m=me.useState(!1),o=Bn(m,2),_=o[1];me.useEffect(function(){_(!0)},[t.current]),me.useEffect(function(){if(u.eventManager&&n.closeOnClick){var B=function(){return i.props.onClose()};return u.eventManager.on("anyclick",B),function(){u.eventManager.off("anyclick",B)}}},[u.eventManager,n.closeOnClick]);var b=u.viewport,E=n.className,T=n.longitude,M=n.latitude,I=n.altitude,N=n.tipSize,D=n.closeButton,re=n.children,W=b.project([T,M,I]),ee=Bk(n,b,t.current,W),J=Fk(n,b,p.current,W,ee),Y=me.useCallback(function(B){i.props.onClose();var V=i.context.eventManager;V&&V.once("click",function(K){return K.stopPropagation()},B.target)},[]);return me.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(ee," ").concat(E),style:J,ref:p},me.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:N}}),me.createElement("div",{key:"content",ref:t,className:"mapboxgl-popup-content"},D&&me.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button",onClick:Y},"×"),re))}Ty.propTypes=jk;Ty.defaultProps=Nk;me.memo(Ty);function a1(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function Uk(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?a1(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):a1(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var Vk=Object.assign({},eo,{toggleLabel:Oe.string,className:Oe.string,style:Oe.object,compact:Oe.bool,customAttribution:Oe.oneOfType([Oe.string,Oe.arrayOf(Oe.string)])}),qk=Object.assign({},al,{className:"",toggleLabel:"Toggle Attribution"});function $k(n,t,i,u){var p=new Do.AttributionControl(n);return p._map=t,p._container=i,p._innerContainer=u,p._updateAttributions(),p._updateEditLink(),t.on("styledata",p._updateData),t.on("sourcedata",p._updateData),p}function Wk(n){n._map.off("styledata",n._updateData),n._map.off("sourcedata",n._updateData)}function Cy(n){var t=xs(n),i=t.context,u=t.containerRef,p=me.useRef(null),m=me.useState(!1),o=Bn(m,2),_=o[0],b=o[1];me.useEffect(function(){var I;return i.map&&(I=$k({customAttribution:n.customAttribution},i.map,u.current,p.current)),function(){return I&&Wk(I)}},[i.map]);var E=n.compact===void 0?i.viewport.width<=640:n.compact;me.useEffect(function(){!E&&_&&b(!1)},[E]);var T=me.useCallback(function(){return b(function(I){return!I})},[]),M=me.useMemo(function(){return Uk({position:"absolute"},n.style)},[n.style]);return me.createElement("div",{style:M,className:n.className},me.createElement("div",{ref:u,"aria-pressed":_,className:"mapboxgl-ctrl mapboxgl-ctrl-attrib ".concat(E?"mapboxgl-compact":""," ").concat(_?"mapboxgl-compact-show":"")},me.createElement("button",{type:"button",className:"mapboxgl-ctrl-attrib-button",title:n.toggleLabel,onClick:T}),me.createElement("div",{ref:p,className:"mapboxgl-ctrl-attrib-inner",role:"list"})))}Cy.propTypes=Vk;Cy.defaultProps=qk;me.memo(Cy);function o1(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function Hk(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?o1(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):o1(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var Zk=Object.assign({},eo,{className:Oe.string,style:Oe.object,container:Oe.object,label:Oe.string}),Gk=Object.assign({},al,{className:"",container:null,label:"Toggle fullscreen"});function Iy(n){var t=xs(n),i=t.context,u=t.containerRef,p=me.useState(!1),m=Bn(p,2),o=m[0],_=m[1],b=me.useState(!1),E=Bn(b,2),T=E[0],M=E[1],I=me.useState(null),N=Bn(I,2),D=N[0],re=N[1];me.useEffect(function(){var V=new Do.FullscreenControl;re(V),M(V._checkFullscreenSupport());var K=function(){var de=!V._fullscreen;V._fullscreen=de,_(de)};return ms.addEventListener(V._fullscreenchange,K),function(){ms.removeEventListener(V._fullscreenchange,K)}},[]);var W=function(){D&&(D._container=n.container||i.container,D._onClickFullscreen())},ee=me.useMemo(function(){return Hk({position:"absolute"},n.style)},[n.style]);if(!T)return null;var J=n.className,Y=n.label,B=o?"shrink":"fullscreen";return me.createElement("div",{style:ee,className:J},me.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:u},me.createElement("button",{key:B,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(B),type:"button",title:Y,onClick:W},me.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}Iy.propTypes=Zk;Iy.defaultProps=Gk;me.memo(Iy);var mc;function Xk(){return mc!==void 0?Promise.resolve(mc):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(function(n){return mc=n.state!=="denied",mc}):(mc=!!window.navigator.geolocation,Promise.resolve(mc))}function s1(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function Kk(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?s1(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):s1(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var l1=function(){},Yk=Object.assign({},eo,{className:Oe.string,style:Oe.object,label:Oe.string,disabledLabel:Oe.string,auto:Oe.bool,positionOptions:Oe.object,fitBoundsOptions:Oe.object,trackUserLocation:Oe.bool,showUserLocation:Oe.bool,showAccuracyCircle:Oe.bool,showUserHeading:Oe.bool,onViewStateChange:Oe.func,onViewportChange:Oe.func,onGeolocate:Oe.func}),Jk=Object.assign({},al,{className:"",label:"Find My Location",disabledLabel:"Location Not Available",auto:!1,positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0,showUserHeading:!1,showAccuracyCircle:!0,onGeolocate:function(){}});function Qk(n){var t=new Do.LngLat(n.coords.longitude,n.coords.latitude),i=n.coords.accuracy,u=t.toBounds(i);return[[u._ne.lng,u._ne.lat],[u._sw.lng,u._sw.lat]]}function eD(n,t,i){var u=new Do.GeolocateControl(t);u._container=ms.createElement("div"),u._map={on:function(){},_getUIString:function(){return""}},u._setupUI(!0),u._map=n.map,u._geolocateButton=i;var p=n.eventManager;return u.options.trackUserLocation&&p&&p.on("panstart",function(){u._watchState==="ACTIVE_LOCK"&&(u._watchState="BACKGROUND",i.classList.add("mapboxgl-ctrl-geolocate-background"),i.classList.remove("mapboxgl-ctrl-geolocate-active"))}),u.on("geolocate",t.onGeolocate),u}function tD(n,t){var i=t.context,u=t.props,p=Qk(n),m=i.viewport.fitBounds(p,u.fitBoundsOptions),o=m.longitude,_=m.latitude,b=m.zoom,E=Object.assign({},i.viewport,{longitude:o,latitude:_,zoom:b}),T=new Sc(E),M=Object.assign({},T.getViewportProps(),hs),I=u.onViewportChange||i.onViewportChange||l1,N=u.onViewStateChange||i.onViewStateChange||l1;N({viewState:M}),I(M)}function My(n){var t=xs(n),i=t.context,u=t.containerRef,p=me.useRef(null),m=me.useState(null),o=Bn(m,2),_=o[0],b=o[1],E=me.useState(!1),T=Bn(E,2),M=T[0],I=T[1];me.useEffect(function(){var Y;return i.map&&Xk().then(function(B){I(B),p.current&&(Y=eD(i,n,p.current),Y._updateCamera=function(V){return tD(V,t)},b(Y))}),function(){Y&&Y._clearWatch()}},[i.map]);var N=me.useCallback(function(){_&&(_.options=t.props,_.trigger())},[_]);me.useEffect(function(){n.auto&&N()},[_,n.auto]),me.useEffect(function(){_&&_._onZoom()},[i.viewport.zoom]);var D=n.className,re=n.label,W=n.disabledLabel,ee=n.trackUserLocation,J=me.useMemo(function(){return Kk({position:"absolute"},n.style)},[n.style]);return me.createElement("div",{style:J,className:D},me.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:u},me.createElement("button",{key:"geolocate",className:"mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",ref:p,disabled:!M,"aria-pressed":!ee,type:"button",title:M?re:W,"aria-label":M?re:W,onClick:N},me.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}My.propTypes=Yk;My.defaultProps=Jk;const rD=me.memo(My);function nD(n,t){for(var i=(n||"").split(".").map(Number),u=t.split(".").map(Number),p=0;p<3;p++){var m=i[p]||0,o=u[p]||0;if(m<o)return-1;if(m>o)return 1}return 0}function u1(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function iD(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?u1(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):u1(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var c1=function(){},aD=Object.assign({},eo,{className:Oe.string,style:Oe.object,onViewStateChange:Oe.func,onViewportChange:Oe.func,showCompass:Oe.bool,showZoom:Oe.bool,zoomInLabel:Oe.string,zoomOutLabel:Oe.string,compassLabel:Oe.string}),oD=Object.assign({},al,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"}),sD=1,Bg=2;function lD(n){return nD(n,"1.6.0")>=0?Bg:sD}function Dv(n,t,i){var u=n.viewport,p=new Sc(Object.assign({},u,i)),m=Object.assign({},p.getViewportProps(),hs),o=t.onViewportChange||n.onViewportChange||c1,_=t.onViewStateChange||n.onViewStateChange||c1;_({viewState:m}),o(m)}function Lv(n,t,i,u){return me.createElement("button",{key:n,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(n),type:"button",title:t,onClick:i},u||me.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}function uD(n){var t=me.useMemo(function(){return n.map?lD(n.map.version):Bg},[n.map]),i=n.viewport.bearing,u={transform:"rotate(".concat(-i,"deg)")};return t===Bg?me.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",style:u}):me.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:u})}function Oy(n){var t=xs(n),i=t.context,u=t.containerRef,p=function(){Dv(i,n,{zoom:i.viewport.zoom+1})},m=function(){Dv(i,n,{zoom:i.viewport.zoom-1})},o=function(){Dv(i,n,{bearing:0,pitch:0})},_=n.className,b=n.showCompass,E=n.showZoom,T=n.zoomInLabel,M=n.zoomOutLabel,I=n.compassLabel,N=me.useMemo(function(){return iD({position:"absolute"},n.style)},[n.style]);return me.createElement("div",{style:N,className:_},me.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:u},E&&Lv("zoom-in",T,p),E&&Lv("zoom-out",M,m),b&&Lv("compass",I,o,uD(i))))}Oy.propTypes=aD;Oy.defaultProps=oD;me.memo(Oy);function p1(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function cD(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?p1(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):p1(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var pD=Object.assign({},eo,{className:Oe.string,style:Oe.object,maxWidth:Oe.number,unit:Oe.oneOf(["imperial","metric","nautical"])}),hD=Object.assign({},al,{className:"",maxWidth:100,unit:"metric"});function Ry(n){var t=xs(n),i=t.context,u=t.containerRef,p=me.useState(null),m=Bn(p,2),o=m[0],_=m[1];me.useEffect(function(){if(i.map){var E=new Do.ScaleControl;E._map=i.map,E._container=u.current,_(E)}},[i.map]),o&&(o.options=n,o._onMove&&o._onMove());var b=me.useMemo(function(){return cD({position:"absolute"},n.style)},[n.style]);return me.createElement("div",{style:b,className:n.className},me.createElement("div",{ref:u,className:"mapboxgl-ctrl mapboxgl-ctrl-scale"}))}Ry.propTypes=pD;Ry.defaultProps=hD;me.memo(Ry);Object.assign({},eo,{redraw:Oe.func.isRequired});function h1(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function dD(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?h1(Object(i),!0).forEach(function(u){ft(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):h1(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var fD=Object.assign({},eo,{redraw:Oe.func.isRequired,style:Oe.object}),mD={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};function xc(n){var t=xs(n),i=t.context,u=t.containerRef,p=i.viewport,m=i.isDragging,o=dD({position:"absolute",left:0,top:0,width:p.width,height:p.height},n.style);return me.createElement("div",{ref:u,style:o},n.redraw({width:p.width,height:p.height,isDragging:m,project:p.project,unproject:p.unproject}))}xc.propTypes=fD;xc.defaultProps=mD;Object.assign({},eo,{redraw:Oe.func.isRequired,style:Oe.object});Do&&Do.setRTLTextPlugin;var pm=gD,vD=Object.prototype.hasOwnProperty;function gD(){for(var n={},t=0;t<arguments.length;t++){var i=arguments[t];for(var u in i)vD.call(i,u)&&(n[u]=i[u])}return n}var yD=Object.prototype.toString,_D=function(n){var t;return yD.call(n)==="[object Object]"&&(t=Object.getPrototypeOf(n),t===null||t===Object.getPrototypeOf({}))},bD=_D,xD=pm,q2="value",zv=`
  `,pn={};pn.assert=function(n,t){return t=t||{},function(i){var u=Js(n,i);if(u){var p=Ay(u,t);throw t.apiName&&(p=t.apiName+": "+p),new Error(p)}}};pn.shape=function(t){var i=PD(t);return function(p){var m=Js(pn.plainObject,p);if(m)return m;for(var o,_,b=[],E=0;E<i.length;E++)o=i[E].key,_=i[E].value,m=Js(_,p[o]),m&&b.push([o].concat(m));return b.length<2?b[0]:function(T){b=b.map(function(N){var D=N[0],re=Ay(N,T).split(`
`).join(zv);return"- "+D+": "+re});var M=T.path.join("."),I=M===q2?"":" of "+M;return"The following properties"+I+" have invalid values:"+zv+b.join(zv)}}};pn.strictShape=function(t){var i=pn.shape(t);return function(p){var m=i(p);if(m)return m;var o=Object.keys(p).reduce(function(_,b){return t[b]===void 0&&_.push(b),_},[]);if(o.length!==0)return function(){return"The following keys are invalid: "+o.join(", ")}}};pn.arrayOf=function(t){return $2(t)};pn.tuple=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return $2(t)};function $2(n){var t=Array.isArray(n),i=function(u){return t?n[u]:n};return function(p){var m=Js(pn.plainArray,p);if(m)return m;if(t&&p.length!==n.length)return"an array with "+n.length+" items";for(var o=0;o<p.length;o++)if(m=Js(i(o),p[o]),m)return[o].concat(m)}}pn.required=function(t){function i(u){return u==null?function(p){return W2(p,H2(p.path)?"cannot be undefined/null.":"is required.")}:t.apply(this,arguments)}return i.__required=!0,i};pn.oneOfType=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(u){var p=t.map(function(m){return Js(m,u)}).filter(Boolean);if(p.length===t.length)return p.every(function(m){return m.length===1&&typeof m[0]=="string"})?wD(p.map(function(m){return m[0]})):p.reduce(function(m,o){return o.length>m.length?o:m})}};pn.equal=function(t){return function(u){if(u!==t)return JSON.stringify(t)}};pn.oneOf=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),i=t.map(function(u){return pn.equal(u)});return pn.oneOfType.apply(this,i)};pn.range=function(t){var i=t[0],u=t[1];return function(m){var o=Js(pn.number,m);if(o||m<i||m>u)return"number between "+i+" & "+u+" (inclusive)"}};pn.any=function(){};pn.boolean=function(t){if(typeof t!="boolean")return"boolean"};pn.number=function(t){if(typeof t!="number")return"number"};pn.plainArray=function(t){if(!Array.isArray(t))return"array"};pn.plainObject=function(t){if(!bD(t))return"object"};pn.string=function(t){if(typeof t!="string")return"string"};pn.func=function(t){if(typeof t!="function")return"function"};function Js(n,t){if(!(t==null&&!n.hasOwnProperty("__required"))){var i=n(t);if(i)return Array.isArray(i)?i:[i]}}function Ay(n,t){var i=n.length,u=n[i-1],p=n.slice(0,i-1);return p.length===0&&(p=[q2]),t=xD(t,{path:p}),typeof u=="function"?u(t):W2(t,SD(u))}function wD(n){return n.length<2?n[0]:n.length===2?n.join(" or "):n.slice(0,-1).join(", ")+", or "+n.slice(-1)}function SD(n){return"must be "+ED(n)+"."}function ED(n){return/^an? /.test(n)?n:/^[aeiou]/i.test(n)?"an "+n:/^[a-z]/i.test(n)?"a "+n:n}function W2(n,t){var i=H2(n.path),u=n.path.join(".")+" "+t,p=i?"Item at position ":"";return p+u}function H2(n){return typeof n[n.length-1]=="number"||typeof n[0]=="number"}function PD(n){return Object.keys(n||{}).map(function(t){return{key:t,value:n[t]}})}pn.validate=Js;pn.processMessage=Ay;var TD=pn,CD=pm,Pc=TD;function ID(n){if(typeof window<"u")return n instanceof Sa.Blob||n instanceof Sa.ArrayBuffer?void 0:"Blob or ArrayBuffer";if(!(typeof n=="string"||n.pipe!==void 0))return"Filename or Readable stream"}function MD(n,t){return Pc.assert(Pc.strictShape(n),t)}function OD(n){var t="date";if(typeof n=="boolean")return t;try{var i=new Date(n);if(i.getTime&&isNaN(i.getTime()))return t}catch{return t}}function RD(n){return Pc.tuple(Pc.number,Pc.number)(n)}var Z2=CD(Pc,{file:ID,date:OD,coordinates:RD,assertShape:MD});function AD(n,t){var i=function(u,p){return t.indexOf(u)!==-1&&p!==void 0};return typeof t=="function"&&(i=t),Object.keys(n).filter(function(u){return i(u,n[u])}).reduce(function(u,p){return u[p]=n[p],u},{})}var G2=AD;function kD(n,t){return Object.keys(n).reduce(function(i,u){return i[u]=t(u,n[u]),i},{})}var DD=kD,LD=DD;function zD(n){return LD(n,function(t,i){return typeof i=="boolean"?JSON.stringify(i):i})}var X2=zD,Hf={exports:{}};/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */Hf.exports;(function(n,t){(function(i){var u=t,p=n&&n.exports==u&&n,m=typeof Sa=="object"&&Sa;(m.global===m||m.window===m)&&(i=m);var o=function(D){this.message=D};o.prototype=new Error,o.prototype.name="InvalidCharacterError";var _=function(D){throw new o(D)},b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",E=/[\t\n\f\r ]/g,T=function(D){D=String(D).replace(E,"");var re=D.length;re%4==0&&(D=D.replace(/==?$/,""),re=D.length),(re%4==1||/[^+a-zA-Z0-9/]/.test(D))&&_("Invalid character: the string to be decoded is not correctly encoded.");for(var W=0,ee,J,Y="",B=-1;++B<re;)J=b.indexOf(D.charAt(B)),ee=W%4?ee*64+J:J,W++%4&&(Y+=String.fromCharCode(255&ee>>(-2*W&6)));return Y},M=function(D){D=String(D),/[^\0-\xFF]/.test(D)&&_("The string to be encoded contains characters outside of the Latin1 range.");for(var re=D.length%3,W="",ee=-1,J,Y,B,V,K=D.length-re;++ee<K;)J=D.charCodeAt(ee)<<16,Y=D.charCodeAt(++ee)<<8,B=D.charCodeAt(++ee),V=J+Y+B,W+=b.charAt(V>>18&63)+b.charAt(V>>12&63)+b.charAt(V>>6&63)+b.charAt(V&63);return re==2?(J=D.charCodeAt(ee)<<8,Y=D.charCodeAt(++ee),V=J+Y,W+=b.charAt(V>>10)+b.charAt(V>>4&63)+b.charAt(V<<2&63)+"="):re==1&&(V=D.charCodeAt(ee),W+=b.charAt(V>>2)+b.charAt(V<<4&63)+"=="),W},I={encode:M,decode:T,version:"0.1.0"};if(u&&!u.nodeType)if(p)p.exports=I;else for(var N in I)I.hasOwnProperty(N)&&(u[N]=I[N]);else i.base64=I})(Sa)})(Hf,Hf.exports);var jD=Hf.exports,ND=jD,jv={};function BD(n){if(jv[n])return jv[n];var t=n.split("."),i=t[0],u=t[1];if(!u)throw new Error("Invalid token");var p=FD(u),m={usage:i,user:p.u};return su(p,"a")&&(m.authorization=p.a),su(p,"exp")&&(m.expires=p.exp*1e3),su(p,"iat")&&(m.created=p.iat*1e3),su(p,"scopes")&&(m.scopes=p.scopes),su(p,"client")&&(m.client=p.client),su(p,"ll")&&(m.lastLogin=p.ll),su(p,"iu")&&(m.impersonator=p.iu),jv[n]=m,m}function FD(n){try{return JSON.parse(ND.decode(n))}catch{throw new Error("Invalid token")}}function su(n,t){return Object.prototype.hasOwnProperty.call(n,t)}var K2=BD,Y2={exports:{}};(function(n){var t=Object.prototype.hasOwnProperty,i="~";function u(){}Object.create&&(u.prototype=Object.create(null),new u().__proto__||(i=!1));function p(b,E,T){this.fn=b,this.context=E,this.once=T||!1}function m(b,E,T,M,I){if(typeof T!="function")throw new TypeError("The listener must be a function");var N=new p(T,M||b,I),D=i?i+E:E;return b._events[D]?b._events[D].fn?b._events[D]=[b._events[D],N]:b._events[D].push(N):(b._events[D]=N,b._eventsCount++),b}function o(b,E){--b._eventsCount===0?b._events=new u:delete b._events[E]}function _(){this._events=new u,this._eventsCount=0}_.prototype.eventNames=function(){var E=[],T,M;if(this._eventsCount===0)return E;for(M in T=this._events)t.call(T,M)&&E.push(i?M.slice(1):M);return Object.getOwnPropertySymbols?E.concat(Object.getOwnPropertySymbols(T)):E},_.prototype.listeners=function(E){var T=i?i+E:E,M=this._events[T];if(!M)return[];if(M.fn)return[M.fn];for(var I=0,N=M.length,D=new Array(N);I<N;I++)D[I]=M[I].fn;return D},_.prototype.listenerCount=function(E){var T=i?i+E:E,M=this._events[T];return M?M.fn?1:M.length:0},_.prototype.emit=function(E,T,M,I,N,D){var re=i?i+E:E;if(!this._events[re])return!1;var W=this._events[re],ee=arguments.length,J,Y;if(W.fn){switch(W.once&&this.removeListener(E,W.fn,void 0,!0),ee){case 1:return W.fn.call(W.context),!0;case 2:return W.fn.call(W.context,T),!0;case 3:return W.fn.call(W.context,T,M),!0;case 4:return W.fn.call(W.context,T,M,I),!0;case 5:return W.fn.call(W.context,T,M,I,N),!0;case 6:return W.fn.call(W.context,T,M,I,N,D),!0}for(Y=1,J=new Array(ee-1);Y<ee;Y++)J[Y-1]=arguments[Y];W.fn.apply(W.context,J)}else{var B=W.length,V;for(Y=0;Y<B;Y++)switch(W[Y].once&&this.removeListener(E,W[Y].fn,void 0,!0),ee){case 1:W[Y].fn.call(W[Y].context);break;case 2:W[Y].fn.call(W[Y].context,T);break;case 3:W[Y].fn.call(W[Y].context,T,M);break;case 4:W[Y].fn.call(W[Y].context,T,M,I);break;default:if(!J)for(V=1,J=new Array(ee-1);V<ee;V++)J[V-1]=arguments[V];W[Y].fn.apply(W[Y].context,J)}}return!0},_.prototype.on=function(E,T,M){return m(this,E,T,M,!1)},_.prototype.once=function(E,T,M){return m(this,E,T,M,!0)},_.prototype.removeListener=function(E,T,M,I){var N=i?i+E:E;if(!this._events[N])return this;if(!T)return o(this,N),this;var D=this._events[N];if(D.fn)D.fn===T&&(!I||D.once)&&(!M||D.context===M)&&o(this,N);else{for(var re=0,W=[],ee=D.length;re<ee;re++)(D[re].fn!==T||I&&!D[re].once||M&&D[re].context!==M)&&W.push(D[re]);W.length?this._events[N]=W.length===1?W[0]:W:o(this,N)}return this},_.prototype.removeAllListeners=function(E){var T;return E?(T=i?i+E:E,this._events[T]&&o(this,T)):(this._events=new u,this._eventsCount=0),this},_.prototype.off=_.prototype.removeListener,_.prototype.addListener=_.prototype.on,_.prefixed=i,_.EventEmitter=_,n.exports=_})(Y2);var UD=Y2.exports;function VD(n){return n.map(encodeURIComponent).join(",")}function J2(n){return Array.isArray(n)?VD(n):encodeURIComponent(String(n))}function Q2(n,t,i){if(i===!1||i===null)return n;var u=/\?/.test(n)?"&":"?",p=encodeURIComponent(t);return i!==void 0&&i!==""&&i!==!0&&(p+="="+J2(i)),""+n+u+p}function qD(n,t){if(!t)return n;var i=n;return Object.keys(t).forEach(function(u){var p=t[u];p!==void 0&&(Array.isArray(p)&&(p=p.filter(function(m){return m!=null}).join(",")),i=Q2(i,u,p))}),i}function $D(n,t){if(!t||n.slice(0,4)==="http")return n;var i=n[0]==="/"?"":"/";return""+t.replace(/\/$/,"")+i+n}function WD(n,t){return t?n.replace(/\/:([a-zA-Z0-9]+)/g,function(i,u){var p=t[u];if(p===void 0)throw new Error("Unspecified route parameter "+u);var m=J2(p);return"/"+m}):n}var HD={appendQueryObject:qD,appendQueryParam:Q2,prependOrigin:$D,interpolateRouteParams:WD},hm={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"},ZD=K2,ky=pm,GD=UD,cf=HD,d1=hm,XD=1;function Qs(n,t){if(!n)throw new Error("MapiRequest requires a client");if(!t||!t.path||!t.method)throw new Error("MapiRequest requires an options object with path and method properties");var i={};t.body&&(i["content-type"]="application/json");var u=ky(i,t.headers),p=Object.keys(u).reduce(function(m,o){return m[o.toLowerCase()]=u[o],m},{});this.id=XD++,this._options=t,this.emitter=new GD,this.client=n,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=t.path,this.method=t.method,this.origin=t.origin||n.origin,this.query=t.query||{},this.params=t.params||{},this.body=t.body||null,this.file=t.file||null,this.encoding=t.encoding||"utf8",this.sendFileAs=t.sendFileAs||null,this.headers=p}Qs.prototype.url=function(t){var i=cf.prependOrigin(this.path,this.origin);i=cf.appendQueryObject(i,this.query);var u=this.params,p=t??this.client.accessToken;if(p){i=cf.appendQueryParam(i,"access_token",p);var m=ZD(p).user;u=ky({ownerId:m},u)}return i=cf.interpolateRouteParams(i,u),i};Qs.prototype.send=function(){var t=this;if(t.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return t.sent=!0,t.client.sendRequest(t).then(function(i){return t.response=i,t.emitter.emit(d1.EVENT_RESPONSE,i),i},function(i){throw t.error=i,t.emitter.emit(d1.EVENT_ERROR,i),i})};Qs.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))};Qs.prototype.eachPage=function(t){var i=this;function u(o){function _(){delete i._nextPageRequest;var b=o.nextPage();b&&(i._nextPageRequest=b,m(b))}t(null,o,_)}function p(o){t(o,null,function(){})}function m(o){o.send().then(u,p)}m(this)};Qs.prototype.clone=function(){return this._extend()};Qs.prototype._extend=function(t){var i=ky(this._options,t);return new Qs(this.client,i)};var KD=Qs,YD=K2,JD=KD,QD=hm;function eE(n){if(!n||!n.accessToken)throw new Error("Cannot create a client without an access token");YD(n.accessToken),this.accessToken=n.accessToken,this.origin=n.origin||QD.API_ORIGIN}eE.prototype.createRequest=function(t){return new JD(this,t)};var tE=eE;function eL(n){var t=n.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return t?{key:t[1],value:t[2]}:null}function tL(n){var t=n.match(/<?([^>]*)>(.*)/);if(!t)return null;var i=t[1],u=t[2].split(";"),p=null,m=u.reduce(function(o,_){var b=eL(_);return b?b.key==="rel"?(p||(p=b.value),o):(o[b.key]=b.value,o):o},{});return p?{url:i,rel:p,params:m}:null}function rL(n){return n?n.split(/,\s*</).reduce(function(t,i){var u=tL(i);if(!u)return t;var p=u.rel.split(/\s+/);return p.forEach(function(m){t[m]||(t[m]={url:u.url,params:u.params})}),t},{}):{}}var nL=rL,iL=nL;function Dy(n,t){this.request=n,this.headers=t.headers,this.rawBody=t.body,this.statusCode=t.statusCode;try{this.body=JSON.parse(t.body||"{}")}catch{this.body=t.body}this.links=iL(this.headers.link)}Dy.prototype.hasNextPage=function(){return!!this.links.next};Dy.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null};var aL=Dy,f1=hm;function oL(n){var t=n.type||f1.ERROR_HTTP,i;if(n.body)try{i=JSON.parse(n.body)}catch{i=n.body}else i=null;var u=n.message||null;u||(typeof i=="string"?u=i:i&&typeof i.message=="string"?u=i.message:t===f1.ERROR_REQUEST_ABORTED&&(u="Request aborted")),this.message=u,this.type=t,this.statusCode=n.statusCode||null,this.request=n.request,this.body=i}var sL=oL;function lL(n){var t=n.indexOf(":"),i=n.substring(0,t).trim().toLowerCase(),u=n.substring(t+1).trim();return{name:i,value:u}}function uL(n){var t={};return n&&n.trim().split(/[\r|\n]+/).forEach(function(i){var u=lL(i);t[u.name]=u.value}),t}var cL=uL,pL=aL,m1=sL,Nv=hm,hL=cL,Zf={};function dL(n){var t=Zf[n.id];t&&(t.abort(),delete Zf[n.id])}function fL(n,t){return new pL(n,{body:t.response,headers:hL(t.getAllResponseHeaders()),statusCode:t.status})}function v1(n){var t=n.total,i=n.loaded,u=100*i/t;return{total:t,transferred:i,percent:u}}function rE(n,t){return new Promise(function(i,u){t.onprogress=function(o){n.emitter.emit(Nv.EVENT_PROGRESS_DOWNLOAD,v1(o))};var p=n.file;p&&(t.upload.onprogress=function(o){n.emitter.emit(Nv.EVENT_PROGRESS_UPLOAD,v1(o))}),t.onerror=function(o){u(o)},t.onabort=function(){var o=new m1({request:n,type:Nv.ERROR_REQUEST_ABORTED});u(o)},t.onload=function(){if(delete Zf[n.id],t.status<200||t.status>=400){var o=new m1({request:n,body:t.response,statusCode:t.status});u(o);return}i(t)};var m=n.body;typeof m=="string"?t.send(m):m?t.send(JSON.stringify(m)):p?t.send(p):t.send(),Zf[n.id]=t}).then(function(i){return fL(n,i)})}function nE(n,t){var i=n.url(t),u=new window.XMLHttpRequest;return u.open(n.method,i),Object.keys(n.headers).forEach(function(p){u.setRequestHeader(p,n.headers[p])}),u}function mL(n){return Promise.resolve().then(function(){var t=nE(n,n.client.accessToken);return rE(n,t)})}var vL={browserAbort:dL,sendRequestXhr:rE,browserSend:mL,createRequestXhr:nE},iE=vL,aE=tE;function Ac(n){aE.call(this,n)}Ac.prototype=Object.create(aE.prototype);Ac.prototype.constructor=Ac;Ac.prototype.sendRequest=iE.browserSend;Ac.prototype.abortRequest=iE.browserAbort;function gL(n){return new Ac(n)}var yL=gL,_L=tE,bL=yL;function xL(n){return function(t){var i;_L.prototype.isPrototypeOf(t)?i=t:i=bL(t);var u=Object.create(n);return u.client=i,u}}var oE=xL,sE=pm,Ar=Z2,Gf=G2,lE=X2,wL=oE,Ly={},uE=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];Ly.forwardGeocode=function(n){Ar.assertShape({query:Ar.required(Ar.string),mode:Ar.oneOf("mapbox.places","mapbox.places-permanent"),countries:Ar.arrayOf(Ar.string),proximity:Ar.oneOf(Ar.coordinates,"ip"),types:Ar.arrayOf(Ar.oneOf(uE)),autocomplete:Ar.boolean,bbox:Ar.arrayOf(Ar.number),limit:Ar.number,language:Ar.arrayOf(Ar.string),routing:Ar.boolean,fuzzyMatch:Ar.boolean,worldview:Ar.string})(n),n.mode=n.mode||"mapbox.places";var t=lE(sE({country:n.countries},Gf(n,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:Gf(n,["mode","query"]),query:t})};Ly.reverseGeocode=function(n){Ar.assertShape({query:Ar.required(Ar.coordinates),mode:Ar.oneOf("mapbox.places","mapbox.places-permanent"),countries:Ar.arrayOf(Ar.string),types:Ar.arrayOf(Ar.oneOf(uE)),bbox:Ar.arrayOf(Ar.number),limit:Ar.number,language:Ar.arrayOf(Ar.string),reverseMode:Ar.oneOf("distance","score"),routing:Ar.boolean,worldview:Ar.string})(n),n.mode=n.mode||"mapbox.places";var t=lE(sE({country:n.countries},Gf(n,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:Gf(n,["mode","query"]),query:t})};var SL=wL(Ly);const EL=_n(SL);var PL=G2;function TL(n){return PL(n,function(t,i){return i!=null})}var CL=TL,sr=Z2,IL=oE,ML=CL,OL=X2,cE={};cE.getDirections=function(n){sr.assertShape({profile:sr.oneOf("driving-traffic","driving","walking","cycling"),waypoints:sr.required(sr.arrayOf(sr.shape({coordinates:sr.required(sr.coordinates),approach:sr.oneOf("unrestricted","curb"),bearing:sr.arrayOf(sr.range([0,360])),radius:sr.oneOfType(sr.number,sr.equal("unlimited")),waypointName:sr.string}))),alternatives:sr.boolean,annotations:sr.arrayOf(sr.oneOf("duration","distance","speed","congestion","congestion_numeric","maxspeed","closure","state_of_charge")),bannerInstructions:sr.boolean,continueStraight:sr.boolean,exclude:sr.string,geometries:sr.string,language:sr.string,overview:sr.string,roundaboutExits:sr.boolean,steps:sr.boolean,voiceInstructions:sr.boolean,voiceUnits:sr.string,engine:sr.string,ev_initial_charge:sr.number,ev_max_charge:sr.number,ev_connector_types:sr.string,energy_consumption_curve:sr.string,ev_charging_curve:sr.string,ev_unconditioned_charging_curve:sr.string,ev_pre_conditioning_time:sr.number,ev_max_ac_charging_power:sr.number,ev_min_charge_at_destination:sr.number,ev_min_charge_at_charging_station:sr.number,auxiliary_consumption:sr.number,maxHeight:sr.number,maxWidth:sr.number,maxWeight:sr.number,notifications:sr.string,departAt:sr.string,arriveBy:sr.string})(n),n.profile=n.profile||"driving";var t={coordinates:[],approach:[],bearing:[],radius:[],waypointName:[]},i=n.waypoints.length;if(i<2||i>25)throw new Error("waypoints must include between 2 and 25 DirectionsWaypoints");n.waypoints.forEach(function(p){t.coordinates.push(p.coordinates[0]+","+p.coordinates[1]),["bearing"].forEach(function(m){p.hasOwnProperty(m)&&p[m]!=null&&(p[m]=p[m].join(","))}),["approach","bearing","radius","waypointName"].forEach(function(m){p.hasOwnProperty(m)&&p[m]!=null?t[m].push(p[m]):t[m].push("")})}),["approach","bearing","radius","waypointName"].forEach(function(p){t[p].every(function(m){return m===""})?delete t[p]:t[p]=t[p].join(";")});var u=OL({alternatives:n.alternatives,annotations:n.annotations,banner_instructions:n.bannerInstructions,continue_straight:n.continueStraight,exclude:n.exclude,geometries:n.geometries,language:n.language,overview:n.overview,roundabout_exits:n.roundaboutExits,steps:n.steps,voice_instructions:n.voiceInstructions,voice_units:n.voiceUnits,approaches:t.approach,bearings:t.bearing,radiuses:t.radius,waypoint_names:t.waypointName,engine:n.engine,ev_initial_charge:n.ev_initial_charge,ev_max_charge:n.ev_max_charge,ev_connector_types:n.ev_connector_types,energy_consumption_curve:n.energy_consumption_curve,ev_charging_curve:n.ev_charging_curve,ev_unconditioned_charging_curve:n.ev_unconditioned_charging_curve,ev_pre_conditioning_time:n.ev_pre_conditioning_time,ev_max_ac_charging_power:n.ev_max_ac_charging_power,ev_min_charge_at_destination:n.ev_min_charge_at_destination,ev_min_charge_at_charging_station:n.ev_min_charge_at_charging_station,auxiliary_consumption:n.auxiliary_consumption,max_height:n.maxHeight,max_width:n.maxWidth,max_weight:n.maxWeight,notifications:n.notifications,depart_at:n.departAt,arrive_by:n.arriveBy});return this.client.createRequest({method:"GET",path:"/directions/v5/mapbox/:profile/:coordinates",params:{profile:n.profile,coordinates:t.coordinates.join(";")},query:ML(u)})};var RL=IL(cE);const AL=_n(RL),pE={latitude:32.711483,longitude:-117.161052},hE="mapbox://styles/commaai/cjj4yzqk201c52ss60ebmow0w",Mh="pk.eyJ1IjoiY29tbWFhaSIsImEiOiJjangyYXV0c20wMGU2NDluMWR4amUydGl5In0.6Vb11S6tdX6Arpj6trRE_g",dE="FzdKQBdDlWNQfvlvreB9ukezD-fYi7uKW0rM_K9eE2E",kL=EL({accessToken:Mh}),g1=AL({accessToken:Mh});function DL(n){const t=["region","district","place","locality","neighborhood"];return n.filter(i=>t.some(u=>i.id.indexOf(u)!==-1))}function Of(n){return n.id.indexOf("region")!==-1&&n.short_code?n.short_code.indexOf("US-")!==-1?n.short_code.substr(3):n.short_code:n.text}function LL(n){const t={};return n.forEach(i=>{const u=i.id.split(".",1)[0];t[u]=Of(i)}),t}const zL={Avenue:"Ave",Boulevard:"Blvd",Circle:"Cir",Close:"Cl",Court:"Ct",Crescent:"Cres",Drive:"Dr",Expressway:"Expy",Highway:"Hwy",Lane:"Ln",Place:"Pl",Road:"Rd",Street:"St"},y1={North:"N",Northeast:"NE",East:"E",Southeast:"SE",South:"S",Southwest:"SW",West:"W",Northwest:"NW"};function jL(n){const t=n.split(" "),i=[];let u=t.pop();const p=t.shift();let m=y1[p];m?t.unshift(m):(t.unshift(p),m=y1[u],m&&(i.push(m),u=t.pop()));const o=zL[u];return o&&i.push(o),t.push(...i.reverse()),t.join(" ")}function NL(n){return["place","locality","district"].flatMap(i=>n.filter(u=>u.id.indexOf(i)!==-1))[0]}async function fE(n,t=!1){if(kL===null||n[0]===0&&n[1]===0)return null;const i="https://api.mapbox.com/geocoding/v5/mapbox.places/",u={access_token:Mh,limit:1};let p;try{if(p=await fetch(`${i}${n[0]},${n[1]}.json?${tm.stringify(u)}`,{method:"GET",cache:"force-cache"}),!p.ok)return null}catch(m){return console.error(m),null}try{const{features:m}=await p.json();if(m.length&&m[0].context){if(t){const E=LL(m[0].context),T=jL(m[0].text);let M;E.country==="United Kingdom"?M=E.postcode:M=`${E.region} ${E.postcode}`;const I=`${E.place}, ${M}, ${E.country}`;return{place:T,details:I}}const o=DL(m[0].context);let _="",b="";return o.length>0&&(_=Of(o.shift())),o.length>0&&(b=Of(o.pop())),o.length>0&&(b=`${Of(NL(o))}, ${b}`),{place:_,details:b}}}catch(m){Qr(m,{fingerprint:"geocode_reverse_parse"})}return null}async function _1(n,t,i){if(!n)return[];const u={apiKey:dE,q:n,limit:20,show:["details"]};if(t)u.at=`${t[1]},${t[0]}`;else if(i){const o=new Ea(i).getBounds(),_=[Math.max(-180,o[0][0]),Math.max(-90,o[0][1]),Math.min(180,o[1][0]),Math.min(90,o[1][1])];u.in=`bbox:${_.join(",")}`}else u.in="bbox:-180,-90,180,90";const p=await fetch(`https://autosuggest.search.hereapi.com/v1/autosuggest?${tm.stringify(u)}`,{method:"GET"});return p.ok?(await p.json()).items:(console.error(p),[])}async function BL(n){const t=await fetch(`https://positioning.hereapi.com/v2/locate?apiKey=${dE}&fallback=any,singleWifi`,{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(n)});return t.ok?(await t.json()).location:(console.error(t),null)}async function FL(n){return g1?(await g1.getDirections({profile:"driving-traffic",waypoints:n.map(i=>({coordinates:i})),annotations:["distance","duration"],geometries:"geojson",overview:"full"}).send()).body.routes:null}var mE={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Rf=eS(mE.VITE_APP_LOCAL_COORDS_DATA);Rf&&console.warn("using local coords data");const Af=eS(mE.VITE_APP_LOCAL_EVENTS_DATA);Af&&console.warn("using local events data");const Bv={},Fv={},Uv={};let b1=!1,Vv=null;async function zy(){if(Vv!==null)return Promise.resolve(Vv);if(!window.indexedDB)return Promise.resolve(null);let n;try{n=window.indexedDB.open("cacheDB",2)}catch(t){return console.error(t),Qr(t,{fingerprint:"cached_open_indexeddb"}),Promise.resolve(null)}return new Promise(t=>{n.onerror=i=>{console.log(i.target.error),t(null)},n.onsuccess=i=>{const u=i.target.result;for(const p of["events","coords","driveCoords"])u.objectStoreNames.contains(p)||(console.log("cannot find store in indexedDB",p),t(null));Vv=u,t(u)},n.onupgradeneeded=i=>{const u=i.target.result;for(const _ of u.objectStoreNames)try{u.deleteObjectStore(_)}catch(b){console.error(b),Qr(b,{fingerprint:"cached_delete_obj_store"}),t(null);return}const p=u.createObjectStore("events",{keyPath:"key"});p.createIndex("key","key",{unique:!0}),p.createIndex("expiry","expiry",{unique:!1});const m=u.createObjectStore("coords",{keyPath:"key"});m.createIndex("key","key",{unique:!0}),m.createIndex("expiry","expiry",{unique:!1});const o=u.createObjectStore("driveCoords",{keyPath:"key"});o.createIndex("key","key",{unique:!0}),o.createIndex("expiry","expiry",{unique:!1})}})}async function jy(n,t,i=void 0){b1||(setTimeout(()=>UL(n),5e3),b1=!0);const u=await zy();if(!u)return null;const m=u.transaction([n]).objectStore(n).get(t);return new Promise((o,_)=>{m.onsuccess=b=>{b.target.result!==void 0&&(i===void 0||b.target.result.version>=i)?o(b.target.result.data):o(null)},m.onerror=b=>_(b.target.error)})}async function Ny(n,t,i,u,p=void 0){const m=await zy();if(!m)return null;const o=m.transaction([n],"readwrite"),_={key:t,expiry:i,data:u};p!==void 0&&(_.version=p);const b=o.objectStore(n).put(_);return new Promise((E,T)=>{b.onsuccess=M=>E(M.target.result),b.onerror=M=>T(M.target.error)})}async function UL(n){const t=await zy();if(!t)return;const u=t.transaction([n],"readwrite").objectStore(n),p=IDBKeyRange.upperBound(Math.floor(Date.now()/1e3)),m=u.index("expiry").openCursor(p);m.onsuccess=o=>{const _=o.target.result;_&&(u.delete(_.primaryKey),_.continue())}}function VL(n,t){var b;t.sort((E,T)=>E.route_offset_millis===T.route_offset_millis?E.route_offset_nanos-T.route_offset_nanos:E.route_offset_millis-T.route_offset_millis);let i=[],u=null,p=null,m=null,o=null,_=null;for(const E of t)E.type==="state"?(u!==null&&!E.data.enabled&&(u.data.end_route_offset_millis=E.route_offset_millis,u=null),u===null&&E.data.enabled&&(u={...E,data:{...E.data},type:"engage"},i.push(u)),p!==null&&E.data.alertStatus!==p.data.alertStatus&&(p.data.end_route_offset_millis=E.route_offset_millis,p=null),p===null&&E.data.alertStatus!=="normal"&&(p={...E,data:{...E.data},type:"alert"},i.push(p)),m!==null&&E.data.state!==m.data.state&&(m.data.end_route_offset_millis=E.route_offset_millis,m=null),m===null&&["overriding","preEnabled"].includes(E.data.state)&&(m={...E,data:{...E.data},type:"overriding"},i.push(m))):E.type==="engage"?(o={...E,data:{...E.data}},i.push(o)):E.type==="disengage"&&o?o.data={end_route_offset_millis:E.route_offset_millis}:E.type==="alert"||E.type==="event"?i.push(E):E.type==="user_flag"&&(_={...E,data:{...E.data,end_route_offset_millis:E.route_offset_millis+1e3},type:"flag"},i.push(_));return u!==null&&(u.data.end_route_offset_millis=n.duration),p!==null&&(p.data.end_route_offset_millis=n.duration),m!==null&&(m.data.end_route_offset_millis=n.duration),o&&((b=o.data)==null?void 0:b.end_route_offset_millis)===void 0&&(o.data={end_route_offset_millis:n.duration}),i=i.map(E=>({type:E.type,route_offset_millis:E.route_offset_millis,data:{state:E.data.state,event_type:E.data.event_type,alertStatus:E.data.alertStatus,end_route_offset_millis:E.data.end_route_offset_millis}})),i}function vE(n){return async(t,i)=>{const u=i();if(!u.routes)return;for(const _ of u.routes)if(_.fullname===n.fullname){if(_.events)return;break}if(Bv[n.fullname]!==void 0){const _=await Bv[n.fullname];t({type:uv,fullname:n.fullname,events:_});return}let p;if(Bv[n.fullname]=new Promise(_=>{p=_}),!Af){const _=await jy("events",n.fullname,n.maxqlog);if(_!==null){t({type:uv,fullname:n.fullname,events:_}),p(_);return}}let m;const o=[];for(let _=0;_<=n.maxqlog;_++)o.push((async b=>{const E=new URL(`${n.url}/${b}/events.json`);Af&&(E.hostname="chffrprivate.azureedge.local");const T=await fetch(E,{method:"GET"});return T.ok?await T.json():[]})(_));try{m=[].concat(...await Promise.all(o))}catch(_){console.error(_);return}m=VL(n,m),t({type:uv,fullname:n.fullname,events:m}),p(m),Af||Ny("events",n.fullname,Math.floor(Date.now()/1e3)+86400*14,m,n.maxqlog)}}function qL(n){return(t,i)=>{t(x1(n,[n.start_lng,n.start_lat],"startLocation")),t(x1(n,[n.end_lng,n.end_lat],"endLocation"))}}function x1(n,t,i){return async(u,p)=>{const m=p();if(!m.routes||!t[0]&&!t[1])return;for(const T of m.routes)if(T.fullname===n.fullname){if(T[i])return;break}t[0]=Math.round(t[0]*1e3)/1e3,t[1]=Math.round(t[1]*1e3)/1e3;const o=JSON.stringify(t);if(Fv[o]!==void 0){const T=await Fv[o];u({type:pv,fullname:n.fullname,locationKey:i,location:T});return}let _;Fv[o]=new Promise(T=>{_=T});const b=await jy("coords",t);if(b!==null){u({type:pv,fullname:n.fullname,locationKey:i,location:b}),_(b);return}const E=await fE(t);E&&(u({type:pv,fullname:n.fullname,locationKey:i,location:E}),_(E),Ny("coords",t,Math.floor(Date.now()/1e3)+86400*14,E))}}function $L(n){return async(t,i)=>{const u=i();if(!u.routes)return;for(const _ of u.routes)if(_.fullname===n.fullname){if(_.driveCoords)return;break}if(Uv[n.fullname]!==void 0){const _=await Uv[n.fullname];t({type:cv,fullname:n.fullname,route:{driveCoords:_}});return}let p;if(Uv[n.fullname]=new Promise(_=>{p=_}),!Rf){const _=await jy("driveCoords",n.fullname,n.maxqlog);if(_!==null){t({type:cv,fullname:n.fullname,route:{driveCoords:_}}),p(_);return}}const m=[];for(let _=0;_<=n.maxqlog;_++)m.push((async b=>{const E=new URL(`${n.url}/${b}/coords.json`);Rf&&(E.hostname="chffrprivate.azureedge.local");const T=await fetch(E,{method:"GET"});return T.ok?await T.json():[]})(_));let o;try{o=await Promise.all(m)}catch(_){console.error(_);return}o=o.reduce((_,b)=>({..._,...b.reduce((E,T)=>(E[T.t]=[T.lng,T.lat],E),{})}),{}),t({type:cv,fullname:n.fullname,route:{driveCoords:o}}),p(o),Rf||Ny("driveCoords",n.fullname,Math.floor(Date.now()/1e3)+86400*14,o,n.maxqlog)}}const gE=1.60934;let qv=null;const yE=()=>(qv===null&&(qv=["en-us","en-gb","my"].indexOf(window.navigator.language.toLowerCase())===-1),qv);var dm={exports:{}},ah={exports:{}};(function(){var n,t,i,u,p,m;typeof performance<"u"&&performance!==null&&performance.now?ah.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(ah.exports=function(){return(n()-p)/1e6},t=process.hrtime,n=function(){var o;return o=t(),o[0]*1e9+o[1]},u=n(),m=process.uptime()*1e9,p=u-m):Date.now?(ah.exports=function(){return Date.now()-i},i=Date.now()):(ah.exports=function(){return new Date().getTime()-i},i=new Date().getTime())}).call(Sa);var WL=ah.exports,HL=WL,_s=typeof window>"u"?Sa:window,pf=["moz","webkit"],Tc="AnimationFrame",kc=_s["request"+Tc],bh=_s["cancel"+Tc]||_s["cancelRequest"+Tc];for(var eh=0;!kc&&eh<pf.length;eh++)kc=_s[pf[eh]+"Request"+Tc],bh=_s[pf[eh]+"Cancel"+Tc]||_s[pf[eh]+"CancelRequest"+Tc];if(!kc||!bh){var $v=0,w1=0,lu=[],ZL=1e3/60;kc=function(n){if(lu.length===0){var t=HL(),i=Math.max(0,ZL-(t-$v));$v=i+t,setTimeout(function(){var u=lu.slice(0);lu.length=0;for(var p=0;p<u.length;p++)if(!u[p].cancelled)try{u[p].callback($v)}catch(m){setTimeout(function(){throw m},0)}},Math.round(i))}return lu.push({handle:++w1,callback:n,cancelled:!1}),w1},bh=function(n){for(var t=0;t<lu.length;t++)lu[t].handle===n&&(lu[t].cancelled=!0)}}dm.exports=function(n){return kc.call(_s,n)};dm.exports.cancel=function(){bh.apply(_s,arguments)};dm.exports.polyfill=function(n){n||(n=_s),n.requestAnimationFrame=kc,n.cancelAnimationFrame=bh};var GL=dm.exports;const xh=_n(GL);var XL=["client","offset","scroll","bounds","margin"];function S1(n){var t=[];return XL.forEach(function(i){n[i]&&t.push(i)}),t}function E1(n,t){var i={};if(t.indexOf("client")>-1&&(i.client={top:n.clientTop,left:n.clientLeft,width:n.clientWidth,height:n.clientHeight}),t.indexOf("offset")>-1&&(i.offset={top:n.offsetTop,left:n.offsetLeft,width:n.offsetWidth,height:n.offsetHeight}),t.indexOf("scroll")>-1&&(i.scroll={top:n.scrollTop,left:n.scrollLeft,width:n.scrollWidth,height:n.scrollHeight}),t.indexOf("bounds")>-1){var u=n.getBoundingClientRect();i.bounds={top:u.top,right:u.right,bottom:u.bottom,left:u.left,width:u.width,height:u.height}}if(t.indexOf("margin")>-1){var p=getComputedStyle(n);i.margin={top:p?parseInt(p.marginTop):0,right:p?parseInt(p.marginRight):0,bottom:p?parseInt(p.marginBottom):0,left:p?parseInt(p.marginLeft):0}}return i}function KL(n){var t=n&&n.ownerDocument&&n.ownerDocument.defaultView;return t||window}function YL(n){return function(t){var i,u;return u=i=function(p){_C(m,p);function m(){for(var _,b=arguments.length,E=new Array(b),T=0;T<b;T++)E[T]=arguments[T];return _=p.call.apply(p,[this].concat(E))||this,_.state={contentRect:{entry:{},client:{},offset:{},scroll:{},bounds:{},margin:{}}},_._animationFrameID=null,_._resizeObserver=null,_._node=null,_._window=null,_.measure=function(M){var I=E1(_._node,S1(_.props));M&&(I.entry=M[0].contentRect),_._animationFrameID=_._window.requestAnimationFrame(function(){_._resizeObserver!==null&&(_.setState({contentRect:I}),typeof _.props.onResize=="function"&&_.props.onResize(I))})},_._handleRef=function(M){_._resizeObserver!==null&&_._node!==null&&_._resizeObserver.unobserve(_._node),_._node=M,_._window=KL(_._node);var I=_.props.innerRef;I&&(typeof I=="function"?I(_._node):I.current=_._node),_._resizeObserver!==null&&_._node!==null&&_._resizeObserver.observe(_._node)},_}var o=m.prototype;return o.componentDidMount=function(){this._resizeObserver=this._window!==null&&this._window.ResizeObserver?new this._window.ResizeObserver(this.measure):new M2(this.measure),this._node!==null&&(this._resizeObserver.observe(this._node),typeof this.props.onResize=="function"&&this.props.onResize(E1(this._node,S1(this.props))))},o.componentWillUnmount=function(){this._window!==null&&this._window.cancelAnimationFrame(this._animationFrameID),this._resizeObserver!==null&&(this._resizeObserver.disconnect(),this._resizeObserver=null)},o.render=function(){var b=this.props;b.innerRef,b.onResize;var E=Qw(b,["innerRef","onResize"]);return me.createElement(t,Qg({},E,{measureRef:this._handleRef,measure:this.measure,contentRect:this.state.contentRect}))},m}(me.Component),i.propTypes={client:kn.bool,offset:kn.bool,scroll:kn.bool,bounds:kn.bool,margin:kn.bool,innerRef:kn.oneOfType([kn.object,kn.func]),onResize:kn.func},u}}var By=YL()(function(n){var t=n.measure,i=n.measureRef,u=n.contentRect,p=n.children;return p({measure:t,measureRef:i,contentRect:u})});By.displayName="Measure";By.propTypes.children=kn.func;function JL(n){const{thumbnail:t}=n,i={display:"inline-block",height:t.height,width:128/80*t.height},u=Math.ceil(t.width/i.width),p=[];let m=null;if(!Number.isFinite(u))return[];const o=n.currentRoute;for(let _=0;_<u;++_){const b=n.percentToOffset((_+.5)/u);if(!o)m&&!m.blank&&(p.push(m),m=null),m||(m={blank:!0,length:0}),m.length+=1;else{const E=Math.floor((b-o.offset)/1e3),T=Math.max(0,Math.min(Math.floor(E/5),11)),M=Ws(o,b),I=`${o.url}/${M}/sprite.jpg`;m&&(m.blank||m.segmentNum!==M)&&(p.push(m),m=null),m&&(T===m.endImage+1?m.endImage=T:(p.push(m),m=null)),m||(m={segmentNum:M,startOffset:E,startImage:T,endImage:T,length:0,url:I}),m.length+=1,m.endOffset=E}}return m&&p.push(m),p.map((_,b)=>_.blank?R.jsx("div",{className:"thumbnailImage blank",role:"img",style:{...i,width:i.width*_.length}},b):R.jsx("div",{className:"thumbnailImage images",role:"img",style:{...i,width:i.width*_.length,backgroundSize:`auto ${i.height*1.2}px`,backgroundRepeat:"repeat-x",backgroundImage:`url(${_.url})`,backgroundPositionX:`-${_.startImage*i.width}px`}},b))}const QL=()=>({base:{position:"relative"},segments:{position:"relative",left:"0px",width:"100%",overflow:"hidden",height:12},segment:{position:"absolute",height:12,background:pc.palette.states.drivingBlue},statusGradient:{background:"linear-gradient(rgba(0, 0, 0, 0.0) 4%, rgba(255, 255, 255, 0.025) 10%, rgba(0, 0, 0, 0.1) 25%, rgba(0, 0, 0, 0.4))",height:12,left:0,pointerEvents:"none",position:"absolute",top:0,width:"100%",zIndex:2},segmentColor:{position:"absolute",display:"inline-block",height:12,width:"100%","&.active":{},"&.engage":{background:pc.palette.states.engagedGreen},"&.overriding":{background:pc.palette.states.engagedGrey},"&.alert":{"&.userPrompt":{background:pc.palette.states.alertOrange},"&.critical":{background:pc.palette.states.alertRed}},"&.flag":{background:pc.palette.states.userFlag,zIndex:1}},thumbnails:{height:20,width:"100%",overflow:"hidden",whiteSpace:"nowrap",userSelect:"none","& > div":{display:"inline-block"}},ruler:{backgroundColor:"rgb(37, 51, 61)",touchAction:"none",width:"100%",height:44},rulerRemaining:{backgroundColor:"rgba(29, 34, 37, 0.9)",borderLeft:"1px solid #D8DDDF",position:"absolute",left:0,height:44,opacity:.45,pointerEvents:"none",width:"100%"},loopStart:{backgroundColor:"rgba(0, 0, 0, 0.5)",borderRight:"1px solid rgba(0, 0, 0, 0.8)",position:"absolute",left:0,height:44,pointerEvents:"none"},loopEnd:{backgroundColor:"rgba(0, 0, 0, 0.5)",borderLeft:"1px solid rgba(0, 0, 0, 0.8)",position:"absolute",right:0,height:44,pointerEvents:"none"},dragHighlight:{pointerEvents:"none",background:"rgba(255, 255, 255, 0.1)",borderLeft:"1px solid rgba(255, 255, 255, 0.3)",borderRight:"1px solid rgba(255, 255, 255, 0.3)",position:"absolute",height:44},hoverBead:{zIndex:3,textAlign:"center",borderRadius:14,fontSize:"0.7em",padding:"3px 4px",border:`1px solid ${Ue.white10}`,backgroundColor:Ue.grey800,color:Ue.white,position:"absolute",top:83,left:0,width:80}}),ez=["normal","userPrompt","critical"];function tz(n){const t=n.currentTarget.getBoundingClientRect();return(n.pageX-t.left)/t.width}class rz extends me.Component{constructor(t){super(t),this.getOffset=this.getOffset.bind(this),this.handleClick=this.handleClick.bind(this),this.handlePointerMove=this.handlePointerMove.bind(this),this.handlePointerDown=this.handlePointerDown.bind(this),this.handlePointerUp=this.handlePointerUp.bind(this),this.handlePointerLeave=this.handlePointerLeave.bind(this),this.percentToOffset=this.percentToOffset.bind(this),this.segmentNum=this.segmentNum.bind(this),this.onRulerRef=this.onRulerRef.bind(this),this.renderRoute=this.renderRoute.bind(this),this.rulerRemaining=Xi.createRef(),this.rulerRef=Xi.createRef(),this.dragBar=Xi.createRef(),this.hoverBead=Xi.createRef();const{zoomOverride:i,zoom:u}=this.props;this.state={dragging:null,hoverX:null,zoom:i||u,thumbnail:{height:0,width:0}}}componentDidMount(){this.mounted=!0,xh(this.getOffset),this.componentDidUpdate({})}componentDidUpdate(t){const{zoomOverride:i,zoom:u}=this.props;(t.zoomOverride!==i||t.zoom!==u)&&this.setState({zoom:i||u})}componentWillUnmount(){this.mounted=!1}handleClick(t){const{dragging:i}=this.state;if(!i||Math.abs(i[1]-i[0])<=3){const u=tz(t);this.props.dispatch(vh(this.percentToOffset(u)))}}handlePointerDown(t){t.button===0&&(t.preventDefault(),jp.addEventListener("pointerup",this.handlePointerUp),jp.addEventListener("pointermove",this.handlePointerMove),this.setState({dragging:[t.pageX,t.pageX]}))}handlePointerMove(t){t.preventDefault();const{dragging:i}=this.state;if(!this.rulerRef.current)return;t.preventDefault();const u=this.rulerRef.current.getBoundingClientRect(),p=Math.max(u.x,Math.min(u.x+u.width,t.pageX));i&&this.setState({dragging:[i[0],p]}),this.setState({hoverX:p})}handlePointerUp(t){t.button!==3&&t.button!==4&&t.preventDefault(),jp.removeEventListener("pointerup",this.handlePointerUp),jp.removeEventListener("pointermove",this.handlePointerMove);const{dragging:i}=this.state;if(!i)return;this.setState({dragging:null});const u=this.rulerRef.current.getBoundingClientRect(),p=(Math.min(i[0],i[1])-u.x)/u.width,m=(Math.max(i[0],i[1])-u.x)/u.width,o=Math.round(this.percentToOffset(p)),_=Math.round(this.percentToOffset(m));if(Math.abs(i[1]-i[0])>3){const b=Gs();(b<o||b>_)&&this.props.dispatch(vh(o));const{filter:E,dispatch:T}=this.props,M=o+E.start,I=_+E.start;T(jf(M,I))}else t.currentTarget!==jp&&this.handleClick(t)}handlePointerLeave(){this.setState({hoverX:null})}onRulerRef(t){this.rulerRef.current=t,t&&t.addEventListener("touchstart",i=>i.stopPropagation())}getOffset(){if(!this.mounted)return;xh(this.getOffset);let t=Gs();this.seekIndex&&(t=this.seekIndex),t=Math.floor(t);const i=this.offsetToPercent(t);this.rulerRemaining.current&&this.rulerRemaining.current.parentElement&&(this.rulerRemaining.current.style.left=`${Math.floor(1e4*i)/100}%`,this.rulerRemaining.current.style.width=`${100-Math.floor(1e4*i)/100}%`)}percentToOffset(t){const{zoom:i}=this.state,{filter:u}=this.props;return t*(i.end-i.start)+(i.start-u.start)}offsetToPercent(t){const{zoom:i}=this.state,{filter:u}=this.props;return(t-(i.start-u.start))/(i.end-i.start)}segmentNum(t){const{route:i}=this.props;return i?Ws(i,t):null}renderRoute(){const{classes:t,route:i,filter:u}=this.props,{zoom:p}=this.state;if(!i.events)return null;const m=u.start-u.end;let o=100*i.offset/m,_=100*i.duration/m;const b=p.start-u.start,E=p.end-u.start,T=E-b;if(i.offset>E)return[];if(i.offset+i.duration<b)return[];o=100*(i.offset-b)/T,_=100*i.duration/T;const M={width:`${_}%`,left:`${o}%`};return R.jsx("div",{className:t.segment,style:M,children:this.renderRouteEvents(i)},i.fullname)}renderRouteEvents(t){const{classes:i}=this.props;return t.events?t.events.filter(u=>u.data&&u.data.end_route_offset_millis).map(u=>{const p={left:`${u.route_offset_millis/t.duration*100}%`,width:`${(u.data.end_route_offset_millis-u.route_offset_millis)/t.duration*100}%`,minWidth:"1px"},m=u.data.alertStatus?`${ez[u.data.alertStatus]}`:"";return R.jsx("div",{style:p,className:`${i.segmentColor} ${u.type} ${m}`},t.fullname+u.route_offset_millis+u.type)}):null}render(){const{classes:t,hasRuler:i,filter:u,className:p,route:m,thumbnailsVisible:o}=this.props,{thumbnail:_,hoverX:b,dragging:E}=this.state,T=i?"hasRuler":"";let M;this.rulerRef.current&&(M=this.rulerRef.current.getBoundingClientRect());let I,N;if(M&&b){const W=this.percentToOffset((b-M.x)/M.width);if(N={left:Math.max(-10,Math.min(M.width-70,b-M.x-40))},!Number.isNaN(W)){I=ui(u.start+W).format("HH:mm:ss");const ee=this.segmentNum(W);ee!==null&&(I=`${ee}, ${I}`)}}let D;M&&E&&Math.abs(E[1]-E[0])>0&&(D={left:`${Math.min(E[1],E[0])-M.x}px`,width:`${Math.abs(E[1]-E[0])}px`});const re={width:"100%"};return R.jsx("div",{className:p,children:R.jsxs("div",{role:"presentation",className:`${t.base} ${T}`,style:re,children:[R.jsxs("div",{className:`${t.segments} ${T}`,children:[m&&this.renderRoute(),R.jsx("div",{className:`${t.statusGradient} ${T}`})]}),R.jsx(By,{bounds:!0,onResize:W=>this.setState({thumbnail:W.bounds}),children:W=>R.jsx("div",{ref:W.measureRef,className:`${t.thumbnails} ${T}`,children:o&&R.jsx(JL,{className:t.thumbnail,currentRoute:m,percentToOffset:this.percentToOffset,thumbnail:_,hasRuler:i})})}),i&&R.jsxs(R.Fragment,{children:[R.jsxs("div",{ref:this.onRulerRef,className:t.ruler,onPointerDown:this.handlePointerDown,onPointerUp:this.handlePointerUp,onPointerMove:this.handlePointerMove,onPointerLeave:this.handlePointerLeave,children:[R.jsx("div",{ref:this.rulerRemaining,className:t.rulerRemaining}),D&&R.jsx("div",{ref:this.dragBar,className:t.dragHighlight,style:D})]}),I&&R.jsx("div",{ref:this.hoverBead,className:t.hoverBead,style:N,children:I})]})]})})}}const nz=pi({zoom:"zoom",loop:"loop",filter:"filter"}),_E=Kn(nz)(ci.withStyles(QL)(rz)),iz=()=>({drive:{background:"linear-gradient(to bottom, #30373B 0%, #1D2225 100%)",borderTop:"1px solid rgba(255, 255, 255, .05)",borderRadius:8,display:"flex",flexDirection:"column",marginBottom:12,overflow:"hidden",padding:0,transition:"background .2s",textDecoration:"none","&:hover":{}},driveHeader:{alignItems:"center"},driveHeaderIntro:{display:"flex"},driveGridItem:{flexGrow:1},driveGridItemRightAlign:{textAlign:"right"},driveHeaderIntroSmall:{justifyContent:"center"},driveArrow:{color:Ue.grey500,height:"100%",marginLeft:"25%",width:32},firstLine:{fontWeight:600}}),az=n=>{var W,ee,J,Y;const t=me.useRef(),[i,u]=me.useState(!1),p=m2(),{classes:m,dispatch:o,drive:_}=n;me.useEffect(()=>{const B=()=>{!i&&t.current&&window&&(!window.visualViewport||window.visualViewport.height>=t.current.getBoundingClientRect().y-300)&&(u(!0),o(vE(_)),o(qL(_)),window.removeEventListener("scroll",B),window.removeEventListener("resize",B))};return window.addEventListener("scroll",B),window.addEventListener("resize",B),B(),()=>{window.removeEventListener("scroll",B),window.removeEventListener("resize",B)}},[_,o,i,t]);const b=mh(()=>o(jf(_.start_time_utc_millis,_.end_time_utc_millis))),E=p<580,T=ui(_.start_time_utc_millis).format("HH:mm"),M=ui(_.start_time_utc_millis).format(E?"ddd, MMM D":"dddd, MMM D"),I=ui(_.end_time_utc_millis).format("HH:mm"),N=bC(_.duration),D=yE()?`${+(_.length*gE).toFixed(1)} km`:`${+_.length.toFixed(1)} mi`,re=E?{date:{order:1,maxWidth:"72%",flexBasis:"72%",marginBottom:12},dur:{order:2,maxWidth:"28%",flexBasis:"28%",marginBottom:12},origin:{order:3,maxWidth:"50%",flexBasis:"50%"},dest:{order:4,maxWidth:"50%",flexBasis:"50%"}}:{date:{order:1,maxWidth:"28%",flexBasis:"26%"},dur:{order:2,maxWidth:"14%",flexBasis:"14%"},origin:{order:3,maxWidth:"26%",flexBasis:"22%"},dest:{order:4,maxWidth:"26%",flexBasis:"22%"},arrow:{order:5,maxWidth:"6%",flexBasis:"6%"}};return R.jsxs("a",{className:`${m.drive} DriveEntry`,ref:t,href:`/${_.dongle_id}/${_.start_time_utc_millis}/${_.end_time_utc_millis}`,onClick:b,children:[R.jsx("div",{className:m.driveHeader,style:E?{padding:18}:{padding:"18px 32px"},children:R.jsxs(zf,{container:!0,children:[R.jsxs("div",{className:m.driveGridItem,style:re.date,children:[R.jsx(dt,{className:m.firstLine,children:M}),R.jsx(dt,{children:`${T} to ${I}`})]}),R.jsxs("div",{className:`${m.driveGridItem} ${E&&m.driveGridItemRightAlign}`,style:re.dur,children:[R.jsx(dt,{className:m.firstLine,children:N}),R.jsx(dt,{children:D})]}),R.jsxs("div",{className:m.driveGridItem,style:re.origin,children:[R.jsx(dt,{className:m.firstLine,children:(W=_.startLocation)==null?void 0:W.place}),R.jsx(dt,{children:(ee=_.startLocation)==null?void 0:ee.details})]}),R.jsxs("div",{className:`${m.driveGridItem} ${E&&m.driveGridItemRightAlign}`,style:re.dest,children:[R.jsx(dt,{className:m.firstLine,children:(J=_.endLocation)==null?void 0:J.place}),R.jsx(dt,{children:(Y=_.endLocation)==null?void 0:Y.details})]}),!E&&R.jsx("div",{className:m.driveGridItem,style:re.arrow,children:R.jsx(xC,{className:m.driveArrow})})]})}),R.jsx(_E,{route:_,thumbnailsVisible:i,zoomOverride:{start:_.start_time_utc_millis,end:_.end_time_utc_millis}})]},_.fullname)},oz=Kn(()=>({}))(ci.withStyles(iz)(az)),sz=()=>({drivesTable:{display:"flex",flexDirection:"column",flexGrow:1},drives:{padding:16,flex:"1"}}),lz=n=>{const{dispatch:t,classes:i,device:u,routes:p}=n;let m;return!p||p.length===0?m=R.jsx(zO,{device:u,routes:p}):m=R.jsx("div",{className:`${i.drives} DriveList`,children:p.map(o=>R.jsx(oz,{drive:o},o.fullname))}),R.jsxs("div",{className:i.drivesTable,children:[R.jsx(Th,{onVisible:()=>t(tS()),minInterval:60}),m]})},uz=pi({routes:"routes",device:"device"}),cz=Kn(uz)(ci.withStyles(sz)(lz));function pz(n){return n&&n.__esModule?n:{default:n}}var Pa=pz,th={},hf={},df={},ff={},P1;function hz(){return P1||(P1=1,ff.__esModule=!0,ff.default=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}),ff}var mf={},vf={},Wv={},T1;function Fy(){return T1||(T1=1,Wv.f=rS),Wv}var Hv,C1;function dz(){return C1||(C1=1,Hv=Fy().f("iterator")),Hv}var Zv,I1;function fz(){return I1||(I1=1,Zv={default:dz(),__esModule:!0}),Zv}var M1={},Gv={exports:{}},O1;function mz(){if(O1)return Gv.exports;O1=1;var n=nS("meta"),t=ty,i=ry,u=ey.f,p=0,m=Object.isExtensible||function(){return!0},o=!iS(function(){return m(Object.preventExtensions({}))}),_=function(I){u(I,n,{value:{i:"O"+ ++p,w:{}}})},b=function(I,N){if(!t(I))return typeof I=="symbol"?I:(typeof I=="string"?"S":"P")+I;if(!i(I,n)){if(!m(I))return"F";if(!N)return"E";_(I)}return I[n].i},E=function(I,N){if(!i(I,n)){if(!m(I))return!0;if(!N)return!1;_(I)}return I[n].w},T=function(I){return o&&M.NEED&&m(I)&&!i(I,n)&&_(I),I},M=Gv.exports={KEY:n,NEED:!1,fastKey:b,getWeak:E,onFreeze:T};return Gv.exports}var Xv,R1;function Uy(){if(R1)return Xv;R1=1;var n=rm,t=Fy(),i=ey.f;return Xv=function(u){var p=n.Symbol||(n.Symbol={});u.charAt(0)!="_"&&!(u in p)&&i(p,u,{value:t.f(u)})},Xv}var Kv={},A1;function bE(){return A1||(A1=1,Kv.f=Object.getOwnPropertySymbols),Kv}var Yv={},k1;function Vy(){return k1||(k1=1,Yv.f={}.propertyIsEnumerable),Yv}var Jv,D1;function vz(){if(D1)return Jv;D1=1;var n=aS,t=bE(),i=Vy();return Jv=function(u){var p=n(u),m=t.f;if(m)for(var o=m(u),_=i.f,b=0,E;o.length>b;)_.call(u,E=o[b++])&&p.push(E);return p},Jv}var Qv,L1;function gz(){if(L1)return Qv;L1=1;var n=wC;return Qv=Array.isArray||function(i){return n(i)=="Array"},Qv}var eg={},tg={},z1;function xE(){if(z1)return tg;z1=1;var n=EC,t=SC.concat("length","prototype");return tg.f=Object.getOwnPropertyNames||function(u){return n(u,t)},tg}var j1;function yz(){if(j1)return eg;j1=1;var n=ny,t=xE().f,i={}.toString,u=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],p=function(m){try{return t(m)}catch{return u.slice()}};return eg.f=function(o){return u&&i.call(o)=="[object Window]"?p(o):t(n(o))},eg}var rg={},N1;function wE(){if(N1)return rg;N1=1;var n=Vy(),t=sS,i=ny,u=lS,p=ry,m=PC,o=Object.getOwnPropertyDescriptor;return rg.f=oS?o:function(b,E){if(b=i(b),E=u(E,!0),m)try{return o(b,E)}catch{}if(p(b,E))return t(!n.f.call(b,E),b[E])},rg}var B1;function _z(){if(B1)return M1;B1=1;var n=IC,t=ry,i=oS,u=iy,p=MC,m=mz().KEY,o=iS,_=OC,b=RC,E=nS,T=rS,M=Fy(),I=Uy(),N=vz(),D=gz(),re=cS,W=ty,ee=AC,J=ny,Y=lS,B=sS,V=uS,K=yz(),ve=wE(),de=bE(),ie=ey,we=aS,ze=ve.f,De=ie.f,ce=K.f,Pe=n.Symbol,gt=n.JSON,jt=gt&&gt.stringify,Tt="prototype",kt=T("_hidden"),Ir=T("toPrimitive"),pr={}.propertyIsEnumerable,Zt=_("symbol-registry"),Kt=_("symbols"),Yt=_("op-symbols"),Dt=Object[Tt],Gt=typeof Pe=="function"&&!!de.f,yr=n.QObject,Et=!yr||!yr[Tt]||!yr[Tt].findChild,er=i&&o(function(){return V(De({},"a",{get:function(){return De(this,"a",{value:7}).a}})).a!=7})?function(Wt,lt,Mt){var nr=ze(Dt,lt);nr&&delete Dt[lt],De(Wt,lt,Mt),nr&&Wt!==Dt&&De(Dt,lt,nr)}:De,mt=function(Wt){var lt=Kt[Wt]=V(Pe[Tt]);return lt._k=Wt,lt},$t=Gt&&typeof Pe.iterator=="symbol"?function(Wt){return typeof Wt=="symbol"}:function(Wt){return Wt instanceof Pe},Nr=function(lt,Mt,nr){return lt===Dt&&Nr(Yt,Mt,nr),re(lt),Mt=Y(Mt,!0),re(nr),t(Kt,Mt)?(nr.enumerable?(t(lt,kt)&&lt[kt][Mt]&&(lt[kt][Mt]=!1),nr=V(nr,{enumerable:B(0,!1)})):(t(lt,kt)||De(lt,kt,B(1,{})),lt[kt][Mt]=!0),er(lt,Mt,nr)):De(lt,Mt,nr)},Br=function(lt,Mt){re(lt);for(var nr=N(Mt=J(Mt)),xn=0,Cn=nr.length,ri;Cn>xn;)Nr(lt,ri=nr[xn++],Mt[ri]);return lt},It=function(lt,Mt){return Mt===void 0?V(lt):Br(V(lt),Mt)},$r=function(lt){var Mt=pr.call(this,lt=Y(lt,!0));return this===Dt&&t(Kt,lt)&&!t(Yt,lt)?!1:Mt||!t(this,lt)||!t(Kt,lt)||t(this,kt)&&this[kt][lt]?Mt:!0},hr=function(lt,Mt){if(lt=J(lt),Mt=Y(Mt,!0),!(lt===Dt&&t(Kt,Mt)&&!t(Yt,Mt))){var nr=ze(lt,Mt);return nr&&t(Kt,Mt)&&!(t(lt,kt)&&lt[kt][Mt])&&(nr.enumerable=!0),nr}},dr=function(lt){for(var Mt=ce(J(lt)),nr=[],xn=0,Cn;Mt.length>xn;)!t(Kt,Cn=Mt[xn++])&&Cn!=kt&&Cn!=m&&nr.push(Cn);return nr},Un=function(lt){for(var Mt=lt===Dt,nr=ce(Mt?Yt:J(lt)),xn=[],Cn=0,ri;nr.length>Cn;)t(Kt,ri=nr[Cn++])&&(!Mt||t(Dt,ri))&&xn.push(Kt[ri]);return xn};Gt||(Pe=function(){if(this instanceof Pe)throw TypeError("Symbol is not a constructor!");var lt=E(arguments.length>0?arguments[0]:void 0),Mt=function(nr){this===Dt&&Mt.call(Yt,nr),t(this,kt)&&t(this[kt],lt)&&(this[kt][lt]=!1),er(this,lt,B(1,nr))};return i&&Et&&er(Dt,lt,{configurable:!0,set:Mt}),mt(lt)},p(Pe[Tt],"toString",function(){return this._k}),ve.f=hr,ie.f=Nr,xE().f=K.f=dr,Vy().f=$r,de.f=Un,i&&!TC&&p(Dt,"propertyIsEnumerable",$r),M.f=function(Wt){return mt(T(Wt))}),u(u.G+u.W+u.F*!Gt,{Symbol:Pe});for(var Tn="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Pi=0;Tn.length>Pi;)T(Tn[Pi++]);for(var bn=we(T.store),en=0;bn.length>en;)I(bn[en++]);u(u.S+u.F*!Gt,"Symbol",{for:function(Wt){return t(Zt,Wt+="")?Zt[Wt]:Zt[Wt]=Pe(Wt)},keyFor:function(lt){if(!$t(lt))throw TypeError(lt+" is not a symbol!");for(var Mt in Zt)if(Zt[Mt]===lt)return Mt},useSetter:function(){Et=!0},useSimple:function(){Et=!1}}),u(u.S+u.F*!Gt,"Object",{create:It,defineProperty:Nr,defineProperties:Br,getOwnPropertyDescriptor:hr,getOwnPropertyNames:dr,getOwnPropertySymbols:Un});var ea=o(function(){de.f(1)});return u(u.S+u.F*ea,"Object",{getOwnPropertySymbols:function(lt){return de.f(ee(lt))}}),gt&&u(u.S+u.F*(!Gt||o(function(){var Wt=Pe();return jt([Wt])!="[null]"||jt({a:Wt})!="{}"||jt(Object(Wt))!="{}"})),"JSON",{stringify:function(lt){for(var Mt=[lt],nr=1,xn,Cn;arguments.length>nr;)Mt.push(arguments[nr++]);if(Cn=xn=Mt[1],!(!W(xn)&&lt===void 0||$t(lt)))return D(xn)||(xn=function(ri,Ui){if(typeof Cn=="function"&&(Ui=Cn.call(this,ri,Ui)),!$t(Ui))return Ui}),Mt[1]=xn,jt.apply(gt,Mt)}}),Pe[Tt][Ir]||CC(Pe[Tt],Ir,Pe[Tt].valueOf),b(Pe,"Symbol"),b(Math,"Math",!0),b(n.JSON,"JSON",!0),M1}var F1={},U1;function bz(){return U1||(U1=1,Uy()("asyncIterator")),F1}var V1={},q1;function xz(){return q1||(q1=1,Uy()("observable")),V1}var ng,$1;function wz(){return $1||($1=1,_z(),bz(),xz(),ng=rm.Symbol),ng}var ig,W1;function Sz(){return W1||(W1=1,ig={default:wz(),__esModule:!0}),ig}var H1;function SE(){if(H1)return vf;H1=1,vf.__esModule=!0;var n=fz(),t=m(n),i=Sz(),u=m(i),p=typeof u.default=="function"&&typeof t.default=="symbol"?function(o){return typeof o}:function(o){return o&&typeof u.default=="function"&&o.constructor===u.default&&o!==u.default.prototype?"symbol":typeof o};function m(o){return o&&o.__esModule?o:{default:o}}return vf.default=typeof u.default=="function"&&p(t.default)==="symbol"?function(o){return typeof o>"u"?"undefined":p(o)}:function(o){return o&&typeof u.default=="function"&&o.constructor===u.default&&o!==u.default.prototype?"symbol":typeof o>"u"?"undefined":p(o)},vf}var Z1;function Ez(){if(Z1)return mf;Z1=1,mf.__esModule=!0;var n=SE(),t=i(n);function i(u){return u&&u.__esModule?u:{default:u}}return mf.default=function(u,p){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&((typeof p>"u"?"undefined":(0,t.default)(p))==="object"||typeof p=="function")?p:u},mf}var gf={},G1={},ag,X1;function Pz(){if(X1)return ag;X1=1;var n=ty,t=cS,i=function(u,p){if(t(u),!n(p)&&p!==null)throw TypeError(p+": can't set as prototype!")};return ag={set:Object.setPrototypeOf||("__proto__"in{}?function(u,p,m){try{m=kC(Function.call,wE().f(Object.prototype,"__proto__").set,2),m(u,[]),p=!(u instanceof Array)}catch{p=!0}return function(_,b){return i(_,b),p?_.__proto__=b:m(_,b),_}}({},!1):void 0),check:i},ag}var K1;function Tz(){if(K1)return G1;K1=1;var n=iy;return n(n.S,"Object",{setPrototypeOf:Pz().set}),G1}var og,Y1;function Cz(){return Y1||(Y1=1,Tz(),og=rm.Object.setPrototypeOf),og}var sg,J1;function Iz(){return J1||(J1=1,sg={default:Cz(),__esModule:!0}),sg}var Q1={},ew;function Mz(){if(ew)return Q1;ew=1;var n=iy;return n(n.S,"Object",{create:uS}),Q1}var lg,tw;function Oz(){if(tw)return lg;tw=1,Mz();var n=rm.Object;return lg=function(i,u){return n.create(i,u)},lg}var ug,rw;function Rz(){return rw||(rw=1,ug={default:Oz(),__esModule:!0}),ug}var nw;function Az(){if(nw)return gf;nw=1,gf.__esModule=!0;var n=Iz(),t=o(n),i=Rz(),u=o(i),p=SE(),m=o(p);function o(_){return _&&_.__esModule?_:{default:_}}return gf.default=function(_,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof b>"u"?"undefined":(0,m.default)(b)));_.prototype=(0,u.default)(b&&b.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),b&&(t.default?(0,t.default)(_,b):_.__proto__=b)},gf}var yf={},_f={},iw;function kz(){if(iw)return _f;iw=1,Object.defineProperty(_f,"__esModule",{value:!0});var n=function(i,u){return function(p){return p[i]=u,p}};return _f.default=n,_f}var aw;function EE(){if(aw)return yf;aw=1,Object.defineProperty(yf,"__esModule",{value:!0});var n=kz(),t=i(n);function i(p){return p&&p.__esModule?p:{default:p}}var u=function(m){return(0,t.default)("displayName",m)};return yf.default=u,yf}var bf={},xf={},ow;function Dz(){if(ow)return xf;ow=1,Object.defineProperty(xf,"__esModule",{value:!0});var n=function(i){if(typeof i=="string")return i;if(i)return i.displayName||i.name||"Component"};return xf.default=n,xf}var sw;function PE(){if(sw)return bf;sw=1,Object.defineProperty(bf,"__esModule",{value:!0});var n=Dz(),t=i(n);function i(p){return p&&p.__esModule?p:{default:p}}var u=function(m,o){return o+"("+(0,t.default)(m)+")"};return bf.default=u,bf}var lw;function Lz(){if(lw)return df;lw=1,Object.defineProperty(df,"__esModule",{value:!0});var n=hz(),t=E(n),i=Ez(),u=E(i),p=Az(),m=E(p),o=me,_=EE();E(_);var b=PE();E(b);function E(M){return M&&M.__esModule?M:{default:M}}var T=function(I){return function(N){var D=(0,o.createFactory)(N),re=function(W){(0,m.default)(ee,W);function ee(){return(0,t.default)(this,ee),(0,u.default)(this,W.apply(this,arguments))}return ee.prototype.shouldComponentUpdate=function(Y){return I(this.props,Y)},ee.prototype.render=function(){return D(this.props)},ee}(o.Component);return re}};return df.default=T,df}var wf={},uw;function zz(){if(uw)return wf;uw=1,Object.defineProperty(wf,"__esModule",{value:!0});var n=OS(),t=i(n);function i(u){return u&&u.__esModule?u:{default:u}}return wf.default=t.default,wf}var cw;function jz(){if(cw)return hf;cw=1,Object.defineProperty(hf,"__esModule",{value:!0});var n=Lz(),t=o(n),i=zz(),u=o(i),p=EE();o(p);var m=PE();o(m);function o(b){return b&&b.__esModule?b:{default:b}}var _=function(E){var T=(0,t.default)(function(M,I){return!(0,u.default)(M,I)});return T(E)};return hf.default=_,hf}var pw;function La(){if(pw)return th;pw=1;var n=Pa;Object.defineProperty(th,"__esModule",{value:!0}),th.default=void 0;var t=n(me),i=n(jz()),u=n(Yw);function p(o,_){var b=function(T){return t.default.createElement(u.default,T,o)};return b.displayName=_,b=(0,i.default)(b),b.muiName="SvgIcon",b}var m=p;return th.default=m,th}var qy={},TE=Pa;Object.defineProperty(qy,"__esModule",{value:!0});var CE=qy.default=void 0,hw=TE(me),Nz=TE(La()),Bz=(0,Nz.default)(hw.default.createElement("g",null,hw.default.createElement("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"})),"AddCircleOutline");CE=qy.default=Bz;var $y={},IE=Pa;Object.defineProperty($y,"__esModule",{value:!0});var Fg=$y.default=void 0,dw=IE(me),Fz=IE(La()),Uz=(0,Fz.default)(dw.default.createElement("g",null,dw.default.createElement("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})),"Check");Fg=$y.default=Uz;var Wy={},ME=Pa;Object.defineProperty(Wy,"__esModule",{value:!0});var hh=Wy.default=void 0,fw=ME(me),Vz=ME(La()),qz=(0,Vz.default)(fw.default.createElement("g",null,fw.default.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),"Clear");hh=Wy.default=qz;var Hy={},OE=Pa;Object.defineProperty(Hy,"__esModule",{value:!0});var RE=Hy.default=void 0,mw=OE(me),$z=OE(La()),Wz=(0,$z.default)(mw.default.createElement("g",null,mw.default.createElement("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})),"ContentCopy");RE=Hy.default=Wz;var Zy={},AE=Pa;Object.defineProperty(Zy,"__esModule",{value:!0});var kE=Zy.default=void 0,vw=AE(me),Hz=AE(La()),Zz=(0,Hz.default)(vw.default.createElement("g",null,vw.default.createElement("path",{d:"M14.59 8L12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41 14.59 8zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"})),"HighlightOff");kE=Zy.default=Zz;var Gy={},DE=Pa;Object.defineProperty(Gy,"__esModule",{value:!0});var LE=Gy.default=void 0,gw=DE(me),Gz=DE(La()),Xz=(0,Gz.default)(gw.default.createElement("g",null,gw.default.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})),"Refresh");LE=Gy.default=Xz;var Xy={},zE=Pa;Object.defineProperty(Xy,"__esModule",{value:!0});var jE=Xy.default=void 0,yw=zE(me),Kz=zE(La()),Yz=(0,Kz.default)(yw.default.createElement("g",null,yw.default.createElement("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"})),"Replay");jE=Xy.default=Yz;var Ky={},NE=Pa;Object.defineProperty(Ky,"__esModule",{value:!0});var BE=Ky.default=void 0,_w=NE(me),Jz=NE(La()),Qz=(0,Jz.default)(_w.default.createElement("g",null,_w.default.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"})),"Save");BE=Ky.default=Qz;var Yy={},FE=Pa;Object.defineProperty(Yy,"__esModule",{value:!0});var UE=Yy.default=void 0,bw=FE(me),ej=FE(La()),tj=(0,ej.default)(bw.default.createElement("g",null,bw.default.createElement("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})),"Search");UE=Yy.default=tj;var Jy={},VE=Pa;Object.defineProperty(Jy,"__esModule",{value:!0});var qE=Jy.default=void 0,xw=VE(me),rj=VE(La()),nj=(0,rj.default)(xw.default.createElement("g",null,xw.default.createElement("path",{d:"M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"})),"Settings");qE=Jy.default=nj;var Qy={},$E=Pa;Object.defineProperty(Qy,"__esModule",{value:!0});var e_=Qy.default=void 0,ww=$E(me),ij=$E(La()),aj=(0,ij.default)(ww.default.createElement("g",null,ww.default.createElement("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"})),"Share");e_=Qy.default=aj;var t_={},WE=Pa;Object.defineProperty(t_,"__esModule",{value:!0});var wh=t_.default=void 0,Sw=WE(me),oj=WE(La()),sj=(0,oj.default)(Sw.default.createElement("g",null,Sw.default.createElement("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})),"Warning");wh=t_.default=sj;const Bc=n=>{const{onResize:t}=n;let i;const u=()=>{i&&window.clearTimeout(i),i=window.setTimeout(()=>{t(window.innerWidth,window.innerHeight),i=null},150)};return me.useEffect(()=>(window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u),i&&window.clearTimeout(i)}),[t]),null};Bc.propTypes={onResize:kn.func.isRequired};function HE(n,t){return t?`${(n/1e3).toFixed(1)} km`:`${(n/1609.34).toFixed(1)} mi`}function lj(n){let t=!0;try{n.legs[0].admins.forEach(i=>{["US","GB"].includes(i.iso_3166_1)&&(t=!1)})}catch{t=!1}return HE(n.distance,t)}function uj(n){let t=Math.round(n/60),i="";if(t>=60){const u=Math.floor(t/60);t-=u*60,i+=`${u} hr `}return`${i}${t} min`}function cj(n){return uj(n.duration_typical)}function yc(n){return n.resultType==="place"||n.resultType==="car"?n.title:n.title.split(",",1)[0]}function kf(n,t="all"){const{address:i,resultType:u}=n;let p;if(!i.city||["street","streets"].every(m=>!i[m]))p=i.label;else{if(u||console.warn("formatSearchAddress: missing resultType",n),p="",t==="all"||["car","place"].includes(u)){const{houseNumber:o,street:_,streets:b}=i;o&&(p+=`${o} `),b?p+=b.join(" & "):p+=_,p+=", "}const{city:m}=i;if(p+=`${m}`,["state","all"].includes(t)){const{stateCode:o,postalCode:_,countryName:b}=i;(o||_)&&(p+=",",o&&(p+=` ${o}`),p+=` ${_}`),t==="all"&&b&&(p+=`, ${b}`)}}if(t!=="all"){const m=yc(n);p.startsWith(m)&&(p=p.substring(m.length+2))}return p}function pj(n){return`, ${kf(n,"none")} (${HE(n.distance)})`}const hj=()=>({noWrap:{whiteSpace:"nowrap"},mapContainer:{borderBottom:`1px solid ${Ue.white10}`},mapError:{position:"relative",marginTop:20,marginLeft:20,"& p":{color:Ue.white50}},geolocateControl:{display:"none"},overlay:{color:Ue.white,borderRadius:22,padding:"12px 16px",border:`1px solid ${Ue.white10}`,backgroundColor:Ue.grey800,maxHeight:"calc(60vh - 100px)",display:"flex",flexDirection:"column",outline:"none !important"},overlayTextfield:{borderRadius:0,"& input":{padding:0,height:24}},overlaySearchButton:{color:Ue.white30},overlayClearButton:{color:Ue.white30,cursor:"pointer"},overlaySearchResults:{marginTop:3,paddingRight:3,flexGrow:1,overflowY:"auto","&::-webkit-scrollbar-thumb":{backgroundColor:Ue.white20}},overlaySearchResultsHr:{marginTop:2,borderTop:`1px solid ${Ue.white20}`},overlaySearchItem:{cursor:"pointer",marginTop:15,"&:first-child":{marginTop:10}},overlaySearchNoResults:{marginTop:10,fontSize:14},overlaySearchNoLocation:{marginTop:10,fontSize:14,color:Ue.orange100},overlaySearchDetails:{color:Ue.white40},searchSelectBox:{borderRadius:22,padding:"12px 16px",border:`1px solid ${Ue.white10}`,backgroundColor:Ue.grey800,color:Ue.white,display:"flex",flexDirection:"column"},searchSelectBoxHeader:{display:"flex",width:"100%",justifyContent:"space-between",alignItems:"flex-start",marginBottom:10},searchSelectBoxTitle:{flexBasis:"auto"},searchSelectBoxButtons:{display:"flex",flexWrap:"wrap-reverse",justifyContent:"flex-end",alignItems:"flex-end"},bold:{fontWeight:600},primeAdTitle:{lineHeight:"31px",fontSize:20,fontWeight:600},searchSelectButton:{marginLeft:8,padding:"6px 12px",backgroundColor:Ue.white,borderRadius:15,color:Ue.grey900,textTransform:"none",minHeight:"unset",flexGrow:1,maxWidth:125,"&:hover":{background:"#ddd",color:Ue.grey900},"&:disabled":{background:"#ddd",color:Ue.grey900}},searchSelectButtonFake:{background:"#ddd",minWidth:81.4,textAlign:"center",display:"inline-flex",justifyContent:"center",alignItems:"center",marginBottom:10,"& p":{color:Ue.grey900,lineHeight:"1.4em",fontWeight:500}},searchSelectButtonSecondary:{marginLeft:8,padding:"4.5px 12px",borderRadius:15,textTransform:"none",minHeight:"unset",flexGrow:1,maxWidth:125,border:`1.5px solid ${Ue.white50}`,"&:disabled":{border:`1.5px solid ${Ue.white20}`}},searchSelectBoxDetails:{color:Ue.white40},primeAdContainer:{backgroundColor:Ue.grey500,border:`1px solid ${Ue.grey700}`},primeAdButton:{padding:"6px 24px",color:Ue.white,backgroundColor:Ue.primeBlue50,"&:hover":{color:Ue.white,backgroundColor:Ue.primeBlue200}},pin:{width:20,height:32},pinClick:{width:22.5,height:32,cursor:"pointer"},favoritePin:{width:15,height:24,cursor:"pointer"},carPinTooltip:{textAlign:"center",borderRadius:14,fontSize:"0.8em",padding:"6px 8px",border:`1px solid ${Ue.white10}`,backgroundColor:Ue.grey800,color:Ue.white},saveAsMenuItem:{justifyContent:"center"},savedNextPopover:{borderRadius:22,padding:"8px 16px",border:`1px solid ${Ue.white10}`,backgroundColor:Ue.grey800,marginTop:5,textAlign:"center",zIndex:5,"& p:first-child":{fontWeight:500}},researchArea:{width:"100%",justifyContent:"center",alignItems:"center",borderRadius:18,padding:"6px 16px",border:`1px solid ${Ue.white10}`,backgroundColor:Ue.grey800,color:Ue.white,"&:hover":{backgroundColor:Ue.grey900},"& svg":{marginRight:6}},clearSearchSelect:{padding:5,fontSize:20,cursor:"pointer",position:"absolute",left:-6,top:-8,height:24,width:24,borderRadius:12,backgroundColor:Ue.grey900,color:Ue.white,border:`1px solid ${Ue.grey600}`,"&:hover":{backgroundColor:Ue.grey700}}}),Ew={hasFocus:!1,carLastLocation:null,carLastLocationTime:null,carNetworkLocation:null,carNetworkLocationAccuracy:null,favoriteLocations:[],geoLocateCoords:null,search:null,searchSelect:null,searchLooking:!1,noFly:!1,windowWidth:window.innerWidth,saveAsMenu:null,savingAs:!1,savedAs:!1,showPrimeAd:!0};class dj extends me.Component{constructor(t){super(t),this.mounted=null,this.state={...Ew,viewport:{...pE,zoom:5},mapError:null,windowWidth:window.innerWidth},this.mapContainerRef=Xi.createRef(),this.searchInputRef=Xi.createRef(),this.searchSelectBoxRef=Xi.createRef(),this.primeAdBoxRef=Xi.createRef(),this.overlayRef=Xi.createRef(),this.carPinTooltipRef=Xi.createRef(),this.navigateFakeButtonRef=Xi.createRef(),this.checkWebGLSupport=this.checkWebGLSupport.bind(this),this.flyToMarkers=this.flyToMarkers.bind(this),this.renderSearchSelectMarker=this.renderSearchSelectMarker.bind(this),this.renderOverlay=this.renderOverlay.bind(this),this.renderSearchOverlay=this.renderSearchOverlay.bind(this),this.renderPrimeAd=this.renderPrimeAd.bind(this),this.renderResearchArea=this.renderResearchArea.bind(this),this.onGeolocate=this.onGeolocate.bind(this),this.onSearch=yy(this.onSearch.bind(this),200),this.onFocus=this.onFocus.bind(this),this.onSearchSelect=this.onSearchSelect.bind(this),this.onCarSelect=this.onCarSelect.bind(this),this.researchArea=this.researchArea.bind(this),this.onFavoriteSelect=this.onFavoriteSelect.bind(this),this.onSearchBlur=this.onSearchBlur.bind(this),this.focus=this.focus.bind(this),this.updateDevice=this.updateDevice.bind(this),this.updateFavoriteLocations=this.updateFavoriteLocations.bind(this),this.getFavoriteLabelIcon=this.getFavoriteLabelIcon.bind(this),this.navigate=this.navigate.bind(this),this.onResize=this.onResize.bind(this),this.toggleCarPinTooltip=this.toggleCarPinTooltip.bind(this),this.clearSearch=this.clearSearch.bind(this),this.itemLoc=this.itemLoc.bind(this),this.itemLngLat=this.itemLngLat.bind(this),this.saveSearchAs=this.saveSearchAs.bind(this),this.deleteFavorite=this.deleteFavorite.bind(this),this.viewportChange=this.viewportChange.bind(this),this.getDeviceLastLocation=this.getDeviceLastLocation.bind(this),this.getDeviceNetworkLocation=this.getDeviceNetworkLocation.bind(this),this.getCarLocation=this.getCarLocation.bind(this),this.carLocationCircle=this.carLocationCircle.bind(this),this.clearSearchSelect=this.clearSearchSelect.bind(this),this.onContainerRef=this.onContainerRef.bind(this)}componentDidMount(){this.mounted=!0,this.checkWebGLSupport(),this.componentDidUpdate({},{})}componentDidUpdate(t,i){var M;const{dongleId:u,device:p}=this.props,{geoLocateCoords:m,search:o,carLastLocation:_,carNetworkLocation:b,searchSelect:E,favoriteLocations:T}=this.state;(_&&!i.carLastLocation||b&&!i.carNetworkLocation||m&&!i.geoLocateCoords||E&&i.searchSelect!==E||o&&i.search!==o)&&this.flyToMarkers(),t.dongleId!==u&&(this.setState({...Ew,windowWidth:window.innerWidth}),this.searchInputRef.current&&(this.searchInputRef.current.value="")),t.device!==p&&this.updateDevice(),!i.hasFocus&&this.state.hasFocus&&this.props.dispatch(xa("nav_focus",{has_car_location:!!(_||b),has_favorites:((M=Object.keys(T))==null?void 0:M.length)||0})),o&&i.search!==o&&this.props.dispatch(xa("nav_search",{panned:this.state.noFly||this.state.searchLooking}))}componentWillUnmount(){this.mounted=!1}checkWebGLSupport(){const t=document.createElement("canvas"),i=t.getContext("webgl")||t.getContext("experimental-webgl");(!i||!(i instanceof WebGLRenderingContext))&&this.setState({mapError:"Failed to get WebGL context, your browser or device may not support WebGL."})}updateDevice(){Nf()||(this.getDeviceLastLocation(),this.getDeviceNetworkLocation(),this.updateFavoriteLocations())}async getDeviceLastLocation(){const{dongleId:t,device:i}=this.props;if(!i.shared)try{const u=await DC(t);this.mounted&&t===this.props.dongleId&&this.setState({carLastLocation:[u.lng,u.lat],carLastLocationTime:u.time},this.flyToMarkers)}catch(u){(!u.message||u.message.indexOf("no_segments_uploaded")===-1)&&(console.error(u),Qr(u,{fingerprint:"nav_fetch_location"}))}}async getDeviceNetworkLocation(){const{dongleId:t,hasNav:i}=this.props;if(!i)return;const u={method:"getNetworks",jsonrpc:"2.0",id:0};try{let p=await uh(t,u);if(!p.result||Object.keys(p.result).length===0||!this.mounted||t!==this.props.dongleId)return;p=await BL(p.result),p&&this.mounted&&t===this.props.dongleId&&this.setState({carNetworkLocation:[p.lng,p.lat],carNetworkLocationAccuracy:p.accuracy},this.flyToMarkers)}catch(p){this.mounted&&t===this.props.dongleId&&(!p.message||p.message.indexOf('{"error": "Device not registered"}')===-1)&&(console.error(p),Qr(p,{fingerprint:"nav_fetch_network_location"}))}}getCarLocation(){const{carLastLocation:t,carLastLocationTime:i,carNetworkLocation:u,carNetworkLocationAccuracy:p}=this.state;return u&&p<=1e4&&(p<=100||!t)?{location:u,accuracy:p,time:Date.now()}:t?{location:t,accuracy:0,time:i}:null}updateFavoriteLocations(){const{dongleId:t,hasNav:i}=this.props;!i||Nf()||vO(t).then(u=>{if(this.mounted&&t===this.props.dongleId){const p={};u.forEach(m=>{m.save_type==="favorite"&&(p[m.id]={...m,icon:this.getFavoriteLabelIcon(m.label)})}),this.setState({favoriteLocations:p})}}).catch(u=>{console.error(u),Qr(u,{fingerprint:"nav_fetch_locationsdata"})})}getFavoriteLabelIcon(t){switch(t){case"home":return jC;case"work":return zC;default:return LC}}onGeolocate(t){t&&t.coords&&this.setState({geoLocateCoords:[t.coords.longitude,t.coords.latitude]})}onSearch(){const t=this.searchInputRef.current;if(this.focus(),t&&t.value.length>=3){const i=this.state.viewport,u=this.getCarLocation(),p=(u?u.location:null)||this.state.geoLocateCoords||[i.longitude,i.latitude];_1(t.value,p).then(m=>{this.setState({noFly:!1,searchSelect:null,search:m.filter(o=>!["categoryQuery","chainQuery","administrativeArea"].includes(o.resultType)).slice(0,10),searchLooking:!1,savingAs:!1,savedAs:!1})}).catch(m=>{console.error(m),Qr(m,{fingerprint:"nav_geocode_forward_lookup"})})}else this.setState({noFly:!1,searchSelect:null,search:null,searchLooking:!1,savingAs:!1,savedAs:!1})}onFocus(){const t=this.searchInputRef.current;this.focus(),t&&t.value.length>=3?this.setState({noFly:!1,searchSelect:null,searchLooking:!1,savingAs:!1,savedAs:!1},this.flyToMarkers):this.setState({noFly:!1,searchSelect:null,search:null,searchLooking:!1,savingAs:!1,savedAs:!1})}onSearchSelect(t,i){this.props.dispatch(xa("nav_search_select",{source:i,panned:this.state.noFly||this.state.noFly,is_favorite:!!t.favoriteId,distance:t.distance})),this.setState({noFly:!1,searchSelect:t,searchLooking:!1,savingAs:!1,savedAs:!1});const u=this.itemLngLat(t),p=this.getCarLocation(),m=(p?p.location:null)||this.state.geoLocateCoords||null;m&&(m[0]!==u[0]||m[1]!==u[1])&&FL([m,u]).then(o=>{this.setState({searchSelect:{...t,route:o[0]},searchLooking:!1})})}onCarSelect(t){this.focus();const[i,u]=t.location,p={address:{label:""},favoriteIcon:D0,favoriteId:null,position:{lng:i,lat:u},resultType:"car",title:""};this.onSearchSelect(p,"car"),fE(t.location,!0).then(m=>{m&&this.setState(o=>({searchSelect:{...o.searchSelect,address:{label:m.details},title:m.place}}))})}onFavoriteSelect(t,i){this.focus();const u={favoriteId:t,favoriteIcon:i.icon,title:i.place_name,address:{label:`${i.place_name}, ${i.place_details}`},resultType:"place",position:{lat:i.latitude,lng:i.longitude}};this.onSearchSelect(u,"pin")}onSearchBlur(t){this.state.search&&this.searchInputRef.current&&this.overlayRef.current&&this.overlayRef.current!==t.relatedTarget&&this.setState({searchLooking:!0})}clearSearch(){this.searchInputRef.current&&(this.searchInputRef.current.value="",this.searchInputRef.current.focus()),this.setState({noFly:!1,search:null,searchSelect:null,searchLooking:!1,savingAs:!1,savedAs:!1})}clearSearchSelect(){this.setState({noFly:!1,searchSelect:null,searchLooking:!1,savingAs:!1,savedAs:!1}),this.onSearch()}flyToMarkers(){const{hasNav:t}=this.props,{noFly:i,geoLocateCoords:u,search:p,searchSelect:m,windowWidth:o,viewport:_}=this.state,b=this.getCarLocation();if(i)return;const E=[];if(u&&E.push([u,u]),b&&E.push([b.location,b.location]),m?E.push(this.itemLngLat(m,!0)):p&&p.forEach(T=>E.push(this.itemLngLat(T,!0))),E.length){const T=[[Math.min.apply(null,E.map(W=>W[0][0])),Math.min.apply(null,E.map(W=>W[0][1]))],[Math.max.apply(null,E.map(W=>W[1][0])),Math.max.apply(null,E.map(W=>W[1][1]))]];Math.abs(T[0][0]-T[1][0])<.01&&(T[0][0]-=.01,T[0][1]+=.01),Math.abs(T[1][0]-T[1][1])<.01&&(T[1][0]-=.01,T[1][1]+=.01);const M=this.searchSelectBoxRef.current&&_.height>200?this.searchSelectBoxRef.current.getBoundingClientRect().height+10:0;let I=0,N=t?62:0;const D=this.primeAdBoxRef.current;D&&(o<600?N=Math.max(N,D.getBoundingClientRect().height+10):I=D.getBoundingClientRect().width+10);const re={left:o<600||!p?20:390,right:I+20,top:N+20,bottom:M+20};if(_.width)try{const W=new Ea(_).fitBounds(T,{padding:re,maxZoom:10});this.setState({viewport:W})}catch(W){console.error(W),Qr(W,{fingerprint:"nav_flymarkers_viewport"})}}}focus(t){!this.state.hasFocus&&(!t||!t.srcEvent||!t.srcEvent.path||!this.mapContainerRef.current||t.srcEvent.path.includes(this.mapContainerRef.current))&&this.setState({hasFocus:!0})}itemLoc(t){return t.access&&t.access.length?t.access[0]:t.position}itemLngLat(t,i=!1){const u=this.itemLoc(t),p=[u.lng,u.lat];return i?[p,p]:p}navigate(){const{dongleId:t,hasNav:i}=this.props,{searchSelect:u}=this.state;if(!i)return;this.props.dispatch(xa("nav_navigate",{distance:u.distance})),this.setState({searchSelect:{...u,settingDest:!0,success:!1}});const p=this.itemLoc(u);console.log(u),mO(t,p.lat,p.lng,yc(u),kf(u,"state")).then(m=>{if(m.error)throw new Error(m.error);this.setState({searchSelect:{...u,settingDest:!0,success:m.success,saved_next:m.saved_next}})}).catch(m=>{Qr(m,{fingerprint:"nav_set_destination"}),console.log(`failed to set destination: ${m.message}`),this.setState({searchSelect:{...u,settingDest:!1,success:!1}})})}onResize(t){this.setState({windowWidth:t})}toggleCarPinTooltip(t){const i=this.carPinTooltipRef.current;i&&(i.style.display=t?"block":"none")}saveSearchAs(t){const{dongleId:i}=this.props,{searchSelect:u}=this.state;this.setState({saveAsMenu:null,savingAs:!0});const p=this.itemLoc(u),m=t==="pin"?void 0:t;gO(i,p.lat,p.lng,yc(u),kf(u,"state"),"favorite",m).then(()=>{this.updateFavoriteLocations(),this.setState({savingAs:!1,savedAs:!0,searchSelect:{...u,favoriteIcon:this.getFavoriteLabelIcon(m)}})}).catch(o=>{console.error(o),Qr(o,{fingerprint:"nav_save_favorite"}),this.setState({savingAs:!1,savedAs:!1})})}deleteFavorite(){const{dongleId:t}=this.props,{searchSelect:i}=this.state;i.favoriteId&&(this.setState({savingAs:!0}),yO(t,i.favoriteId).then(()=>{this.updateFavoriteLocations(),this.setState({noFly:!1,searchSelect:null,searchLooking:!1,savingAs:!1,savedAs:!1},this.flyToMarkers)}).catch(u=>{console.error(u),Qr(u,{fingerprint:"nav_delete_favorite"}),this.setState({savingAs:!1,savedAs:!1})}))}researchArea(){const{viewport:t,windowWidth:i}=this.state,u=this.searchInputRef.current;_1(u.value,null,t).then(p=>{this.setState({noFly:!0,searchSelect:null,search:p.filter(m=>!["categoryQuery","chainQuery","administrativeArea"].includes(m.resultType)).slice(0,10),searchLooking:i<600,savingAs:!1,savedAs:!1})}).catch(p=>{console.error(p),Qr(p,{fingerprint:"nav_research_geocode_forward"})})}viewportChange(t,i){const{search:u,searchSelect:p,searchLooking:m}=this.state;this.setState({viewport:t}),(i.isPanning||i.isZooming||i.isRotating)&&(this.focus(),u&&!p&&!m&&this.setState({searchLooking:!0,noFly:!0}))}carLocationCircle(t){const u=t.accuracy/1e3,p=u/(111.32*Math.cos(t.location[1]*(Math.PI/180))),m=u/110.574,o=[];let _,b,E;for(let T=0;T<128;T++)_=T/128*(2*Math.PI),b=p*Math.cos(_),E=m*Math.sin(_),o.push([t.location[0]+b,t.location[1]+E]);return o.push(o[0]),{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Polygon",coordinates:[o]}}]}}onContainerRef(t){this.mapContainerRef.current=t,t&&t.addEventListener("touchstart",i=>i.stopPropagation())}render(){const{classes:t,device:i,hasNav:u}=this.props,{mapError:p,hasFocus:m,search:o,searchLooking:_,searchSelect:b,favoriteLocations:E,viewport:T,windowWidth:M,showPrimeAd:I}=this.state,N=this.getCarLocation(),D=M<600?{zIndex:4,width:"auto",height:"auto",top:"auto",bottom:"auto",left:10,right:10}:{zIndex:4,width:360,height:"auto",top:"auto",bottom:"auto",left:10};let re={transform:"translate(calc(-50% + 10px), -4px)"};return N&&T.height-new Ea(T).project(N.location)[1]<50&&(re={transform:"translate(calc(-50% + 10px), -81px)"}),R.jsxs("div",{ref:this.onContainerRef,className:t.mapContainer,style:{height:m&&u?"60vh":200},children:[R.jsx(Bc,{onResize:this.onResize}),R.jsx(Th,{onVisible:this.updateDevice,onInit:!0,onDongleId:!0,minInterval:60}),p&&R.jsxs("div",{className:t.mapError,children:[R.jsx(dt,{children:"Could not initialize map."}),R.jsx(dt,{children:p})]}),R.jsxs(Ih,{latitude:T.latitude,longitude:T.longitude,zoom:T.zoom,bearing:T.bearing,pitch:T.pitch,onViewportChange:this.viewportChange,onContextMenu:null,mapStyle:hE,width:"100%",height:"100%",onNativeClick:this.focus,maxPitch:0,mapboxApiAccessToken:Mh,attributionControl:!1,dragRotate:!1,onError:W=>this.setState({mapError:W.error.message}),children:[R.jsx(rD,{className:t.geolocateControl,positionOptions:{enableHighAccuracy:!0},showAccuracyCircle:!1,onGeolocate:this.onGeolocate,auto:m,fitBoundsOptions:{maxZoom:10},trackUserLocation:!0,onViewportChange:()=>{}}),b&&b.route&&R.jsx(jg,{id:"my-data",type:"geojson",data:b.route.geometry,children:R.jsx(Ng,{type:"line",layout:{"line-cap":"round","line-join":"bevel"},paint:{"line-color":"#31a1ee","line-width":3,"line-blur":1}})}),!o&&!b&&E&&Object.entries(E).map(([W,ee])=>{const J=ee.icon;return R.jsx(uf,{latitude:ee.latitude,longitude:ee.longitude,offsetLeft:-7.5,offsetTop:-24,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,children:R.jsx(J,{className:t.favoritePin,onClick:()=>this.onFavoriteSelect(W,ee),alt:"favorite-location"})},W)}),N&&R.jsxs(uf,{latitude:N.location[1],longitude:N.location[0],offsetLeft:-10,offsetTop:-30,captureDrag:!1,captureClick:!0,captureDoubleClick:!1,children:[R.jsx(D0,{className:t.pin,onMouseEnter:()=>this.toggleCarPinTooltip(!0),onMouseLeave:()=>this.toggleCarPinTooltip(!1),alt:"car-location",onClick:()=>this.onCarSelect(N)}),R.jsxs("div",{className:t.carPinTooltip,ref:this.carPinTooltipRef,style:{...re,display:"none"},children:[ui(N.time).format("h:mm A"),",",R.jsx("br",{}),L0(N.time)]})]}),N&&!!N.accuracy&&R.jsx(jg,{type:"geojson",data:this.carLocationCircle(N),children:R.jsx(Ng,{id:"polygon",type:"fill",source:"polygon",layout:{},paint:{"fill-color":"#31a1ee","fill-opacity":.3}})}),o&&!b&&o.map(W=>R.jsx(uf,{latitude:this.itemLoc(W).lat,longitude:this.itemLoc(W).lng,offsetLeft:-10,offsetTop:-30,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,children:R.jsx(z0,{className:t.pinClick,onClick:()=>this.onSearchSelect(W,"pin"),alt:"pin-location"})},W.id)),b&&this.renderSearchSelectMarker(b),u&&R.jsx(xc,{redraw:this.renderOverlay,style:{...D,top:10},captureScroll:!0,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!0}),b&&R.jsx(xc,{redraw:this.renderSearchOverlay,captureScroll:!0,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!0,style:{...D,bottom:10}}),o&&_&&!b&&R.jsx(xc,{redraw:this.renderResearchArea,captureScroll:!0,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!0,style:{...D,bottom:10,left:"50%",width:180,transform:"translate(-50%, 0)"}}),I&&!u&&!i.prime&&i.is_owner&&R.jsx(xc,{redraw:this.renderPrimeAd,captureScroll:!0,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!0,style:{...D,top:10,left:M<600?10:"auto",right:10}})]})]})}renderSearchSelectMarker(t){const{classes:i}=this.props;let u,p;t.resultType==="car"?[p,u]=this.getCarLocation().location:{lat:u,lng:p}=this.itemLoc(t);const m=t.favoriteIcon||z0;return R.jsx(uf,{latitude:u,longitude:p,offsetLeft:-10,offsetTop:-30,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,children:R.jsx(m,{className:i.pin,alt:"pin-location"})})}renderOverlay(){const{classes:t}=this.props,{search:i,searchSelect:u,searchLooking:p,geoLocateCoords:m}=this.state,o=this.getCarLocation();return R.jsxs("div",{className:t.overlay,ref:this.overlayRef,tabIndex:-1,onBlur:this.onSearchBlur,onClick:this.focus,children:[R.jsx(gg,{onChange:this.onSearch,fullWidth:!0,inputRef:this.searchInputRef,placeholder:"where do you want to go?",InputProps:{onFocus:this.onFocus,onBlur:this.onSearchBlur,classes:{root:t.overlayTextfield},endAdornment:R.jsxs(R.Fragment,{children:[this.searchInputRef.current&&this.searchInputRef.current.value&&R.jsx(qb,{position:"end",children:R.jsx(hh,{className:t.overlayClearButton,onClick:this.clearSearch})}),R.jsx(qb,{position:"end",children:R.jsx(UE,{className:t.overlaySearchButton,onClick:this.onSearchBlur})})]})}}),i&&!u&&!p&&R.jsxs(R.Fragment,{children:[R.jsx("div",{className:t.overlaySearchResultsHr}),R.jsxs("div",{className:`${t.overlaySearchResults} scrollstyle`,children:[!m&&!o&&R.jsx(dt,{className:t.overlaySearchNoLocation,children:"location unknown, turn on device for better results"}),i.length===0&&R.jsx(dt,{className:t.overlaySearchNoResults,children:"no search results"}),i.map(_=>R.jsx("div",{className:t.overlaySearchItem,onClick:()=>this.onSearchSelect(_,"list"),children:R.jsxs(dt,{children:[yc(_),R.jsx("span",{className:t.overlaySearchDetails,children:pj(_)})]})},_.id))]})]})]})}renderSearchOverlay(){const{classes:t,device:i}=this.props,{searchSelect:u,geoLocateCoords:p,saveAsMenu:m,savingAs:o,savedAs:_}=this.state,b=this.getCarLocation(),E=!u.route&&(b||p),T=u.resultType==="car",M=/iphone|ipad|ipod/.test(window.navigator.userAgent.toLowerCase()),I=T?i.alias:yc(u),{lat:N,lng:D}=u.position;let re;return M?re=`https://maps.apple.com/?ll=${N},${D}&q=${I}`:re=`https://maps.google.com/?q=${N},${D}`,R.jsxs("div",{className:t.searchSelectBox,ref:this.searchSelectBoxRef,children:[R.jsx(hh,{className:t.clearSearchSelect,onClick:this.clearSearchSelect}),R.jsxs("div",{className:t.searchSelectBoxHeader,children:[R.jsxs("div",{className:t.searchSelectBoxTitle,children:[R.jsx(dt,{className:t.bold,children:I}),u.route&&R.jsxs(dt,{className:t.searchSelectBoxDetails,children:[lj(u.route)," ","(",cj(u.route),")"]}),T&&R.jsx(dt,{className:t.searchSelectBoxDetails,children:L0(b.time)})]}),R.jsxs("div",{className:t.searchSelectBoxButtons,children:[R.jsx(an,{classes:{root:T?t.searchSelectButton:t.searchSelectButtonSecondary},target:"_blank",href:re,children:"open in maps"}),u.favoriteId?R.jsx(an,{disabled:o||_,onClick:this.deleteFavorite,classes:{root:t.searchSelectButtonSecondary,label:t.noWrap},children:o?"...":"delete"}):R.jsx(an,{disabled:o||_,onClick:W=>this.setState({saveAsMenu:W.target}),classes:{root:t.searchSelectButtonSecondary,label:t.noWrap},children:o?"...":_?"saved":"save as"}),R.jsxs(Bf,{id:"menu-save-as",open:!!m,anchorEl:m,onClose:()=>this.setState({saveAsMenu:null}),anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[R.jsx(yi,{classes:{root:t.saveAsMenuItem},onClick:()=>this.saveSearchAs("home"),children:"home"}),R.jsx(yi,{classes:{root:t.saveAsMenuItem},onClick:()=>this.saveSearchAs("work"),children:"work"}),R.jsx(yi,{classes:{root:t.saveAsMenuItem},onClick:()=>this.saveSearchAs("pin"),children:"favorite"})]}),u.settingDest?R.jsxs("div",{className:`${t.searchSelectButton} ${t.searchSelectButtonFake}`,ref:this.navigateFakeButtonRef,children:[u.success?R.jsx(dt,{children:"destination set"}):R.jsx(ha,{size:19}),R.jsxs(nm,{open:!!(u.success&&u.saved_next),placement:"bottom",anchorEl:this.navigateFakeButtonRef.current,className:t.savedNextPopover,children:[R.jsx(dt,{children:"device offline"}),R.jsx(dt,{children:"destination will be set once device is online"})]})]}):!T&&R.jsx(an,{disabled:!!E,onClick:this.navigate,classes:{root:t.searchSelectButton},style:{marginBottom:8},children:E?"no route":"navigate"})]})]}),R.jsxs(dt,{className:t.searchSelectBoxDetails,children:[T&&`${yc(u)}, `,kf(u,"state")]})]})}renderResearchArea(){const{classes:t}=this.props;return R.jsxs(an,{className:t.researchArea,onClick:this.researchArea,children:[R.jsx(LE,{}),"search this area"]})}renderPrimeAd(){const{classes:t}=this.props;return R.jsxs("div",{className:`${t.searchSelectBox} ${t.primeAdContainer}`,ref:this.primeAdBoxRef,children:[R.jsx(hh,{className:t.clearSearchSelect,onClick:()=>this.setState({showPrimeAd:!1},this.flyToMarkers)}),R.jsxs("div",{className:t.searchSelectBoxHeader,children:[R.jsx("div",{className:t.searchSelectBoxTitle,children:R.jsx(dt,{className:t.primeAdTitle,children:"comma prime"})}),R.jsx("div",{className:t.searchSelectBoxButtons,children:R.jsx(an,{onClick:()=>this.props.dispatch(pS(!0)),className:`${t.searchSelectButton} ${t.primeAdButton} primeSignUp`,children:"sign up"})})]}),R.jsx(dt,{className:t.primeAdDetails,children:"Put your car on the internet with comma prime"})]})}}const fj=pi({device:"device",dongleId:"dongleId"}),mj=Kn(fj)(ci.withStyles(hj)(dj));var ZE={},fm={},r_={},cg={},Pw;function vj(){return Pw||(Pw=1,function(n){(function(t,i){i(n,me,Cr())})(Sa,function(t,i,u){Object.defineProperty(t,"__esModule",{value:!0}),t.setHasSupportToCaptureOption=D;var p=o(i),m=o(u);function o(J){return J&&J.__esModule?J:{default:J}}var _=Object.assign||function(J){for(var Y=1;Y<arguments.length;Y++){var B=arguments[Y];for(var V in B)Object.prototype.hasOwnProperty.call(B,V)&&(J[V]=B[V])}return J};function b(J,Y){var B={};for(var V in J)Y.indexOf(V)>=0||Object.prototype.hasOwnProperty.call(J,V)&&(B[V]=J[V]);return B}function E(J,Y){if(!(J instanceof Y))throw new TypeError("Cannot call a class as a function")}var T=function(){function J(Y,B){for(var V=0;V<B.length;V++){var K=B[V];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(Y,K.key,K)}}return function(Y,B,V){return B&&J(Y.prototype,B),V&&J(Y,V),Y}}();function M(J,Y){if(!J)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Y&&(typeof Y=="object"||typeof Y=="function")?Y:J}function I(J,Y){if(typeof Y!="function"&&Y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Y);J.prototype=Object.create(Y&&Y.prototype,{constructor:{value:J,enumerable:!1,writable:!0,configurable:!0}}),Y&&(Object.setPrototypeOf?Object.setPrototypeOf(J,Y):J.__proto__=Y)}var N=!1;function D(J){N=J}try{addEventListener("test",null,Object.defineProperty({},"capture",{get:function(){D(!0)}}))}catch{}function re(){var J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{capture:!0};return N?J:J.capture}function W(J){if("touches"in J){var Y=J.touches[0],B=Y.pageX,V=Y.pageY;return{x:B,y:V}}var K=J.screenX,ve=J.screenY;return{x:K,y:ve}}var ee=function(J){I(Y,J);function Y(){var B;E(this,Y);for(var V=arguments.length,K=Array(V),ve=0;ve<V;ve++)K[ve]=arguments[ve];var de=M(this,(B=Y.__proto__||Object.getPrototypeOf(Y)).call.apply(B,[this].concat(K)));return de._handleSwipeStart=de._handleSwipeStart.bind(de),de._handleSwipeMove=de._handleSwipeMove.bind(de),de._handleSwipeEnd=de._handleSwipeEnd.bind(de),de._onMouseDown=de._onMouseDown.bind(de),de._onMouseMove=de._onMouseMove.bind(de),de._onMouseUp=de._onMouseUp.bind(de),de._setSwiperRef=de._setSwiperRef.bind(de),de}return T(Y,[{key:"componentDidMount",value:function(){this.swiper&&this.swiper.addEventListener("touchmove",this._handleSwipeMove,re({capture:!0,passive:!1}))}},{key:"componentWillUnmount",value:function(){this.swiper&&this.swiper.removeEventListener("touchmove",this._handleSwipeMove,re({capture:!0,passive:!1}))}},{key:"_onMouseDown",value:function(V){this.props.allowMouseEvents&&(this.mouseDown=!0,document.addEventListener("mouseup",this._onMouseUp),document.addEventListener("mousemove",this._onMouseMove),this._handleSwipeStart(V))}},{key:"_onMouseMove",value:function(V){this.mouseDown&&this._handleSwipeMove(V)}},{key:"_onMouseUp",value:function(V){this.mouseDown=!1,document.removeEventListener("mouseup",this._onMouseUp),document.removeEventListener("mousemove",this._onMouseMove),this._handleSwipeEnd(V)}},{key:"_handleSwipeStart",value:function(V){var K=W(V),ve=K.x,de=K.y;this.moveStart={x:ve,y:de},this.props.onSwipeStart(V)}},{key:"_handleSwipeMove",value:function(V){if(this.moveStart){var K=W(V),ve=K.x,de=K.y,ie=ve-this.moveStart.x,we=de-this.moveStart.y;this.moving=!0;var ze=this.props.onSwipeMove({x:ie,y:we},V);ze&&V.cancelable&&V.preventDefault(),this.movePosition={deltaX:ie,deltaY:we}}}},{key:"_handleSwipeEnd",value:function(V){this.props.onSwipeEnd(V);var K=this.props.tolerance;this.moving&&this.movePosition&&(this.movePosition.deltaX<-K?this.props.onSwipeLeft(1,V):this.movePosition.deltaX>K&&this.props.onSwipeRight(1,V),this.movePosition.deltaY<-K?this.props.onSwipeUp(1,V):this.movePosition.deltaY>K&&this.props.onSwipeDown(1,V)),this.moveStart=null,this.moving=!1,this.movePosition=null}},{key:"_setSwiperRef",value:function(V){this.swiper=V,this.props.innerRef(V)}},{key:"render",value:function(){var V=this.props;V.tagName;var K=V.className,ve=V.style,de=V.children;V.allowMouseEvents,V.onSwipeUp,V.onSwipeDown,V.onSwipeLeft,V.onSwipeRight,V.onSwipeStart,V.onSwipeMove,V.onSwipeEnd,V.innerRef,V.tolerance;var ie=b(V,["tagName","className","style","children","allowMouseEvents","onSwipeUp","onSwipeDown","onSwipeLeft","onSwipeRight","onSwipeStart","onSwipeMove","onSwipeEnd","innerRef","tolerance"]);return p.default.createElement(this.props.tagName,_({ref:this._setSwiperRef,onMouseDown:this._onMouseDown,onTouchStart:this._handleSwipeStart,onTouchEnd:this._handleSwipeEnd,className:K,style:ve},ie),de)}}]),Y}(i.Component);ee.displayName="ReactSwipe",ee.propTypes={tagName:m.default.string,className:m.default.string,style:m.default.object,children:m.default.node,allowMouseEvents:m.default.bool,onSwipeUp:m.default.func,onSwipeDown:m.default.func,onSwipeLeft:m.default.func,onSwipeRight:m.default.func,onSwipeStart:m.default.func,onSwipeMove:m.default.func,onSwipeEnd:m.default.func,innerRef:m.default.func,tolerance:m.default.number.isRequired},ee.defaultProps={tagName:"div",allowMouseEvents:!1,onSwipeUp:function(){},onSwipeDown:function(){},onSwipeLeft:function(){},onSwipeRight:function(){},onSwipeStart:function(){},onSwipeMove:function(){},onSwipeEnd:function(){},innerRef:function(){},tolerance:0},t.default=ee})}(cg)),cg}(function(n){(function(t,i){i(n,vj())})(Sa,function(t,i){Object.defineProperty(t,"__esModule",{value:!0});var u=p(i);function p(m){return m&&m.__esModule?m:{default:m}}t.default=u.default})})(r_);var Oh={};Object.defineProperty(Oh,"__esModule",{value:!0});Oh.default=void 0;var Us=gj(hn());function gj(n){return n&&n.__esModule?n:{default:n}}function yj(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}var _j={ROOT:function(t){return(0,Us.default)(yj({"carousel-root":!0},t||"",!!t))},CAROUSEL:function(t){return(0,Us.default)({carousel:!0,"carousel-slider":t})},WRAPPER:function(t,i){return(0,Us.default)({"thumbs-wrapper":!t,"slider-wrapper":t,"axis-horizontal":i==="horizontal","axis-vertical":i!=="horizontal"})},SLIDER:function(t,i){return(0,Us.default)({thumbs:!t,slider:t,animated:!i})},ITEM:function(t,i,u){return(0,Us.default)({thumb:!t,slide:t,selected:i,previous:u})},ARROW_PREV:function(t){return(0,Us.default)({"control-arrow control-prev":!0,"control-disabled":t})},ARROW_NEXT:function(t){return(0,Us.default)({"control-arrow control-next":!0,"control-disabled":t})},DOT:function(t){return(0,Us.default)({dot:!0,selected:t})}};Oh.default=_j;var Rh={},mm={};Object.defineProperty(mm,"__esModule",{value:!0});mm.outerWidth=void 0;var bj=function(t){var i=t.offsetWidth,u=getComputedStyle(t);return i+=parseInt(u.marginLeft)+parseInt(u.marginRight),i};mm.outerWidth=bj;var Fc={};Object.defineProperty(Fc,"__esModule",{value:!0});Fc.default=void 0;var xj=function(t,i,u){var p=t===0?t:t+i,m=u==="horizontal"?[p,0,0]:[0,p,0],o="translate3d",_="("+m.join(",")+")";return o+_};Fc.default=xj;var Ah={};Object.defineProperty(Ah,"__esModule",{value:!0});Ah.default=void 0;var wj=function(){return window};Ah.default=wj;Object.defineProperty(Rh,"__esModule",{value:!0});Rh.default=void 0;var Ga=Pj(me),uu=vm(Oh),Sj=mm,Tw=vm(Fc),Ej=vm(r_),Sf=vm(Ah);function vm(n){return n&&n.__esModule?n:{default:n}}function GE(){if(typeof WeakMap!="function")return null;var n=new WeakMap;return GE=function(){return n},n}function Pj(n){if(n&&n.__esModule)return n;if(n===null||dh(n)!=="object"&&typeof n!="function")return{default:n};var t=GE();if(t&&t.has(n))return t.get(n);var i={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in n)if(Object.prototype.hasOwnProperty.call(n,p)){var m=u?Object.getOwnPropertyDescriptor(n,p):null;m&&(m.get||m.set)?Object.defineProperty(i,p,m):i[p]=n[p]}return i.default=n,t&&t.set(n,i),i}function dh(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?dh=function(i){return typeof i}:dh=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},dh(n)}function Ug(){return Ug=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&(n[u]=i[u])}return n},Ug.apply(this,arguments)}function Tj(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function Cj(n,t){for(var i=0;i<t.length;i++){var u=t[i];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(n,u.key,u)}}function Ij(n,t,i){return t&&Cj(n.prototype,t),n}function Mj(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&Vg(n,t)}function Vg(n,t){return Vg=Object.setPrototypeOf||function(u,p){return u.__proto__=p,u},Vg(n,t)}function Oj(n){var t=Aj();return function(){var u=Xf(n),p;if(t){var m=Xf(this).constructor;p=Reflect.construct(u,arguments,m)}else p=u.apply(this,arguments);return Rj(this,p)}}function Rj(n,t){return t&&(dh(t)==="object"||typeof t=="function")?t:Gi(n)}function Gi(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Aj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Xf(n){return Xf=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},Xf(n)}function Ni(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}var kj=function(t){return t.hasOwnProperty("key")},n_=function(n){Mj(i,n);var t=Oj(i);function i(u){var p;return Tj(this,i),p=t.call(this,u),Ni(Gi(p),"itemsWrapperRef",void 0),Ni(Gi(p),"itemsListRef",void 0),Ni(Gi(p),"thumbsRef",void 0),Ni(Gi(p),"setItemsWrapperRef",function(m){p.itemsWrapperRef=m}),Ni(Gi(p),"setItemsListRef",function(m){p.itemsListRef=m}),Ni(Gi(p),"setThumbsRef",function(m,o){p.thumbsRef||(p.thumbsRef=[]),p.thumbsRef[o]=m}),Ni(Gi(p),"updateSizes",function(){if(!(!p.props.children||!p.itemsWrapperRef||!p.thumbsRef)){var m=Ga.Children.count(p.props.children),o=p.itemsWrapperRef.clientWidth,_=p.props.thumbWidth?p.props.thumbWidth:(0,Sj.outerWidth)(p.thumbsRef[0]),b=Math.floor(o/_),E=b<m,T=E?m-b:0;p.setState(function(M,I){return{itemSize:_,visibleItems:b,firstItem:E?p.getFirstItem(I.selectedItem):0,lastPosition:T,showArrows:E}})}}),Ni(Gi(p),"handleClickItem",function(m,o,_){if(!kj(_)||_.key==="Enter"){var b=p.props.onSelectItem;typeof b=="function"&&b(m,o)}}),Ni(Gi(p),"onSwipeStart",function(){p.setState({swiping:!0})}),Ni(Gi(p),"onSwipeEnd",function(){p.setState({swiping:!1})}),Ni(Gi(p),"onSwipeMove",function(m){var o=m.x;if(!p.state.itemSize||!p.itemsWrapperRef||!p.state.visibleItems)return!1;var _=0,b=Ga.Children.count(p.props.children),E=-(p.state.firstItem*100)/p.state.visibleItems,T=Math.max(b-p.state.visibleItems,0),M=-T*100/p.state.visibleItems;E===_&&o>0&&(o=0),E===M&&o<0&&(o=0);var I=p.itemsWrapperRef.clientWidth,N=E+100/(I/o);return p.itemsListRef&&["WebkitTransform","MozTransform","MsTransform","OTransform","transform","msTransform"].forEach(function(D){p.itemsListRef.style[D]=(0,Tw.default)(N,"%",p.props.axis)}),!0}),Ni(Gi(p),"slideRight",function(m){p.moveTo(p.state.firstItem-(typeof m=="number"?m:1))}),Ni(Gi(p),"slideLeft",function(m){p.moveTo(p.state.firstItem+(typeof m=="number"?m:1))}),Ni(Gi(p),"moveTo",function(m){m=m<0?0:m,m=m>=p.state.lastPosition?p.state.lastPosition:m,p.setState({firstItem:m})}),p.state={selectedItem:u.selectedItem,swiping:!1,showArrows:!1,firstItem:0,visibleItems:0,lastPosition:0},p}return Ij(i,[{key:"componentDidMount",value:function(){this.setupThumbs()}},{key:"componentDidUpdate",value:function(p){this.props.selectedItem!==this.state.selectedItem&&this.setState({selectedItem:this.props.selectedItem,firstItem:this.getFirstItem(this.props.selectedItem)}),this.props.children!==p.children&&this.updateSizes()}},{key:"componentWillUnmount",value:function(){this.destroyThumbs()}},{key:"setupThumbs",value:function(){(0,Sf.default)().addEventListener("resize",this.updateSizes),(0,Sf.default)().addEventListener("DOMContentLoaded",this.updateSizes),this.updateSizes()}},{key:"destroyThumbs",value:function(){(0,Sf.default)().removeEventListener("resize",this.updateSizes),(0,Sf.default)().removeEventListener("DOMContentLoaded",this.updateSizes)}},{key:"getFirstItem",value:function(p){var m=p;return p>=this.state.lastPosition&&(m=this.state.lastPosition),p<this.state.firstItem+this.state.visibleItems&&(m=this.state.firstItem),p<this.state.firstItem&&(m=p),m}},{key:"renderItems",value:function(){var p=this;return this.props.children.map(function(m,o){var _=uu.default.ITEM(!1,o===p.state.selectedItem),b={key:o,ref:function(T){return p.setThumbsRef(T,o)},className:_,onClick:p.handleClickItem.bind(p,o,p.props.children[o]),onKeyDown:p.handleClickItem.bind(p,o,p.props.children[o]),"aria-label":"".concat(p.props.labels.item," ").concat(o+1),style:{width:p.props.thumbWidth}};return Ga.default.createElement("li",Ug({},b,{role:"button",tabIndex:0}),m)})}},{key:"render",value:function(){var p=this;if(!this.props.children)return null;var m=Ga.Children.count(this.props.children)>1,o=this.state.showArrows&&this.state.firstItem>0,_=this.state.showArrows&&this.state.firstItem<this.state.lastPosition,b={},E=-this.state.firstItem*(this.state.itemSize||0),T=(0,Tw.default)(E,"px",this.props.axis),M=this.props.transitionTime+"ms";return b={WebkitTransform:T,MozTransform:T,MsTransform:T,OTransform:T,transform:T,msTransform:T,WebkitTransitionDuration:M,MozTransitionDuration:M,MsTransitionDuration:M,OTransitionDuration:M,transitionDuration:M,msTransitionDuration:M},Ga.default.createElement("div",{className:uu.default.CAROUSEL(!1)},Ga.default.createElement("div",{className:uu.default.WRAPPER(!1),ref:this.setItemsWrapperRef},Ga.default.createElement("button",{type:"button",className:uu.default.ARROW_PREV(!o),onClick:function(){return p.slideRight()},"aria-label":this.props.labels.leftArrow}),m?Ga.default.createElement(Ej.default,{tagName:"ul",className:uu.default.SLIDER(!1,this.state.swiping),onSwipeLeft:this.slideLeft,onSwipeRight:this.slideRight,onSwipeMove:this.onSwipeMove,onSwipeStart:this.onSwipeStart,onSwipeEnd:this.onSwipeEnd,style:b,innerRef:this.setItemsListRef,allowMouseEvents:this.props.emulateTouch},this.renderItems()):Ga.default.createElement("ul",{className:uu.default.SLIDER(!1,this.state.swiping),ref:function(N){return p.setItemsListRef(N)},style:b},this.renderItems()),Ga.default.createElement("button",{type:"button",className:uu.default.ARROW_NEXT(!_),onClick:function(){return p.slideLeft()},"aria-label":this.props.labels.rightArrow})))}}]),i}(Ga.Component);Rh.default=n_;Ni(n_,"displayName","Thumbs");Ni(n_,"defaultProps",{axis:"horizontal",labels:{leftArrow:"previous slide / item",rightArrow:"next slide / item",item:"slide item"},selectedItem:0,thumbWidth:80,transitionTime:350});var gm={};Object.defineProperty(gm,"__esModule",{value:!0});gm.default=void 0;var Dj=function(){return document};gm.default=Dj;var wa={};Object.defineProperty(wa,"__esModule",{value:!0});wa.setPosition=wa.getPosition=wa.isKeyboardEvent=wa.defaultStatusFormatter=wa.noop=void 0;var Lj=me,zj=jj(Fc);function jj(n){return n&&n.__esModule?n:{default:n}}var Nj=function(){};wa.noop=Nj;var Bj=function(t,i){return"".concat(t," of ").concat(i)};wa.defaultStatusFormatter=Bj;var Fj=function(t){return t?t.hasOwnProperty("key"):!1};wa.isKeyboardEvent=Fj;var Uj=function(t,i){if(i.infiniteLoop&&++t,t===0)return 0;var u=Lj.Children.count(i.children);if(i.centerMode&&i.axis==="horizontal"){var p=-t*i.centerSlidePercentage,m=u-1;return t&&(t!==m||i.infiniteLoop)?p+=(100-i.centerSlidePercentage)/2:t===m&&(p+=100-i.centerSlidePercentage),p}return-t*100};wa.getPosition=Uj;var Vj=function(t,i){var u={};return["WebkitTransform","MozTransform","MsTransform","OTransform","transform","msTransform"].forEach(function(p){u[p]=(0,zj.default)(t,"%",i)}),u};wa.setPosition=Vj;var Ro={};Object.defineProperty(Ro,"__esModule",{value:!0});Ro.fadeAnimationHandler=Ro.slideStopSwipingHandler=Ro.slideSwipeAnimationHandler=Ro.slideAnimationHandler=void 0;var XE=me,qj=$j(Fc),Ao=wa;function $j(n){return n&&n.__esModule?n:{default:n}}function Cw(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function cu(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Cw(Object(i),!0).forEach(function(u){Wj(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Cw(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function Wj(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}var Hj=function(t,i){var u={},p=i.selectedItem,m=p,o=XE.Children.count(t.children)-1,_=t.infiniteLoop&&(p<0||p>o);if(_)return m<0?t.centerMode&&t.centerSlidePercentage&&t.axis==="horizontal"?u.itemListStyle=(0,Ao.setPosition)(-(o+2)*t.centerSlidePercentage-(100-t.centerSlidePercentage)/2,t.axis):u.itemListStyle=(0,Ao.setPosition)(-(o+2)*100,t.axis):m>o&&(u.itemListStyle=(0,Ao.setPosition)(0,t.axis)),u;var b=(0,Ao.getPosition)(p,t),E=(0,qj.default)(b,"%",t.axis),T=t.transitionTime+"ms";return u.itemListStyle={WebkitTransform:E,msTransform:E,OTransform:E,transform:E},i.swiping||(u.itemListStyle=cu(cu({},u.itemListStyle),{},{WebkitTransitionDuration:T,MozTransitionDuration:T,OTransitionDuration:T,transitionDuration:T,msTransitionDuration:T})),u};Ro.slideAnimationHandler=Hj;var Zj=function(t,i,u,p){var m={},o=i.axis==="horizontal",_=XE.Children.count(i.children),b=0,E=(0,Ao.getPosition)(u.selectedItem,i),T=i.infiniteLoop?(0,Ao.getPosition)(_-1,i)-100:(0,Ao.getPosition)(_-1,i),M=o?t.x:t.y,I=M;E===b&&M>0&&(I=0),E===T&&M<0&&(I=0);var N=E+100/(u.itemSize/I),D=Math.abs(M)>i.swipeScrollTolerance;return i.infiniteLoop&&D&&(u.selectedItem===0&&N>-100?N-=_*100:u.selectedItem===_-1&&N<-_*100&&(N+=_*100)),(!i.preventMovementUntilSwipeScrollTolerance||D||u.swipeMovementStarted)&&(u.swipeMovementStarted||p({swipeMovementStarted:!0}),m.itemListStyle=(0,Ao.setPosition)(N,i.axis)),D&&!u.cancelClick&&p({cancelClick:!0}),m};Ro.slideSwipeAnimationHandler=Zj;var Gj=function(t,i){var u=(0,Ao.getPosition)(i.selectedItem,t),p=(0,Ao.setPosition)(u,t.axis);return{itemListStyle:p}};Ro.slideStopSwipingHandler=Gj;var Xj=function(t,i){var u=t.transitionTime+"ms",p="ease-in-out",m={position:"absolute",display:"block",zIndex:-2,minHeight:"100%",opacity:0,top:0,right:0,left:0,bottom:0,transitionTimingFunction:p,msTransitionTimingFunction:p,MozTransitionTimingFunction:p,WebkitTransitionTimingFunction:p,OTransitionTimingFunction:p};return i.swiping||(m=cu(cu({},m),{},{WebkitTransitionDuration:u,MozTransitionDuration:u,OTransitionDuration:u,transitionDuration:u,msTransitionDuration:u})),{slideStyle:m,selectedStyle:cu(cu({},m),{},{opacity:1,position:"relative"}),prevStyle:cu({},m)}};Ro.fadeAnimationHandler=Xj;Object.defineProperty(fm,"__esModule",{value:!0});fm.default=void 0;var Jr=Jj(me),Kj=kh(r_),ds=kh(Oh),Yj=kh(Rh),Ef=kh(gm),Pf=kh(Ah),oh=wa,Kf=Ro;function kh(n){return n&&n.__esModule?n:{default:n}}function KE(){if(typeof WeakMap!="function")return null;var n=new WeakMap;return KE=function(){return n},n}function Jj(n){if(n&&n.__esModule)return n;if(n===null||fh(n)!=="object"&&typeof n!="function")return{default:n};var t=KE();if(t&&t.has(n))return t.get(n);var i={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in n)if(Object.prototype.hasOwnProperty.call(n,p)){var m=u?Object.getOwnPropertyDescriptor(n,p):null;m&&(m.get||m.set)?Object.defineProperty(i,p,m):i[p]=n[p]}return i.default=n,t&&t.set(n,i),i}function fh(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?fh=function(i){return typeof i}:fh=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},fh(n)}function qg(){return qg=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&(n[u]=i[u])}return n},qg.apply(this,arguments)}function Iw(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);t&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(n,p).enumerable})),i.push.apply(i,u)}return i}function Xa(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Iw(Object(i),!0).forEach(function(u){xr(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Iw(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function Qj(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function eN(n,t){for(var i=0;i<t.length;i++){var u=t[i];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(n,u.key,u)}}function tN(n,t,i){return t&&eN(n.prototype,t),n}function rN(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&$g(n,t)}function $g(n,t){return $g=Object.setPrototypeOf||function(u,p){return u.__proto__=p,u},$g(n,t)}function nN(n){var t=aN();return function(){var u=Yf(n),p;if(t){var m=Yf(this).constructor;p=Reflect.construct(u,arguments,m)}else p=u.apply(this,arguments);return iN(this,p)}}function iN(n,t){return t&&(fh(t)==="object"||typeof t=="function")?t:Pr(n)}function Pr(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function aN(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Yf(n){return Yf=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},Yf(n)}function xr(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}var i_=function(n){rN(i,n);var t=nN(i);function i(u){var p;Qj(this,i),p=t.call(this,u),xr(Pr(p),"thumbsRef",void 0),xr(Pr(p),"carouselWrapperRef",void 0),xr(Pr(p),"listRef",void 0),xr(Pr(p),"itemsRef",void 0),xr(Pr(p),"timer",void 0),xr(Pr(p),"animationHandler",void 0),xr(Pr(p),"setThumbsRef",function(o){p.thumbsRef=o}),xr(Pr(p),"setCarouselWrapperRef",function(o){p.carouselWrapperRef=o}),xr(Pr(p),"setListRef",function(o){p.listRef=o}),xr(Pr(p),"setItemsRef",function(o,_){p.itemsRef||(p.itemsRef=[]),p.itemsRef[_]=o}),xr(Pr(p),"autoPlay",function(){Jr.Children.count(p.props.children)<=1||(p.clearAutoPlay(),p.props.autoPlay&&(p.timer=setTimeout(function(){p.increment()},p.props.interval)))}),xr(Pr(p),"clearAutoPlay",function(){p.timer&&clearTimeout(p.timer)}),xr(Pr(p),"resetAutoPlay",function(){p.clearAutoPlay(),p.autoPlay()}),xr(Pr(p),"stopOnHover",function(){p.setState({isMouseEntered:!0},p.clearAutoPlay)}),xr(Pr(p),"startOnLeave",function(){p.setState({isMouseEntered:!1},p.autoPlay)}),xr(Pr(p),"isFocusWithinTheCarousel",function(){return p.carouselWrapperRef?!!((0,Ef.default)().activeElement===p.carouselWrapperRef||p.carouselWrapperRef.contains((0,Ef.default)().activeElement)):!1}),xr(Pr(p),"navigateWithKeyboard",function(o){if(p.isFocusWithinTheCarousel()){var _=p.props.axis,b=_==="horizontal",E={ArrowUp:38,ArrowRight:39,ArrowDown:40,ArrowLeft:37},T=b?E.ArrowRight:E.ArrowDown,M=b?E.ArrowLeft:E.ArrowUp;T===o.keyCode?p.increment():M===o.keyCode&&p.decrement()}}),xr(Pr(p),"updateSizes",function(){if(!(!p.state.initialized||!p.itemsRef||p.itemsRef.length===0)){var o=p.props.axis==="horizontal",_=p.itemsRef[0];if(_){var b=o?_.clientWidth:_.clientHeight;p.setState({itemSize:b}),p.thumbsRef&&p.thumbsRef.updateSizes()}}}),xr(Pr(p),"setMountState",function(){p.setState({hasMount:!0}),p.updateSizes()}),xr(Pr(p),"handleClickItem",function(o,_){if(Jr.Children.count(p.props.children)!==0){if(p.state.cancelClick){p.setState({cancelClick:!1});return}p.props.onClickItem(o,_),o!==p.state.selectedItem&&p.setState({selectedItem:o})}}),xr(Pr(p),"handleOnChange",function(o,_){Jr.Children.count(p.props.children)<=1||p.props.onChange(o,_)}),xr(Pr(p),"handleClickThumb",function(o,_){p.props.onClickThumb(o,_),p.moveTo(o)}),xr(Pr(p),"onSwipeStart",function(o){p.setState({swiping:!0}),p.props.onSwipeStart(o)}),xr(Pr(p),"onSwipeEnd",function(o){p.setState({swiping:!1,cancelClick:!1,swipeMovementStarted:!1}),p.props.onSwipeEnd(o),p.clearAutoPlay(),p.state.autoPlay&&p.autoPlay()}),xr(Pr(p),"onSwipeMove",function(o,_){p.props.onSwipeMove(_);var b=p.props.swipeAnimationHandler(o,p.props,p.state,p.setState.bind(Pr(p)));return p.setState(Xa({},b)),!!Object.keys(b).length}),xr(Pr(p),"decrement",function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;p.moveTo(p.state.selectedItem-(typeof o=="number"?o:1))}),xr(Pr(p),"increment",function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;p.moveTo(p.state.selectedItem+(typeof o=="number"?o:1))}),xr(Pr(p),"moveTo",function(o){if(typeof o=="number"){var _=Jr.Children.count(p.props.children)-1;o<0&&(o=p.props.infiniteLoop?_:0),o>_&&(o=p.props.infiniteLoop?0:_),p.selectItem({selectedItem:o}),p.state.autoPlay&&p.state.isMouseEntered===!1&&p.resetAutoPlay()}}),xr(Pr(p),"onClickNext",function(){p.increment(1)}),xr(Pr(p),"onClickPrev",function(){p.decrement(1)}),xr(Pr(p),"onSwipeForward",function(){p.increment(1),p.props.emulateTouch&&p.setState({cancelClick:!0})}),xr(Pr(p),"onSwipeBackwards",function(){p.decrement(1),p.props.emulateTouch&&p.setState({cancelClick:!0})}),xr(Pr(p),"changeItem",function(o){return function(_){(!(0,oh.isKeyboardEvent)(_)||_.key==="Enter")&&p.moveTo(o)}}),xr(Pr(p),"selectItem",function(o){p.setState(Xa({previousItem:p.state.selectedItem},o),function(){p.setState(p.animationHandler(p.props,p.state))}),p.handleOnChange(o.selectedItem,Jr.Children.toArray(p.props.children)[o.selectedItem])}),xr(Pr(p),"getInitialImage",function(){var o=p.props.selectedItem,_=p.itemsRef&&p.itemsRef[o],b=_&&_.getElementsByTagName("img")||[];return b[0]}),xr(Pr(p),"getVariableItemHeight",function(o){var _=p.itemsRef&&p.itemsRef[o];if(p.state.hasMount&&_&&_.children.length){var b=_.children[0].getElementsByTagName("img")||[];if(b.length>0){var E=b[0];if(!E.complete){var T=function N(){p.forceUpdate(),E.removeEventListener("load",N)};E.addEventListener("load",T)}}var M=b[0]||_.children[0],I=M.clientHeight;return I>0?I:null}return null});var m={initialized:!1,previousItem:u.selectedItem,selectedItem:u.selectedItem,hasMount:!1,isMouseEntered:!1,autoPlay:u.autoPlay,swiping:!1,swipeMovementStarted:!1,cancelClick:!1,itemSize:1,itemListStyle:{},slideStyle:{},selectedStyle:{},prevStyle:{}};return p.animationHandler=typeof u.animationHandler=="function"&&u.animationHandler||u.animationHandler==="fade"&&Kf.fadeAnimationHandler||Kf.slideAnimationHandler,p.state=Xa(Xa({},m),p.animationHandler(u,m)),p}return tN(i,[{key:"componentDidMount",value:function(){this.props.children&&this.setupCarousel()}},{key:"componentDidUpdate",value:function(p,m){!p.children&&this.props.children&&!this.state.initialized&&this.setupCarousel(),!p.autoFocus&&this.props.autoFocus&&this.forceFocus(),m.swiping&&!this.state.swiping&&this.setState(Xa({},this.props.stopSwipingHandler(this.props,this.state))),(p.selectedItem!==this.props.selectedItem||p.centerMode!==this.props.centerMode)&&(this.updateSizes(),this.moveTo(this.props.selectedItem)),p.autoPlay!==this.props.autoPlay&&(this.props.autoPlay?this.setupAutoPlay():this.destroyAutoPlay(),this.setState({autoPlay:this.props.autoPlay}))}},{key:"componentWillUnmount",value:function(){this.destroyCarousel()}},{key:"setupCarousel",value:function(){var p=this;this.bindEvents(),this.state.autoPlay&&Jr.Children.count(this.props.children)>1&&this.setupAutoPlay(),this.props.autoFocus&&this.forceFocus(),this.setState({initialized:!0},function(){var m=p.getInitialImage();m&&!m.complete?m.addEventListener("load",p.setMountState):p.setMountState()})}},{key:"destroyCarousel",value:function(){this.state.initialized&&(this.unbindEvents(),this.destroyAutoPlay())}},{key:"setupAutoPlay",value:function(){this.autoPlay();var p=this.carouselWrapperRef;this.props.stopOnHover&&p&&(p.addEventListener("mouseenter",this.stopOnHover),p.addEventListener("mouseleave",this.startOnLeave))}},{key:"destroyAutoPlay",value:function(){this.clearAutoPlay();var p=this.carouselWrapperRef;this.props.stopOnHover&&p&&(p.removeEventListener("mouseenter",this.stopOnHover),p.removeEventListener("mouseleave",this.startOnLeave))}},{key:"bindEvents",value:function(){(0,Pf.default)().addEventListener("resize",this.updateSizes),(0,Pf.default)().addEventListener("DOMContentLoaded",this.updateSizes),this.props.useKeyboardArrows&&(0,Ef.default)().addEventListener("keydown",this.navigateWithKeyboard)}},{key:"unbindEvents",value:function(){(0,Pf.default)().removeEventListener("resize",this.updateSizes),(0,Pf.default)().removeEventListener("DOMContentLoaded",this.updateSizes);var p=this.getInitialImage();p&&p.removeEventListener("load",this.setMountState),this.props.useKeyboardArrows&&(0,Ef.default)().removeEventListener("keydown",this.navigateWithKeyboard)}},{key:"forceFocus",value:function(){var p;(p=this.carouselWrapperRef)===null||p===void 0||p.focus()}},{key:"renderItems",value:function(p){var m=this;return this.props.children?Jr.Children.map(this.props.children,function(o,_){var b=_===m.state.selectedItem,E=_===m.state.previousItem,T=b&&m.state.selectedStyle||E&&m.state.prevStyle||m.state.slideStyle||{};m.props.centerMode&&m.props.axis==="horizontal"&&(T=Xa(Xa({},T),{},{minWidth:m.props.centerSlidePercentage+"%"})),m.state.swiping&&m.state.swipeMovementStarted&&(T=Xa(Xa({},T),{},{pointerEvents:"none"}));var M={ref:function(N){return m.setItemsRef(N,_)},key:"itemKey"+_+(p?"clone":""),className:ds.default.ITEM(!0,_===m.state.selectedItem,_===m.state.previousItem),onClick:m.handleClickItem.bind(m,_,o),style:T};return Jr.default.createElement("li",M,m.props.renderItem(o,{isSelected:_===m.state.selectedItem,isPrevious:_===m.state.previousItem}))}):[]}},{key:"renderControls",value:function(){var p=this,m=this.props,o=m.showIndicators,_=m.labels,b=m.renderIndicator,E=m.children;return o?Jr.default.createElement("ul",{className:"control-dots"},Jr.Children.map(E,function(T,M){return b&&b(p.changeItem(M),M===p.state.selectedItem,M,_.item)})):null}},{key:"renderStatus",value:function(){return this.props.showStatus?Jr.default.createElement("p",{className:"carousel-status"},this.props.statusFormatter(this.state.selectedItem+1,Jr.Children.count(this.props.children))):null}},{key:"renderThumbs",value:function(){return!this.props.showThumbs||!this.props.children||Jr.Children.count(this.props.children)===0?null:Jr.default.createElement(Yj.default,{ref:this.setThumbsRef,onSelectItem:this.handleClickThumb,selectedItem:this.state.selectedItem,transitionTime:this.props.transitionTime,thumbWidth:this.props.thumbWidth,labels:this.props.labels,emulateTouch:this.props.emulateTouch},this.props.renderThumbs(this.props.children))}},{key:"render",value:function(){var p=this;if(!this.props.children||Jr.Children.count(this.props.children)===0)return null;var m=this.props.swipeable&&Jr.Children.count(this.props.children)>1,o=this.props.axis==="horizontal",_=this.props.showArrows&&Jr.Children.count(this.props.children)>1,b=_&&(this.state.selectedItem>0||this.props.infiniteLoop)||!1,E=_&&(this.state.selectedItem<Jr.Children.count(this.props.children)-1||this.props.infiniteLoop)||!1,T=this.renderItems(!0),M=T.shift(),I=T.pop(),N={className:ds.default.SLIDER(!0,this.state.swiping),onSwipeMove:this.onSwipeMove,onSwipeStart:this.onSwipeStart,onSwipeEnd:this.onSwipeEnd,style:this.state.itemListStyle,tolerance:this.props.swipeScrollTolerance},D={};if(o){if(N.onSwipeLeft=this.onSwipeForward,N.onSwipeRight=this.onSwipeBackwards,this.props.dynamicHeight){var re=this.getVariableItemHeight(this.state.selectedItem);D.height=re||"auto"}}else N.onSwipeUp=this.props.verticalSwipe==="natural"?this.onSwipeBackwards:this.onSwipeForward,N.onSwipeDown=this.props.verticalSwipe==="natural"?this.onSwipeForward:this.onSwipeBackwards,N.style=Xa(Xa({},N.style),{},{height:this.state.itemSize}),D.height=this.state.itemSize;return Jr.default.createElement("div",{"aria-label":this.props.ariaLabel,className:ds.default.ROOT(this.props.className),ref:this.setCarouselWrapperRef,tabIndex:this.props.useKeyboardArrows?0:void 0},Jr.default.createElement("div",{className:ds.default.CAROUSEL(!0),style:{width:this.props.width}},this.renderControls(),this.props.renderArrowPrev(this.onClickPrev,b,this.props.labels.leftArrow),Jr.default.createElement("div",{className:ds.default.WRAPPER(!0,this.props.axis),style:D},m?Jr.default.createElement(Kj.default,qg({tagName:"ul",innerRef:this.setListRef},N,{allowMouseEvents:this.props.emulateTouch}),this.props.infiniteLoop&&I,this.renderItems(),this.props.infiniteLoop&&M):Jr.default.createElement("ul",{className:ds.default.SLIDER(!0,this.state.swiping),ref:function(ee){return p.setListRef(ee)},style:this.state.itemListStyle||{}},this.props.infiniteLoop&&I,this.renderItems(),this.props.infiniteLoop&&M)),this.props.renderArrowNext(this.onClickNext,E,this.props.labels.rightArrow),this.renderStatus()),this.renderThumbs())}}]),i}(Jr.default.Component);fm.default=i_;xr(i_,"displayName","Carousel");xr(i_,"defaultProps",{ariaLabel:void 0,axis:"horizontal",centerSlidePercentage:80,interval:3e3,labels:{leftArrow:"previous slide / item",rightArrow:"next slide / item",item:"slide item"},onClickItem:oh.noop,onClickThumb:oh.noop,onChange:oh.noop,onSwipeStart:function(){},onSwipeEnd:function(){},onSwipeMove:function(){return!1},preventMovementUntilSwipeScrollTolerance:!1,renderArrowPrev:function(t,i,u){return Jr.default.createElement("button",{type:"button","aria-label":u,className:ds.default.ARROW_PREV(!i),onClick:t})},renderArrowNext:function(t,i,u){return Jr.default.createElement("button",{type:"button","aria-label":u,className:ds.default.ARROW_NEXT(!i),onClick:t})},renderIndicator:function(t,i,u,p){return Jr.default.createElement("li",{className:ds.default.DOT(i),onClick:t,onKeyDown:t,value:u,key:u,role:"button",tabIndex:0,"aria-label":"".concat(p," ").concat(u+1)})},renderItem:function(t){return t},renderThumbs:function(t){var i=Jr.Children.map(t,function(u){var p=u;if(u.type!=="img"&&(p=Jr.Children.toArray(u.props.children).find(function(m){return m.type==="img"})),!!p)return p});return i.filter(function(u){return u}).length===0?(console.warn("No images found! Can't build the thumb list without images. If you don't need thumbs, set showThumbs={false} in the Carousel. Note that it's not possible to get images rendered inside custom components. More info at https://github.com/leandrowd/react-responsive-carousel/blob/master/TROUBLESHOOTING.md"),[]):i},statusFormatter:oh.defaultStatusFormatter,selectedItem:0,showArrows:!0,showIndicators:!0,showStatus:!0,showThumbs:!0,stopOnHover:!0,swipeScrollTolerance:5,swipeable:!0,transitionTime:350,verticalSwipe:"standard",width:"100%",animationHandler:"slide",swipeAnimationHandler:Kf.slideSwipeAnimationHandler,stopSwipingHandler:Kf.slideStopSwipingHandler});var oN={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Carousel",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"CarouselProps",{enumerable:!0,get:function(){return i.CarouselProps}}),Object.defineProperty(n,"Thumbs",{enumerable:!0,get:function(){return u.default}});var t=p(fm),i=oN,u=p(Rh);function p(m){return m&&m.__esModule?m:{default:m}}})(ZE);const sN=n=>({container:{borderBottom:`1px solid ${Ue.white10}`,paddingTop:8,display:"flex",flexDirection:"column",minHeight:64,justifyContent:"center"},row:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4,[n.breakpoints.down("xs")]:{marginBottom:8}},columnGap:{columnGap:n.spacing.unit*4},bold:{fontWeight:600},button:{backgroundColor:Ue.white,color:Ue.grey900,textTransform:"none",minHeight:"unset","&:hover":{background:"#ddd",color:Ue.grey900},"&:disabled":{background:"#ddd",color:Ue.grey900},"&:disabled:hover":{background:"#ddd",color:Ue.grey900}},buttonOffline:{background:Ue.grey400,color:Ue.lightGrey600,"&:disabled":{background:Ue.grey400,color:Ue.lightGrey600},"&:disabled:hover":{background:Ue.grey400,color:Ue.lightGrey600}},buttonRow:{justifyContent:"center"},spaceAround:{display:"flex",justifyContent:"space-around"},deviceStatContainer:{display:"flex",flex:1,justifySelf:"start"},deviceStat:{display:"flex",flexDirection:"column",alignItems:"center",maxWidth:80,padding:`0 ${n.spacing.unit*4}px`},carBattery:{padding:"5px 16px",borderRadius:15,margin:"0 10px",textAlign:"center","& p":{fontSize:14,fontWeight:500,lineHeight:"1.4em"}},actionButton:{minWidth:130,padding:"5px 16px",borderRadius:15},actionButtonSmall:{minWidth:90,padding:"5px 10px",borderRadius:15},snapshotContainer:{borderBottom:`1px solid ${Ue.white10}`},snapshotContainerLarge:{maxWidth:1050,margin:"0 auto",display:"flex"},snapshotImageContainerLarge:{width:"50%",display:"flex",justifyContent:"center"},snapshotImage:{display:"block",width:"450px !important",maxWidth:"100%"},snapshotImageError:{width:450,maxWidth:"100%",backgroundColor:Ue.grey950,padding:"0 80px",margin:"0 auto",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center","& p":{textAlign:"center",fontSize:"1rem","&:first-child":{fontWeight:600}}},buttonIcon:{fontSize:20,marginLeft:n.spacing.unit},popover:{borderRadius:22,padding:"8px 16px",border:`1px solid ${Ue.white10}`,backgroundColor:Ue.grey800,fontSize:12,marginTop:5,textAlign:"center"}});class lN extends me.Component{constructor(t){super(t),this.mounted=null,this.state={deviceStats:{},carHealth:{},snapshot:{},windowWidth:window.innerWidth},this.snapshotButtonRef=Xi.createRef(),this.onResize=this.onResize.bind(this),this.onVisible=this.onVisible.bind(this),this.fetchDeviceInfo=this.fetchDeviceInfo.bind(this),this.fetchDeviceCarHealth=this.fetchDeviceCarHealth.bind(this),this.takeSnapshot=this.takeSnapshot.bind(this),this.snapshotType=this.snapshotType.bind(this),this.renderButtons=this.renderButtons.bind(this),this.renderStats=this.renderStats.bind(this),this.renderSnapshotImage=this.renderSnapshotImage.bind(this)}componentDidMount(){this.mounted=!0}componentDidUpdate(t){const{dongleId:i}=this.props;t.dongleId!==i&&this.setState({deviceStats:{},carHealth:{},snapshot:{},windowWidth:window.innerWidth})}componentWillUnmount(){this.mounted=!1}onResize(t){this.setState({windowWidth:t})}onVisible(){const{device:t}=this.props;t.shared||(this.fetchDeviceInfo(),this.fetchDeviceCarHealth())}async fetchDeviceInfo(){const{dongleId:t,device:i}=this.props;if(!i.shared){this.setState({deviceStats:{fetching:!0}});try{const u=await NC(t);this.mounted&&t===this.props.dongleId&&this.setState({deviceStats:{result:u}})}catch(u){console.error(u),Qr(u,{fingerprint:"device_info_device_stats"}),this.setState({deviceStats:{error:u.message}})}}}async fetchDeviceCarHealth(){const{dongleId:t,device:i}=this.props;if(!Hs(i)){this.setState({carHealth:{}});return}this.setState({carHealth:{fetching:!0}});try{const p=await uh(t,{method:"getMessage",params:{service:"peripheralState",timeout:5e3},jsonrpc:"2.0",id:0});this.mounted&&t===this.props.dongleId&&this.setState({carHealth:p})}catch(u){this.mounted&&t===this.props.dongleId&&((!u.message||u.message.indexOf("Device not registered")===-1)&&(console.error(u),Qr(u,{fingerprint:"device_info_athena_pandastate"})),this.setState({carHealth:{error:u.message}}))}}async takeSnapshot(){const{dongleId:t}=this.props,{snapshot:i}=this.state;this.setState({snapshot:{...i,error:null,fetching:!0}}),this.props.dispatch(xa("take_snapshot"));try{const u={method:"takeSnapshot",jsonrpc:"2.0",id:0};let p=await uh(t,u);if(p.result&&!p.result.jpegBack&&!p.result.jpegFront&&(p=await uh(t,u)),p.result&&!p.result.jpegBack&&!p.result.jpegFront)throw new Error("unable to fetch snapshot");t===this.props.dongleId&&this.setState({snapshot:p})}catch(u){let p=u.message;if(p.indexOf("Device not registered")!==-1)p="device offline";else if(console.error(u),Qr(u,{fingerprint:"device_info_snapshot"}),p.length>5&&p[5]==="{")try{p=JSON.parse(p.substr(5)).error}catch{}this.setState({snapshot:{error:p}})}}snapshotType(t){const{snapshot:i}=this.state;this.setState({snapshot:{...i,showFront:t}})}render(){const{classes:t,device:i}=this.props,{snapshot:u,deviceStats:p,windowWidth:m}=this.state,o=m>520?36:16,_=m>1440?"12px 0":0;return R.jsxs(R.Fragment,{children:[R.jsx(Bc,{onResize:this.onResize}),R.jsx(Th,{onVisible:this.onVisible,onInit:!0,onDongleId:!0,minInterval:60}),R.jsx("div",{className:t.container,style:{paddingLeft:o,paddingRight:o},children:m>=768?R.jsxs("div",{className:`${t.row} ${t.columnGap}`,children:[R.jsx(dt,{variant:"title",children:mg(i)}),R.jsx("div",{className:t.deviceStatContainer,children:this.renderStats()}),R.jsx("div",{className:`${t.row} ${t.buttonRow}`,children:this.renderButtons()})]}):R.jsxs(R.Fragment,{children:[R.jsx("div",{className:t.row,children:R.jsx(dt,{variant:"title",children:mg(i)})}),R.jsx("div",{className:t.row,children:this.renderButtons()}),p.result&&R.jsx("div",{className:`${t.row} ${t.spaceAround}`,children:this.renderStats()})]})}),u.result&&R.jsx("div",{className:t.snapshotContainer,children:m>=640?R.jsxs("div",{className:t.snapshotContainerLarge,style:{padding:_},children:[R.jsx("div",{className:t.snapshotImageContainerLarge,children:this.renderSnapshotImage(u.result.jpegBack,!1)}),R.jsx("div",{className:t.snapshotImageContainerLarge,children:this.renderSnapshotImage(u.result.jpegFront,!0)})]}):R.jsxs(ZE.Carousel,{autoPlay:!1,interval:2147483647,showThumbs:!1,showStatus:!1,showArrows:!1,children:[this.renderSnapshotImage(u.result.jpegBack,!1),this.renderSnapshotImage(u.result.jpegFront,!0)]})})]})}renderStats(){const{classes:t}=this.props,{deviceStats:i}=this.state;if(!i.result)return R.jsxs(R.Fragment,{children:[R.jsx("div",{}),R.jsx("div",{}),R.jsx("div",{})]});const u=yE(),p=Math.round(u?i.result.all.distance*gE:i.result.all.distance);return R.jsxs(R.Fragment,{children:[R.jsxs("div",{className:t.deviceStat,children:[R.jsx(dt,{variant:"subheading",className:t.bold,children:p}),R.jsx(dt,{variant:"subheading",children:u?"kilometers":"miles"})]}),R.jsxs("div",{className:t.deviceStat,children:[R.jsx(dt,{variant:"subheading",className:t.bold,children:i.result.all.routes}),R.jsx(dt,{variant:"subheading",children:"drives"})]}),R.jsxs("div",{className:t.deviceStat,children:[R.jsx(dt,{variant:"subheading",className:t.bold,children:Math.round(i.result.all.minutes/60)}),R.jsx(dt,{variant:"subheading",children:"hours"})]})]})}renderButtons(){const{classes:t,device:i}=this.props,{snapshot:u,carHealth:p,windowWidth:m}=this.state;let o,_=Ue.grey400;Hs(i)&&(p!=null&&p.result)&&p.result.peripheralState&&p.result.peripheralState.voltage&&(o=p.result.peripheralState.voltage/1e3,_=o<11?Ue.red400:Ue.green400);const b=m>=520?t.actionButton:t.actionButtonSmall,E=Hs(i)?"":t.buttonOffline;let T=null;u.error&&u.error.data&&u.error.data.message?T=u.error.data.message:u.error&&u.error.message?T=u.error.message:u.error&&(T="error while fetching snapshot");let M="no ping received from device";if(i.last_athena_ping){const I=ui(i.last_athena_ping*1e3);M=`Last ping on ${I.format("MMM D, YYYY")} at ${I.format("h:mm A")}`}return R.jsxs(R.Fragment,{children:[R.jsx("div",{className:t.carBattery,style:{backgroundColor:_},children:Hs(i)?R.jsx(dt,{children:`${m>=520?"car ":""}battery: ${o?`${o.toFixed(1)} V`:"N/A"}`}):R.jsx(SS,{classes:{tooltip:t.popover},title:M,placement:"bottom",children:R.jsx(dt,{children:"device offline"})})}),R.jsx(an,{ref:this.snapshotButtonRef,classes:{root:`${t.button} ${b} ${E}`},onClick:this.takeSnapshot,disabled:!!(u.fetching||!Hs(i)),children:u.fetching?R.jsx(ha,{size:19}):"take snapshot"}),R.jsx(nm,{className:t.popover,open:!!T,placement:"bottom",anchorEl:this.snapshotButtonRef.current,children:R.jsx(dt,{children:T})})]})}renderSnapshotImage(t,i){const{classes:u}=this.props;return t?R.jsx("img",{src:`data:image/jpeg;base64,${t}`,className:u.snapshotImage}):R.jsxs("div",{className:u.snapshotImageError,children:[R.jsxs(dt,{children:[i&&"Interior"," ","snapshot not available"]}),i&&R.jsx(dt,{children:"Enable “Record and Upload Driver Camera” on your device for interior camera snapshots"})]})}}const uN=pi({dongleId:"dongleId",device:"device"}),cN=Kn(uN)(ci.withStyles(sN)(lN)),pN=me.lazy(()=>ay(()=>import("./index-DvY2LsV0.js"),__vite__mapDeps([0,1,2,3]))),Mw=()=>R.jsx(zf,{container:!0,alignItems:"center",style:{width:"100%",height:"100vh"},children:R.jsx(zf,{item:!0,align:"center",xs:12,children:R.jsx(ha,{size:"10vh",style:{color:"#525E66"}})})}),hN=({primeNav:n,device:t,dongleId:i})=>{var u;return!t||!i?R.jsx(Mw,{}):R.jsx("div",{className:"flex flex-col",children:R.jsx(me.Suspense,{fallback:R.jsx(Mw,{}),children:n?R.jsx(pN,{}):R.jsxs(R.Fragment,{children:[R.jsx(mj,{hasNav:t.prime&&((u=t.eligible_features)==null?void 0:u.nav)}),R.jsx(cN,{}),R.jsx(cz,{})]})})})},dN=pi({dongleId:"dongleId",primeNav:"primeNav",device:"device"}),fN=Kn(dN)(hN),mN=()=>({box:{margin:"0 auto",borderRadius:22,padding:"12px 20px",color:Ue.white,display:"flex",flexDirection:"column",backgroundColor:Ue.grey500,border:`1px solid ${Ue.grey700}`},hide:{cursor:"pointer",padding:5,fontSize:20,position:"relative",left:-30,top:-24,marginBottom:-32,height:32,width:32,borderRadius:16,backgroundColor:Ue.grey900,color:Ue.white,border:`1px solid ${Ue.grey600}`},title:{lineHeight:"31px",fontSize:20,fontWeight:600},icon:{display:"inline",verticalAlign:"text-bottom",margin:"0 3px"}});class vN extends me.Component{constructor(t){super(t),this.state={show:!1},this.hide=this.hide.bind(this),this.onWindowClick=this.onWindowClick.bind(this),this.windowEvents=0}async componentDidMount(){if(window&&window.navigator){const t=/iphone|ipad|ipod/.test(window.navigator.userAgent.toLowerCase()),i=window.navigator.standalone===!0;if(t&&!i&&bs.isAuthenticated()){let u;try{u=await $s.getItem("hideIosPwaPopup")}catch{u=!0}this.setState({show:!u})}}}async componentDidUpdate(t,i){!i.show&&this.state.show?window.addEventListener("click",this.onWindowClick):i.show&&!this.state.show&&window.removeEventListener("click",this.onWindowClick),t.pathname!==this.props.pathname&&this.hide()}componentWillUnmount(){window.removeEventListener("click",this.onWindowClick)}onWindowClick(){this.windowEvents+=1,this.windowEvents>=3&&this.hide()}hide(){try{$s.setItem("hideIosPwaPopup",!0)}catch{}this.setState({show:!1})}render(){const{classes:t}=this.props,{show:i}=this.state;return i?R.jsx("div",{className:"fixed bottom-3 left-3 right-3 z-20",children:R.jsxs("div",{className:`${t.box} xs:w-fit`,children:[R.jsx(hh,{className:t.hide,onClick:this.hide}),R.jsx(dt,{className:t.title,children:"Add to home screen"}),R.jsxs(dt,{children:["Install this webapp on your home screen:"," ",R.jsx("br",{}),"tap"," ",R.jsx("img",{className:t.icon,src:_O,width:35/2.2,height:44/2.2,alt:"share"})," ","and then ‘Add to Home Screen’"]})]})}):null}}const gN=pi({pathname:"router.location.pathname"}),yN=Kn(gN)(ci.withStyles(mN)(vN));class wr{constructor(t,i,u,p,m){this._legacyCanvasSize=wr.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=t,this.$canvas=document.createElement("canvas"),u&&typeof u=="object"?this._onDecode=i:(console.warn(u||p||m?"You're using a deprecated version of the QrScanner constructor which will be removed in the future":"Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=i),i=typeof u=="object"?u:{},this._onDecodeError=i.onDecodeError||(typeof u=="function"?u:this._onDecodeError),this._calculateScanRegion=i.calculateScanRegion||(typeof p=="function"?p:this._calculateScanRegion),this._preferredCamera=i.preferredCamera||m||this._preferredCamera,this._legacyCanvasSize=typeof u=="number"?u:typeof p=="number"?p:this._legacyCanvasSize,this._maxScansPerSecond=i.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),t.disablePictureInPicture=!0,t.playsInline=!0,t.muted=!0;let o=!1;if(t.hidden&&(t.hidden=!1,o=!0),document.body.contains(t)||(document.body.appendChild(t),o=!0),u=t.parentElement,i.highlightScanRegion||i.highlightCodeOutline){if(p=!!i.overlay,this.$overlay=i.overlay||document.createElement("div"),m=this.$overlay.style,m.position="absolute",m.display="none",m.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!p&&i.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch{}u.insertBefore(this.$overlay,this.$video.nextSibling)}i.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(t),requestAnimationFrame(()=>{let _=window.getComputedStyle(t);_.display==="none"&&(t.style.setProperty("display","block","important"),o=!0),_.visibility!=="visible"&&(t.style.setProperty("visibility","visible","important"),o=!0),o&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),t.style.opacity="0",t.style.width="0",t.style.height="0",this.$overlay&&this.$overlay.parentElement&&this.$overlay.parentElement.removeChild(this.$overlay),delete this.$overlay,delete this.$codeOutlineHighlight),this.$overlay&&this._updateOverlay()}),t.addEventListener("play",this._onPlay),t.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=wr.createQrEngine()}static set WORKER_PATH(t){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}static async hasCamera(){try{return!!(await wr.listCameras(!1)).length}catch{return!1}}static async listCameras(t=!1){if(!navigator.mediaDevices)return[];let i=async()=>(await navigator.mediaDevices.enumerateDevices()).filter(p=>p.kind==="videoinput"),u;try{t&&(await i()).every(p=>!p.label)&&(u=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0}))}catch{}try{return(await i()).map((p,m)=>({id:p.deviceId,label:p.label||(m===0?"Default Camera":`Camera ${m+1}`)}))}finally{u&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),wr._stopVideoStream(u))}}async hasFlash(){let t;try{if(this.$video.srcObject){if(!(this.$video.srcObject instanceof MediaStream))return!1;t=this.$video.srcObject}else t=(await this._getCameraStream()).stream;return"torch"in t.getVideoTracks()[0].getSettings()}catch{return!1}finally{t&&t!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),wr._stopVideoStream(t))}}isFlashOn(){return this._flashOn}async toggleFlash(){this._flashOn?await this.turnFlashOff():await this.turnFlashOn()}async turnFlashOn(){if(!this._flashOn&&!this._destroyed&&(this._flashOn=!0,this._active&&!this._paused))try{if(!await this.hasFlash())throw"No flash available";await this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]})}catch(t){throw this._flashOn=!1,t}}async turnFlashOff(){this._flashOn&&(this._flashOn=!1,await this._restartVideoStream())}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),wr._postWorkerMessage(this._qrEnginePromise,"close")}async start(){if(this._destroyed)throw Error("The QR scanner can not be started as it had been destroyed.");if((!this._active||this._paused)&&(window.location.protocol!=="https:"&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,!document.hidden))if(this._paused=!1,this.$video.srcObject)await this.$video.play();else try{let{stream:t,facingMode:i}=await this._getCameraStream();!this._active||this._paused?wr._stopVideoStream(t):(this._setVideoMirror(i),this.$video.srcObject=t,await this.$video.play(),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{})))}catch(t){if(!this._paused)throw this._active=!1,t}}stop(){this.pause(),this._active=!1}async pause(t=!1){if(this._paused=!0,!this._active)return!0;this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none");let i=()=>{this.$video.srcObject instanceof MediaStream&&(wr._stopVideoStream(this.$video.srcObject),this.$video.srcObject=null)};return t?(i(),!0):(await new Promise(u=>setTimeout(u,300)),this._paused?(i(),!0):!1)}async setCamera(t){t!==this._preferredCamera&&(this._preferredCamera=t,await this._restartVideoStream())}static async scanImage(t,i,u,p,m=!1,o=!1){let _,b=!1;i&&("scanRegion"in i||"qrEngine"in i||"canvas"in i||"disallowCanvasResizing"in i||"alsoTryWithoutScanRegion"in i||"returnDetailedScanResult"in i)?(_=i.scanRegion,u=i.qrEngine,p=i.canvas,m=i.disallowCanvasResizing||!1,o=i.alsoTryWithoutScanRegion||!1,b=!0):console.warn(i||u||p||m||o?"You're using a deprecated api for scanImage which will be removed in the future.":"Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),i=!!u;try{let E,T;[u,E]=await Promise.all([u||wr.createQrEngine(),wr._loadImage(t)]),[p,T]=wr._drawToCanvas(E,_,p,m);let M;if(u instanceof Worker){let I=u;i||wr._postWorkerMessageSync(I,"inversionMode","both"),M=await new Promise((N,D)=>{let re,W,ee,J=-1;W=B=>{B.data.id===J&&(I.removeEventListener("message",W),I.removeEventListener("error",ee),clearTimeout(re),B.data.data!==null?N({data:B.data.data,cornerPoints:wr._convertPoints(B.data.cornerPoints,_)}):D(wr.NO_QR_CODE_FOUND))},ee=B=>{I.removeEventListener("message",W),I.removeEventListener("error",ee),clearTimeout(re),D("Scanner error: "+(B?B.message||B:"Unknown Error"))},I.addEventListener("message",W),I.addEventListener("error",ee),re=setTimeout(()=>ee("timeout"),1e4);let Y=T.getImageData(0,0,p.width,p.height);J=wr._postWorkerMessageSync(I,"decode",Y,[Y.data.buffer])})}else M=await Promise.race([new Promise((I,N)=>window.setTimeout(()=>N("Scanner error: timeout"),1e4)),(async()=>{try{var[I]=await u.detect(p);if(!I)throw wr.NO_QR_CODE_FOUND;return{data:I.rawValue,cornerPoints:wr._convertPoints(I.cornerPoints,_)}}catch(N){if(I=N.message||N,/not implemented|service unavailable/.test(I))return wr._disableBarcodeDetector=!0,wr.scanImage(t,{scanRegion:_,canvas:p,disallowCanvasResizing:m,alsoTryWithoutScanRegion:o});throw`Scanner error: ${I}`}})()]);return b?M:M.data}catch(E){if(!_||!o)throw E;let T=await wr.scanImage(t,{qrEngine:u,canvas:p,disallowCanvasResizing:m});return b?T:T.data}finally{i||wr._postWorkerMessage(u,"close")}}setGrayscaleWeights(t,i,u,p=!0){wr._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:t,green:i,blue:u,useIntegerApproximation:p})}setInversionMode(t){wr._postWorkerMessage(this._qrEnginePromise,"inversionMode",t)}static async createQrEngine(t){if(t&&console.warn("Specifying a worker path is not required and not supported anymore."),t=()=>ay(()=>import("./qr-scanner-worker.min-D85Z9gVD.js"),[]).then(u=>u.createWorker()),!(!wr._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats&&(await BarcodeDetector.getSupportedFormats()).includes("qr_code")))return t();let i=navigator.userAgentData;return i&&i.brands.some(({brand:u})=>/Chromium/i.test(u))&&/mac ?OS/i.test(i.platform)&&await i.getHighEntropyValues(["architecture","platformVersion"]).then(({architecture:u,platformVersion:p})=>/arm/i.test(u||"arm")&&13<=parseInt(p||"13")).catch(()=>!0)?t():new BarcodeDetector({formats:["qr_code"]})}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(t){let i=Math.round(.6666666666666666*Math.min(t.videoWidth,t.videoHeight));return{x:Math.round((t.videoWidth-i)/2),y:Math.round((t.videoHeight-i)/2),width:i,height:i,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_updateOverlay(){requestAnimationFrame(()=>{if(this.$overlay){var t=this.$video,i=t.videoWidth,u=t.videoHeight,p=t.offsetWidth,m=t.offsetHeight,o=t.offsetLeft,_=t.offsetTop,b=window.getComputedStyle(t),E=b.objectFit,T=i/u,M=p/m;switch(E){case"none":var I=i,N=u;break;case"fill":I=p,N=m;break;default:(E==="cover"?T>M:T<M)?(N=m,I=N*T):(I=p,N=I/T),E==="scale-down"&&(I=Math.min(I,i),N=Math.min(N,u))}var[D,re]=b.objectPosition.split(" ").map((ee,J)=>{const Y=parseFloat(ee);return ee.endsWith("%")?(J?m-N:p-I)*Y/100:Y});b=this._scanRegion.width||i,M=this._scanRegion.height||u,E=this._scanRegion.x||0;var W=this._scanRegion.y||0;T=this.$overlay.style,T.width=`${b/i*I}px`,T.height=`${M/u*N}px`,T.top=`${_+re+W/u*N}px`,u=/scaleX\(-1\)/.test(t.style.transform),T.left=`${o+(u?p-D-I:D)+(u?i-E-b:E)/i*I}px`,T.transform=t.style.transform}})}static _convertPoints(t,i){if(!i)return t;let u=i.x||0,p=i.y||0,m=i.width&&i.downScaledWidth?i.width/i.downScaledWidth:1;i=i.height&&i.downScaledHeight?i.height/i.downScaledHeight:1;for(let o of t)o.x=o.x*m+u,o.y=o.y*i+p;return t}_scanFrame(){!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)(async()=>{if(!(1>=this.$video.readyState)){var t=Date.now()-this._lastScanTimestamp,i=1e3/this._maxScansPerSecond;t<i&&await new Promise(p=>setTimeout(p,i-t)),this._lastScanTimestamp=Date.now();try{var u=await wr.scanImage(this.$video,{scanRegion:this._scanRegion,qrEngine:this._qrEnginePromise,canvas:this.$canvas})}catch(p){if(!this._active)return;this._onDecodeError(p)}!wr._disableBarcodeDetector||await this._qrEnginePromise instanceof Worker||(this._qrEnginePromise=wr.createQrEngine()),u?(this._onDecode?this._onDecode(u):this._legacyOnDecode&&this._legacyOnDecode(u.data),this.$codeOutlineHighlight&&(clearTimeout(this._codeOutlineHighlightRemovalTimeout),this._codeOutlineHighlightRemovalTimeout=void 0,this.$codeOutlineHighlight.setAttribute("viewBox",`${this._scanRegion.x||0} ${this._scanRegion.y||0} ${this._scanRegion.width||this.$video.videoWidth} ${this._scanRegion.height||this.$video.videoHeight}`),this.$codeOutlineHighlight.firstElementChild.setAttribute("points",u.cornerPoints.map(({x:p,y:m})=>`${p},${m}`).join(" ")),this.$codeOutlineHighlight.style.display="")):this.$codeOutlineHighlight&&!this._codeOutlineHighlightRemovalTimeout&&(this._codeOutlineHighlightRemovalTimeout=setTimeout(()=>this.$codeOutlineHighlight.style.display="none",100))}this._scanFrame()})}_onDecodeError(t){t!==wr.NO_QR_CODE_FOUND&&console.log(t)}async _getCameraStream(){if(!navigator.mediaDevices)throw"Camera not found.";let t=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",i=[{width:{min:1024}},{width:{min:768}},{}],u=i.map(p=>Object.assign({},p,{[t]:{exact:this._preferredCamera}}));for(let p of[...u,...i])try{let m=await navigator.mediaDevices.getUserMedia({video:p,audio:!1}),o=this._getFacingMode(m)||(p.facingMode?this._preferredCamera:this._preferredCamera==="environment"?"user":"environment");return{stream:m,facingMode:o}}catch{}throw"Camera not found."}async _restartVideoStream(){let t=this._paused;await this.pause(!0)&&!t&&this._active&&await this.start()}static _stopVideoStream(t){for(let i of t.getTracks())i.stop(),t.removeTrack(i)}_setVideoMirror(t){this.$video.style.transform="scaleX("+(t==="user"?-1:1)+")"}_getFacingMode(t){return(t=t.getVideoTracks()[0])?/rear|back|environment/i.test(t.label)?"environment":/front|user|face/i.test(t.label)?"user":null:null}static _drawToCanvas(t,i,u,p=!1){u=u||document.createElement("canvas");let m=i&&i.x?i.x:0,o=i&&i.y?i.y:0,_=i&&i.width?i.width:t.videoWidth||t.width,b=i&&i.height?i.height:t.videoHeight||t.height;return p||(p=i&&i.downScaledWidth?i.downScaledWidth:_,i=i&&i.downScaledHeight?i.downScaledHeight:b,u.width!==p&&(u.width=p),u.height!==i&&(u.height=i)),i=u.getContext("2d",{alpha:!1}),i.imageSmoothingEnabled=!1,i.drawImage(t,m,o,_,b,0,0,u.width,u.height),[u,i]}static async _loadImage(t){if(t instanceof Image)return await wr._awaitImageLoad(t),t;if(t instanceof HTMLVideoElement||t instanceof HTMLCanvasElement||t instanceof SVGImageElement||"OffscreenCanvas"in window&&t instanceof OffscreenCanvas||"ImageBitmap"in window&&t instanceof ImageBitmap)return t;if(t instanceof File||t instanceof Blob||t instanceof URL||typeof t=="string"){let i=new Image;i.src=t instanceof File||t instanceof Blob?URL.createObjectURL(t):t.toString();try{return await wr._awaitImageLoad(i),i}finally{(t instanceof File||t instanceof Blob)&&URL.revokeObjectURL(i.src)}}else throw"Unsupported image type."}static async _awaitImageLoad(t){t.complete&&t.naturalWidth!==0||await new Promise((i,u)=>{let p=m=>{t.removeEventListener("load",p),t.removeEventListener("error",p),m instanceof ErrorEvent?u("Image load error"):i()};t.addEventListener("load",p),t.addEventListener("error",p)})}static async _postWorkerMessage(t,i,u,p){return wr._postWorkerMessageSync(await t,i,u,p)}static _postWorkerMessageSync(t,i,u,p){if(!(t instanceof Worker))return-1;let m=wr._workerMessageId++;return t.postMessage({id:m,type:i,data:u},p),m}}wr.DEFAULT_CANVAS_SIZE=400;wr.NO_QR_CODE_FOUND="No QR code found";wr._disableBarcodeDetector=!1;wr._workerMessageId=0;const _N=n=>({titleContainer:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:5},addButton:{width:"100%",background:Ue.white,borderRadius:18,color:Ue.grey900,textTransform:"none","&:hover":{backgroundColor:Ue.white70,color:Ue.grey900}},retryButton:{marginTop:10,background:Ue.white,borderRadius:18,color:Ue.grey900,textTransform:"none","&:hover":{backgroundColor:Ue.white70,color:Ue.grey900}},modal:{position:"absolute",padding:n.spacing.unit*2,width:n.spacing.unit*50,maxWidth:"90%",left:"50%",top:"50%",transform:"translate(-50%, -50%)",outline:"none"},divider:{marginBottom:10},videoContainer:{position:"relative",margin:"0 auto","& video":{display:"block",width:"100%",maxWidth:"100%"}},videoContainerOverlay:{"&::before":{content:"''",position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.8)",top:-1,bottom:-1,right:-1,left:-1,zIndex:3}},videoOverlay:{position:"absolute",zIndex:4,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center","& p":{fontSize:"1rem"}},pairedDongleId:{fontWeight:"bold"},canvas:{position:"absolute",zIndex:2,width:"100%",height:"100%"}});class bN extends me.Component{constructor(t){super(t),this.state={modalOpen:!1,hasCamera:null,pairLoading:!1,pairError:null,pairDongleId:null,canvasWidth:null,canvasHeight:null},this.videoRef=null,this.qrScanner=null,this.componentDidUpdate=this.componentDidUpdate.bind(this),this.onVideoRef=this.onVideoRef.bind(this),this.onCanvasRef=this.onCanvasRef.bind(this),this.modalClose=this.modalClose.bind(this),this.onQrRead=this.onQrRead.bind(this),this.restart=this.restart.bind(this),this.onOpenModal=this.onOpenModal.bind(this)}async componentDidMount(){this.componentDidUpdate({},{})}async componentDidUpdate(){const{modalOpen:t,pairLoading:i,pairError:u,pairDongleId:p}=this.state;let{hasCamera:m}=this.state;if(m===null&&(m=await wr.hasCamera(),this.setState({hasCamera:m})),t&&this.videoRef&&!this.qrScanner&&m&&!p&&(this.videoRef.addEventListener("play",this.componentDidUpdate),this.videoRef.addEventListener("loadeddata",this.componentDidUpdate),this.qrScanner=new wr(this.videoRef,this.onQrRead)),this.canvasRef&&this.videoRef&&this.videoRef.srcObject){const{canvasWidth:o,canvasHeight:_}=this.state,{width:b,height:E}=this.canvasRef.getBoundingClientRect();if(o!==b||_!==E){this.setState({canvasWidth:b,canvasHeight:E});const T=Math.min(b,E),M=(b-T)/2+T/6,I=(E-T)/2+T/6,N=T*(2/3),D=T/6;this.canvasRef.width=b,this.canvasRef.height=E;const re=this.canvasRef.getContext("2d");re.clearRect(0,0,b,E),re.strokeStyle="white",re.beginPath(),re.moveTo(M,I+D),re.lineTo(M,I),re.lineTo(M+D,I),re.stroke(),re.beginPath(),re.moveTo(M+N-D,I),re.lineTo(M+N,I),re.lineTo(M+N,I+D),re.stroke(),re.beginPath(),re.moveTo(M+N,I+N-D),re.lineTo(M+N,I+N),re.lineTo(M+N-D,I+N),re.stroke(),re.beginPath(),re.moveTo(M+D,I+N),re.lineTo(M,I+N),re.lineTo(M,I+N-D),re.stroke()}}if(!i&&!u&&!p&&this.qrScanner&&t&&m)try{await this.qrScanner.start()}catch(o){o==="Camera not found."?this.setState({hasCamera:!1}):console.error(o)}}async componentWillUnmount(){this.videoRef&&(this.videoRef.removeEventListener("play",this.componentDidUpdate),this.videoRef.removeEventListener("loadeddata",this.componentDidUpdate))}async onVideoRef(t){this.videoRef=t,this.componentDidUpdate()}async onCanvasRef(t){this.canvasRef=t,this.componentDidUpdate()}restart(){this.setState({pairLoading:!1,pairError:null,pairDongleId:null}),this.videoRef&&this.videoRef.play(),this.qrScanner&&this.qrScanner.start()}modalClose(){const{pairDongleId:t}=this.state;if(this.qrScanner&&(this.qrScanner._active=!0,this.qrScanner.stop(),this.qrScanner.destroy(),this.qrScanner=null),t&&this.props.devices.length===0){this.props.dispatch(xa("pair_device",{method:"add_device_new"})),window.location=`${window.location.origin}/${t}`;return}this.setState({modalOpen:!1,pairLoading:!1,pairError:null,pairDongleId:null}),t&&this.props.dispatch(Ks(t))}async onQrRead(t){const{pairDongleId:i,pairError:u,pairLoading:p}=this.state;if(p||u||i||!t)return;j0("qr scanned",{extra:{result:t}});const m=t.startsWith("https://");let o;if(m)try{if(o=tm.parse(t.split("?")[1]).pair,!o)throw new Error("empty pairToken from url qr code")}catch(E){this.setState({pairLoading:!1,pairDongleId:null,pairError:"Error: could not parse pair token from detected url"}),console.error(E);return}else try{if(o=t.split("--")[2],!o)throw new Error("empty pairToken from qr code")}catch(E){this.setState({pairLoading:!1,pairDongleId:null,pairError:"Error: invalid QR code detected"}),console.error(E);return}this.videoRef&&this.videoRef.pause(),this.qrScanner&&(this.qrScanner._active=!1),this.setState({pairLoading:!0,pairDongleId:null,pairError:null});try{hS(o,m,"adddevice_verify_pairtoken")}catch(E){this.setState({pairLoading:!1,pairDongleId:null,pairError:`Error: ${E.message}`});return}const{devices:_,dispatch:b}=this.props;try{const E=await dS(o);if(E.dongle_id){const T=await fS(E.dongle_id);_.length>0&&(b(oy(T)),b(xa("pair_device",{method:"add_device_sidebar"}))),this.setState({pairLoading:!1,pairDongleId:E.dongle_id,pairError:null})}else this.setState({pairLoading:!1,pairDongleId:null,pairError:"Error: could not pair"}),j0("qr scan failed",{extra:{resp:E}})}catch(E){const T=mS(E,"adddevice_pair_qr");this.setState({pairLoading:!1,pairDongleId:null,pairError:`Error: ${T}`})}}onOpenModal(){this.setState({modalOpen:!0})}render(){const{classes:t,buttonText:i,buttonStyle:u,buttonIcon:p}=this.props,{modalOpen:m,hasCamera:o,pairLoading:_,pairDongleId:b,pairError:E}=this.state,T=_||b||E?t.videoContainerOverlay:"";return R.jsxs(R.Fragment,{children:[R.jsxs(an,{onClick:this.onOpenModal,className:t.addButton,style:u,children:[i,p&&R.jsx(CE,{style:{color:"rgba(255, 255, 255, 0.3)"}})]}),R.jsx(Mc,{"aria-labelledby":"add-device-modal",open:m,onClose:this.modalClose,children:R.jsxs(Ic,{className:t.modal,children:[R.jsxs("div",{className:t.titleContainer,children:[R.jsx(dt,{variant:"title",children:"Pair device"}),R.jsx(dt,{variant:"caption",children:"scan QR code"})]}),R.jsx(Ja,{className:t.divider}),o===!1?R.jsxs(R.Fragment,{children:[R.jsx(dt,{style:{marginBottom:5},children:"Camera not found, please enable camera access."}),R.jsx(dt,{children:"You can also scan the QR code on your comma device using any other QR code reader application."})]}):R.jsxs("div",{className:`${t.videoContainer} ${T}`,children:[R.jsx("canvas",{className:t.canvas,ref:this.onCanvasRef}),R.jsxs("div",{className:t.videoOverlay,children:[_&&R.jsx(ha,{size:"10vw",style:{color:"#525E66"}}),E&&R.jsxs(R.Fragment,{children:[R.jsx(dt,{children:E}),R.jsx(an,{className:t.retryButton,onClick:this.restart,children:"try again"})]}),b&&R.jsxs(R.Fragment,{children:[R.jsxs(dt,{children:["Successfully paired device ",R.jsx("span",{className:t.pairedDongleId,children:b})]}),R.jsx(an,{className:t.retryButton,onClick:this.modalClose,children:"close"})]})]}),R.jsx("video",{className:t.video,ref:this.onVideoRef})]})]})})]})}}const xN=pi({profile:"profile",devices:"devices"}),YE=Kn(xN)(ci.withStyles(_N)(bN)),a_={qcameras:"qcamera.ts",cameras:"fcamera.hevc",dcameras:"dcamera.hevc",ecameras:"ecamera.hevc",qlogs:"qlog.bz2",logs:"rlog.bz2"},wN=15,SN=5;let vs=null,Tf=0;function Ow(n,t){const[i,u]=t.split("/"),p=Object.entries(a_).find(m=>m[1]===u)[0];return`${n}|${i}/${p}`}async function Dc(n,t,i,u=0){try{for(;Tf>wN;)await N0(2e3);Tf+=1;const p=await uh(n,t);return Tf-=1,p}catch(p){return Tf-=1,!p.resp&&u<SN?(await N0(2e3),Dc(n,t,i,u+1)):p.message&&(p.message.indexOf("Timed out")===-1||p.message.indexOf("Device not registered")===-1)?{offline:!0}:(console.error(p),Qr(p,{fingerprint:i}),{error:p.message})}}function EN(n,t){return async(i,u)=>{const{device:p}=u();if(!sy(p,"0.9.6"))return;await Dc(n,{id:0,jsonrpc:"2.0",method:"setRouteViewed",params:{route:t}},"action_files_set_route_viewed")}}async function Rw(n,t){try{const i=await fO(n,t,7);if(i&&!i.error)return i.map(u=>u.url)}catch(i){console.error(i),Qr(i,{fingerprint:"action_files_upload_geturls"})}return null}function fs(n){return(t,i)=>{const{dongleId:u}=i();t({type:BC,dongleId:u,files:n})}}function JE(n,t=!1){return async i=>{let u;try{u=await dO(n,t)}catch(_){console.error(_),Qr(_,{fingerprint:"action_files_fetch_files"});return}const p=n.split("|")[0],m=n.replace("|","/"),o=Object.keys(a_).filter(_=>u[_]).flatMap(_=>u[_].map(b=>[_,b])).reduce((_,[b,E])=>{const T=parseInt(E.split(m)[1].split("/")[1],10),M=`${n}--${T}/${b}`;return _[M]={url:E},_},{});i({type:FC,dongleId:p,urls:o})}}function Wg(){vs&&(vs!==!0&&clearTimeout(vs),vs=null)}function Jf(n){return async(t,i)=>{if(vs)return;vs=!0,t(UC(n));const p=await Dc(n,{method:"listUploadQueue",jsonrpc:"2.0",id:0},"action_files_athena_uploadqueue");if(!p||!p.result){p&&p.offline&&t(pu(n,0)),Wg();return}t(pu(n,Math.floor(Date.now()/1e3)));const m=i().filesUploading||{},o=VC(i(),n),_={},b={};if(p.result.forEach(E=>{const T=E.url.split("?")[0].split("/"),M=T[T.length-1],I=T[T.length-2],N=T[T.length-3],D=T[T.length-4],re=Object.entries(a_).find(J=>J[1]===M)[0],W=`${D}|${N}--${I}/${re}`,ee=!!(ly(o)&&E.allow_cellular===!1);_[W]={current:E.current,progress:E.progress,paused:ee},b[E.id]={fileName:W,current:E.current,progress:E.progress,createdAt:E.created_at,paused:ee},delete m[E.id]}),i().dongleId===n&&Object.keys(m).length){const E=Object.values(m)[0].fileName.split("--").slice(0,2).join("--");t(JE(E,!0))}t({type:qC,dongleId:n,uploading:b,files:_}),vs===!0&&p.result.length&&(Wg(),vs=setTimeout(()=>{vs=null,t(Jf(n))},2e3))}}function Aw(n,t,i,u){return async(p,m)=>{var b,E;const{device:o}=m();let _=!sy(o,"0.8.13");if(!_){const M={id:0,jsonrpc:"2.0",method:"uploadFilesToUrls",params:{files_data:i.map((N,D)=>({fn:N,url:u[D],headers:{"x-ms-blob-type":"BlockBlob"},allow_cellular:!1}))},expiry:Math.floor(Date.now()/1e3)+86400*7},I=await Dc(n,M,"action_files_athena_uploads");if(I&&I.error&&I.error.code===-32e3&&I.error.data.message==="too many values to unpack (expected 3)")_=!0;else if(!I||I.error){const N=t.reduce((D,re)=>(D[re]={},D),{});p(pu(n,Math.floor(Date.now()/1e3))),p(fs(N))}else if(I.offline)p(pu(n,0));else if(I.result==="Device offline, message queued"){const N=t.reduce((D,re)=>(D[re]={progress:0,current:!1},D),{});p(fs(N))}else if(I.result){if(I.result.failed){const N=I.result.failed.filter(D=>i.indexOf(D)>-1).reduce((D,re)=>{const W=t[i.indexOf(re)];return D[W]={notFound:!0},D},{});p(fs(N))}p(Jf(n))}}if(_)for(let T=0;T<t.length;T++){const M={id:0,jsonrpc:"2.0",method:"uploadFileToUrl",params:[i[T],u[T],{"x-ms-blob-type":"BlockBlob"}],expiry:Math.floor(Date.now()/1e3)+604800},I=await Dc(n,M,"files_actions_athena_upload");if(!I||I.error){const N={};N[t[T]]={},p(pu(n,Math.floor(Date.now()/1e3))),p(fs(N))}else if(I.offline)p(pu(n,0));else if(I.result==="Device offline, message queued"){const N={};N[t[T]]={progress:0,current:!1},p(fs(N))}else if(I.result===404||((E=(b=I==null?void 0:I.result)==null?void 0:b.failed)==null?void 0:E[0])===i[T]){const N={};N[t[T]]={notFound:!0},p(fs(N))}else I.result&&p(Jf(n))}}}function PN(n){return async t=>{let i;try{i=await $C(n)}catch(p){console.error(p),Qr(p,{fingerprint:"action_files_fetch_athena_queue"});return}const u={};for(const p of i)if(!(!p.method||!p.expiry||p.expiry<Math.floor(Date.now()/1e3))){if(p.method==="uploadFileToUrl"){const m=Ow(n,p.params[0]);u[m]={progress:0,current:!1}}else if(p.method==="uploadFilesToUrls")for(const{fn:m}of p.params.files_data){const o=Ow(n,m);u[o]={progress:0,current:!1}}}t(fs(u))}}function kw(n,t){return async i=>{const p=await Dc(n,{id:0,jsonrpc:"2.0",method:"cancelUpload",params:{upload_id:t}},"action_files_athena_canceluploads");if(p&&p.result&&p.result.success){const m=Array.isArray(t)?t:[t];i({type:WC,dongleId:n,ids:m})}else p&&p.offline&&i(pu(n,0))}}const TN=n=>({modal:{position:"absolute",padding:n.spacing.unit*2,width:"max-content",maxWidth:"90%",left:"50%",top:"50%",transform:"translate(-50%, -50%)",outline:"none"},titleContainer:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:5},buttonGroup:{textAlign:"right"},uploadContainer:{margin:`${n.spacing.unit}px 0`,color:Ue.white90,textAlign:"left",overflowY:"auto"},uploadTable:{borderCollapse:"collapse"},uploadCell:{height:25},cancelCell:{textAlign:"center","& button":{minWidth:"unset",padding:0,fontWeight:600,borderRadius:13,minHeight:"unset","&:hover":{backgroundColor:"transparent"},"& svg":{fontSize:18}}},segmentName:{display:"flex",flexWrap:"wrap","& span":{whiteSpace:"nowrap"}},uploadCancelled:{color:Ue.white,margin:1.5},uploadProgress:{display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.8rem","& > div":{width:"80%",height:8,marginRight:6,border:"none",backgroundColor:Ue.white30,"& > div":{backgroundColor:Ue.white80,transition:"transform 0.5s linear"}}},cancelButton:{marginLeft:8,backgroundColor:Ue.grey200,color:Ue.white,"&:hover":{backgroundColor:Ue.grey400}},cellularWarning:{backgroundColor:Ue.grey500,padding:`${n.spacing.unit*1.5}px ${n.spacing.unit*2}px`,borderRadius:4,display:"flex",flexDirection:"column",marginBottom:n.spacing.unit,"& div":{display:"flex",alignItems:"center",marginBottom:2,"& svg":{marginRight:8}}}}),CN={qcameras:"qcamera.ts",cameras:"fcamera.hevc",dcameras:"dcamera.hevc",ecameras:"ecamera.hevc",qlogs:"qlog.bz2",logs:"rlog.bz2"};class IN extends me.Component{constructor(t){super(t),this.state={windowWidth:window.innerWidth,windowHeight:window.innerHeight,cancelQueue:[]},this.cancelUploading=this.cancelUploading.bind(this),this.uploadQueue=this.uploadQueue.bind(this)}componentDidMount(){this.componentDidUpdate({},{})}componentDidUpdate(t){t.update!==this.props.update?this.uploadQueue(this.props.update):this.props.update&&t.device.dongle_id!==this.props.device.dongle_id?this.uploadQueue(!0):this.props.update&&t.filesUploading!==this.props.filesUploading&&this.uploadQueue(!!Object.keys(this.props.filesUploading).length)}componentWillUnmount(){this.uploadQueue(!1)}uploadQueue(t){t?this.props.dispatch(Jf(this.props.device.dongle_id)):Wg()}async cancelUploading(t){const{device:i,dispatch:u,filesUploading:p}=this.props;t===void 0&&(t=Object.keys(p)),t=t.filter(m=>p[m]&&!p[m].current),this.setState(m=>({cancelQueue:m.cancelQueue.concat(t)})),sy(i,"0.8.13")?u(kw(i.dongle_id,t)):t.forEach(m=>u(kw(i.dongle_id,m))),this.uploadQueue(!0)}render(){const{device:t,classes:i,filesUploading:u,filesUploadingMeta:p}=this.props,{cancelQueue:m,windowWidth:o,windowHeight:_}=this.state,b=!Hs(t),E=p.dongleId===t.dongle_id,T=!b&&E&&Object.keys(u).length>0,M=o<600?4:64,I=o<450?{fontSize:o<400?"0.8rem":"0.9rem"}:{},N={padding:o<400?"0 2px":o<450?"0 4px":"0 8px"},D=Object.entries(u);if(D.length&&D[D.length-1][1].current){const W=D.splice([D.length-1],1);D.unshift(W[0])}const re=D.every(W=>W.paused);return R.jsxs(R.Fragment,{children:[R.jsx(Bc,{onResize:(W,ee)=>this.setState({windowWidth:W,windowHeight:ee})}),R.jsx(Mc,{"aria-labelledby":"upload-queue-modal",open:this.props.open,onClose:this.props.onClose,children:R.jsxs(Ic,{className:i.modal,children:[R.jsxs("div",{className:i.titleContainer,children:[R.jsx(dt,{variant:"title",children:"Upload queue"}),R.jsx(dt,{variant:"caption",style:{marginLeft:8},children:t.dongle_id})]}),R.jsx(Ja,{}),R.jsx("div",{className:i.uploadContainer,style:{maxHeight:_*.9-98},children:T?R.jsxs(R.Fragment,{children:[ly(t)&&re&&R.jsxs("div",{className:i.cellularWarning,children:[R.jsxs("div",{children:[R.jsx(wh,{}),"Connect to WiFi"]}),R.jsx("span",{style:{fontSize:"0.8rem"},children:"uploading paused on cellular connection"})]}),R.jsxs("table",{className:i.uploadTable,children:[R.jsx("thead",{children:R.jsxs("tr",{children:[R.jsx("th",{className:i.uploadCell,style:N,children:"segment"}),R.jsx("th",{className:i.uploadCell,style:N,children:"type"}),R.jsx("th",{className:i.uploadCell,style:N,children:"progress"}),o>=600&&R.jsx("th",{className:i.uploadCell,style:N})]})}),R.jsx("tbody",{children:D.map(([W,ee])=>{const J=m.includes(W),[Y,B]=ee.fileName.split("/"),V=ee.progress*100,K=Y.split("|")[1];return R.jsxs("tr",{children:[R.jsx("td",{className:i.uploadCell,style:N,children:R.jsxs("div",{className:i.segmentName,style:I,children:[R.jsx("span",{children:K.substring(0,12)}),R.jsx("span",{children:K.substring(12)})]})}),R.jsx("td",{className:i.uploadCell,style:N,children:CN[B].split(".")[0].substring(0,M)}),ee.current?R.jsx("td",{className:i.uploadCell,style:N,children:R.jsx("div",{className:i.uploadProgress,children:R.jsx(PM,{variant:"determinate",value:V})})}):R.jsxs(R.Fragment,{children:[o>=600&&R.jsx("td",{className:i.uploadCell,style:N,children:ee.paused?"paused":"pending"}),R.jsx("td",{className:`${i.uploadCell} ${i.cancelCell}`,style:N,children:J?R.jsx(ha,{className:i.uploadCancelled,size:15}):R.jsx(an,{onClick:()=>this.cancelUploading([W]),children:R.jsx(kE,{})})})]})]},W)})})]})]}):b?R.jsx("p",{children:"device offline"}):E?R.jsx("p",{children:"no uploads"}):R.jsx(ha,{style:{color:Ue.white,margin:8},size:17})}),R.jsxs("div",{className:i.buttonGroup,children:[R.jsx(an,{variant:"contained",className:i.cancelButton,disabled:!T,onClick:T?()=>this.cancelUploading():null,children:"Cancel All"}),R.jsx(an,{variant:"contained",className:i.cancelButton,onClick:this.props.onClose,children:"Close"})]})]})})]})}}const MN=pi({filesUploading:"filesUploading",filesUploadingMeta:"filesUploadingMeta"}),QE=Kn(MN)(ci.withStyles(TN)(IN)),ON=n=>({modal:{position:"absolute",padding:n.spacing.unit*2,width:n.spacing.unit*50,maxWidth:"90%",left:"50%",top:"40%",transform:"translate(-50%, -50%)",outline:"none"},modalUnpair:{width:n.spacing.unit*45,maxWidth:"80%"},titleContainer:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:5},buttonGroup:{textAlign:"right"},form:{paddingTop:n.spacing.unit,paddingBottom:n.spacing.unit},formRow:{minHeight:75},formRowError:{padding:10,marginBottom:5,backgroundColor:Ue.red500},textField:{maxWidth:"70%"},fabProgress:{position:"absolute",top:0,left:0,zIndex:1},wrapper:{margin:n.spacing.unit,position:"relative",display:"inline-block"},primeManageButton:{marginTop:20,marginRight:20,"&:last-child":{marginRight:0}},topButtonGroup:{display:"flex",justifyContent:"space-between",flexWrap:"wrap-reverse",alignItems:"baseline"},cancelButton:{backgroundColor:Ue.grey200,color:Ue.white,"&:hover":{backgroundColor:Ue.grey400}},unpairError:{marginTop:15,padding:10,display:"flex",alignItems:"center",backgroundColor:"rgba(255, 0, 0, 0.3)","& p":{display:"inline-block",marginLeft:10},color:Ue.white},unpairWarning:{marginTop:15,padding:10,display:"flex",alignItems:"center",backgroundColor:Ue.orange200,"& p":{display:"inline-block",marginLeft:10},color:Ue.white}}),Dw={deviceAlias:"",loadingDeviceAlias:!1,loadingDeviceShare:!1,hasSavedAlias:!1,shareEmail:"",unpairConfirm:!1,unpaired:!1,loadingUnpair:!1,error:null,unpairError:null,uploadModal:!1};class RN extends me.Component{constructor(t){super(t),this.state={...Dw},this.onPrimeSettings=this.onPrimeSettings.bind(this),this.handleAliasChange=this.handleAliasChange.bind(this),this.handleEmailChange=this.handleEmailChange.bind(this),this.callOnEnter=this.callOnEnter.bind(this),this.setDeviceAlias=this.setDeviceAlias.bind(this),this.shareDevice=this.shareDevice.bind(this),this.unpairDevice=this.unpairDevice.bind(this),this.closeUnpair=this.closeUnpair.bind(this)}componentDidUpdate(t){var i;if(t.dongleId!==this.props.dongleId){const u=((i=this.props.device)==null?void 0:i.dongle_id)===this.props.dongleId?this.props.device.alias:"";this.setState({...Dw,deviceAlias:u})}}handleAliasChange(t){this.setState((i,u)=>({deviceAlias:t.target.value,hasSavedAlias:t.target.value===u.device.dongle_id?i.hasSavedAlias:!1}))}handleEmailChange(t){this.setState({shareEmail:t.target.value,hasShared:!1,error:null})}callOnEnter(t,i){i.key==="Enter"&&t()}async setDeviceAlias(){const{dongle_id:t}=this.props.device;if(!this.state.loadingDeviceAlias){this.setState({loadingDeviceAlias:!0,hasSavedAlias:!1});try{const i=await HC(t,this.state.deviceAlias.trim());this.props.dispatch(oy(i)),this.setState({loadingDeviceAlias:!1,hasSavedAlias:!0})}catch(i){Qr(i,{fingerprint:"device_settings_alias"}),this.setState({error:i.message,loadingDeviceAlias:!1})}}}async shareDevice(){if(!this.state.loadingDeviceShare){this.setState({loadingDeviceShare:!0,hasShared:!1});try{await ZC(this.props.dongleId,this.state.shareEmail.trim()),this.setState({loadingDeviceShare:!1,shareEmail:"",hasShared:!0,error:null})}catch(t){t.resp&&t.resp.status===404?this.setState({error:"could not find user",loadingDeviceShare:!1}):(console.error(t),Qr(t,{fingerprint:"device_settings_share"}),this.setState({error:"unable to share",loadingDeviceShare:!1}))}}}onPrimeSettings(){let t=null;const i=()=>{t&&clearInterval(t),this.props.dispatch(pS(!0)),this.props.onClose()};this.props.dongleId!==this.props.globalDongleId?(this.props.dispatch(Ks(this.props.dongleId)),t=setInterval(()=>{this.props.dongleId===this.props.globalDongleId&&i()},100)):i()}async unpairDevice(){this.setState({loadingUnpair:!0});try{const t=await GC(this.props.device.dongle_id);t.success?this.setState({loadingUnpair:!1,unpaired:!0}):t.error?this.setState({loadingUnpair:!1,unpaired:!1,unpairError:t.error}):this.setState({loadingUnpair:!1,unpaired:!1,unpairError:"Could not successfully unpair"})}catch(t){Qr(t,{fingerprint:"device_settings_unpair"}),console.error(t),this.setState({loadingUnpair:!1,unpaired:!1,unpairError:"Unable to unpair"})}}closeUnpair(){this.state.unpaired?window.location=window.location.origin:this.setState({unpairConfirm:!1})}render(){const{classes:t,device:i}=this.props;return i?R.jsxs(R.Fragment,{children:[R.jsx(Mc,{"aria-labelledby":"device-settings-modal","aria-describedby":"device-settings-modal-description",open:this.props.isOpen,onClose:this.props.onClose,children:R.jsxs(Ic,{className:t.modal,children:[R.jsxs("div",{className:t.titleContainer,children:[R.jsx(dt,{variant:"title",children:"Device settings"}),R.jsx(dt,{variant:"caption",children:i.dongle_id})]}),R.jsx(Ja,{}),R.jsxs("div",{children:[R.jsx(an,{variant:"outlined",className:t.primeManageButton,onClick:this.onPrimeSettings,children:"Prime settings"}),R.jsx(an,{variant:"outlined",className:t.primeManageButton,onClick:()=>this.setState({unpairConfirm:!0}),children:"Unpair"})]}),R.jsx("div",{children:R.jsx(an,{variant:"outlined",className:t.primeManageButton,onClick:()=>this.setState({uploadModal:!0}),children:"Uploads"})}),R.jsxs("div",{className:t.form,children:[this.state.error&&R.jsx("div",{className:t.formRowError,children:R.jsx(dt,{children:this.state.error})}),R.jsxs("div",{className:t.formRow,children:[R.jsx(gg,{id:"device_alias",label:"Device name",className:t.textField,value:this.state.deviceAlias?this.state.deviceAlias:"",onChange:this.handleAliasChange,onKeyPress:u=>this.callOnEnter(this.setDeviceAlias,u)}),(this.props.device.alias!==this.state.deviceAlias||this.state.hasSavedAlias)&&R.jsxs("div",{className:t.wrapper,children:[R.jsx(Da,{variant:"fab",onClick:this.setDeviceAlias,children:this.state.hasSavedAlias?R.jsx(Fg,{}):R.jsx(BE,{})}),this.state.loadingDeviceAlias&&R.jsx(ha,{size:48,className:t.fabProgress})]})]}),R.jsxs("div",{className:t.formRow,children:[R.jsx(gg,{id:"device_share",label:"Share by email or user id",className:t.textField,value:this.state.shareEmail,onChange:this.handleEmailChange,variant:"outlined",onKeyPress:u=>this.callOnEnter(this.shareDevice,u),helperText:"give another user read access to this device"}),(this.state.shareEmail.length>0||this.state.hasShared)&&R.jsxs("div",{className:t.wrapper,children:[R.jsx(Da,{variant:"fab",onClick:this.shareDevice,children:this.state.hasShared?R.jsx(Fg,{}):R.jsx(e_,{})}),this.state.loadingDeviceShare&&R.jsx(ha,{size:48,className:t.fabProgress})]})]})]}),R.jsx("div",{className:t.buttonGroup,children:R.jsx(an,{variant:"contained",className:t.cancelButton,onClick:this.props.onClose,children:"Close"})})]})}),R.jsx(Mc,{"aria-labelledby":"device-settings-modal","aria-describedby":"device-settings-modal-description",open:this.state.unpairConfirm,onClose:this.closeUnpair,children:R.jsxs(Ic,{className:`${t.modal} ${t.modalUnpair}`,children:[R.jsxs("div",{className:t.titleContainer,children:[R.jsx(dt,{variant:"title",children:"Unpair device"}),R.jsx(dt,{variant:"caption",children:i.dongle_id})]}),R.jsx(Ja,{}),this.state.unpairError&&R.jsxs("div",{className:t.unpairError,children:[R.jsx(uy,{}),R.jsx(dt,{children:this.state.unpairError})]}),this.props.device.prime&&R.jsxs("div",{className:t.unpairWarning,children:[R.jsx(wh,{}),R.jsx(dt,{children:"Unpairing will also cancel the comma prime subscription for this device."})]}),R.jsxs("div",{className:t.topButtonGroup,children:[R.jsx(an,{variant:"contained",className:`${t.primeManageButton} ${t.cancelButton}`,onClick:this.closeUnpair,children:this.state.unpaired?"Close":"Cancel"}),this.state.unpaired?R.jsx(dt,{variant:"body2",children:"Unpaired"}):R.jsx(an,{variant:"outlined",className:t.primeManageButton,onClick:this.unpairDevice,disabled:this.state.loadingUnpair,children:this.state.loadingUnpair?"Unpairing...":"Confirm"})]})]})}),R.jsx(QE,{open:this.state.uploadModal,update:this.state.uploadModal,onClose:()=>this.setState({uploadModal:!1}),device:i})]}):null}}const AN=(n,t)=>{const i=n.devices.find(u=>u.dongle_id===t.dongleId)||(n.device&&n.device.dongle_id===t.dongleId?n.device:null);return{subscription:n.subscription,device:i,globalDongleId:n.dongleId}},kN=Kn(AN)(ci.withStyles(ON)(RN)),DN=n=>({deviceList:{overflow:"auto"},device:{textDecoration:"none",alignItems:"center",display:"flex",justifyContent:"space-between",padding:"16px 32px","&.isSelected":{backgroundColor:"rgba(0, 0, 0, 0.25)"}},settingsButton:{height:46,width:46,color:Ue.white30,transition:"color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms","&:hover":{color:Ue.white}},deviceOnline:{width:6,height:6,borderRadius:3,backgroundColor:Ue.green400},deviceOffline:{backgroundColor:Ue.grey400},deviceInfo:{display:"flex",alignItems:"center"},deviceName:{display:"flex",flexDirection:"column",justifyContent:"center",marginLeft:16},deviceAlias:{fontWeight:600},deviceId:{color:"#74838e"},editDeviceIcon:{color:"white","&:hover":{color:n.palette.grey[100]}},nameField:{marginRight:n.spacing.unit},saveButton:{marginRight:n.spacing.unit},textField:{marginBottom:n.spacing.unit},addDeviceContainer:{"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.25)"}}});class LN extends me.Component{constructor(t){super(t),this.state={settingsModalDongleId:null},this.renderDevice=this.renderDevice.bind(this),this.handleOpenedSettingsModal=this.handleOpenedSettingsModal.bind(this),this.handleClosedSettingsModal=this.handleClosedSettingsModal.bind(this),this.onVisible=this.onVisible.bind(this)}handleOpenedSettingsModal(t,i){i.stopPropagation(),i.preventDefault(),this.setState({settingsModalDongleId:t})}handleClosedSettingsModal(){this.setState({settingsModalDongleId:null})}async onVisible(){const{dispatch:t}=this.props;if(bs.isAuthenticated())try{const i=await vS();t(XC(i))}catch(i){console.error(i),Qr(i,{fingerprint:"devicelist_visible_listdevices"})}}renderDevice(t){const{classes:i,handleDeviceSelected:u,profile:p,selectedDevice:m}=this.props,o=m===t.dongle_id?"isSelected":"",_=Hs(t)?"":i.deviceOffline;return R.jsxs("a",{className:`${i.device} ${o}`,onClick:mh(()=>u(t.dongle_id)),href:`/${t.dongle_id}`,children:[R.jsxs("div",{className:i.deviceInfo,children:[R.jsx("div",{className:`${i.deviceOnline} ${_}`,children:" "}),R.jsxs("div",{className:i.deviceName,children:[R.jsx(dt,{className:i.deviceAlias,children:mg(t)}),R.jsx(dt,{variant:"caption",className:i.deviceId,children:t.dongle_id})]})]}),(t.is_owner||p&&p.superuser)&&R.jsx(Da,{className:i.settingsButton,"aria-label":"device settings",onClick:b=>this.handleOpenedSettingsModal(t.dongle_id,b),children:R.jsx(qE,{className:i.settingsButtonIcon})})]},t.dongle_id)}render(){const{settingsModalDongleId:t}=this.state,{classes:i,device:u,selectedDevice:p}=this.props;let{devices:m}=this.props;if(m===null)return null;const o=m.some(b=>b.dongle_id===p);!o&&u&&p===u.dongle_id?m=[{...u,alias:B0.alias}].concat(m):!o&&p&&(m=[{...B0,dongle_id:p}].concat(m));const _={borderRadius:"unset",backgroundColor:"transparent",color:"white",fontWeight:600,justifyContent:"space-between",padding:"16px 44px 16px 54px"};return R.jsxs(R.Fragment,{children:[R.jsx(Th,{onVisible:this.onVisible,minInterval:10}),R.jsxs("div",{className:`scrollstyle ${i.deviceList}`,style:{height:"calc(100vh - 64px)"},children:[m.map(this.renderDevice),bs.isAuthenticated()&&R.jsx("div",{className:i.addDeviceContainer,children:R.jsx(YE,{buttonText:"add new device",buttonStyle:_,buttonIcon:!0})})]}),R.jsx(kN,{isOpen:!!t,dongleId:t,onClose:this.handleClosedSettingsModal})]})}}const zN=pi({devices:"devices",device:"device",profile:"profile"}),jN=Kn(zN)(ci.withStyles(DN)(LN)),Lw=n=>n.stopPropagation(),NN=({dispatch:n,isPermanent:t,drawerIsOpen:i,selectedDongleId:u,handleDrawerStateChanged:p,width:m})=>{const o=me.useRef(null);me.useEffect(()=>{const E=o.current;return E&&E.addEventListener("touchstart",Lw),()=>{E&&E.removeEventListener("touchstart",Lw)}},[o]);const _=me.useCallback(()=>{p(!1)},[p]),b=me.useCallback(E=>{n(Ks(E)),_()},[n,_]);return R.jsx(hM,{open:t||i,onClose:_,variant:t?"permanent":"temporary",PaperProps:{style:{width:m,top:"auto"}},children:R.jsxs("div",{ref:o,className:"flex flex-col h-full bg-[linear-gradient(180deg,#1B2023_0%,#111516_100%)]",children:[!t&&R.jsxs(aO,{to:"/",className:"flex items-center min-h-[64px] mx-2",children:[R.jsx("img",{alt:"comma",src:"/images/comma-white.png",className:"w-[18.9px] mx-6"}),R.jsx("span",{className:"text-xl font-extrabold",children:"connect"})]}),R.jsx(jN,{selectedDevice:u,handleDeviceSelected:b})]})})},BN=pi({selectedDongleId:"dongleId",device:"device"}),FN=Kn(BN)(NN),UN=()=>({root:{position:"absolute",zIndex:5050,top:-48,left:"calc(50% - 24px)",display:"flex",alignItems:"center",justifyContent:"center",width:48,height:48,backgroundColor:Ue.grey100,borderRadius:24}});class VN extends me.Component{constructor(t){super(t),this.state={startY:null,reloading:!1},this.dragEl=Xi.createRef(null),this.touchStart=this.touchStart.bind(this),this.touchMove=this.touchMove.bind(this),this.touchEnd=this.touchEnd.bind(this)}async componentDidMount(){if(window&&window.navigator){const t=/iphone|ipad|ipod/.test(window.navigator.userAgent.toLowerCase()),i=window.navigator.standalone===!0;t&&i&&(document.addEventListener("touchstart",this.touchStart,{passive:!1}),document.addEventListener("touchmove",this.touchMove,{passive:!1}),document.addEventListener("touchend",this.touchEnd,{passive:!1}))}}componentWillUnmount(){document.removeEventListener("touchstart",this.touchStart),document.removeEventListener("touchmove",this.touchMove),document.removeEventListener("touchend",this.touchEnd)}touchStart(t){document.scrollingElement.scrollTop!==0||t.defaultPrevented||this.setState({startY:t.touches[0].pageY})}touchMove(t){const{startY:i}=this.state,{current:u}=this.dragEl;if(i===null||!u)return;const p=Math.min((t.touches[0].pageY-i)/2-48,32);u.style.transition="unset",u.style.top=`${p}px`,t.touches[0].pageY-i>0?t.preventDefault():(this.setState({startY:null}),u.style.transition="top 0.1s",u.style.top="-48px")}touchEnd(){const{reloading:t,startY:i}=this.state,{current:u}=this.dragEl;if(i===null||!u)return;parseInt(u.style.top.substring(0,u.style.top.length-2),10)>=32&&!t?(this.setState({reloading:!0}),window.location.reload()):(this.setState({startY:null}),u.style.transition="top 0.1s",u.style.top="-48px")}render(){const{classes:t}=this.props;return R.jsx("div",{className:t.root,ref:this.dragEl,children:R.jsx(jE,{})})}}const qN=ci.withStyles(UN)(VN),$N="commaexplorer@gmail.com",WN="8ca5365277ebc093",HN=7857,ZN=!1,GN=1542645991,XN=!1,KN=!1,YN="commaexplorer",JN={email:$N,id:WN,points:HN,prime:ZN,regdate:GN,superuser:XN,upload_video:KN,username:YN};async function QN(){if(bs.isAuthenticated())try{return await sO()}catch(n){n.resp&&n.resp.status===401?await bs.logOut():(console.error(n),Qr(n,{fingerprint:"init_api_get_profile"}))}else if(Nf())return JN;return null}async function eB(){let n=[];if(Nf()&&(n=n.concat(eI)),bs.isAuthenticated())try{n=n.concat(await vS())}catch(t){(!t.resp||t.resp.status!==401)&&(console.error(t),Qr(t,{fingerprint:"init_api_list_devices"}))}return n}function tB(){return async(n,t)=>{let i=t();i.dongleId&&n(tS());const[u,p]=await Promise.all([QN(),eB()]);if(i=t(),u&&KC({id:u.id}),p.length>0){if(!i.dongleId){const _=window.localStorage.getItem("selectedDongleId");_&&p.find(b=>b.dongle_id===_)?n(Ks(_)):n(Ks(p[0].dongle_id))}const m=i.dongleId||p[0].dongle_id||null,o=p.find(_=>_.dongle_id===m);o?n(YC(m,o,u)):m&&n(JC(m))}n({type:QC,profile:u,devices:p})}}const rB=5e3;class nB extends me.Component{constructor(t){super(t),this.state={viewport:{...pE,zoom:14},driveCoordsMin:null,driveCoordsMax:null},this.onRef=this.onRef.bind(this),this.onViewportChange=this.onViewportChange.bind(this),this.initMap=this.initMap.bind(this),this.populateMap=this.populateMap.bind(this),this.posAtOffset=this.posAtOffset.bind(this),this.setPath=this.setPath.bind(this),this.updateMarkerPos=this.updateMarkerPos.bind(this),this.onInteraction=this.onInteraction.bind(this),this.shouldFlyTo=!1,this.isInteracting=!1,this.isInteractingTimeout=null}componentDidMount(){this.mounted=!0,this.componentDidUpdate({},{}),this.updateMarkerPos()}componentDidUpdate(t){var _;const{dispatch:i,currentRoute:u,startTime:p}=this.props,m=((_=t.currentRoute)==null?void 0:_.fullname)||null,o=(u==null?void 0:u.fullname)||null;if(m!==o&&(this.setPath([]),o&&i($L(u))),t.startTime&&t.startTime!==p&&(this.shouldFlyTo=!0),u&&t.currentRoute&&u.driveCoords&&t.currentRoute.driveCoords!==u.driveCoords){this.shouldFlyTo=!1;const b=Object.keys(u.driveCoords);this.setState({driveCoordsMin:Math.min(...b),driveCoordsMax:Math.max(...b)}),this.populateMap()}}componentWillUnmount(){this.mounted=!1}onInteraction(t){(t.isDragging||t.isRotating||t.isZooming)&&(this.shouldFlyTo=!0,this.isInteracting=!0,this.isInteractingTimeout!==null&&clearTimeout(this.isInteractingTimeout),this.isInteractingTimeout=setTimeout(()=>{this.isInteracting=!1},rB))}updateMarkerPos(){if(!this.mounted)return;const t=this.map&&this.map.getMap().getSource("seekPoint");if(t)if(this.props.currentRoute&&this.props.currentRoute.driveCoords){const{offset:i}=this.props.currentRoute,u=this.posAtOffset(Gs()-i);u&&(t.setData({type:"Point",coordinates:u}),this.isInteracting||this.moveViewportTo(u))}else t._data&&t._data.coordinates.length>0&&t.setData({type:"Point",coordinates:[]});xh(this.updateMarkerPos)}moveViewportTo(t){const i={longitude:t[0],latitude:t[1]};this.shouldFlyTo&&(i.transitionDuration=200,i.transitionInterpolator=new Ec,this.shouldFlyTo=!1),this.setState(u=>({viewport:{...u.viewport,...i}}))}async populateMap(){const{currentRoute:t}=this.props;!this.map||!t||!t.driveCoords||this.setPath(Object.values(t.driveCoords))}onRef(t){t&&t.addEventListener("touchstart",i=>i.stopPropagation())}onViewportChange(t){this.setState({viewport:t})}setPath(t){const i=this.map&&this.map.getMap();i&&i.getSource("route").setData({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:t}})}posAtOffset(t){const{currentRoute:i}=this.props;if(!i.driveCoords)return null;const u=Math.floor(t/1e3),p=t%1e3/1e3,m=Math.max(this.state.driveCoordsMin,Math.min(u,this.state.driveCoordsMax)),o=Math.max(this.state.driveCoordsMin,Math.min(u+1,this.state.driveCoordsMax));if(!i.driveCoords[m])return null;const[_,b]=i.driveCoords[m];if(!i.driveCoords[o])return[_,b];const[E,T]=i.driveCoords[o];return[_+(E-_)*p,b+(T-b)*p]}initMap(t){if(!t){this.map=null;return}const i=t.getMap();if(!i){this.map=null;return}i.on("load",()=>{i.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}}}),i.addSource("seekPoint",{type:"geojson",data:{type:"Point",coordinates:[]}});const u={id:"routeLine",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#888","line-width":8}};i.addLayer(u);const p={id:"marker",type:"circle",paint:{"circle-radius":10,"circle-color":"#007cbf"},source:"seekPoint"};i.addLayer(p),this.map=t;const{currentRoute:m}=this.props;if(m!=null&&m.driveCoords){this.shouldFlyTo=!1;const o=Object.keys(m.driveCoords);this.setState({driveCoordsMin:Math.min(...o),driveCoordsMax:Math.max(...o)}),this.populateMap()}})}render(){const{viewport:t}=this.state;return R.jsx("div",{ref:this.onRef,className:"h-full cursor-default [&_div]:h-full [&_div]:w-full [&_div]:min-h-[300px]",children:R.jsx(Ih,{width:"100%",height:"100%",latitude:t.latitude,longitude:t.longitude,zoom:t.zoom,mapStyle:hE,maxPitch:0,mapboxApiAccessToken:Mh,ref:this.initMap,onContextMenu:null,dragRotate:!1,onViewportChange:this.onViewportChange,attributionControl:!1,onInteractionStateChange:this.onInteraction})})}}const iB=pi({offset:"offset",currentRoute:"currentRoute",startTime:"startTime"}),zw=Kn(iB)(nB);var aB=function(t){return oB(t)&&!sB(t)};function oB(n){return!!n&&typeof n=="object"}function sB(n){var t=Object.prototype.toString.call(n);return t==="[object RegExp]"||t==="[object Date]"||cB(n)}var lB=typeof Symbol=="function"&&Symbol.for,uB=lB?Symbol.for("react.element"):60103;function cB(n){return n.$$typeof===uB}function pB(n){return Array.isArray(n)?[]:{}}function Sh(n,t){return t.clone!==!1&&t.isMergeableObject(n)?Lc(pB(n),n,t):n}function hB(n,t,i){return n.concat(t).map(function(u){return Sh(u,i)})}function dB(n,t){if(!t.customMerge)return Lc;var i=t.customMerge(n);return typeof i=="function"?i:Lc}function fB(n){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(n).filter(function(t){return Object.propertyIsEnumerable.call(n,t)}):[]}function jw(n){return Object.keys(n).concat(fB(n))}function eP(n,t){try{return t in n}catch{return!1}}function mB(n,t){return eP(n,t)&&!(Object.hasOwnProperty.call(n,t)&&Object.propertyIsEnumerable.call(n,t))}function vB(n,t,i){var u={};return i.isMergeableObject(n)&&jw(n).forEach(function(p){u[p]=Sh(n[p],i)}),jw(t).forEach(function(p){mB(n,p)||(eP(n,p)&&i.isMergeableObject(t[p])?u[p]=dB(p,i)(n[p],t[p],i):u[p]=Sh(t[p],i))}),u}function Lc(n,t,i){i=i||{},i.arrayMerge=i.arrayMerge||hB,i.isMergeableObject=i.isMergeableObject||aB,i.cloneUnlessOtherwiseSpecified=Sh;var u=Array.isArray(t),p=Array.isArray(n),m=u===p;return m?u?i.arrayMerge(n,t,i):vB(n,t,i):Sh(t,i)}Lc.all=function(t,i){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(u,p){return Lc(u,p,i)},{})};var gB=Lc,tP=gB,Nw=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function yB(n,t){return!!(n===t||Nw(n)&&Nw(t))}function _B(n,t){if(n.length!==t.length)return!1;for(var i=0;i<n.length;i++)if(!yB(n[i],t[i]))return!1;return!0}function bB(n,t){t===void 0&&(t=_B);var i,u=[],p,m=!1;function o(){for(var _=[],b=0;b<arguments.length;b++)_[b]=arguments[b];return m&&i===this&&t(_,u)||(p=n.apply(this,_),m=!0,i=this,u=_),p}return o}const xB=Object.freeze(Object.defineProperty({__proto__:null,default:bB},Symbol.toStringTag,{value:"Module"})),wB=tI(xB);var SB=typeof Element<"u",EB=typeof Map=="function",PB=typeof Set=="function",TB=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function Df(n,t){if(n===t)return!0;if(n&&t&&typeof n=="object"&&typeof t=="object"){if(n.constructor!==t.constructor)return!1;var i,u,p;if(Array.isArray(n)){if(i=n.length,i!=t.length)return!1;for(u=i;u--!==0;)if(!Df(n[u],t[u]))return!1;return!0}var m;if(EB&&n instanceof Map&&t instanceof Map){if(n.size!==t.size)return!1;for(m=n.entries();!(u=m.next()).done;)if(!t.has(u.value[0]))return!1;for(m=n.entries();!(u=m.next()).done;)if(!Df(u.value[1],t.get(u.value[0])))return!1;return!0}if(PB&&n instanceof Set&&t instanceof Set){if(n.size!==t.size)return!1;for(m=n.entries();!(u=m.next()).done;)if(!t.has(u.value[0]))return!1;return!0}if(TB&&ArrayBuffer.isView(n)&&ArrayBuffer.isView(t)){if(i=n.length,i!=t.length)return!1;for(u=i;u--!==0;)if(n[u]!==t[u])return!1;return!0}if(n.constructor===RegExp)return n.source===t.source&&n.flags===t.flags;if(n.valueOf!==Object.prototype.valueOf&&typeof n.valueOf=="function"&&typeof t.valueOf=="function")return n.valueOf()===t.valueOf();if(n.toString!==Object.prototype.toString&&typeof n.toString=="function"&&typeof t.toString=="function")return n.toString()===t.toString();if(p=Object.keys(n),i=p.length,i!==Object.keys(t).length)return!1;for(u=i;u--!==0;)if(!Object.prototype.hasOwnProperty.call(t,p[u]))return!1;if(SB&&n instanceof Element)return!1;for(u=i;u--!==0;)if(!((p[u]==="_owner"||p[u]==="__v"||p[u]==="__o")&&n.$$typeof)&&!Df(n[p[u]],t[p[u]]))return!1;return!0}return n!==n&&t!==t}var rP=function(t,i){try{return Df(t,i)}catch(u){if((u.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw u}},CB=Object.create,ym=Object.defineProperty,IB=Object.getOwnPropertyDescriptor,MB=Object.getOwnPropertyNames,OB=Object.getPrototypeOf,RB=Object.prototype.hasOwnProperty,AB=(n,t)=>{for(var i in t)ym(n,i,{get:t[i],enumerable:!0})},nP=(n,t,i,u)=>{if(t&&typeof t=="object"||typeof t=="function")for(let p of MB(t))!RB.call(n,p)&&p!==i&&ym(n,p,{get:()=>t[p],enumerable:!(u=IB(t,p))||u.enumerable});return n},kB=(n,t,i)=>(i=n!=null?CB(OB(n)):{},nP(!n||!n.__esModule?ym(i,"default",{value:n,enumerable:!0}):i,n)),DB=n=>nP(ym({},"__esModule",{value:!0}),n),iP={};AB(iP,{defaultProps:()=>jB,propTypes:()=>zB});var aP=DB(iP),LB=kB(Cr());const{string:Si,bool:Zi,number:vc,array:pg,oneOfType:rh,shape:ba,object:ji,func:si,node:Bw}=LB.default,zB={url:rh([Si,pg,ji]),playing:Zi,loop:Zi,controls:Zi,volume:vc,muted:Zi,playbackRate:vc,width:rh([Si,vc]),height:rh([Si,vc]),style:ji,progressInterval:vc,playsinline:Zi,pip:Zi,stopOnUnmount:Zi,light:rh([Zi,Si,ji]),playIcon:Bw,previewTabIndex:vc,previewAriaLabel:Si,fallback:Bw,oEmbedUrl:Si,wrapper:rh([Si,si,ba({render:si.isRequired})]),config:ba({soundcloud:ba({options:ji}),youtube:ba({playerVars:ji,embedOptions:ji,onUnstarted:si}),facebook:ba({appId:Si,version:Si,playerId:Si,attributes:ji}),dailymotion:ba({params:ji}),vimeo:ba({playerOptions:ji,title:Si}),mux:ba({attributes:ji,version:Si}),file:ba({attributes:ji,tracks:pg,forceVideo:Zi,forceAudio:Zi,forceHLS:Zi,forceSafariHLS:Zi,forceDisableHls:Zi,forceDASH:Zi,forceFLV:Zi,hlsOptions:ji,hlsVersion:Si,dashVersion:Si,flvVersion:Si}),wistia:ba({options:ji,playerId:Si,customControls:pg}),mixcloud:ba({options:ji}),twitch:ba({options:ji,playerId:Si}),vidyard:ba({options:ji})}),onReady:si,onStart:si,onPlay:si,onPause:si,onBuffer:si,onBufferEnd:si,onEnded:si,onError:si,onDuration:si,onSeek:si,onPlaybackRateChange:si,onPlaybackQualityChange:si,onProgress:si,onClickPreview:si,onEnablePIP:si,onDisablePIP:si},Ei=()=>{},jB={playing:!1,loop:!1,controls:!1,volume:null,muted:!1,playbackRate:1,width:"640px",height:"360px",style:{},progressInterval:1e3,playsinline:!1,pip:!1,stopOnUnmount:!0,light:!1,fallback:null,wrapper:"div",previewTabIndex:0,previewAriaLabel:"",oEmbedUrl:"https://noembed.com/embed?url={url}",config:{soundcloud:{options:{visual:!0,buying:!1,liking:!1,download:!1,sharing:!1,show_comments:!1,show_playcount:!1}},youtube:{playerVars:{playsinline:1,showinfo:0,rel:0,iv_load_policy:3,modestbranding:1},embedOptions:{},onUnstarted:Ei},facebook:{appId:"1309697205772819",version:"v3.3",playerId:null,attributes:{}},dailymotion:{params:{api:1,"endscreen-enable":!1}},vimeo:{playerOptions:{autopause:!1,byline:!1,portrait:!1,title:!1},title:null},mux:{attributes:{},version:"2"},file:{attributes:{},tracks:[],forceVideo:!1,forceAudio:!1,forceHLS:!1,forceDASH:!1,forceFLV:!1,hlsOptions:{},hlsVersion:"1.1.4",dashVersion:"3.1.3",flvVersion:"1.5.0",forceDisableHls:!1},wistia:{options:{},playerId:null,customControls:null},mixcloud:{options:{hide_cover:1}},twitch:{options:{},playerId:null},vidyard:{options:{}}},onReady:Ei,onStart:Ei,onPlay:Ei,onPause:Ei,onBuffer:Ei,onBufferEnd:Ei,onEnded:Ei,onError:Ei,onDuration:Ei,onSeek:Ei,onPlaybackRateChange:Ei,onPlaybackQualityChange:Ei,onProgress:Ei,onClickPreview:Ei,onEnablePIP:Ei,onDisablePIP:Ei};var NB=function(t,i,u){var p=document.head||document.getElementsByTagName("head")[0],m=document.createElement("script");typeof i=="function"&&(u=i,i={}),i=i||{},u=u||function(){},m.type=i.type||"text/javascript",m.charset=i.charset||"utf8",m.async="async"in i?!!i.async:!0,m.src=t,i.attrs&&BB(m,i.attrs),i.text&&(m.text=""+i.text);var o="onload"in m?Fw:FB;o(m,u),m.onload||Fw(m,u),p.appendChild(m)};function BB(n,t){for(var i in t)n.setAttribute(i,t[i])}function Fw(n,t){n.onload=function(){this.onerror=this.onload=null,t(null,n)},n.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),n)}}function FB(n,t){n.onreadystatechange=function(){this.readyState!="complete"&&this.readyState!="loaded"||(this.onreadystatechange=null,t(null,n))}}var UB=Object.create,_m=Object.defineProperty,VB=Object.getOwnPropertyDescriptor,qB=Object.getOwnPropertyNames,$B=Object.getPrototypeOf,WB=Object.prototype.hasOwnProperty,HB=(n,t)=>{for(var i in t)_m(n,i,{get:t[i],enumerable:!0})},oP=(n,t,i,u)=>{if(t&&typeof t=="object"||typeof t=="function")for(let p of qB(t))!WB.call(n,p)&&p!==i&&_m(n,p,{get:()=>t[p],enumerable:!(u=VB(t,p))||u.enumerable});return n},o_=(n,t,i)=>(i=n!=null?UB($B(n)):{},oP(!n||!n.__esModule?_m(i,"default",{value:n,enumerable:!0}):i,n)),ZB=n=>oP(_m({},"__esModule",{value:!0}),n),sP={};HB(sP,{callPlayer:()=>u5,getConfig:()=>s5,getSDK:()=>o5,isBlobUrl:()=>p5,isMediaStream:()=>c5,lazy:()=>YB,omit:()=>l5,parseEndTime:()=>n5,parseStartTime:()=>r5,queryString:()=>a5,randomString:()=>i5,supportsWebKitPresentationMode:()=>h5});var bm=ZB(sP),GB=o_(me),XB=o_(NB),KB=o_(tP);const YB=n=>GB.default.lazy(async()=>{const t=await n();return typeof t.default=="function"?t:t.default}),JB=/[?&#](?:start|t)=([0-9hms]+)/,QB=/[?&#]end=([0-9hms]+)/,Hg=/(\d+)(h|m|s)/g,e5=/^\d+$/;function lP(n,t){if(n instanceof Array)return;const i=n.match(t);if(i){const u=i[1];if(u.match(Hg))return t5(u);if(e5.test(u))return parseInt(u)}}function t5(n){let t=0,i=Hg.exec(n);for(;i!==null;){const[,u,p]=i;p==="h"&&(t+=parseInt(u,10)*60*60),p==="m"&&(t+=parseInt(u,10)*60),p==="s"&&(t+=parseInt(u,10)),i=Hg.exec(n)}return t}function r5(n){return lP(n,JB)}function n5(n){return lP(n,QB)}function i5(){return Math.random().toString(36).substr(2,5)}function a5(n){return Object.keys(n).map(t=>`${t}=${n[t]}`).join("&")}function hg(n){return window[n]?window[n]:window.exports&&window.exports[n]?window.exports[n]:window.module&&window.module.exports&&window.module.exports[n]?window.module.exports[n]:null}const gc={},o5=function(t,i,u=null,p=()=>!0,m=XB.default){const o=hg(i);return o&&p(o)?Promise.resolve(o):new Promise((_,b)=>{if(gc[t]){gc[t].push({resolve:_,reject:b});return}gc[t]=[{resolve:_,reject:b}];const E=T=>{gc[t].forEach(M=>M.resolve(T))};if(u){const T=window[u];window[u]=function(){T&&T(),E(hg(i))}}m(t,T=>{T?(gc[t].forEach(M=>M.reject(T)),gc[t]=null):u||E(hg(i))})})};function s5(n,t){return(0,KB.default)(t.config,n.config)}function l5(n,...t){const i=[].concat(...t),u={},p=Object.keys(n);for(const m of p)i.indexOf(m)===-1&&(u[m]=n[m]);return u}function u5(n,...t){if(!this.player||!this.player[n]){let i=`ReactPlayer: ${this.constructor.displayName} player could not call %c${n}%c – `;return this.player?this.player[n]||(i+="The method was not available"):i+="The player was not available",console.warn(i,"font-weight: bold",""),null}return this.player[n](...t)}function c5(n){return typeof window<"u"&&typeof window.MediaStream<"u"&&n instanceof window.MediaStream}function p5(n){return/^blob:/.test(n)}function h5(n=document.createElement("video")){const t=/iPhone|iPod/.test(navigator.userAgent)===!1;return n.webkitSupportsPresentationMode&&typeof n.webkitSetPresentationMode=="function"&&t}var d5=Object.create,Dh=Object.defineProperty,f5=Object.getOwnPropertyDescriptor,m5=Object.getOwnPropertyNames,v5=Object.getPrototypeOf,g5=Object.prototype.hasOwnProperty,y5=(n,t,i)=>t in n?Dh(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i,_5=(n,t)=>{for(var i in t)Dh(n,i,{get:t[i],enumerable:!0})},uP=(n,t,i,u)=>{if(t&&typeof t=="object"||typeof t=="function")for(let p of m5(t))!g5.call(n,p)&&p!==i&&Dh(n,p,{get:()=>t[p],enumerable:!(u=f5(t,p))||u.enumerable});return n},cP=(n,t,i)=>(i=n!=null?d5(v5(n)):{},uP(!n||!n.__esModule?Dh(i,"default",{value:n,enumerable:!0}):i,n)),b5=n=>uP(Dh({},"__esModule",{value:!0}),n),Xn=(n,t,i)=>(y5(n,typeof t!="symbol"?t+"":t,i),i),pP={};_5(pP,{default:()=>xm});var x5=b5(pP),Uw=cP(me),w5=cP(rP),hP=aP,S5=bm;const E5=5e3;let xm=class extends Uw.Component{constructor(){super(...arguments),Xn(this,"mounted",!1),Xn(this,"isReady",!1),Xn(this,"isPlaying",!1),Xn(this,"isLoading",!0),Xn(this,"loadOnReady",null),Xn(this,"startOnPlay",!0),Xn(this,"seekOnPlay",null),Xn(this,"onDurationCalled",!1),Xn(this,"handlePlayerMount",t=>{if(this.player){this.progress();return}this.player=t,this.player.load(this.props.url),this.progress()}),Xn(this,"getInternalPlayer",t=>this.player?this.player[t]:null),Xn(this,"progress",()=>{if(this.props.url&&this.player&&this.isReady){const t=this.getCurrentTime()||0,i=this.getSecondsLoaded(),u=this.getDuration();if(u){const p={playedSeconds:t,played:t/u};i!==null&&(p.loadedSeconds=i,p.loaded=i/u),(p.playedSeconds!==this.prevPlayed||p.loadedSeconds!==this.prevLoaded)&&this.props.onProgress(p),this.prevPlayed=p.playedSeconds,this.prevLoaded=p.loadedSeconds}}this.progressTimeout=setTimeout(this.progress,this.props.progressFrequency||this.props.progressInterval)}),Xn(this,"handleReady",()=>{if(!this.mounted)return;this.isReady=!0,this.isLoading=!1;const{onReady:t,playing:i,volume:u,muted:p}=this.props;t(),!p&&u!==null&&this.player.setVolume(u),this.loadOnReady?(this.player.load(this.loadOnReady,!0),this.loadOnReady=null):i&&this.player.play(),this.handleDurationCheck()}),Xn(this,"handlePlay",()=>{this.isPlaying=!0,this.isLoading=!1;const{onStart:t,onPlay:i,playbackRate:u}=this.props;this.startOnPlay&&(this.player.setPlaybackRate&&u!==1&&this.player.setPlaybackRate(u),t(),this.startOnPlay=!1),i(),this.seekOnPlay&&(this.seekTo(this.seekOnPlay),this.seekOnPlay=null),this.handleDurationCheck()}),Xn(this,"handlePause",t=>{this.isPlaying=!1,this.isLoading||this.props.onPause(t)}),Xn(this,"handleEnded",()=>{const{activePlayer:t,loop:i,onEnded:u}=this.props;t.loopOnEnded&&i&&this.seekTo(0),i||(this.isPlaying=!1,u())}),Xn(this,"handleError",(...t)=>{this.isLoading=!1,this.props.onError(...t)}),Xn(this,"handleDurationCheck",()=>{clearTimeout(this.durationCheckTimeout);const t=this.getDuration();t?this.onDurationCalled||(this.props.onDuration(t),this.onDurationCalled=!0):this.durationCheckTimeout=setTimeout(this.handleDurationCheck,100)}),Xn(this,"handleLoaded",()=>{this.isLoading=!1})}componentDidMount(){this.mounted=!0}componentWillUnmount(){clearTimeout(this.progressTimeout),clearTimeout(this.durationCheckTimeout),this.isReady&&this.props.stopOnUnmount&&(this.player.stop(),this.player.disablePIP&&this.player.disablePIP()),this.mounted=!1}componentDidUpdate(t){if(!this.player)return;const{url:i,playing:u,volume:p,muted:m,playbackRate:o,pip:_,loop:b,activePlayer:E,disableDeferredLoading:T}=this.props;if(!(0,w5.default)(t.url,i)){if(this.isLoading&&!E.forceLoad&&!T&&!(0,S5.isMediaStream)(i)){console.warn(`ReactPlayer: the attempt to load ${i} is being deferred until the player has loaded`),this.loadOnReady=i;return}this.isLoading=!0,this.startOnPlay=!0,this.onDurationCalled=!1,this.player.load(i,this.isReady)}!t.playing&&u&&!this.isPlaying&&this.player.play(),t.playing&&!u&&this.isPlaying&&this.player.pause(),!t.pip&&_&&this.player.enablePIP&&this.player.enablePIP(),t.pip&&!_&&this.player.disablePIP&&this.player.disablePIP(),t.volume!==p&&p!==null&&this.player.setVolume(p),t.muted!==m&&(m?this.player.mute():(this.player.unmute(),p!==null&&setTimeout(()=>this.player.setVolume(p)))),t.playbackRate!==o&&this.player.setPlaybackRate&&this.player.setPlaybackRate(o),t.loop!==b&&this.player.setLoop&&this.player.setLoop(b)}getDuration(){return this.isReady?this.player.getDuration():null}getCurrentTime(){return this.isReady?this.player.getCurrentTime():null}getSecondsLoaded(){return this.isReady?this.player.getSecondsLoaded():null}seekTo(t,i,u){if(!this.isReady){t!==0&&(this.seekOnPlay=t,setTimeout(()=>{this.seekOnPlay=null},E5));return}if(i?i==="fraction":t>0&&t<1){const m=this.player.getDuration();if(!m){console.warn("ReactPlayer: could not seek using fraction – duration not yet available");return}this.player.seekTo(m*t,u);return}this.player.seekTo(t,u)}render(){const t=this.props.activePlayer;return t?Uw.default.createElement(t,{...this.props,onMount:this.handlePlayerMount,onReady:this.handleReady,onPlay:this.handlePlay,onPause:this.handlePause,onEnded:this.handleEnded,onLoaded:this.handleLoaded,onError:this.handleError}):null}};Xn(xm,"displayName","Player");Xn(xm,"propTypes",hP.propTypes);Xn(xm,"defaultProps",hP.defaultProps);var P5=Object.create,Lh=Object.defineProperty,T5=Object.getOwnPropertyDescriptor,C5=Object.getOwnPropertyNames,I5=Object.getPrototypeOf,M5=Object.prototype.hasOwnProperty,O5=(n,t,i)=>t in n?Lh(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i,R5=(n,t)=>{for(var i in t)Lh(n,i,{get:t[i],enumerable:!0})},dP=(n,t,i,u)=>{if(t&&typeof t=="object"||typeof t=="function")for(let p of C5(t))!M5.call(n,p)&&p!==i&&Lh(n,p,{get:()=>t[p],enumerable:!(u=T5(t,p))||u.enumerable});return n},zh=(n,t,i)=>(i=n!=null?P5(I5(n)):{},dP(!n||!n.__esModule?Lh(i,"default",{value:n,enumerable:!0}):i,n)),A5=n=>dP(Lh({},"__esModule",{value:!0}),n),Gn=(n,t,i)=>(O5(n,typeof t!="symbol"?t+"":t,i),i),fP={};R5(fP,{createReactPlayer:()=>U5});var k5=A5(fP),_c=zh(me),D5=zh(tP),dg=zh(wB),Vw=zh(rP),sh=aP,mP=bm,L5=zh(x5);const z5=(0,mP.lazy)(()=>ay(()=>import("./Preview-CDba-58y.js").then(n=>n.P),__vite__mapDeps([4,1,2]))),j5=typeof window<"u"&&window.document&&typeof document<"u",N5=typeof Sa<"u"&&Sa.window&&Sa.window.document,B5=Object.keys(sh.propTypes),F5=j5||N5?_c.Suspense:()=>null,nh=[],U5=(n,t)=>{var i;return i=class extends _c.Component{constructor(){super(...arguments),Gn(this,"state",{showPreview:!!this.props.light}),Gn(this,"references",{wrapper:u=>{this.wrapper=u},player:u=>{this.player=u}}),Gn(this,"handleClickPreview",u=>{this.setState({showPreview:!1}),this.props.onClickPreview(u)}),Gn(this,"showPreview",()=>{this.setState({showPreview:!0})}),Gn(this,"getDuration",()=>this.player?this.player.getDuration():null),Gn(this,"getCurrentTime",()=>this.player?this.player.getCurrentTime():null),Gn(this,"getSecondsLoaded",()=>this.player?this.player.getSecondsLoaded():null),Gn(this,"getInternalPlayer",(u="player")=>this.player?this.player.getInternalPlayer(u):null),Gn(this,"seekTo",(u,p,m)=>{if(!this.player)return null;this.player.seekTo(u,p,m)}),Gn(this,"handleReady",()=>{this.props.onReady(this)}),Gn(this,"getActivePlayer",(0,dg.default)(u=>{for(const p of[...nh,...n])if(p.canPlay(u))return p;return t||null})),Gn(this,"getConfig",(0,dg.default)((u,p)=>{const{config:m}=this.props;return D5.default.all([sh.defaultProps.config,sh.defaultProps.config[p]||{},m,m[p]||{}])})),Gn(this,"getAttributes",(0,dg.default)(u=>(0,mP.omit)(this.props,B5))),Gn(this,"renderActivePlayer",u=>{if(!u)return null;const p=this.getActivePlayer(u);if(!p)return null;const m=this.getConfig(u,p.key);return _c.default.createElement(L5.default,{...this.props,key:p.key,ref:this.references.player,config:m,activePlayer:p.lazyPlayer||p,onReady:this.handleReady})})}shouldComponentUpdate(u,p){return!(0,Vw.default)(this.props,u)||!(0,Vw.default)(this.state,p)}componentDidUpdate(u){const{light:p}=this.props;!u.light&&p&&this.setState({showPreview:!0}),u.light&&!p&&this.setState({showPreview:!1})}renderPreview(u){if(!u)return null;const{light:p,playIcon:m,previewTabIndex:o,oEmbedUrl:_,previewAriaLabel:b}=this.props;return _c.default.createElement(z5,{url:u,light:p,playIcon:m,previewTabIndex:o,previewAriaLabel:b,oEmbedUrl:_,onClick:this.handleClickPreview})}render(){const{url:u,style:p,width:m,height:o,fallback:_,wrapper:b}=this.props,{showPreview:E}=this.state,T=this.getAttributes(u),M=typeof b=="string"?this.references.wrapper:void 0;return _c.default.createElement(b,{ref:M,style:{...p,width:m,height:o},...T},_c.default.createElement(F5,{fallback:_},E?this.renderPreview(u):this.renderActivePlayer(u)))}},Gn(i,"displayName","ReactPlayer"),Gn(i,"propTypes",sh.propTypes),Gn(i,"defaultProps",sh.defaultProps),Gn(i,"addCustomPlayer",u=>{nh.push(u)}),Gn(i,"removeCustomPlayers",()=>{nh.length=0}),Gn(i,"canPlay",u=>{for(const p of[...nh,...n])if(p.canPlay(u))return!0;return!1}),Gn(i,"canEnablePIP",u=>{for(const p of[...nh,...n])if(p.canEnablePIP&&p.canEnablePIP(u))return!0;return!1}),i};var s_=Object.defineProperty,V5=Object.getOwnPropertyDescriptor,q5=Object.getOwnPropertyNames,$5=Object.prototype.hasOwnProperty,W5=(n,t)=>{for(var i in t)s_(n,i,{get:t[i],enumerable:!0})},H5=(n,t,i,u)=>{if(t&&typeof t=="object"||typeof t=="function")for(let p of q5(t))!$5.call(n,p)&&p!==i&&s_(n,p,{get:()=>t[p],enumerable:!(u=V5(t,p))||u.enumerable});return n},Z5=n=>H5(s_({},"__esModule",{value:!0}),n),vP={};W5(vP,{AUDIO_EXTENSIONS:()=>l_,DASH_EXTENSIONS:()=>OP,FLV_EXTENSIONS:()=>RP,HLS_EXTENSIONS:()=>c_,MATCH_URL_DAILYMOTION:()=>TP,MATCH_URL_FACEBOOK:()=>bP,MATCH_URL_FACEBOOK_WATCH:()=>xP,MATCH_URL_KALTURA:()=>MP,MATCH_URL_MIXCLOUD:()=>CP,MATCH_URL_MUX:()=>_P,MATCH_URL_SOUNDCLOUD:()=>gP,MATCH_URL_STREAMABLE:()=>wP,MATCH_URL_TWITCH_CHANNEL:()=>PP,MATCH_URL_TWITCH_VIDEO:()=>EP,MATCH_URL_VIDYARD:()=>IP,MATCH_URL_VIMEO:()=>yP,MATCH_URL_WISTIA:()=>SP,MATCH_URL_YOUTUBE:()=>Zg,VIDEO_EXTENSIONS:()=>u_,canPlay:()=>X5});var G5=Z5(vP),qw=bm;const Zg=/(?:youtu\.be\/|youtube(?:-nocookie|education)?\.com\/(?:embed\/|v\/|watch\/|watch\?v=|watch\?.+&v=|shorts\/|live\/))((\w|-){11})|youtube\.com\/playlist\?list=|youtube\.com\/user\//,gP=/(?:soundcloud\.com|snd\.sc)\/[^.]+$/,yP=/vimeo\.com\/(?!progressive_redirect).+/,_P=/stream\.mux\.com\/(?!\w+\.m3u8)(\w+)/,bP=/^https?:\/\/(www\.)?facebook\.com.*\/(video(s)?|watch|story)(\.php?|\/).+$/,xP=/^https?:\/\/fb\.watch\/.+$/,wP=/streamable\.com\/([a-z0-9]+)$/,SP=/(?:wistia\.(?:com|net)|wi\.st)\/(?:medias|embed)\/(?:iframe\/)?([^?]+)/,EP=/(?:www\.|go\.)?twitch\.tv\/videos\/(\d+)($|\?)/,PP=/(?:www\.|go\.)?twitch\.tv\/([a-zA-Z0-9_]+)($|\?)/,TP=/^(?:(?:https?):)?(?:\/\/)?(?:www\.)?(?:(?:dailymotion\.com(?:\/embed)?\/video)|dai\.ly)\/([a-zA-Z0-9]+)(?:_[\w_-]+)?(?:[\w.#_-]+)?/,CP=/mixcloud\.com\/([^/]+\/[^/]+)/,IP=/vidyard.com\/(?:watch\/)?([a-zA-Z0-9-_]+)/,MP=/^https?:\/\/[a-zA-Z]+\.kaltura.(com|org)\/p\/([0-9]+)\/sp\/([0-9]+)00\/embedIframeJs\/uiconf_id\/([0-9]+)\/partner_id\/([0-9]+)(.*)entry_id.([a-zA-Z0-9-_].*)$/,l_=/\.(m4a|m4b|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\?)/i,u_=/\.(mp4|og[gv]|webm|mov|m4v)(#t=[,\d+]+)?($|\?)/i,c_=/\.(m3u8)($|\?)/i,OP=/\.(mpd)($|\?)/i,RP=/\.(flv)($|\?)/i,Gg=n=>{if(n instanceof Array){for(const t of n)if(typeof t=="string"&&Gg(t)||Gg(t.src))return!0;return!1}return(0,qw.isMediaStream)(n)||(0,qw.isBlobUrl)(n)?!0:l_.test(n)||u_.test(n)||c_.test(n)||OP.test(n)||RP.test(n)},X5={youtube:n=>n instanceof Array?n.every(t=>Zg.test(t)):Zg.test(n),soundcloud:n=>gP.test(n)&&!l_.test(n),vimeo:n=>yP.test(n)&&!u_.test(n)&&!c_.test(n),mux:n=>_P.test(n),facebook:n=>bP.test(n)||xP.test(n),streamable:n=>wP.test(n),wistia:n=>SP.test(n),twitch:n=>EP.test(n)||PP.test(n),dailymotion:n=>TP.test(n),mixcloud:n=>CP.test(n),vidyard:n=>IP.test(n),kaltura:n=>MP.test(n),file:Gg};var K5=Object.create,jh=Object.defineProperty,Y5=Object.getOwnPropertyDescriptor,J5=Object.getOwnPropertyNames,Q5=Object.getPrototypeOf,e4=Object.prototype.hasOwnProperty,t4=(n,t,i)=>t in n?jh(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i,r4=(n,t)=>{for(var i in t)jh(n,i,{get:t[i],enumerable:!0})},AP=(n,t,i,u)=>{if(t&&typeof t=="object"||typeof t=="function")for(let p of J5(t))!e4.call(n,p)&&p!==i&&jh(n,p,{get:()=>t[p],enumerable:!(u=Y5(t,p))||u.enumerable});return n},n4=(n,t,i)=>(i=n!=null?K5(Q5(n)):{},AP(!n||!n.__esModule?jh(i,"default",{value:n,enumerable:!0}):i,n)),i4=n=>AP(jh({},"__esModule",{value:!0}),n),li=(n,t,i)=>(t4(n,typeof t!="symbol"?t+"":t,i),i),kP={};r4(kP,{default:()=>h_});var a4=i4(kP),ih=n4(me),ps=bm,lh=G5;const p_=typeof navigator<"u",o4=p_&&navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,$w=p_&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||o4)&&!window.MSStream,s4=p_&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&!window.MSStream,l4="https://cdn.jsdelivr.net/npm/hls.js@VERSION/dist/hls.min.js",u4="Hls",c4="https://cdnjs.cloudflare.com/ajax/libs/dashjs/VERSION/dash.all.min.js",p4="dashjs",h4="https://cdn.jsdelivr.net/npm/flv.js@VERSION/dist/flv.min.js",d4="flvjs",f4=/www\.dropbox\.com\/.+/,fg=/https:\/\/watch\.cloudflarestream\.com\/([a-z0-9]+)/,m4="https://videodelivery.net/{id}/manifest/video.m3u8";class h_ extends ih.Component{constructor(){super(...arguments),li(this,"onReady",(...t)=>this.props.onReady(...t)),li(this,"onPlay",(...t)=>this.props.onPlay(...t)),li(this,"onBuffer",(...t)=>this.props.onBuffer(...t)),li(this,"onBufferEnd",(...t)=>this.props.onBufferEnd(...t)),li(this,"onPause",(...t)=>this.props.onPause(...t)),li(this,"onEnded",(...t)=>this.props.onEnded(...t)),li(this,"onError",(...t)=>this.props.onError(...t)),li(this,"onPlayBackRateChange",t=>this.props.onPlaybackRateChange(t.target.playbackRate)),li(this,"onEnablePIP",(...t)=>this.props.onEnablePIP(...t)),li(this,"onDisablePIP",t=>{const{onDisablePIP:i,playing:u}=this.props;i(t),u&&this.play()}),li(this,"onPresentationModeChange",t=>{if(this.player&&(0,ps.supportsWebKitPresentationMode)(this.player)){const{webkitPresentationMode:i}=this.player;i==="picture-in-picture"?this.onEnablePIP(t):i==="inline"&&this.onDisablePIP(t)}}),li(this,"onSeek",t=>{this.props.onSeek(t.target.currentTime)}),li(this,"mute",()=>{this.player.muted=!0}),li(this,"unmute",()=>{this.player.muted=!1}),li(this,"renderSourceElement",(t,i)=>typeof t=="string"?ih.default.createElement("source",{key:i,src:t}):ih.default.createElement("source",{key:i,...t})),li(this,"renderTrack",(t,i)=>ih.default.createElement("track",{key:i,...t})),li(this,"ref",t=>{this.player&&(this.prevPlayer=this.player),this.player=t})}componentDidMount(){this.props.onMount&&this.props.onMount(this),this.addListeners(this.player);const t=this.getSource(this.props.url);t&&(this.player.src=t),($w||this.props.config.forceDisableHls)&&this.player.load()}componentDidUpdate(t){this.shouldUseAudio(this.props)!==this.shouldUseAudio(t)&&(this.removeListeners(this.prevPlayer,t.url),this.addListeners(this.player)),this.props.url!==t.url&&!(0,ps.isMediaStream)(this.props.url)&&!(this.props.url instanceof Array)&&(this.player.srcObject=null)}componentWillUnmount(){this.player.removeAttribute("src"),this.removeListeners(this.player),this.hls&&this.hls.destroy()}addListeners(t){const{url:i,playsinline:u}=this.props;t.addEventListener("play",this.onPlay),t.addEventListener("waiting",this.onBuffer),t.addEventListener("playing",this.onBufferEnd),t.addEventListener("pause",this.onPause),t.addEventListener("seeked",this.onSeek),t.addEventListener("ended",this.onEnded),t.addEventListener("error",this.onError),t.addEventListener("ratechange",this.onPlayBackRateChange),t.addEventListener("enterpictureinpicture",this.onEnablePIP),t.addEventListener("leavepictureinpicture",this.onDisablePIP),t.addEventListener("webkitpresentationmodechanged",this.onPresentationModeChange),this.shouldUseHLS(i)||t.addEventListener("canplay",this.onReady),u&&(t.setAttribute("playsinline",""),t.setAttribute("webkit-playsinline",""),t.setAttribute("x5-playsinline",""))}removeListeners(t,i){t.removeEventListener("canplay",this.onReady),t.removeEventListener("play",this.onPlay),t.removeEventListener("waiting",this.onBuffer),t.removeEventListener("playing",this.onBufferEnd),t.removeEventListener("pause",this.onPause),t.removeEventListener("seeked",this.onSeek),t.removeEventListener("ended",this.onEnded),t.removeEventListener("error",this.onError),t.removeEventListener("ratechange",this.onPlayBackRateChange),t.removeEventListener("enterpictureinpicture",this.onEnablePIP),t.removeEventListener("leavepictureinpicture",this.onDisablePIP),t.removeEventListener("webkitpresentationmodechanged",this.onPresentationModeChange),this.shouldUseHLS(i)||t.removeEventListener("canplay",this.onReady)}shouldUseAudio(t){return t.config.forceVideo||t.config.attributes.poster?!1:lh.AUDIO_EXTENSIONS.test(t.url)||t.config.forceAudio}shouldUseHLS(t){return s4&&this.props.config.forceSafariHLS||this.props.config.forceHLS?!0:$w||this.props.config.forceDisableHls?!1:lh.HLS_EXTENSIONS.test(t)||fg.test(t)}shouldUseDASH(t){return lh.DASH_EXTENSIONS.test(t)||this.props.config.forceDASH}shouldUseFLV(t){return lh.FLV_EXTENSIONS.test(t)||this.props.config.forceFLV}load(t){const{hlsVersion:i,hlsOptions:u,dashVersion:p,flvVersion:m}=this.props.config;if(this.hls&&this.hls.destroy(),this.dash&&this.dash.reset(),this.shouldUseHLS(t)&&(0,ps.getSDK)(l4.replace("VERSION",i),u4).then(o=>{if(this.hls=new o(u),this.hls.on(o.Events.MANIFEST_PARSED,()=>{this.props.onReady()}),this.hls.on(o.Events.ERROR,(_,b)=>{this.props.onError(_,b,this.hls,o)}),fg.test(t)){const _=t.match(fg)[1];this.hls.loadSource(m4.replace("{id}",_))}else this.hls.loadSource(t);this.hls.attachMedia(this.player),this.props.onLoaded()}),this.shouldUseDASH(t)&&(0,ps.getSDK)(c4.replace("VERSION",p),p4).then(o=>{this.dash=o.MediaPlayer().create(),this.dash.initialize(this.player,t,this.props.playing),this.dash.on("error",this.props.onError),parseInt(p)<3?this.dash.getDebug().setLogToBrowserConsole(!1):this.dash.updateSettings({debug:{logLevel:o.Debug.LOG_LEVEL_NONE}}),this.props.onLoaded()}),this.shouldUseFLV(t)&&(0,ps.getSDK)(h4.replace("VERSION",m),d4).then(o=>{this.flv=o.createPlayer({type:"flv",url:t}),this.flv.attachMediaElement(this.player),this.flv.on(o.Events.ERROR,(_,b)=>{this.props.onError(_,b,this.flv,o)}),this.flv.load(),this.props.onLoaded()}),t instanceof Array)this.player.load();else if((0,ps.isMediaStream)(t))try{this.player.srcObject=t}catch{this.player.src=window.URL.createObjectURL(t)}}play(){const t=this.player.play();t&&t.catch(this.props.onError)}pause(){this.player.pause()}stop(){this.player.removeAttribute("src"),this.dash&&this.dash.reset()}seekTo(t,i=!0){this.player.currentTime=t,i||this.pause()}setVolume(t){this.player.volume=t}enablePIP(){this.player.requestPictureInPicture&&document.pictureInPictureElement!==this.player?this.player.requestPictureInPicture():(0,ps.supportsWebKitPresentationMode)(this.player)&&this.player.webkitPresentationMode!=="picture-in-picture"&&this.player.webkitSetPresentationMode("picture-in-picture")}disablePIP(){document.exitPictureInPicture&&document.pictureInPictureElement===this.player?document.exitPictureInPicture():(0,ps.supportsWebKitPresentationMode)(this.player)&&this.player.webkitPresentationMode!=="inline"&&this.player.webkitSetPresentationMode("inline")}setPlaybackRate(t){try{this.player.playbackRate=t}catch(i){this.props.onError(i)}}getDuration(){if(!this.player)return null;const{duration:t,seekable:i}=this.player;return t===1/0&&i.length>0?i.end(i.length-1):t}getCurrentTime(){return this.player?this.player.currentTime:null}getSecondsLoaded(){if(!this.player)return null;const{buffered:t}=this.player;if(t.length===0)return 0;const i=t.end(t.length-1),u=this.getDuration();return i>u?u:i}getSource(t){const i=this.shouldUseHLS(t),u=this.shouldUseDASH(t),p=this.shouldUseFLV(t);if(!(t instanceof Array||(0,ps.isMediaStream)(t)||i||u||p))return f4.test(t)?t.replace("www.dropbox.com","dl.dropboxusercontent.com"):t}render(){const{url:t,playing:i,loop:u,controls:p,muted:m,config:o,width:_,height:b}=this.props,T=this.shouldUseAudio(this.props)?"audio":"video",M={width:_==="auto"?_:"100%",height:b==="auto"?b:"100%"};return ih.default.createElement(T,{ref:this.ref,src:this.getSource(t),style:M,preload:"auto",autoPlay:i||void 0,controls:p,muted:m,loop:u,...o.attributes},t instanceof Array&&t.map(this.renderSourceElement),o.tracks.map(this.renderTrack))}}li(h_,"displayName","FilePlayer");li(h_,"canPlay",lh.canPlay.file);var v4=k5.createReactPlayer,Ww=a4.default,g4=v4([{key:"file",canPlay:Ww.canPlay,lazyPlayer:Ww}]);const y4=_n(g4),_4=({loading:n,error:t})=>{let i;if(t)i=R.jsxs(R.Fragment,{children:[R.jsx(uy,{className:"mb-2"}),R.jsx(dt,{children:t})]});else if(n)i=R.jsx(ha,{style:{color:Ue.white},thickness:4,size:50});else return null;return R.jsx("div",{className:"z-50 absolute h-full w-full bg-[#16181AAA]",children:R.jsx("div",{className:"relative text-center top-[calc(50%_-_25px)]",children:i})})},Hw=n=>{const t=n.getCurrentTime(),{buffered:i}=n.getInternalPlayer();let u=-1;for(let p=0;p<i.length;p++){const m=i.end(p);if(t>=i.start(p)&&t<=m){u=m-t;break}}return{bufferRemaining:u,hasLoaded:u>0}};class b4 extends me.Component{constructor(t){super(t),this.onVideoBuffering=this.onVideoBuffering.bind(this),this.onHlsError=this.onHlsError.bind(this),this.onVideoError=this.onVideoError.bind(this),this.onVideoResume=this.onVideoResume.bind(this),this.syncVideo=yy(this.syncVideo.bind(this),200,!0),this.firstSeek=!0,this.videoPlayer=Xi.createRef(),this.state={src:null,videoError:null}}componentDidMount(){const{playSpeed:t}=this.props;this.videoPlayer.current&&(this.videoPlayer.current.playbackRate=t||1),this.updateVideoSource({}),this.syncVideo(),this.videoSyncIntv=setInterval(this.syncVideo,500)}componentDidUpdate(t){this.updateVideoSource(t),this.syncVideo()}componentWillUnmount(){this.videoSyncIntv&&(clearTimeout(this.videoSyncIntv),this.videoSyncIntv=null)}onVideoBuffering(){const{dispatch:t,currentRoute:i}=this.props,u=this.videoPlayer.current;(!u||!i||!u.getDuration())&&t(qs(!0)),this.firstSeek&&(this.firstSeek=!1,u.seekTo(this.currentVideoTime(),"seconds"));const{hasLoaded:p}=Hw(u),{readyState:m}=u.getInternalPlayer();(!p||m<2)&&t(qs(!0))}onHlsError(t){var u;const{dispatch:i}=this.props;i(qs(!0)),!(t.type==="mediaError"&&(t.details==="bufferStalledError"||t.details==="bufferNudgeOnStall"))&&(t.type==="networkError"&&((u=t.response)==null?void 0:u.code)===404?this.setState({videoError:"This video segment has not uploaded yet or has been deleted."}):this.setState({videoError:"Unable to load video"}))}onVideoError(t,i){var m,o,_,b;if(!t){console.warn("Unknown video error",{e:t,data:i});return}if(t==="hlsError"){this.onHlsError(i);return}if(t.name==="AbortError")return;if((o=(m=t.target)==null?void 0:m.src)!=null&&o.startsWith(window.location.origin)&&t.target.src.endsWith("undefined")){console.warn("Video error with undefined src, ignoring",{e:t,data:i});return}const{dispatch:u}=this.props;if(u(qs(!0)),t.type==="networkError"){console.error("Network error",{e:t,data:i}),this.setState({videoError:"Unable to load video. Check network connection."});return}const p=((_=t.response)==null?void 0:_.code)===404?"This video segment has not uploaded yet or has been deleted.":((b=t.response)==null?void 0:b.text)||"Unable to load video";this.setState({videoError:p})}onVideoResume(){const{videoError:t}=this.state;t&&this.setState({videoError:null})}updateVideoSource(t){var p;let{src:i}=this.state;const{currentRoute:u}=this.props;if(!u){i!==""&&this.setState({src:"",videoError:null});return}(i===""||!t.currentRoute||((p=t.currentRoute)==null?void 0:p.fullname)!==u.fullname)&&(i=rI(u.fullname,u.share_exp,u.share_sig),this.setState({src:i,videoError:null}),this.syncVideo())}syncVideo(){const{dispatch:t,isBufferingVideo:i,currentRoute:u}=this.props;if(!u){t(nI()),u&&i&&t(qs(!1));return}const p=this.videoPlayer.current;if(!p||!p.getInternalPlayer()||!p.getDuration())return;let{desiredPlaySpeed:m}=this.props;const o=this.currentVideoTime(),_=p.getCurrentTime(),b=o-_;Math.abs(b)<=.3?m=Math.max(0,m+b):o===0&&b<0&&_!==p.getDuration()?t(vh(Gs()-b*1e3)):p.seekTo(o,"seconds"),m=Math.round(m*10)/10,m=Math.max(0,Math.min(16,m));const E=p.getInternalPlayer(),T=Math.min(p.getDuration()-p.getCurrentTime(),30),{hasLoaded:M,bufferRemaining:I}=Hw(p),N=I>=T;if(i&&N&&E.readyState>=2?t(qs(!1)):(i||!M||E.readyState<2)&&(i||t(qs(!0)),m=0),p.getInternalPlayer("hls")){if(!E.paused&&m===0?E.pause():E.playbackRate!==m&&m!==0&&(E.playbackRate=m),E.paused&&m!==0){const D=E.play();D&&D.catch(()=>console.debug("[DriveVideo] play interrupted by pause"))}}else E.playbackRate=m}currentVideoTime(t=Gs()){const{currentRoute:i}=this.props;return i?(t-=i.offset,i.videoStartOffset&&(t-=i.videoStartOffset),t/=1e3,Math.max(0,t)):0}render(){const{desiredPlaySpeed:t,isBufferingVideo:i,currentRoute:u}=this.props,{src:p,videoError:m}=this.state;return R.jsxs("div",{className:"min-h-[200px] relative max-w-[964px] m-[0_auto] aspect-[1.593]",children:[R.jsx(_4,{loading:i,error:m}),R.jsx(y4,{ref:this.videoPlayer,url:p,playsinline:!0,muted:!0,width:"100%",height:"100%",playing:!!(u&&t),config:{hlsVersion:"1.4.8",hlsOptions:{maxBufferLength:40}},playbackRate:t,onBuffer:this.onVideoBuffering,onBufferEnd:this.onVideoResume,onPlay:this.onVideoResume,onError:this.onVideoError})]})}}const x4=pi({dongleId:"dongleId",desiredPlaySpeed:"desiredPlaySpeed",offset:"offset",startTime:"startTime",isBufferingVideo:"isBufferingVideo",currentRoute:"currentRoute"}),w4=Kn(x4)(b4),ka=[.1,.25,.5,1,2,4,8],S4=n=>({base:{display:"flex",alignItems:"center",backgroundColor:n.palette.grey[999],height:"64px",borderRadius:"32px",padding:n.spacing.unit,width:400,maxWidth:"100%",margin:"0 auto",opacity:0,pointerEvents:"none",transition:"opacity 0.1s ease-in-out","&.isExpanded":{opacity:1,pointerEvents:"auto"},"&.isThin":{height:50,paddingBottom:0,paddingTop:0}},desiredPlaySpeedContainer:{marginRight:n.spacing.unit*1,display:"flex",flexDirection:"column",alignItems:"center",minWidth:"40px"},icon:{width:"98%",height:"98%","&.dim":{color:n.palette.grey[300]},"&.small":{width:"80%",height:"80%"},"&.circle":{border:`1px solid ${n.palette.grey[900]}`,borderRadius:"50%"}},iconButton:{width:"40px",height:"40px"},tinyArrowIcon:{width:12,height:12,color:n.palette.grey[500],"&[disabled]":{visibility:"hidden"}},iconBox:{borderRight:`1px solid ${n.palette.grey[900]}`},playButtonBox:{borderLeft:`1px solid ${n.palette.grey[900]}`},currentTime:{margin:`0 ${n.spacing.unit*1}px`,fontSize:15,fontWeight:500,display:"block",flexGrow:1}});class E4 extends me.Component{static getDerivedStateFromProps(t,i){return t.desiredPlaySpeed!==0&&t.desiredPlaySpeed!==i.desiredPlaySpeed?{...i,desiredPlaySpeed:t.desiredPlaySpeed}:i}constructor(t){super(t),this.textHolder=Xi.createRef(),this.updateTime=this.updateTime.bind(this),this.togglePause=this.togglePause.bind(this),this.increaseSpeed=this.increaseSpeed.bind(this),this.decreaseSpeed=this.decreaseSpeed.bind(this),this.jumpBack=this.jumpBack.bind(this),this.jumpForward=this.jumpForward.bind(this),this.state={desiredPlaySpeed:1,displayTime:this.getDisplayTime()}}componentDidMount(){this.mounted=!0,xh(this.updateTime)}componentWillUnmount(){this.mounted=!1}getDisplayTime(){const t=Gs(),{filter:i,currentRoute:u}=this.props,p=new Date(t+i.start);if(Number.isNaN(p.getTime()))return"...";let m=ui(p).format("HH:mm:ss");const o=Ws(u);return o!==null&&(m=`${m} – ${o}`),m}jumpBack(t){this.props.dispatch(vh(Gs()-t))}jumpForward(t){this.props.dispatch(vh(Gs()+t))}updateTime(){if(!this.mounted||!this.textHolder.current)return;const t=this.getDisplayTime(),{displayTime:i}=this.state;t!==i&&this.setState({displayTime:t}),xh(this.updateTime)}decreaseSpeed(){const{dispatch:t}=this.props,{desiredPlaySpeed:i}=this.state;let u=ka.indexOf(i);u===-1&&(u=ka.indexOf(1)),u=Math.max(0,u-1),t(Cf(ka[u]))}canDecreaseSpeed(){const{desiredPlaySpeed:t}=this.state;let i=ka.indexOf(t);return i===-1&&(i=ka.indexOf(1)),i>0}increaseSpeed(){const{dispatch:t}=this.props,{desiredPlaySpeed:i}=this.state;let u=ka.indexOf(i);u===-1&&(u=ka.indexOf(1)),u=Math.min(ka.length-1,u+1),t(Cf(ka[u]))}canIncreaseSpeed(){const{desiredPlaySpeed:t}=this.state;let i=ka.indexOf(t);return i===-1&&(i=ka.indexOf(1)),i<ka.length-1}togglePause(){const{desiredPlaySpeed:t,dispatch:i}=this.props;i(t===0?Cf(this.state.desiredPlaySpeed):gS())}render(){const{classes:t,zoom:i,desiredPlaySpeed:u,isThin:p}=this.props,{displayTime:m,desiredPlaySpeed:o}=this.state,_=u===0,b=i?"isExpanded":"",E=p?"isThin":"",T=/iphone|ipad|ipod/.test(window.navigator.userAgent.toLowerCase());return R.jsxs("div",{className:`${t.base} ${b} ${E}`,children:[R.jsx("div",{className:t.iconBox,children:R.jsx(Da,{className:t.iconButton,onClick:()=>this.jumpBack(1e4),"aria-label":"Jump back 10 seconds",children:R.jsx(iI,{className:`${t.icon} small dim`})})}),R.jsx("div",{className:t.iconBox,children:R.jsx(Da,{className:t.iconButton,onClick:()=>this.jumpForward(1e4),"aria-label":"Jump forward 10 seconds",children:R.jsx(aI,{className:`${t.icon} small dim`})})}),!p&&R.jsx(dt,{variant:"caption",align:"center",style:{paddingTop:4},children:"CURRENT PLAYBACK TIME"}),R.jsx(dt,{variant:"body1",align:"center",className:t.currentTime,children:R.jsx("span",{ref:this.textHolder,children:m})}),!T&&R.jsxs("div",{className:t.desiredPlaySpeedContainer,children:[R.jsx(Da,{className:t.tinyArrowIcon,onClick:this.increaseSpeed,disabled:!this.canIncreaseSpeed(),"aria-label":"Increase play speed by 1 step",children:R.jsx(oI,{className:t.tinyArrowIcon})}),R.jsxs(dt,{variant:"body2",align:"center",children:[o,"×"]}),R.jsx(Da,{className:t.tinyArrowIcon,onClick:this.decreaseSpeed,disabled:!this.canDecreaseSpeed(),"aria-label":"Decrease play speed by 1 step",children:R.jsx(sI,{className:t.tinyArrowIcon})})]}),R.jsx("div",{className:t.playButtonBox,children:R.jsx(Da,{onClick:this.togglePause,"aria-label":_?"Unpause":"Pause",children:_?R.jsx(lI,{className:t.icon}):R.jsx(uI,{className:t.icon})})})]})}}const P4=pi({currentRoute:"currentRoute",zoom:"zoom",desiredPlaySpeed:"desiredPlaySpeed",filter:"filter"}),T4=Kn(P4)(ci.withStyles(S4)(E4)),C4=n=>({arrowPopper:{opacity:1,"& $arrowArrow":{bottom:0,left:0,marginBottom:"-0.9em",width:"3em",height:"1em","&::before":{borderWidth:"1em 1em 0 1em",borderColor:`${n.palette.grey[900]} transparent transparent transparent`}}},arrowArrow:{position:"absolute",fontSize:7,width:"3em",height:"3em","&::before":{content:'""',margin:"auto",display:"block",width:0,height:0,borderStyle:"solid"}},tooltip:{background:n.palette.grey[900],marginBottom:8},icon:{marginLeft:n.spacing.unit,fontSize:18}});class DP extends me.Component{constructor(t){super(t),this.state={arrowRef:null,open:!1},this.handleArrowRef=this.handleArrowRef.bind(this),this.onTooltipOpen=this.onTooltipOpen.bind(this),this.onTooltipClose=this.onTooltipClose.bind(this)}handleArrowRef(t){this.setState({arrowRef:t})}onTooltipOpen(){this.setState({open:!0})}onTooltipClose(){this.setState({open:!1})}render(){const{classes:t,title:i}=this.props,{arrowRef:u,open:p}=this.state;return R.jsx(KI,{onClickAway:this.onTooltipClose,children:R.jsx(SS,{PopperProps:{popperOptions:{modifiers:{arrow:{enabled:!!u,element:u}}}},title:R.jsxs(R.Fragment,{children:[R.jsx(dt,{color:"inherit",children:i}),R.jsx("span",{className:t.arrowArrow,ref:this.handleArrowRef})]}),onOpen:this.onTooltipOpen,onClose:this.onTooltipClose,open:p,classes:{tooltip:t.tooltip,popper:t.arrowPopper},placement:"top",children:R.jsx(yS,{className:t.icon,onClick:this.onTooltipOpen})})})}}DP.propTypes={title:kn.string.isRequired};const I4=ci.withStyles(C4)(DP),M4=()=>({root:{display:"flex",alignItems:"center"},switchThumbLoading:{"&::before":{content:"''",display:"inline-block",height:"100%",width:"100%",backgroundImage:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 20 20"><circle cx="50%25" cy="50%25" r="5" stroke="%23eee" fill="none" stroke-width="2" stroke-dasharray="24px 8px"></circle></svg>')`,strokeDasharray:"80px, 200px",animation:"circular-rotate 1s linear infinite"}},errorIcon:{color:Ue.red300},copiedPopover:{borderRadius:16,padding:"8px 16px",border:`1px solid ${Ue.white10}`,backgroundColor:Ue.grey800,marginTop:12,zIndex:5e4,maxWidth:"95%","& p":{maxWidth:400,fontSize:"0.9rem",color:Ue.white,margin:0}}});class LP extends me.Component{constructor(t){super(t),this.state={loading:!1,checked:null,error:null,errorPopper:null},this.onChange=this.onChange.bind(this)}async onChange(t){if(this.state.loading)return;this.setState({loading:!0,checked:t.target.checked,error:null});const i=await this.props.onChange(t);if(i!=null&&i.error){this.setState({loading:!1,checked:null,error:i.error});return}this.setState({loading:!1,checked:null,error:null})}render(){const{classes:t,checked:i,label:u,loading:p,tooltip:m}=this.props,o=this.state.checked!==null?this.state.checked:i,_=p||this.state.loading?{icon:t.switchThumbLoading}:{},b=R.jsx(zM,{color:"secondary",checked:o,onChange:this.onChange,classes:_,disabled:p});return R.jsxs("div",{className:t.root,children:[R.jsx(gM,{control:b,label:u}),m&&R.jsx(I4,{title:m}),!!this.state.error&&R.jsxs(R.Fragment,{children:[R.jsx(uy,{className:t.errorIcon,onMouseLeave:()=>this.setState({errorPopper:null}),onMouseEnter:E=>this.setState({errorPopper:E.target})}),R.jsx(nm,{open:!!this.state.errorPopper,placement:"bottom",anchorEl:this.state.errorPopper,className:t.copiedPopover,children:R.jsx(dt,{children:this.state.error})})]})]})}}LP.propTypes={checked:kn.bool.isRequired,onChange:kn.func.isRequired,loading:kn.bool,label:kn.string,tooltip:kn.string};const Zw=ci.withStyles(M4)(LP),O4="Making a route public allows anyone with the route name or link to access it.",R4="Preserving a route will prevent it from being deleted. You can preserve up to 10 routes, or 100 if you have comma prime.",A4=()=>({root:{display:"flex"},mediaOptionsRoot:{maxWidth:964,margin:"0 auto",display:"flex",justifyContent:"space-between",flexWrap:"wrap"},mediaOptions:{marginBottom:12,display:"flex",width:"max-content",alignItems:"center",border:"1px solid rgba(255,255,255,.1)",borderRadius:50},mediaOption:{alignItems:"center",borderRight:"1px solid rgba(255,255,255,.1)",display:"flex",flexDirection:"column",justifyContent:"center",cursor:"pointer",minHeight:32,minWidth:44,paddingLeft:15,paddingRight:15,"&.disabled":{cursor:"default"},"&:last-child":{borderRight:"none"}},mediaOptionDisabled:{cursor:"auto"},mediaOptionIcon:{backgroundColor:"#fff",borderRadius:3,height:20,margin:"2px 0",width:30},mediaOptionText:{fontSize:12,fontWeight:500,textAlign:"center"},mediaSource:{width:"100%"},menuLoading:{position:"absolute",outline:"none",zIndex:5,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},filesItem:{justifyContent:"space-between",opacity:1},switchListItem:{padding:"12px 16px",boxSizing:"content-box",height:24,lineHeight:1,"& span":{fontSize:"1rem"}},offlineMenuItem:{height:"unset",flexDirection:"column",alignItems:"flex-start","& div":{display:"flex"},"& svg":{marginRight:8}},uploadButton:{marginLeft:12,color:Ue.white,borderRadius:13,fontSize:"0.8rem",padding:"4px 12px",minHeight:19,backgroundColor:Ue.white05,"&:hover":{backgroundColor:Ue.white10}},fakeUploadButton:{marginLeft:12,color:Ue.white,fontSize:"0.8rem",padding:"4px 12px",display:"flex",justifyContent:"center",alignItems:"center"},copySegment:{pointerEvents:"auto",opacity:1,"& div":{whiteSpace:"normal",padding:"0 6px",borderRadius:4,backgroundColor:Ue.white08,marginRight:4}},shareButton:{display:"flex",alignItems:"center",justifyContent:"space-between"},dcameraUploadIcon:{fontSize:"1rem",marginLeft:4},dcameraUploadInfo:{zIndex:2e3,textAlign:"center",borderRadius:14,fontSize:"0.8em",padding:"6px 8px",border:`1px solid ${Ue.white10}`,backgroundColor:Ue.grey800,color:Ue.white,"& p":{fontSize:"0.8rem"}},noPrimePopover:{borderRadius:16,padding:16,border:`1px solid ${Ue.white10}`,backgroundColor:Ue.grey800,marginTop:12,zIndex:5,"& p":{fontSize:"0.9rem",color:Ue.white,margin:0}},noPrimeHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12,"& p":{fontSize:"1rem",fontWeight:500}},noPrimeButton:{padding:"6px 24px",borderRadius:15,textTransform:"none",minHeight:"unset",color:Ue.white,backgroundColor:Ue.primeBlue50,"&:disabled":{background:"#ddd",color:Ue.grey900},"&:hover":{color:Ue.white,backgroundColor:Ue.primeBlue200}}}),Gw={qcameras:"qcamera.ts",cameras:"fcamera.hevc",dcameras:"dcamera.hevc",ecameras:"ecamera.hevc",qlogs:"qlog.bz2",logs:"rlog.bz2"},Ka={VIDEO:"video",MAP:"map"};class k4 extends me.Component{constructor(t){super(t),this.state={inView:Ka.VIDEO,windowWidth:window.innerWidth,downloadMenu:null,moreInfoMenu:null,uploadModal:!1,dcamUploadInfo:null,routePreserved:null},this.renderMediaOptions=this.renderMediaOptions.bind(this),this.renderMenus=this.renderMenus.bind(this),this.renderUploadMenuItem=this.renderUploadMenuItem.bind(this),this.copySegmentName=this.copySegmentName.bind(this),this.openInUseradmin=this.openInUseradmin.bind(this),this.shareCurrentRoute=this.shareCurrentRoute.bind(this),this.uploadFile=this.uploadFile.bind(this),this.uploadFilesAll=this.uploadFilesAll.bind(this),this.getUploadStats=this.getUploadStats.bind(this),this._uploadStats=this._uploadStats.bind(this),this.downloadFile=this.downloadFile.bind(this),this.onPublicToggle=this.onPublicToggle.bind(this),this.fetchRoutePreserved=this.fetchRoutePreserved.bind(this),this.onPreserveToggle=this.onPreserveToggle.bind(this)}componentDidMount(){var t;this.componentDidUpdate({},{}),this.props.currentRoute&&(this.props.device&&!this.props.device.shared||(t=this.props.profile)!=null&&t.superuser)&&this.props.dispatch(EN(this.props.dongleId,this.props.currentRoute.fullname))}componentDidUpdate(t,i){var E,T,M;const{windowWidth:u,inView:p,downloadMenu:m,moreInfoMenu:o,routePreserved:_}=this.state,b=u>=1536;b&&p===Ka.MAP&&this.setState({inView:Ka.VIDEO}),!b&&p===Ka.MAP&&this.props.isBufferingVideo&&this.props.dispatch(qs(!1)),t.currentRoute!==this.props.currentRoute&&this.props.currentRoute&&this.props.dispatch(vE(this.props.currentRoute)),i.inView&&i.inView!==this.state.inView&&this.props.dispatch(xa("media_switch_view",{in_view:this.state.inView})),this.props.currentRoute&&(!i.downloadMenu&&m||!this.props.files&&!i.moreInfoMenu&&o||!t.currentRoute&&(m||o))&&((this.props.device&&!this.props.device.shared||(E=this.props.profile)!=null&&E.superuser)&&this.props.dispatch(PN(this.props.dongleId)),this.props.dispatch(JE(this.props.currentRoute.fullname))),_===null&&((T=this.props.device)!=null&&T.is_owner||(M=this.props.profile)!=null&&M.superuser)&&(!i.moreInfoMenu&&!t.currentRoute)!==(o&&this.props.currentRoute)&&this.fetchRoutePreserved()}async copySegmentName(){const{currentRoute:t}=this.props;!t||!navigator.clipboard||(await navigator.clipboard.writeText(`${t.fullname.replace("|","/")}/${Ws(t)}`),this.setState({moreInfoMenu:null}))}openInUseradmin(){const{currentRoute:t}=this.props;if(!t)return;const i={route_start_time:t.start_time_utc_millis};this.props.dispatch(xa("open_in_useradmin",i));const u={onebox:t.fullname},p=window.open(`${window.USERADMIN_URL_ROOT}?${tm.stringify(u)}`,"_blank");p.focus&&p.focus()}async shareCurrentRoute(){try{await navigator.share({title:"comma connect",url:window.location.href})}catch(t){console.error(t),Qr(t,{fingerprint:"media_navigator_share"})}}async uploadFile(t){const{dongleId:i,currentRoute:u}=this.props;if(!u)return;this.props.dispatch(xa("files_upload",{type:t}));const p=u.fullname.split("|")[1],m=`${p}--${Ws(u)}/${Gw[t]}`,o=`${i}|${p}--${Ws(u)}/${t}`,_={};_[o]={requested:!0},this.props.dispatch(fs(_));const b=await Rw(i,[m]);b&&this.props.dispatch(Aw(i,[o],[m],b))}async uploadFilesAll(t){const{dongleId:i,currentRoute:u,loop:p,files:m}=this.props;if(t===void 0&&(t=["logs","cameras","dcameras","ecameras"]),!u||!m)return;this.props.dispatch(xa("files_upload_all",{types:t.length===1&&t[0]==="logs"?"logs":"all"}));const o={};for(let E=0;E<u.segment_numbers.length;E++)u.segment_start_times[E]<p.startTime+p.duration&&u.segment_end_times[E]>p.startTime&&t.forEach(T=>{const M=`${u.fullname}--${u.segment_numbers[E]}/${T}`;m[M]||(o[M]={requested:!0})});this.props.dispatch(fs(o));const _=Object.keys(o).map(E=>{const[T,M]=E.split("/");return`${T.split("|")[1]}/${Gw[M]}`}),b=await Rw(i,_);b&&this.props.dispatch(Aw(i,Object.keys(o),_,b))}_uploadStats(t,i,u,p,m,o){const{currentRoute:_,loop:b,files:E}=this.props;for(let T=0;T<_.segment_numbers.length;T++)if(_.segment_start_times[T]<b.startTime+b.duration&&_.segment_end_times[T]>b.startTime)for(let M=0;M<t.length;M++){i+=1;const I=E[`${_.fullname}--${_.segment_numbers[T]}/${t[M]}`];I&&(u+=!!(I.url||I.notFound),p+=I.progress!==void 0,m+=!!I.paused,o+=!!I.requested)}return[i,u,p,m,o]}getUploadStats(){const{currentRoute:t,files:i}=this.props;if(!i||!t)return null;const[u,p,m,o,_]=this._uploadStats(["logs"],0,0,0,0,0),b=["cameras","dcameras","ecameras"],[E,T,M,I,N]=this._uploadStats(b,u,p,m,o,_);return{canRequestAll:E-T-M-N,canRequestRlog:u-p-m-_,isUploadingAll:!(E-T-M),isUploadingRlog:!(u-p-m),isUploadedAll:!(E-T),isUploadedRlog:!(u-p),isPausedAll:I>0&&I===M}}downloadFile(t,i){const{currentRoute:u}=this.props,p={type:i,route_start_time:u.start_time_utc_millis};this.props.dispatch(xa("download_file",p)),window.location.href=t.url}async onPublicToggle(t){const i=t.target.checked;try{const u=await cI(this.props.currentRoute.fullname,i);return u&&u.fullname===this.props.currentRoute.fullname&&(this.props.dispatch(pI(this.props.currentRoute.fullname,{is_public:u.is_public})),u.is_public!==i)?{error:"unable to update"}:null}catch(u){return console.error(u),Qr(u,{fingerprint:"media_toggle_public"}),{error:"could not update"}}}async fetchRoutePreserved(){try{const t=await hI(this.props.dongleId);if(t&&Array.isArray(t)&&this.props.currentRoute){if(t.find(i=>i.fullname===this.props.currentRoute.fullname)){this.setState({routePreserved:!0});return}this.setState({routePreserved:!1})}}catch(t){console.error(t),Qr(t,{fingerprint:"media_fetch_preserved"})}}async onPreserveToggle(t){const i=t.target.checked;try{const u=await dI(this.props.currentRoute.fullname,i);return u&&u.success?(this.setState({routePreserved:i}),null):(this.fetchRoutePreserved(),{error:"unable to update"})}catch(u){return console.error(u),Qr(u,{fingerprint:"media_toggle_preserved"}),this.fetchRoutePreserved(),{error:"could not update"}}}render(){const{classes:t}=this.props,{inView:i,windowWidth:u}=this.state;if(this.props.menusOnly)return this.renderMenus(!0);const p=u>=1536,m=p?{width:"60%"}:{width:"100%"},o=p?{width:"40%",marginBottom:62,marginTop:46,paddingLeft:24}:{width:"100%"};return R.jsxs("div",{className:t.root,children:[R.jsx(Bc,{onResize:_=>this.setState({windowWidth:_})}),R.jsxs("div",{style:m,children:[this.renderMediaOptions(p),i===Ka.VIDEO&&R.jsx(w4,{}),i===Ka.MAP&&!p&&R.jsx("div",{style:o,children:R.jsx(zw,{})}),R.jsx("div",{className:"mt-3",children:R.jsx(T4,{isThin:!0})})]}),i===Ka.VIDEO&&p&&R.jsx("div",{style:o,children:R.jsx(zw,{})})]})}renderMediaOptions(t){const{classes:i}=this.props,{inView:u}=this.state;return R.jsxs(R.Fragment,{children:[R.jsxs("div",{className:i.mediaOptionsRoot,children:[t?R.jsx("div",{}):R.jsxs("div",{className:i.mediaOptions,children:[R.jsx("div",{className:i.mediaOption,style:u!==Ka.VIDEO?{opacity:.6}:{},onClick:()=>this.setState({inView:Ka.VIDEO}),children:R.jsx(dt,{className:i.mediaOptionText,children:"Video"})}),R.jsx("div",{className:i.mediaOption,style:u!==Ka.MAP?{opacity:.6}:{},onClick:()=>this.setState({inView:Ka.MAP}),children:R.jsx(dt,{className:i.mediaOptionText,children:"Map"})})]}),R.jsxs("div",{className:i.mediaOptions,children:[R.jsx("div",{className:i.mediaOption,"aria-haspopup":"true",onClick:p=>this.setState({downloadMenu:p.target}),children:R.jsx(dt,{className:i.mediaOptionText,children:"Files"})}),R.jsx("div",{className:i.mediaOption,"aria-haspopup":"true",onClick:p=>this.setState({moreInfoMenu:p.target}),children:R.jsx(dt,{className:i.mediaOptionText,children:"More info"})})]})]}),this.renderMenus()]})}renderMenus(t=!1){const{currentRoute:i,device:u,classes:p,files:m,profile:o}=this.props,{downloadMenu:_,moreInfoMenu:b,uploadModal:E,windowWidth:T,dcamUploadInfo:M,routePreserved:I}=this.state;if(!u)return null;let N={},D={},re={},W={};if(m&&i){const ve=`${i.fullname}--${Ws(i)}`;N=m[`${ve}/cameras`]||{},D=m[`${ve}/ecameras`]||{},re=m[`${ve}/dcameras`]||{},W=m[`${ve}/logs`]||{}}const ee=u.is_owner||o&&o.superuser,J=T<425?80:120,Y=[[N,"Road camera","cameras"],[D,"Wide road camera","ecameras"],[re,"Driver camera","dcameras"],[W,"Log data","logs"]],B=this.getUploadStats(),V=!B||B.isUploadedRlog||B.isUploadingRlog||!B.canRequestRlog,K=!B||B.isUploadedAll||B.isUploadingAll||!B.canRequestAll;return R.jsxs(R.Fragment,{children:[R.jsxs(Bf,{id:"menu-download",open:!!(t||_),anchorEl:_,onClose:()=>this.setState({downloadMenu:null}),anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[!m&&R.jsx("div",{className:p.menuLoading,children:R.jsx(ha,{size:36,style:{color:Ue.white}})}),Y.filter(ve=>!!ve).map(this.renderUploadMenuItem),R.jsx(Ja,{}),R.jsxs(yi,{className:p.filesItem,disabled:!0,style:m&&B?{pointerEvents:"auto"}:{color:Ue.white60},children:["All logs",!!(m&&ee&&!V)&&R.jsx(an,{className:p.uploadButton,style:{minWidth:J},onClick:()=>this.uploadFilesAll(["logs"]),children:`upload ${B.canRequestRlog} logs`}),!!(ee&&V&&B)&&R.jsx("div",{className:p.fakeUploadButton,style:{minWidth:J-24},children:B.isUploadedRlog?"uploaded":B.isUploadingRlog?"pending":R.jsx(ha,{style:{color:Ue.white},size:17})})]}),R.jsxs(yi,{className:p.filesItem,disabled:!0,style:m&&B?{pointerEvents:"auto"}:{color:Ue.white60},children:["All files",!!(m&&ee&&!K)&&R.jsx(an,{className:p.uploadButton,style:{minWidth:J},onClick:()=>this.uploadFilesAll(),children:`upload ${B.canRequestAll} files`}),!!(ee&&K&&B)&&R.jsx("div",{className:p.fakeUploadButton,style:{minWidth:J-24},children:B.isUploadedAll?"uploaded":B.isUploadingAll?"pending":R.jsx(ha,{style:{color:Ue.white},size:17})})]}),R.jsx(Ja,{}),Hs(u)||!m?R.jsx(yi,{onClick:m?()=>this.setState({uploadModal:!0,downloadMenu:null}):null,style:m?{pointerEvents:"auto"}:{color:Ue.white60},className:p.filesItem,disabled:!m,children:"View upload queue"}):R.jsxs(yi,{className:p.offlineMenuItem,disabled:!0,children:[R.jsxs("div",{children:[R.jsx(wh,{}),"Device offline"]}),R.jsx("span",{style:{fontSize:"0.8rem"},children:"uploading will resume when device is online"})]}),B&&B.isPausedAll&&ly(u)&&R.jsxs(yi,{className:p.offlineMenuItem,disabled:!0,children:[R.jsxs("div",{children:[R.jsx(wh,{}),"Connect to WiFi"]}),R.jsx("span",{style:{fontSize:"0.8rem"},children:"uploading paused on cellular connection"})]})]}),R.jsxs(Bf,{id:"menu-info",open:!!(t||b),anchorEl:b,onClose:()=>this.setState({moreInfoMenu:null}),transformOrigin:{vertical:"top",horizontal:T>400?260:300},children:[R.jsxs(yi,{className:p.copySegment,onClick:this.copySegmentName,style:{fontSize:T>400?"0.8rem":"0.7rem"},children:[R.jsx("div",{children:i?`${i.fullname.replace("|","/")}/${Ws(i)}`:"---"}),R.jsx(RE,{})]}),typeof navigator.share<"u"&&R.jsxs(yi,{onClick:this.shareCurrentRoute,className:p.shareButton,children:["Share this route",R.jsx(e_,{})]}),R.jsx(Ja,{}),R.jsx(yi,{onClick:this.openInUseradmin,children:"View in useradmin"}),!!(u!=null&&u.is_owner||o&&o.superuser)&&[R.jsx(Ja,{},"1"),R.jsx(vg,{className:p.switchListItem,children:R.jsx(Zw,{checked:i==null?void 0:i.is_public,onChange:this.onPublicToggle,label:"Public access",tooltip:O4})},"2"),R.jsx(vg,{className:p.switchListItem,children:R.jsx(Zw,{checked:!!I,loading:I===null,onChange:this.onPreserveToggle,label:"Preserved",tooltip:R4})},"3")]]}),R.jsx(QE,{open:E,onClose:()=>this.setState({uploadModal:!1}),update:!!(b||E||_),store:this.props.store,device:u}),R.jsx(nm,{open:!!M,placement:"bottom",anchorEl:M,className:p.dcameraUploadInfo,children:R.jsx(dt,{children:"make sure to enable the “Record and Upload Driver Camera” toggle"})})]})}renderUploadMenuItem([t,i,u]){const{device:p,classes:m,files:o,profile:_}=this.props,{windowWidth:b}=this.state,E=p.is_owner||_&&_.superuser,T=b<425?80:120;let M;return o?t.url?M=R.jsx(an,{className:m.uploadButton,style:{minWidth:T},onClick:()=>this.downloadFile(t,u),children:"download"}):t.progress!==void 0?M=R.jsx("div",{className:m.fakeUploadButton,style:{minWidth:T-24},children:t.current?`${Math.floor(t.progress*100)}%`:t.paused?"paused":"pending"}):t.requested?M=R.jsx("div",{className:m.fakeUploadButton,style:{minWidth:T-24},children:R.jsx(ha,{style:{color:Ue.white},size:17})}):t.notFound?M=R.jsxs("div",{className:m.fakeUploadButton,style:{minWidth:T-24},onMouseEnter:u==="dcameras"?I=>this.setState({dcamUploadInfo:I.target}):null,onMouseLeave:u==="dcameras"?()=>this.setState({dcamUploadInfo:null}):null,children:["not found",u==="dcameras"&&R.jsx(yS,{className:m.dcameraUploadIcon})]}):E?M=R.jsx(an,{className:m.uploadButton,style:{minWidth:T},onClick:()=>this.uploadFile(u),children:b<425?"upload":"request upload"}):M=R.jsx(an,{className:m.uploadButton,style:{minWidth:T},disabled:!0,children:"download"}):M=null,R.jsxs(yi,{disabled:!0,className:m.filesItem,style:o?{pointerEvents:"auto"}:{color:Ue.white60},children:[i,M]},u)}}const D4=pi({dongleId:"dongleId",device:"device",routes:"routes",currentRoute:"currentRoute",loop:"loop",filter:"filter",files:"files",profile:"profile",isBufferingVideo:"isBufferingVideo"}),L4=Kn(D4)(ci.withStyles(A4)(k4));class z4 extends me.Component{constructor(t){super(t),this.close=this.close.bind(this)}onBack(t,i){t.previous?this.props.dispatch(fI()):i&&this.props.dispatch(jf(i.start_time_utc_millis,i.end_time_utc_millis))}close(){this.props.dispatch(jf(null,null))}render(){const{dongleId:t,zoom:i,routes:u,currentRoute:p}=this.props,m=(p==null?void 0:p.start_time_utc_millis)===i.start&&(p==null?void 0:p.end_time_utc_millis)===i.end,o=!i.previousZoom&&m,_=ui(i.start).format("dddd"),b=ui(i.start).format("MMM D @ HH:mm"),E=ui(i.end).format("HH:mm");return R.jsx("div",{className:"DriveView",children:R.jsxs("div",{className:"flex flex-col rounded-lg m-4 bg-[linear-gradient(to_bottom,#30373B_0%,#272D30_10%,#1D2225_100%)]",children:[R.jsxs("div",{children:[R.jsxs("div",{className:"items-center justify-between flex p-3 gap-2",children:[R.jsx(Da,{onClick:()=>this.onBack(i,p),"aria-label":"Go Back",disabled:o,children:R.jsx(mI,{})}),R.jsxs("div",{className:"text-white text-lg font-medium",children:[R.jsx("span",{className:"hidden sm:inline",children:`${_} `}),`${b} - ${E}`]}),R.jsx(Da,{onClick:mh(this.close),"aria-label":"Close",href:`/${t}`,children:R.jsx(vI,{})})]}),R.jsx(_E,{route:p,thumbnailsVisible:!0,hasRuler:!0})]}),R.jsx("div",{className:"p-3 md:p-8",children:u&&u.length===0?R.jsx(dt,{children:"Route does not exist."}):R.jsx(L4,{})})]})})}}const j4=pi({dongleId:"dongleId",routes:"routes",zoom:"zoom",currentRoute:"currentRoute"}),N4=Kn(j4)(z4),B4=()=>R.jsxs("div",{className:"flex flex-col items-center mx-4 md:mx-6 lg:mx-8 mt-4 sm:mt-8 md:mt-16",children:[R.jsxs("div",{className:"flex flex-col prose prose-invert py-2 items-center max-w-sm",children:[R.jsx("h2",{children:"Pair your device"}),R.jsx("p",{children:"Scan the QR code on your device. If you cannot see a QR code, check the following:"}),R.jsxs("ul",{className:"my-0",children:[R.jsx("li",{children:"Your device is connected to the internet"}),R.jsx("li",{children:"You have installed the latest version of openpilot"})]}),R.jsx("p",{children:"If you still cannot see a QR code, your device may already be paired to another account. Make sure you have signed in with the same account you may have used previously."}),R.jsx("div",{className:"mt-2 w-full",children:R.jsx(YE,{buttonText:"add new device"})})]}),R.jsxs("picture",{className:"max-w-3xl mt-4 p-4",children:[R.jsx("source",{type:"image/webp",srcSet:"/images/c3x-ad.webp"}),R.jsx("source",{type:"image/png",srcSet:"/images/c3x-ad.png"}),R.jsx("img",{alt:"comma 3X"})]})]}),F4=n=>({window:{background:"linear-gradient(180deg, #1D2225 0%, #16181A 100%)",display:"flex",flexDirection:"column"},modal:{position:"absolute",padding:n.spacing.unit*2,width:n.spacing.unit*50,maxWidth:"90%",left:"50%",top:"40%",transform:"translate(-50%, -50%)",outline:"none","& p":{marginTop:10}},closeButton:{marginTop:10,float:"right",backgroundColor:Ue.grey200,color:Ue.white,"&:hover":{backgroundColor:Ue.grey400}},fabProgress:{marginTop:10},pairedDongleId:{fontWeight:"bold"}});class U4 extends me.Component{constructor(t){super(t),this.state={drawerIsOpen:!1,headerRef:null,pairLoading:!1,pairError:null,pairDongleId:null,windowWidth:window.innerWidth},this.handleDrawerStateChanged=this.handleDrawerStateChanged.bind(this),this.updateHeaderRef=this.updateHeaderRef.bind(this),this.closePair=this.closePair.bind(this)}async componentDidMount(){const{pairLoading:t,pairError:i,pairDongleId:u}=this.state;window.scrollTo({top:0});const p=new URLSearchParams(window.location.search);p.has("r")&&this.props.dispatch(gI(p.get("r"))),this.props.dispatch(tB());let m;try{m=await $s.getItem("pairToken")}catch(o){console.error(o)}if(m&&!t&&!i&&!u){this.setState({pairLoading:!0});try{hS(m,!0,"explorer_pair_verify_pairtoken")}catch(o){this.setState({pairLoading:!1,pairDongleId:null,pairError:`Error: ${o.message}`}),await $s.removeItem("pairToken");return}try{const o=await dS(m);if(o.dongle_id){await $s.removeItem("pairToken"),this.setState({pairLoading:!1,pairError:null,pairDongleId:o.dongle_id});const _=await fS(o.dongle_id);this.props.dispatch(oy(_)),this.props.dispatch(xa("pair_device",{method:"url_string"}))}else await $s.removeItem("pairToken"),console.log(o),this.setState({pairDongleId:null,pairLoading:!1,pairError:"Error: could not pair, please try again"})}catch(o){await $s.removeItem("pairToken");const _=mS(o,"explorer_pair_pairtoken");this.setState({pairDongleId:null,pairLoading:!1,pairError:`Error: ${_}, please try again`})}}this.componentDidUpdate({})}componentDidUpdate(t,i){const{pathname:u,zoom:p}=this.props;t.pathname!==u&&this.setState({drawerIsOpen:!1}),!t.zoom&&p&&this.props.dispatch(Cf()),t.zoom&&!p&&this.props.dispatch(gS())}async closePair(){const{pairDongleId:t}=this.state;await $s.removeItem("pairToken"),t&&this.props.dispatch(Ks(t)),this.setState({pairLoading:!1,pairError:null,pairDongleId:null})}handleDrawerStateChanged(t){this.setState({drawerIsOpen:t})}updateHeaderRef(t){this.state.headerRef||this.setState({headerRef:t})}render(){const{classes:t,zoom:i,devices:u,dongleId:p}=this.props,{drawerIsOpen:m,pairLoading:o,pairError:_,pairDongleId:b,windowWidth:E}=this.state,T=(u==null?void 0:u.length)===0&&!p,M=T||E>1080,I=T?0:Math.max(280,E*.2),N=this.state.headerRef?this.state.headerRef.getBoundingClientRect().height:E<640?111:66;let D={minHeight:`calc(100vh - ${N}px)`};M&&(D={...D,width:`calc(100% - ${I}px)`,marginLeft:I});const re={minHeight:`calc(100vh - ${N}px)`};return R.jsxs("div",{children:[R.jsx(Bc,{onResize:W=>this.setState({windowWidth:W})}),R.jsx(qN,{}),R.jsx(AO,{drawerIsOpen:m,annotating:!!i,showDrawerButton:!M,handleDrawerStateChanged:this.handleDrawerStateChanged,forwardRef:this.updateHeaderRef}),R.jsx(FN,{drawerIsOpen:m,isPermanent:M,width:I,handleDrawerStateChanged:this.handleDrawerStateChanged,style:re}),R.jsx("div",{className:t.window,style:D,children:T?R.jsx(B4,{}):i?R.jsx(N4,{}):R.jsx(fN,{})}),R.jsx(yN,{}),R.jsx(Mc,{open:!!(o||_||b),onClose:this.closePair,children:R.jsxs(Ic,{className:t.modal,children:[R.jsx(dt,{variant:"title",children:"Pairing device"}),R.jsx(Ja,{}),o&&R.jsx(ha,{size:32,className:t.fabProgress}),b&&R.jsxs(dt,{children:["Successfully paired device ",R.jsx("span",{className:t.pairedDongleId,children:b})]}),_&&R.jsx(dt,{children:_}),R.jsx(an,{variant:"contained",className:t.closeButton,onClick:this.closePair,children:"Close"})]})})]})}}const V4=pi({zoom:"zoom",pathname:"router.location.pathname",dongleId:"dongleId",devices:"devices"}),q4=Kn(V4)(ci.withStyles(F4)(U4)),Z4=Object.freeze(Object.defineProperty({__proto__:null,default:q4},Symbol.toStringTag,{value:"Module"}));export{an as B,Mc as M,Ic as P,Bc as R,Fg as d,Z4 as e,Pa as i,La as r};
//# sourceMappingURL=explorer-DGVTHNNb.js.map
